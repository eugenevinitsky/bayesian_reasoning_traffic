{"episode_reward_max": 0.28183319622133995, "episode_reward_min": -14.990000523058193, "episode_reward_mean": -7.365584214577889, "episode_len_mean": 269.55263157894734, "episodes_this_iter": 38, "policy_reward_min": {"av": -14.990000523058193}, "policy_reward_max": {"av": 0.28183319622133995}, "policy_reward_mean": {"av": -7.365584214577889}, "custom_metrics": {"num_ped_collisions_mean": 0.39473684210526316, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.15789473684210525, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.64945513715602, "avg_speed_min": 3.1116535162170345, "avg_speed_max": 5.802383302436866, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 20.77764211937203, "mean_processing_ms": 4.6794990082287296, "mean_inference_ms": 0.24732100593401615}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1920, "num_steps_sampled": 10830, "sample_time_ms": 43426.281, "load_time_ms": 56.41, "grad_time_ms": 1506.183, "update_time_ms": 964.531, "learner": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 22.86345100402832, "policy_loss": -0.016670765355229378, "vf_loss": 22.874589920043945, "vf_explained_var": 0.4160807430744171, "kl": 0.027670804411172867, "entropy": 1.407952904701233, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10830, "done": false, "timesteps_total": 10830, "episodes_total": 38, "training_iteration": 1, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-04-48", "timestamp": 1589875488, "time_this_iter_s": 45.99703860282898, "time_total_s": 45.99703860282898, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef256e7378>", "on_episode_step": "<function on_episode_step at 0x7fef205ee510>", "on_episode_end": "<function on_episode_end at 0x7fef205ee598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205ee950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 45.99703860282898, "timesteps_since_restore": 10830, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 76.06212121212121, "ram_util_percent": 28.837878787878786}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28183319622133995, "episode_reward_min": -14.990000523058193, "episode_reward_mean": -5.9994093650870495, "episode_len_mean": 301.9076923076923, "episodes_this_iter": 27, "policy_reward_min": {"av": -14.990000523058193}, "policy_reward_max": {"av": 0.28183319622133995}, "policy_reward_mean": {"av": -5.9994093650870495}, "custom_metrics": {"num_ped_collisions_mean": 0.3384615384615385, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1076923076923077, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.354561247509401, "avg_speed_min": 1.480866132984851, "avg_speed_max": 5.802383302436866, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 21.881657372256598, "mean_processing_ms": 4.411351294833905, "mean_inference_ms": 0.2594659977271555}, "off_policy_estimator": {}, "info": {"num_steps_trained": 4736, "num_steps_sampled": 20952, "sample_time_ms": 45545.009, "load_time_ms": 28.943, "grad_time_ms": 1467.178, "update_time_ms": 484.776, "learner": {"av": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 16.79878807067871, "policy_loss": -0.01995587721467018, "vf_loss": 16.81507110595703, "vf_explained_var": 0.2504090368747711, "kl": 0.012239298783242702, "entropy": 1.402750849723816, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10122, "done": false, "timesteps_total": 20952, "episodes_total": 65, "training_iteration": 2, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-05-37", "timestamp": 1589875537, "time_this_iter_s": 49.107739210128784, "time_total_s": 95.10477781295776, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205ee2f0>", "on_episode_step": "<function on_episode_step at 0x7fef205da510>", "on_episode_end": "<function on_episode_end at 0x7fef205da620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205da6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205ee0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 95.10477781295776, "timesteps_since_restore": 20952, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 83.80428571428571, "ram_util_percent": 29.164285714285715}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28183319622133995, "episode_reward_min": -14.99019537231357, "episode_reward_mean": -5.678770556034585, "episode_len_mean": 317.2421052631579, "episodes_this_iter": 30, "policy_reward_min": {"av": -14.99019537231357}, "policy_reward_max": {"av": 0.28183319622133995}, "policy_reward_mean": {"av": -5.678770556034585}, "custom_metrics": {"num_ped_collisions_mean": 0.3263157894736842, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09473684210526316, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.089542411035277, "avg_speed_min": 1.480866132984851, "avg_speed_max": 5.802383302436866, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 22.869467919778465, "mean_processing_ms": 4.298520924492842, "mean_inference_ms": 0.27532153791582864}, "off_policy_estimator": {}, "info": {"num_steps_trained": 7808, "num_steps_sampled": 31449, "sample_time_ms": 47371.703, "load_time_ms": 19.806, "grad_time_ms": 1536.516, "update_time_ms": 324.951, "learner": {"av": {"cur_kl_coeff": 0.30000001192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 10.08004379272461, "policy_loss": -0.004647558555006981, "vf_loss": 10.083584785461426, "vf_explained_var": 0.6937381625175476, "kl": 0.0036911964416503906, "entropy": 1.4361833333969116, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10497, "done": false, "timesteps_total": 31449, "episodes_total": 95, "training_iteration": 3, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-06-30", "timestamp": 1589875590, "time_this_iter_s": 52.717174768447876, "time_total_s": 147.82195258140564, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205ee598>", "on_episode_step": "<function on_episode_step at 0x7fef256dee18>", "on_episode_end": "<function on_episode_end at 0x7fef256deea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef256deb70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205eee18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 147.82195258140564, "timesteps_since_restore": 31449, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 82.73815789473686, "ram_util_percent": 29.199999999999985}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28175096442698777, "episode_reward_min": -14.99019537231357, "episode_reward_mean": -4.622935094300929, "episode_len_mean": 344.78, "episodes_this_iter": 26, "policy_reward_min": {"av": -14.99019537231357}, "policy_reward_max": {"av": 0.28175096442698777}, "policy_reward_mean": {"av": -4.622935094300929}, "custom_metrics": {"num_ped_collisions_mean": 0.26, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.83848074453833, "avg_speed_min": 0.8552648618096284, "avg_speed_max": 5.802383302436866, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.90976775188291, "mean_processing_ms": 4.085697951013703, "mean_inference_ms": 0.291821811333365}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11008, "num_steps_sampled": 41829, "sample_time_ms": 48011.495, "load_time_ms": 15.205, "grad_time_ms": 1652.208, "update_time_ms": 244.809, "learner": {"av": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 13.802355766296387, "policy_loss": -0.007539324928075075, "vf_loss": 13.808598518371582, "vf_explained_var": 0.6177648305892944, "kl": 0.008646730333566666, "entropy": 1.4727377891540527, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10380, "done": false, "timesteps_total": 41829, "episodes_total": 121, "training_iteration": 4, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-07-22", "timestamp": 1589875642, "time_this_iter_s": 51.945284843444824, "time_total_s": 199.76723742485046, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef21e3aa60>", "on_episode_step": "<function on_episode_step at 0x7fef21e3a950>", "on_episode_end": "<function on_episode_end at 0x7fef21e3ad90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef21e3ae18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205ee0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 199.76723742485046, "timesteps_since_restore": 41829, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 84.99189189189188, "ram_util_percent": 29.19999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28175096442698777, "episode_reward_min": -14.99019537231357, "episode_reward_mean": -3.098938694453446, "episode_len_mean": 391.11, "episodes_this_iter": 20, "policy_reward_min": {"av": -14.99019537231357}, "policy_reward_max": {"av": 0.28175096442698777}, "policy_reward_mean": {"av": -3.098938694453446}, "custom_metrics": {"num_ped_collisions_mean": 0.2, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.527452690683037, "avg_speed_min": 0.5371510261604936, "avg_speed_max": 5.471100883538104, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 24.893194502730257, "mean_processing_ms": 3.8514304881770456, "mean_inference_ms": 0.3093948731926089}, "off_policy_estimator": {}, "info": {"num_steps_trained": 14848, "num_steps_sampled": 51892, "sample_time_ms": 48305.219, "load_time_ms": 12.687, "grad_time_ms": 1808.968, "update_time_ms": 196.807, "learner": {"av": {"cur_kl_coeff": 0.15000000596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 1.627868413925171, "policy_loss": -0.0016808018554002047, "vf_loss": 1.6288198232650757, "vf_explained_var": 0.34534019231796265, "kl": 0.004863531328737736, "entropy": 1.4524444341659546, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10063, "done": false, "timesteps_total": 51892, "episodes_total": 141, "training_iteration": 5, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-08-14", "timestamp": 1589875694, "time_this_iter_s": 51.94548201560974, "time_total_s": 251.7127194404602, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205ee7b8>", "on_episode_step": "<function on_episode_step at 0x7fef205ee8c8>", "on_episode_end": "<function on_episode_end at 0x7fef256dec80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef256def28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef256e7268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 251.7127194404602, "timesteps_since_restore": 51892, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 81.6256756756757, "ram_util_percent": 29.19999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28175096442698777, "episode_reward_min": -14.99019537231357, "episode_reward_mean": -2.540946300979245, "episode_len_mean": 411.67, "episodes_this_iter": 22, "policy_reward_min": {"av": -14.99019537231357}, "policy_reward_max": {"av": 0.28175096442698777}, "policy_reward_mean": {"av": -2.540946300979245}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.336368907856508, "avg_speed_min": 0.5371510261604936, "avg_speed_max": 5.856276244676158, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 25.58178857110702, "mean_processing_ms": 3.735863988157655, "mean_inference_ms": 0.3270325249007849}, "off_policy_estimator": {}, "info": {"num_steps_trained": 18816, "num_steps_sampled": 62002, "sample_time_ms": 48743.224, "load_time_ms": 10.922, "grad_time_ms": 1933.436, "update_time_ms": 164.802, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 2.61588454246521, "policy_loss": -0.024190828204154968, "vf_loss": 2.637036085128784, "vf_explained_var": 0.421556681394577, "kl": 0.040520619601011276, "entropy": 1.4809417724609375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10110, "done": false, "timesteps_total": 62002, "episodes_total": 163, "training_iteration": 6, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-09-07", "timestamp": 1589875747, "time_this_iter_s": 53.50625729560852, "time_total_s": 305.2189767360687, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef256e7378>", "on_episode_step": "<function on_episode_step at 0x7fef256deea0>", "on_episode_end": "<function on_episode_end at 0x7fef205eee18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205ee730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 305.2189767360687, "timesteps_since_restore": 62002, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 82.6328947368421, "ram_util_percent": 29.261842105263167}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817002478044528, "episode_reward_min": -14.98977592173006, "episode_reward_mean": -1.3932925070684237, "episode_len_mean": 436.84, "episodes_this_iter": 24, "policy_reward_min": {"av": -14.98977592173006}, "policy_reward_max": {"av": 0.2817002478044528}, "policy_reward_mean": {"av": -1.3932925070684237}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9035157082073706, "avg_speed_min": 0.5371510261604936, "avg_speed_max": 5.856276244676158, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 26.51442802233581, "mean_processing_ms": 3.567400774754371, "mean_inference_ms": 0.3538364885937473}, "off_policy_estimator": {}, "info": {"num_steps_trained": 25728, "num_steps_sampled": 72150, "sample_time_ms": 51955.372, "load_time_ms": 9.729, "grad_time_ms": 2302.597, "update_time_ms": 142.005, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.698959231376648, "policy_loss": -0.00963278952986002, "vf_loss": 0.7064799666404724, "vf_explained_var": 0.5715729594230652, "kl": 0.018774421885609627, "entropy": 1.4409247636795044, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10148, "done": false, "timesteps_total": 72150, "episodes_total": 187, "training_iteration": 7, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-10-23", "timestamp": 1589875823, "time_this_iter_s": 75.76546263694763, "time_total_s": 380.98443937301636, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef256e7510>", "on_episode_step": "<function on_episode_step at 0x7fef20583730>", "on_episode_end": "<function on_episode_end at 0x7fef20583840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205838c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 380.98443937301636, "timesteps_since_restore": 72150, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 84.84722222222223, "ram_util_percent": 29.289814814814825}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2816832831429734, "episode_reward_min": -14.989471139590462, "episode_reward_mean": -0.8511590554055705, "episode_len_mean": 447.64, "episodes_this_iter": 21, "policy_reward_min": {"av": -14.989471139590462}, "policy_reward_max": {"av": 0.2816832831429734}, "policy_reward_mean": {"av": -0.8597566216217881}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.626666661884753, "avg_speed_min": 0.5371510261604936, "avg_speed_max": 5.856276244676158, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.479839993872883, "mean_processing_ms": 3.5074627033384327, "mean_inference_ms": 0.38152942308031723}, "off_policy_estimator": {}, "info": {"num_steps_trained": 32256, "num_steps_sampled": 82291, "sample_time_ms": 54148.405, "load_time_ms": 8.831, "grad_time_ms": 2537.694, "update_time_ms": 124.979, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 2.339221239089966, "policy_loss": -0.004016810096800327, "vf_loss": 2.3419742584228516, "vf_explained_var": 0.30092939734458923, "kl": 0.011235104873776436, "entropy": 1.4787802696228027, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10141, "done": false, "timesteps_total": 82291, "episodes_total": 208, "training_iteration": 8, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-11-37", "timestamp": 1589875897, "time_this_iter_s": 73.70092439651489, "time_total_s": 454.68536376953125, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205837b8>", "on_episode_step": "<function on_episode_step at 0x7fef205839d8>", "on_episode_end": "<function on_episode_end at 0x7fef20583950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20583ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 454.68536376953125, "timesteps_since_restore": 82291, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 84.47428571428571, "ram_util_percent": 29.300000000000008}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2816832831429734, "episode_reward_min": -14.988884166003897, "episode_reward_mean": -0.3335268426480891, "episode_len_mean": 463.53, "episodes_this_iter": 21, "policy_reward_min": {"av": -14.988884166003897}, "policy_reward_max": {"av": 0.2816832831429734}, "policy_reward_mean": {"av": -0.33689580065463526}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.0743547545567376, "avg_speed_min": 0.4395883109919579, "avg_speed_max": 5.856276244676158, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 28.908085943512106, "mean_processing_ms": 3.433227055089008, "mean_inference_ms": 0.4199432482481372}, "off_policy_estimator": {}, "info": {"num_steps_trained": 40192, "num_steps_sampled": 92461, "sample_time_ms": 56701.01, "load_time_ms": 8.144, "grad_time_ms": 2766.535, "update_time_ms": 111.826, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13239715993404388, "policy_loss": -0.006269312929362059, "vf_loss": 0.13730917870998383, "vf_explained_var": 0.5688555240631104, "kl": 0.012064862996339798, "entropy": 1.4807130098342896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10170, "done": false, "timesteps_total": 92461, "episodes_total": 229, "training_iteration": 9, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-12-59", "timestamp": 1589875979, "time_this_iter_s": 81.7368860244751, "time_total_s": 536.4222497940063, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583c80>", "on_episode_step": "<function on_episode_step at 0x7fef205831e0>", "on_episode_end": "<function on_episode_end at 0x7fef20583268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20583488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef256e7488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 536.4222497940063, "timesteps_since_restore": 92461, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 84.8777777777778, "ram_util_percent": 29.300000000000015}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2816832831429734, "episode_reward_min": -14.988884166003897, "episode_reward_mean": -0.1440957112483284, "episode_len_mean": 467.0, "episodes_this_iter": 21, "policy_reward_min": {"av": -14.988884166003897}, "policy_reward_max": {"av": 0.2816832831429734}, "policy_reward_mean": {"av": -0.14555122348316}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.941256361305881, "avg_speed_min": 0.4395883109919579, "avg_speed_max": 5.856276244676158, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.303899103439548, "mean_processing_ms": 3.3861625617009548, "mean_inference_ms": 0.45554473389380185}, "off_policy_estimator": {}, "info": {"num_steps_trained": 46208, "num_steps_sampled": 102597, "sample_time_ms": 57829.055, "load_time_ms": 7.575, "grad_time_ms": 2816.277, "update_time_ms": 101.187, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.024687839671969414, "policy_loss": -0.015116407535970211, "vf_loss": 0.03833320364356041, "vf_explained_var": 0.8349946141242981, "kl": 0.013075985945761204, "entropy": 1.4330228567123413, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10136, "done": false, "timesteps_total": 102597, "episodes_total": 250, "training_iteration": 10, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-14-10", "timestamp": 1589876050, "time_this_iter_s": 71.26071858406067, "time_total_s": 607.682968378067, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583ae8>", "on_episode_step": "<function on_episode_step at 0x7fef205daae8>", "on_episode_end": "<function on_episode_end at 0x7fef205dae18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205da048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2221be18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 607.682968378067, "timesteps_since_restore": 102597, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 84.95882352941177, "ram_util_percent": 29.30000000000002}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2818085115996839, "episode_reward_min": -14.988884166003897, "episode_reward_mean": -0.002904485552267385, "episode_len_mean": 454.34, "episodes_this_iter": 26, "policy_reward_min": {"av": -14.988884166003897}, "policy_reward_max": {"av": 0.2818085115996839}, "policy_reward_mean": {"av": -0.0029943150023375212}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.794327344220127, "avg_speed_min": 0.4395883109919579, "avg_speed_max": 5.763696194189544, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.978300729299164, "mean_processing_ms": 3.366134261832087, "mean_inference_ms": 0.4978661137385432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 51712, "num_steps_sampled": 112801, "sample_time_ms": 59897.171, "load_time_ms": 2.148, "grad_time_ms": 3016.679, "update_time_ms": 5.141, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.033295270055532455, "policy_loss": -0.01098165288567543, "vf_loss": 0.042178817093372345, "vf_explained_var": 0.8275571465492249, "kl": 0.018649915233254433, "entropy": 1.4547278881072998, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10204, "done": false, "timesteps_total": 112801, "episodes_total": 276, "training_iteration": 11, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-15-18", "timestamp": 1589876118, "time_this_iter_s": 67.63454723358154, "time_total_s": 675.3175156116486, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205da2f0>", "on_episode_step": "<function on_episode_step at 0x7fef21e3aae8>", "on_episode_end": "<function on_episode_end at 0x7fef21e3af28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef21e3ad08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 675.3175156116486, "timesteps_since_restore": 112801, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 85.81979166666667, "ram_util_percent": 29.302083333333343}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2818085115996839, "episode_reward_min": 0.0, "episode_reward_mean": 0.17393553193469655, "episode_len_mean": 466.44, "episodes_this_iter": 20, "policy_reward_min": {"av": 0.0004580328060310247}, "policy_reward_max": {"av": 0.2818085115996839}, "policy_reward_mean": {"av": 0.17748523666805768}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.0404201403083335, "avg_speed_min": 0.4395883109919579, "avg_speed_max": 5.763696194189544, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 32.61209633534932, "mean_processing_ms": 3.33814676907296, "mean_inference_ms": 0.5136059789863336}, "off_policy_estimator": {}, "info": {"num_steps_trained": 55680, "num_steps_sampled": 123136, "sample_time_ms": 60261.239, "load_time_ms": 2.24, "grad_time_ms": 3112.985, "update_time_ms": 5.327, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05237709730863571, "policy_loss": -0.0070603592321276665, "vf_loss": 0.05811462923884392, "vf_explained_var": 0.7770259976387024, "kl": 0.011758551932871342, "entropy": 1.4377782344818115, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10335, "done": false, "timesteps_total": 123136, "episodes_total": 296, "training_iteration": 12, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-16-11", "timestamp": 1589876171, "time_this_iter_s": 53.71338367462158, "time_total_s": 729.0308992862701, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583ea0>", "on_episode_step": "<function on_episode_step at 0x7fef2054ca60>", "on_episode_end": "<function on_episode_end at 0x7fef2054c048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2054cbf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205837b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 729.0308992862701, "timesteps_since_restore": 123136, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 82.77792207792206, "ram_util_percent": 29.310389610389624}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2818085115996839, "episode_reward_min": -14.979254950590747, "episode_reward_mean": -0.09939298534477066, "episode_len_mean": 458.79, "episodes_this_iter": 22, "policy_reward_min": {"av": -14.979254950590747}, "policy_reward_max": {"av": 0.2818085115996839}, "policy_reward_mean": {"av": -0.10246699520079451}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.311371377904022, "avg_speed_min": 0.4395883109919579, "avg_speed_max": 5.763696194189544, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 32.9785585324912, "mean_processing_ms": 3.3176245573538825, "mean_inference_ms": 0.5234132376798609}, "off_policy_estimator": {}, "info": {"num_steps_trained": 59136, "num_steps_sampled": 133141, "sample_time_ms": 59904.521, "load_time_ms": 2.246, "grad_time_ms": 3157.776, "update_time_ms": 5.366, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 4.393416404724121, "policy_loss": -0.005239368416368961, "vf_loss": 4.397702217102051, "vf_explained_var": 0.2610428035259247, "kl": 0.00847845058888197, "entropy": 1.478742241859436, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10005, "done": false, "timesteps_total": 133141, "episodes_total": 318, "training_iteration": 13, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-17-01", "timestamp": 1589876221, "time_this_iter_s": 49.597395181655884, "time_total_s": 778.628294467926, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2054c9d8>", "on_episode_step": "<function on_episode_step at 0x7fef205dab70>", "on_episode_end": "<function on_episode_end at 0x7fef205daea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205da158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef256e7510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 778.628294467926, "timesteps_since_restore": 133141, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 81.21126760563381, "ram_util_percent": 29.32535211267606}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2818085115996839, "episode_reward_min": -14.979254950590747, "episode_reward_mean": -0.21476273247856437, "episode_len_mean": 451.84, "episodes_this_iter": 23, "policy_reward_min": {"av": -14.979254950590747}, "policy_reward_max": {"av": 0.2818085115996839}, "policy_reward_mean": {"av": -0.2214048788438808}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.9139421177561133, "avg_speed_min": 0.509183484218883, "avg_speed_max": 6.38320507994587, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 32.86443277216963, "mean_processing_ms": 3.3021046963812934, "mean_inference_ms": 0.5210656782282623}, "off_policy_estimator": {}, "info": {"num_steps_trained": 61440, "num_steps_sampled": 143315, "sample_time_ms": 59047.538, "load_time_ms": 2.229, "grad_time_ms": 3094.811, "update_time_ms": 5.626, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0506889820098877, "policy_loss": -0.010690459050238132, "vf_loss": 1.0601634979248047, "vf_explained_var": 0.8425320982933044, "kl": 0.010807016864418983, "entropy": 1.4967436790466309, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10174, "done": false, "timesteps_total": 143315, "episodes_total": 341, "training_iteration": 14, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-17-44", "timestamp": 1589876264, "time_this_iter_s": 42.7509548664093, "time_total_s": 821.3792493343353, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef21e3ab70>", "on_episode_step": "<function on_episode_step at 0x7fef205da6a8>", "on_episode_end": "<function on_episode_end at 0x7fef205daa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205da8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef21e3ac80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 821.3792493343353, "timesteps_since_restore": 143315, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 82.8967213114754, "ram_util_percent": 29.3}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2818085115996839, "episode_reward_min": -14.98931373301896, "episode_reward_mean": -0.803358800583341, "episode_len_mean": 462.18, "episodes_this_iter": 23, "policy_reward_min": {"av": -14.98931373301896}, "policy_reward_max": {"av": 0.2818085115996839}, "policy_reward_mean": {"av": -0.8197538781462664}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.0843212858237776, "avg_speed_min": 0.5157448866038334, "avg_speed_max": 6.38320507994587, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 32.398226394659325, "mean_processing_ms": 3.276521650309046, "mean_inference_ms": 0.5098910592764694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 64640, "num_steps_sampled": 153674, "sample_time_ms": 58665.964, "load_time_ms": 2.121, "grad_time_ms": 3047.891, "update_time_ms": 5.837, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 6.128831386566162, "policy_loss": -0.013163086958229542, "vf_loss": 6.140139579772949, "vf_explained_var": 0.6912455558776855, "kl": 0.01648549921810627, "entropy": 1.501451015472412, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10359, "done": false, "timesteps_total": 153674, "episodes_total": 364, "training_iteration": 15, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-18-32", "timestamp": 1589876312, "time_this_iter_s": 47.65074610710144, "time_total_s": 869.0299954414368, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef21e3ad90>", "on_episode_step": "<function on_episode_step at 0x7fef205da7b8>", "on_episode_end": "<function on_episode_end at 0x7fef205da950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205dabf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 869.0299954414368, "timesteps_since_restore": 153674, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 81.79558823529412, "ram_util_percent": 29.314705882352946}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817515646851359, "episode_reward_min": -14.98931373301896, "episode_reward_mean": -0.9481146726789484, "episode_len_mean": 458.19, "episodes_this_iter": 23, "policy_reward_min": {"av": -14.98931373301896}, "policy_reward_max": {"av": 0.2817515646851359}, "policy_reward_mean": {"av": -0.9576915885645944}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.290887531709339, "avg_speed_min": 1.1852696046895854, "avg_speed_max": 6.38320507994587, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.91163615376378, "mean_processing_ms": 3.2544423531690234, "mean_inference_ms": 0.49846889341506795}, "off_policy_estimator": {}, "info": {"num_steps_trained": 67328, "num_steps_sampled": 163946, "sample_time_ms": 57959.509, "load_time_ms": 2.111, "grad_time_ms": 2963.521, "update_time_ms": 5.826, "learner": {"av": {"cur_kl_coeff": 0.11249999701976776, "cur_lr": 4.999999873689376e-05, "total_loss": 2.0669825077056885, "policy_loss": -0.010707972571253777, "vf_loss": 2.074712038040161, "vf_explained_var": 0.7394726872444153, "kl": 0.026475219056010246, "entropy": 1.5902841091156006, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10272, "done": false, "timesteps_total": 163946, "episodes_total": 387, "training_iteration": 16, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-19-17", "timestamp": 1589876357, "time_this_iter_s": 45.59736251831055, "time_total_s": 914.6273579597473, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef21e3ac80>", "on_episode_step": "<function on_episode_step at 0x7fef204f7400>", "on_episode_end": "<function on_episode_end at 0x7fef204f7488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204f7510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204f7b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 914.6273579597473, "timesteps_since_restore": 163946, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 82.13076923076925, "ram_util_percent": 29.340000000000003}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817515646851359, "episode_reward_min": -14.98931373301896, "episode_reward_mean": -0.7955540869899944, "episode_len_mean": 461.95, "episodes_this_iter": 21, "policy_reward_min": {"av": -14.98931373301896}, "policy_reward_max": {"av": 0.2817515646851359}, "policy_reward_mean": {"av": -0.8035899868585801}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.5430376932807337, "avg_speed_min": 1.1852696046895854, "avg_speed_max": 6.628668840843789, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.396526254253928, "mean_processing_ms": 3.2364529900731327, "mean_inference_ms": 0.4857976735748039}, "off_policy_estimator": {}, "info": {"num_steps_trained": 69760, "num_steps_sampled": 174108, "sample_time_ms": 54905.58, "load_time_ms": 2.016, "grad_time_ms": 2665.19, "update_time_ms": 5.96, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.22030511498451233, "policy_loss": -0.007888704538345337, "vf_loss": 0.2267487645149231, "vf_explained_var": 0.6454598903656006, "kl": 0.008563403971493244, "entropy": 1.615555763244629, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10162, "done": false, "timesteps_total": 174108, "episodes_total": 408, "training_iteration": 17, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-20-00", "timestamp": 1589876400, "time_this_iter_s": 42.24036264419556, "time_total_s": 956.8677206039429, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583bf8>", "on_episode_step": "<function on_episode_step at 0x7fef205ee730>", "on_episode_end": "<function on_episode_end at 0x7fef205eee18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205ee048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 956.8677206039429, "timesteps_since_restore": 174108, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 82.68333333333334, "ram_util_percent": 29.376666666666672}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28175155612266967, "episode_reward_min": -14.98931373301896, "episode_reward_mean": -0.6429654003911955, "episode_len_mean": 465.82, "episodes_this_iter": 20, "policy_reward_min": {"av": -14.98931373301896}, "policy_reward_max": {"av": 0.28175155612266967}, "policy_reward_mean": {"av": -0.6494600003951468}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.4854230366166172, "avg_speed_min": 1.1852696046895854, "avg_speed_max": 6.628668840843789, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 31.07920528474463, "mean_processing_ms": 3.213291981995927, "mean_inference_ms": 0.47845092958739877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 72832, "num_steps_sampled": 184311, "sample_time_ms": 52269.768, "load_time_ms": 1.964, "grad_time_ms": 2438.428, "update_time_ms": 6.02, "learner": {"av": {"cur_kl_coeff": 0.16875000298023224, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08584588766098022, "policy_loss": -0.01867610216140747, "vf_loss": 0.10057307034730911, "vf_explained_var": 0.8061898350715637, "kl": 0.023400984704494476, "entropy": 1.610001564025879, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10203, "done": false, "timesteps_total": 184311, "episodes_total": 428, "training_iteration": 18, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-20-45", "timestamp": 1589876445, "time_this_iter_s": 45.07579040527344, "time_total_s": 1001.9435110092163, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205daa60>", "on_episode_step": "<function on_episode_step at 0x7fef205ee400>", "on_episode_end": "<function on_episode_end at 0x7fef205eef28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205ee268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204ff510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1001.9435110092163, "timesteps_since_restore": 184311, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 81.42769230769231, "ram_util_percent": 29.395384615384618}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28175155612266967, "episode_reward_min": -14.98931373301896, "episode_reward_mean": -0.18515049893446736, "episode_len_mean": 477.11, "episodes_this_iter": 22, "policy_reward_min": {"av": -14.98931373301896}, "policy_reward_max": {"av": 0.28175155612266967}, "policy_reward_mean": {"av": -0.18702070599441148}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.4694739281776763, "avg_speed_min": 1.1852696046895854, "avg_speed_max": 6.628668840843789, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.70377305126163, "mean_processing_ms": 3.195045602728596, "mean_inference_ms": 0.46988209074025067}, "off_policy_estimator": {}, "info": {"num_steps_trained": 75776, "num_steps_sampled": 194538, "sample_time_ms": 48897.684, "load_time_ms": 1.88, "grad_time_ms": 2170.404, "update_time_ms": 6.022, "learner": {"av": {"cur_kl_coeff": 0.25312501192092896, "cur_lr": 4.999999873689376e-05, "total_loss": 0.09203518182039261, "policy_loss": -0.003931001760065556, "vf_loss": 0.09498172998428345, "vf_explained_var": 0.8056763410568237, "kl": 0.003889156971126795, "entropy": 1.6949224472045898, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10227, "done": false, "timesteps_total": 194538, "episodes_total": 450, "training_iteration": 19, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-21-30", "timestamp": 1589876490, "time_this_iter_s": 45.33717155456543, "time_total_s": 1047.2806825637817, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205da840>", "on_episode_step": "<function on_episode_step at 0x7fef205da378>", "on_episode_end": "<function on_episode_end at 0x7fef205da158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205da0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204ff950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1047.2806825637817, "timesteps_since_restore": 194538, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 80.28750000000001, "ram_util_percent": 29.395312500000003}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28175155612266967, "episode_reward_min": -14.979188503744778, "episode_reward_mean": 0.017544137365301443, "episode_len_mean": 480.62, "episodes_this_iter": 20, "policy_reward_min": {"av": -14.979188503744778}, "policy_reward_max": {"av": 0.28175155612266967}, "policy_reward_mean": {"av": 0.017721350874041853}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4710735510004516, "avg_speed_min": 1.3786910083998787, "avg_speed_max": 6.628668840843789, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.384610670584383, "mean_processing_ms": 3.172541274157228, "mean_inference_ms": 0.46246239119577204}, "off_policy_estimator": {}, "info": {"num_steps_trained": 79104, "num_steps_sampled": 204711, "sample_time_ms": 46936.379, "load_time_ms": 1.793, "grad_time_ms": 2027.038, "update_time_ms": 6.052, "learner": {"av": {"cur_kl_coeff": 0.12656250596046448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9870587587356567, "policy_loss": -0.015438789501786232, "vf_loss": 0.9994699954986572, "vf_explained_var": 0.5152323246002197, "kl": 0.023921512067317963, "entropy": 1.6305782794952393, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10173, "done": false, "timesteps_total": 204711, "episodes_total": 470, "training_iteration": 20, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-22-21", "timestamp": 1589876541, "time_this_iter_s": 50.21384072303772, "time_total_s": 1097.4945232868195, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef21e3aa60>", "on_episode_step": "<function on_episode_step at 0x7fef20583e18>", "on_episode_end": "<function on_episode_end at 0x7fef20583730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20583f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1097.4945232868195, "timesteps_since_restore": 204711, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 82.16805555555555, "ram_util_percent": 29.398611111111116}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28174627159466686, "episode_reward_min": -14.979258433940618, "episode_reward_mean": -0.4430669752054536, "episode_len_mean": 464.03, "episodes_this_iter": 26, "policy_reward_min": {"av": -14.979258433940618}, "policy_reward_max": {"av": 0.28174627159466686}, "policy_reward_mean": {"av": -0.4475423991974279}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4692950178261066, "avg_speed_min": 1.3786910083998787, "avg_speed_max": 6.628668840843789, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 30.067407129839804, "mean_processing_ms": 3.158600595357442, "mean_inference_ms": 0.45493431104040155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 81920, "num_steps_sampled": 214868, "sample_time_ms": 44996.22, "load_time_ms": 1.72, "grad_time_ms": 1813.684, "update_time_ms": 6.206, "learner": {"av": {"cur_kl_coeff": 0.18984374403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 1.9219341278076172, "policy_loss": -0.0021388656459748745, "vf_loss": 1.9230221509933472, "vf_explained_var": 0.8608383536338806, "kl": 0.005534535273909569, "entropy": 1.6401313543319702, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10157, "done": false, "timesteps_total": 214868, "episodes_total": 496, "training_iteration": 21, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-23-07", "timestamp": 1589876587, "time_this_iter_s": 46.09760761260986, "time_total_s": 1143.5921308994293, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583ea0>", "on_episode_step": "<function on_episode_step at 0x7fef205830d0>", "on_episode_end": "<function on_episode_end at 0x7fef20583b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20583378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef21e3af28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1143.5921308994293, "timesteps_since_restore": 214868, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 82.27878787878788, "ram_util_percent": 29.398484848484852}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28174627159466686, "episode_reward_min": -14.979258433940618, "episode_reward_mean": -0.4402359061924245, "episode_len_mean": 468.52, "episodes_this_iter": 19, "policy_reward_min": {"av": -14.979258433940618}, "policy_reward_max": {"av": 0.28174627159466686}, "policy_reward_mean": {"av": -0.4402359061924245}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3201166748410516, "avg_speed_min": 1.3786910083998787, "avg_speed_max": 6.026649288017292, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.93323633923662, "mean_processing_ms": 3.1463005634845356, "mean_inference_ms": 0.4517637346562286}, "off_policy_estimator": {}, "info": {"num_steps_trained": 84992, "num_steps_sampled": 224959, "sample_time_ms": 44503.241, "load_time_ms": 1.661, "grad_time_ms": 1747.281, "update_time_ms": 6.104, "learner": {"av": {"cur_kl_coeff": 0.18984374403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15052686631679535, "policy_loss": -0.011737209744751453, "vf_loss": 0.16058261692523956, "vf_explained_var": 0.7023372650146484, "kl": 0.00885701086372137, "entropy": 1.57025945186615, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10091, "done": false, "timesteps_total": 224959, "episodes_total": 515, "training_iteration": 22, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-23-55", "timestamp": 1589876635, "time_this_iter_s": 48.11881351470947, "time_total_s": 1191.7109444141388, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef256deb70>", "on_episode_step": "<function on_episode_step at 0x7fef204f7d90>", "on_episode_end": "<function on_episode_end at 0x7fef205ee1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205ee268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef256ded90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1191.7109444141388, "timesteps_since_restore": 224959, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 83.5449275362319, "ram_util_percent": 29.40000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817269418566115, "episode_reward_min": -14.979258433940618, "episode_reward_mean": -0.5428685398477344, "episode_len_mean": 464.57, "episodes_this_iter": 23, "policy_reward_min": {"av": -14.979258433940618}, "policy_reward_max": {"av": 0.2817269418566115}, "policy_reward_mean": {"av": -0.5428685398477344}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3448873165067745, "avg_speed_min": 1.4975295178831944, "avg_speed_max": 6.579778741260003, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.71592815389358, "mean_processing_ms": 3.1352859478158717, "mean_inference_ms": 0.44566315769208154}, "off_policy_estimator": {}, "info": {"num_steps_trained": 87680, "num_steps_sampled": 235199, "sample_time_ms": 44147.988, "load_time_ms": 1.671, "grad_time_ms": 1711.164, "update_time_ms": 6.079, "learner": {"av": {"cur_kl_coeff": 0.18984374403953552, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2771730422973633, "policy_loss": -0.018976939842104912, "vf_loss": 1.2909201383590698, "vf_explained_var": 0.5171132683753967, "kl": 0.027547651901841164, "entropy": 1.5874210596084595, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10240, "done": false, "timesteps_total": 235199, "episodes_total": 538, "training_iteration": 23, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-24-41", "timestamp": 1589876681, "time_this_iter_s": 45.68511486053467, "time_total_s": 1237.3960592746735, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f77b8>", "on_episode_step": "<function on_episode_step at 0x7fef204ffb70>", "on_episode_end": "<function on_episode_end at 0x7fef204ffae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ffc80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204d10d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1237.3960592746735, "timesteps_since_restore": 235199, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 84.35538461538462, "ram_util_percent": 29.39846153846154}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817269418566115, "episode_reward_min": -14.979258433940618, "episode_reward_mean": -0.6429080703491133, "episode_len_mean": 460.59, "episodes_this_iter": 21, "policy_reward_min": {"av": -14.979258433940618}, "policy_reward_max": {"av": 0.2817269418566115}, "policy_reward_mean": {"av": -0.6429080703491133}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5945854879073265, "avg_speed_min": 1.4975295178831944, "avg_speed_max": 6.848473172504574, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.567454068420602, "mean_processing_ms": 3.124887676453577, "mean_inference_ms": 0.44085157203569714}, "off_policy_estimator": {}, "info": {"num_steps_trained": 89856, "num_steps_sampled": 245500, "sample_time_ms": 44215.098, "load_time_ms": 1.67, "grad_time_ms": 1698.344, "update_time_ms": 6.118, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.20693832635879517, "policy_loss": -0.01303760427981615, "vf_loss": 0.21737512946128845, "vf_explained_var": 0.6992806792259216, "kl": 0.00913317408412695, "entropy": 1.500905990600586, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10301, "done": false, "timesteps_total": 245500, "episodes_total": 559, "training_iteration": 24, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-25-24", "timestamp": 1589876724, "time_this_iter_s": 43.29124212265015, "time_total_s": 1280.6873013973236, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204ff268>", "on_episode_step": "<function on_episode_step at 0x7fef204ff1e0>", "on_episode_end": "<function on_episode_end at 0x7fef204ff7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ff840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204ff620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1280.6873013973236, "timesteps_since_restore": 245500, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 84.75645161290323, "ram_util_percent": 29.40000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817751882190379, "episode_reward_min": -14.978298758338445, "episode_reward_mean": -0.08521576579422191, "episode_len_mean": 472.37, "episodes_this_iter": 22, "policy_reward_min": {"av": -14.978298758338445}, "policy_reward_max": {"av": 0.2817751882190379}, "policy_reward_mean": {"av": -0.08521576579422191}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.52427108802854, "avg_speed_min": 1.3858725982485394, "avg_speed_max": 6.848473172504574, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 29.413991405072064, "mean_processing_ms": 3.1129719579483366, "mean_inference_ms": 0.43595372803757715}, "off_policy_estimator": {}, "info": {"num_steps_trained": 93056, "num_steps_sampled": 255739, "sample_time_ms": 44278.532, "load_time_ms": 1.657, "grad_time_ms": 1698.038, "update_time_ms": 6.134, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.031049618497490883, "policy_loss": -0.013363680802285671, "vf_loss": 0.04243417829275131, "vf_explained_var": 0.9189208149909973, "kl": 0.00694999797269702, "entropy": 1.5309569835662842, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10239, "done": false, "timesteps_total": 255739, "episodes_total": 581, "training_iteration": 25, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-26-12", "timestamp": 1589876772, "time_this_iter_s": 48.28073525428772, "time_total_s": 1328.9680366516113, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204ff488>", "on_episode_step": "<function on_episode_step at 0x7fef205838c8>", "on_episode_end": "<function on_episode_end at 0x7fef205831e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205837b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1328.9680366516113, "timesteps_since_restore": 255739, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 83.42608695652171, "ram_util_percent": 29.398550724637687}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817751882190379, "episode_reward_min": -9.985540841336203, "episode_reward_mean": 0.07020445201267393, "episode_len_mean": 480.87, "episodes_this_iter": 21, "policy_reward_min": {"av": -9.985540841336203}, "policy_reward_max": {"av": 0.2817751882190379}, "policy_reward_mean": {"av": 0.07020445201267393}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5529464897743592, "avg_speed_min": 1.3858725982485394, "avg_speed_max": 6.848473172504574, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 29.293405070180246, "mean_processing_ms": 3.099901770133053, "mean_inference_ms": 0.4323174445080816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 95872, "num_steps_sampled": 265945, "sample_time_ms": 44262.353, "load_time_ms": 1.632, "grad_time_ms": 1709.522, "update_time_ms": 6.267, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03563198447227478, "policy_loss": -0.0069844662211835384, "vf_loss": 0.04071434959769249, "vf_explained_var": 0.9226548671722412, "kl": 0.006679529324173927, "entropy": 1.499755859375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10206, "done": false, "timesteps_total": 265945, "episodes_total": 602, "training_iteration": 26, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-26-58", "timestamp": 1589876818, "time_this_iter_s": 45.552080154418945, "time_total_s": 1374.5201168060303, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205da730>", "on_episode_step": "<function on_episode_step at 0x7fef205da620>", "on_episode_end": "<function on_episode_end at 0x7fef205dab70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205dac80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204e3510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1374.5201168060303, "timesteps_since_restore": 265945, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 82.66153846153846, "ram_util_percent": 29.400000000000002}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817751882190379, "episode_reward_min": -9.985540841336203, "episode_reward_mean": 0.067424436442839, "episode_len_mean": 476.89, "episodes_this_iter": 22, "policy_reward_min": {"av": -9.985540841336203}, "policy_reward_max": {"av": 0.2817751882190379}, "policy_reward_mean": {"av": 0.067424436442839}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.569342510307266, "avg_speed_min": 1.3858725982485394, "avg_speed_max": 6.848473172504574, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 29.070385942472548, "mean_processing_ms": 3.090281472131247, "mean_inference_ms": 0.426066421614077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 98304, "num_steps_sampled": 276433, "sample_time_ms": 44421.39, "load_time_ms": 1.627, "grad_time_ms": 1706.562, "update_time_ms": 6.3, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.04219045490026474, "policy_loss": -0.007758782245218754, "vf_loss": 0.047265805304050446, "vf_explained_var": 0.9140089154243469, "kl": 0.009423316456377506, "entropy": 1.5615010261535645, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10488, "done": false, "timesteps_total": 276433, "episodes_total": 624, "training_iteration": 27, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-27-42", "timestamp": 1589876862, "time_this_iter_s": 43.80787920951843, "time_total_s": 1418.3279960155487, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e3bf8>", "on_episode_step": "<function on_episode_step at 0x7fef204e3400>", "on_episode_end": "<function on_episode_end at 0x7fef204e3ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e3f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204e30d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1418.3279960155487, "timesteps_since_restore": 276433, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 79.87096774193547, "ram_util_percent": 29.409677419354846}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817751882190379, "episode_reward_min": -9.984963103276748, "episode_reward_mean": -0.03260770463784861, "episode_len_mean": 472.6, "episodes_this_iter": 24, "policy_reward_min": {"av": -9.984963103276748}, "policy_reward_max": {"av": 0.2817751882190379}, "policy_reward_mean": {"av": -0.03260770463784861}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6762628222243414, "avg_speed_min": 1.3858725982485394, "avg_speed_max": 7.049748630615376, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 28.847741576642264, "mean_processing_ms": 3.0849519506864826, "mean_inference_ms": 0.4204267851441075}, "off_policy_estimator": {}, "info": {"num_steps_trained": 100352, "num_steps_sampled": 286855, "sample_time_ms": 43958.768, "load_time_ms": 1.548, "grad_time_ms": 1633.745, "update_time_ms": 6.544, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5808883309364319, "policy_loss": -0.018359960988163948, "vf_loss": 0.5936813950538635, "vf_explained_var": 0.7626221179962158, "kl": 0.019548848271369934, "entropy": 1.6419885158538818, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10422, "done": false, "timesteps_total": 286855, "episodes_total": 648, "training_iteration": 28, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-28-22", "timestamp": 1589876902, "time_this_iter_s": 39.72317910194397, "time_total_s": 1458.0511751174927, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e3048>", "on_episode_step": "<function on_episode_step at 0x7fef204e3378>", "on_episode_end": "<function on_episode_end at 0x7fef204e3d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e32f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204e3b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1458.0511751174927, "timesteps_since_restore": 286855, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 82.02280701754387, "ram_util_percent": 29.426315789473687}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817751882190379, "episode_reward_min": -9.984963103276748, "episode_reward_mean": 0.06734482726005285, "episode_len_mean": 475.7, "episodes_this_iter": 21, "policy_reward_min": {"av": -9.984963103276748}, "policy_reward_max": {"av": 0.2817751882190379}, "policy_reward_mean": {"av": 0.0680250780404574}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6315964424188665, "avg_speed_min": 1.6471864296388787, "avg_speed_max": 7.049748630615376, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 28.645002299934834, "mean_processing_ms": 3.0788063662874223, "mean_inference_ms": 0.4155978316296155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 103424, "num_steps_sampled": 297204, "sample_time_ms": 44163.725, "load_time_ms": 1.523, "grad_time_ms": 1638.295, "update_time_ms": 6.663, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.05008881911635399, "policy_loss": -0.011309385299682617, "vf_loss": 0.059538424015045166, "vf_explained_var": 0.89018315076828, "kl": 0.00653090700507164, "entropy": 1.6459089517593384, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10349, "done": false, "timesteps_total": 297204, "episodes_total": 669, "training_iteration": 29, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-29-09", "timestamp": 1589876949, "time_this_iter_s": 47.433008909225464, "time_total_s": 1505.4841840267181, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20469950>", "on_episode_step": "<function on_episode_step at 0x7fef204691e0>", "on_episode_end": "<function on_episode_end at 0x7fef204696a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20469d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1505.4841840267181, "timesteps_since_restore": 297204, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 81.11617647058823, "ram_util_percent": 29.46029411764706}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28173854834165846, "episode_reward_min": -9.984963103276748, "episode_reward_mean": 0.06448576468188302, "episode_len_mean": 470.72, "episodes_this_iter": 22, "policy_reward_min": {"av": -9.984963103276748}, "policy_reward_max": {"av": 0.28173854834165846}, "policy_reward_mean": {"av": 0.06648016977513713}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6688522958688434, "avg_speed_min": 1.6471864296388787, "avg_speed_max": 7.049748630615376, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 28.47960163494458, "mean_processing_ms": 3.0681399452960165, "mean_inference_ms": 0.4117530583617862}, "off_policy_estimator": {}, "info": {"num_steps_trained": 105984, "num_steps_sampled": 307606, "sample_time_ms": 43573.337, "load_time_ms": 1.499, "grad_time_ms": 1615.218, "update_time_ms": 6.778, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.06644877046346664, "policy_loss": -0.009223923087120056, "vf_loss": 0.07371897995471954, "vf_explained_var": 0.8946830630302429, "kl": 0.006860767491161823, "entropy": 1.6150944232940674, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10402, "done": false, "timesteps_total": 307606, "episodes_total": 691, "training_iteration": 30, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-29-53", "timestamp": 1589876993, "time_this_iter_s": 44.084187507629395, "time_total_s": 1549.5683715343475, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e3bf8>", "on_episode_step": "<function on_episode_step at 0x7fef20469378>", "on_episode_end": "<function on_episode_end at 0x7fef20469488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20469510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1549.5683715343475, "timesteps_since_restore": 307606, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 82.92698412698412, "ram_util_percent": 29.469841269841275}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817419576714598, "episode_reward_min": -9.984963103276748, "episode_reward_mean": 0.05884798477210424, "episode_len_mean": 462.4, "episodes_this_iter": 24, "policy_reward_min": {"av": -9.984963103276748}, "policy_reward_max": {"av": 0.2817419576714598}, "policy_reward_mean": {"av": 0.06129998413760859}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7758411312670295, "avg_speed_min": 1.6374885667149837, "avg_speed_max": 7.049748630615376, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 28.278683369855386, "mean_processing_ms": 3.0631261264965537, "mean_inference_ms": 0.4068140225036636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 108032, "num_steps_sampled": 318176, "sample_time_ms": 42954.009, "load_time_ms": 1.51, "grad_time_ms": 1607.123, "update_time_ms": 6.743, "learner": {"av": {"cur_kl_coeff": 0.2847656309604645, "cur_lr": 4.999999873689376e-05, "total_loss": 0.03463819622993469, "policy_loss": -0.01371009275317192, "vf_loss": 0.04242146760225296, "vf_explained_var": 0.934742271900177, "kl": 0.020812977105379105, "entropy": 1.592359185218811, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10570, "done": false, "timesteps_total": 318176, "episodes_total": 715, "training_iteration": 31, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-30-33", "timestamp": 1589877033, "time_this_iter_s": 39.82685422897339, "time_total_s": 1589.395225763321, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e3d90>", "on_episode_step": "<function on_episode_step at 0x7fef20583bf8>", "on_episode_end": "<function on_episode_end at 0x7fef204692f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204690d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204696a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1589.395225763321, "timesteps_since_restore": 318176, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 80.40175438596492, "ram_util_percent": 29.480701754385965}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817419576714598, "episode_reward_min": -9.719159718480253, "episode_reward_mean": 0.15870415974923108, "episode_len_mean": 469.71, "episodes_this_iter": 21, "policy_reward_min": {"av": -9.719159718480253}, "policy_reward_max": {"av": 0.2817419576714598}, "policy_reward_mean": {"av": 0.16705701026234854}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.716754057714237, "avg_speed_min": 1.6374885667149837, "avg_speed_max": 7.049748630615376, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 28.145854180091604, "mean_processing_ms": 3.0569778112942436, "mean_inference_ms": 0.40383377834089346}, "off_policy_estimator": {}, "info": {"num_steps_trained": 111104, "num_steps_sampled": 328631, "sample_time_ms": 43026.304, "load_time_ms": 1.496, "grad_time_ms": 1622.697, "update_time_ms": 6.85, "learner": {"av": {"cur_kl_coeff": 0.4271484315395355, "cur_lr": 4.999999873689376e-05, "total_loss": 0.07190307229757309, "policy_loss": -0.003725145012140274, "vf_loss": 0.07444186508655548, "vf_explained_var": 0.9050628542900085, "kl": 0.0027773722540587187, "entropy": 1.67465078830719, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10455, "done": false, "timesteps_total": 328631, "episodes_total": 736, "training_iteration": 32, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-31-22", "timestamp": 1589877082, "time_this_iter_s": 48.99843168258667, "time_total_s": 1638.3936574459076, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20469e18>", "on_episode_step": "<function on_episode_step at 0x7fef204e3840>", "on_episode_end": "<function on_episode_end at 0x7fef204e3510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e3598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef21e3af28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1638.3936574459076, "timesteps_since_restore": 328631, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 82.32142857142858, "ram_util_percent": 29.494285714285713}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817419576714598, "episode_reward_min": -15.00003, "episode_reward_mean": 0.0965374492402255, "episode_len_mean": 466.56, "episodes_this_iter": 24, "policy_reward_min": {"av": -15.00003}, "policy_reward_max": {"av": 0.2817419576714598}, "policy_reward_mean": {"av": 0.1005598429585682}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.665395320284333, "avg_speed_min": 1.1956193944244249, "avg_speed_max": 6.476721778355771, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.97971932273512, "mean_processing_ms": 3.0495576697653415, "mean_inference_ms": 0.3996404117275631}, "off_policy_estimator": {}, "info": {"num_steps_trained": 113280, "num_steps_sampled": 339108, "sample_time_ms": 42642.867, "load_time_ms": 1.453, "grad_time_ms": 1567.592, "update_time_ms": 7.067, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.4772345721721649, "policy_loss": -0.011771687306463718, "vf_loss": 0.4872845411300659, "vf_explained_var": 0.9468475580215454, "kl": 0.008061205968260765, "entropy": 1.65404212474823, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10477, "done": false, "timesteps_total": 339108, "episodes_total": 760, "training_iteration": 33, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-32-04", "timestamp": 1589877124, "time_this_iter_s": 41.299468994140625, "time_total_s": 1679.6931264400482, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e3b70>", "on_episode_step": "<function on_episode_step at 0x7fef204e3ae8>", "on_episode_end": "<function on_episode_end at 0x7fef204e3ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e3d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef256e7488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1679.6931264400482, "timesteps_since_restore": 339108, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 82.41186440677964, "ram_util_percent": 29.494915254237288}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2817419576714598, "episode_reward_min": -15.00003, "episode_reward_mean": 0.09030875192095394, "episode_len_mean": 466.56, "episodes_this_iter": 20, "policy_reward_min": {"av": -15.00003}, "policy_reward_max": {"av": 0.2817419576714598}, "policy_reward_mean": {"av": 0.09407161658432699}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.7452657292254297, "avg_speed_min": 1.1956193944244249, "avg_speed_max": 6.476721778355771, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.877358532157523, "mean_processing_ms": 3.0442813443125334, "mean_inference_ms": 0.39714751320988817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 116096, "num_steps_sampled": 349452, "sample_time_ms": 42903.954, "load_time_ms": 1.473, "grad_time_ms": 1578.698, "update_time_ms": 6.76, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.08024661988019943, "policy_loss": -0.016005128622055054, "vf_loss": 0.09321913868188858, "vf_explained_var": 0.9008550643920898, "kl": 0.014199330471456051, "entropy": 1.6259509325027466, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10344, "done": false, "timesteps_total": 349452, "episodes_total": 780, "training_iteration": 34, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-32-50", "timestamp": 1589877170, "time_this_iter_s": 46.010687828063965, "time_total_s": 1725.7038142681122, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef21e3a730>", "on_episode_step": "<function on_episode_step at 0x7fef204e3620>", "on_episode_end": "<function on_episode_end at 0x7fef204e3f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20469ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1725.7038142681122, "timesteps_since_restore": 349452, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 82.88153846153847, "ram_util_percent": 29.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.2814552728302807, "episode_reward_min": -15.00003, "episode_reward_mean": -0.0627841813140571, "episode_len_mean": 472.51, "episodes_this_iter": 21, "policy_reward_min": {"av": -15.00003}, "policy_reward_max": {"av": 0.2814552728302807}, "policy_reward_mean": {"av": -0.06341836496369406}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.6000077395374213, "avg_speed_min": 1.1956193944244249, "avg_speed_max": 6.571710125736642, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.782716048703815, "mean_processing_ms": 3.038915433504371, "mean_inference_ms": 0.3949180517078634}, "off_policy_estimator": {}, "info": {"num_steps_trained": 119168, "num_steps_sampled": 359602, "sample_time_ms": 42645.898, "load_time_ms": 1.461, "grad_time_ms": 1562.508, "update_time_ms": 6.662, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5581440329551697, "policy_loss": -0.015857623890042305, "vf_loss": 0.5703803896903992, "vf_explained_var": 0.9382309913635254, "kl": 0.01695559173822403, "entropy": 1.7035621404647827, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10150, "done": false, "timesteps_total": 359602, "episodes_total": 801, "training_iteration": 35, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-33-35", "timestamp": 1589877215, "time_this_iter_s": 45.53764319419861, "time_total_s": 1771.2414574623108, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f7840>", "on_episode_step": "<function on_episode_step at 0x7fef20469598>", "on_episode_end": "<function on_episode_end at 0x7fef20469e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204699d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1771.2414574623108, "timesteps_since_restore": 359602, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 82.29846153846154, "ram_util_percent": 29.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.28104753906039165, "episode_reward_min": -15.00003, "episode_reward_mean": -0.06966551402416438, "episode_len_mean": 467.96, "episodes_this_iter": 22, "policy_reward_min": {"av": -15.00003}, "policy_reward_max": {"av": 0.28104753906039165}, "policy_reward_mean": {"av": -0.07108725920833099}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.6398917504086516, "avg_speed_min": 1.1956193944244249, "avg_speed_max": 7.173538792322168, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.65224399475361, "mean_processing_ms": 3.0322969304815666, "mean_inference_ms": 0.39155806343723654}, "off_policy_estimator": {}, "info": {"num_steps_trained": 121088, "num_steps_sampled": 369778, "sample_time_ms": 42241.558, "load_time_ms": 1.434, "grad_time_ms": 1489.927, "update_time_ms": 6.618, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10269425809383392, "policy_loss": -0.00193509878590703, "vf_loss": 0.1022958755493164, "vf_explained_var": 0.9081097841262817, "kl": 0.01092586386948824, "entropy": 1.6977429389953613, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10176, "done": false, "timesteps_total": 369778, "episodes_total": 823, "training_iteration": 36, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-34-16", "timestamp": 1589877256, "time_this_iter_s": 40.7833571434021, "time_total_s": 1812.024814605713, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204697b8>", "on_episode_step": "<function on_episode_step at 0x7fef20583c80>", "on_episode_end": "<function on_episode_end at 0x7fef20583268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20583400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204f7950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1812.024814605713, "timesteps_since_restore": 369778, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 83.03559322033897, "ram_util_percent": 29.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00003, "episode_reward_mean": 0.08249599999999997, "episode_len_mean": 472.15, "episodes_this_iter": 21, "policy_reward_min": {"av": -15.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0833292929292929}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.7097999701553412, "avg_speed_min": 1.1956193944244249, "avg_speed_max": 7.173538792322168, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.570040820561005, "mean_processing_ms": 3.025903367338596, "mean_inference_ms": 0.38903953421146853}, "off_policy_estimator": {}, "info": {"num_steps_trained": 123392, "num_steps_sampled": 380079, "sample_time_ms": 42061.98, "load_time_ms": 1.408, "grad_time_ms": 1473.722, "update_time_ms": 6.514, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 4.999999873689376e-05, "total_loss": 1.499037265777588, "policy_loss": -0.00741178123280406, "vf_loss": 1.5050740242004395, "vf_explained_var": 0.4603031575679779, "kl": 0.006437639240175486, "entropy": 1.7001736164093018, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10301, "done": false, "timesteps_total": 380079, "episodes_total": 844, "training_iteration": 37, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-34-58", "timestamp": 1589877298, "time_this_iter_s": 41.84546113014221, "time_total_s": 1853.870275735855, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20469730>", "on_episode_step": "<function on_episode_step at 0x7fef204f7ae8>", "on_episode_end": "<function on_episode_end at 0x7fef20447048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204470d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204e3d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1853.870275735855, "timesteps_since_restore": 380079, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 84.18813559322035, "ram_util_percent": 29.498305084745763}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00005, "episode_reward_mean": -0.5275059999999999, "episode_len_mean": 456.52, "episodes_this_iter": 28, "policy_reward_min": {"av": -15.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5328343434343434}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 3.681682673719024, "avg_speed_min": 1.6296916395985448, "avg_speed_max": 7.173538792322168, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.50546731128859, "mean_processing_ms": 3.0255958888583883, "mean_inference_ms": 0.38683400270368923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 126208, "num_steps_sampled": 390653, "sample_time_ms": 42893.347, "load_time_ms": 1.479, "grad_time_ms": 1518.778, "update_time_ms": 6.166, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6046206951141357, "policy_loss": -0.020908916369080544, "vf_loss": 0.6207208633422852, "vf_explained_var": 0.960113525390625, "kl": 0.022515468299388885, "entropy": 1.7869998216629028, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10574, "done": false, "timesteps_total": 390653, "episodes_total": 872, "training_iteration": 38, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-35-47", "timestamp": 1589877347, "time_this_iter_s": 48.482975244522095, "time_total_s": 1902.3532509803772, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20447158>", "on_episode_step": "<function on_episode_step at 0x7fef20447378>", "on_episode_end": "<function on_episode_end at 0x7fef20447400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204471e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1902.3532509803772, "timesteps_since_restore": 390653, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 81.00142857142858, "ram_util_percent": 29.50142857142857}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00005, "episode_reward_mean": -0.6300061000000001, "episode_len_mean": 453.18, "episodes_this_iter": 20, "policy_reward_min": {"av": -15.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6363697979797981}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.734778741006979, "avg_speed_min": 1.6296916395985448, "avg_speed_max": 7.256369951257748, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.377742754594372, "mean_processing_ms": 3.021038193276754, "mean_inference_ms": 0.3832425958749735}, "off_policy_estimator": {}, "info": {"num_steps_trained": 129024, "num_steps_sampled": 401027, "sample_time_ms": 42578.378, "load_time_ms": 1.501, "grad_time_ms": 1494.59, "update_time_ms": 5.988, "learner": {"av": {"cur_kl_coeff": 0.32036131620407104, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5443789958953857, "policy_loss": -0.0063693043775856495, "vf_loss": 1.5491797924041748, "vf_explained_var": 0.615355908870697, "kl": 0.004896428901702166, "entropy": 1.7407387495040894, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10374, "done": false, "timesteps_total": 401027, "episodes_total": 892, "training_iteration": 39, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-36-31", "timestamp": 1589877391, "time_this_iter_s": 44.039199352264404, "time_total_s": 1946.3924503326416, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e3598>", "on_episode_step": "<function on_episode_step at 0x7fef204560d0>", "on_episode_end": "<function on_episode_end at 0x7fef20456158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204561e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20456840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1946.3924503326416, "timesteps_since_restore": 401027, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 81.91935483870968, "ram_util_percent": 29.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00005, "episode_reward_mean": -0.4750055999999999, "episode_len_mean": 461.75, "episodes_this_iter": 20, "policy_reward_min": {"av": -15.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4750055999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.667667320060927, "avg_speed_min": 1.2506513059576148, "avg_speed_max": 7.256369951257748, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.27609792912088, "mean_processing_ms": 3.018425623785655, "mean_inference_ms": 0.3803680253143655}, "off_policy_estimator": {}, "info": {"num_steps_trained": 131712, "num_steps_sampled": 411034, "sample_time_ms": 42639.279, "load_time_ms": 1.519, "grad_time_ms": 1494.436, "update_time_ms": 5.85, "learner": {"av": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12528297305107117, "policy_loss": -0.013723053969442844, "vf_loss": 0.13604319095611572, "vf_explained_var": 0.8850780725479126, "kl": 0.018497003242373466, "entropy": 1.6827459335327148, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10007, "done": false, "timesteps_total": 411034, "episodes_total": 912, "training_iteration": 40, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-37-16", "timestamp": 1589877436, "time_this_iter_s": 44.68656635284424, "time_total_s": 1991.0790166854858, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204ff268>", "on_episode_step": "<function on_episode_step at 0x7fef204f7378>", "on_episode_end": "<function on_episode_end at 0x7fef204f7488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204f7bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef256deb70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 1991.0790166854858, "timesteps_since_restore": 411034, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 82.325, "ram_util_percent": 29.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00005, "episode_reward_mean": -0.5725060999999999, "episode_len_mean": 461.43, "episodes_this_iter": 23, "policy_reward_min": {"av": -15.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5725060999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6342214780154563, "avg_speed_min": 1.2506513059576148, "avg_speed_max": 7.256369951257748, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.26021086534388, "mean_processing_ms": 3.015975548648713, "mean_inference_ms": 0.37991737537486053}, "off_policy_estimator": {}, "info": {"num_steps_trained": 134272, "num_steps_sampled": 421227, "sample_time_ms": 42937.366, "load_time_ms": 1.503, "grad_time_ms": 1519.623, "update_time_ms": 5.814, "learner": {"av": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6000577807426453, "policy_loss": -0.01805189624428749, "vf_loss": 0.6143184900283813, "vf_explained_var": 0.6425790786743164, "kl": 0.02366805635392666, "entropy": 1.6726398468017578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10193, "done": false, "timesteps_total": 421227, "episodes_total": 935, "training_iteration": 41, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-37-59", "timestamp": 1589877479, "time_this_iter_s": 43.05607533454895, "time_total_s": 2034.1350920200348, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20469268>", "on_episode_step": "<function on_episode_step at 0x7fef20441488>", "on_episode_end": "<function on_episode_end at 0x7fef20441620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204416a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2034.1350920200348, "timesteps_since_restore": 421227, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 81.22903225806452, "ram_util_percent": 29.54193548387096}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00005, "episode_reward_mean": -0.2700046, "episode_len_mean": 465.27, "episodes_this_iter": 22, "policy_reward_min": {"av": -15.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2700046}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5620550038234144, "avg_speed_min": 1.2506513059576148, "avg_speed_max": 7.454872906434425, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 27.194727295429903, "mean_processing_ms": 3.011260234814155, "mean_inference_ms": 0.3784339599364151}, "off_policy_estimator": {}, "info": {"num_steps_trained": 136704, "num_steps_sampled": 431608, "sample_time_ms": 42234.862, "load_time_ms": 1.522, "grad_time_ms": 1482.631, "update_time_ms": 6.204, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1278773993253708, "policy_loss": -0.009832985699176788, "vf_loss": 0.13578224182128906, "vf_explained_var": 0.8853130340576172, "kl": 0.008024892769753933, "entropy": 1.6521632671356201, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10381, "done": false, "timesteps_total": 431608, "episodes_total": 957, "training_iteration": 42, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-38-40", "timestamp": 1589877520, "time_this_iter_s": 41.60882377624512, "time_total_s": 2075.74391579628, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20441a60>", "on_episode_step": "<function on_episode_step at 0x7fef203ef7b8>", "on_episode_end": "<function on_episode_end at 0x7fef203efa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203efae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20441b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2075.74391579628, "timesteps_since_restore": 431608, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 82.59322033898307, "ram_util_percent": 29.55593220338983}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": 0.0399953, "episode_len_mean": 481.13, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0399953}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.543327888795697, "avg_speed_min": 1.2506513059576148, "avg_speed_max": 7.454872906434425, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 27.09751847966227, "mean_processing_ms": 3.005009646390353, "mean_inference_ms": 0.3762628093610188}, "off_policy_estimator": {}, "info": {"num_steps_trained": 139520, "num_steps_sampled": 441932, "sample_time_ms": 42464.613, "load_time_ms": 1.545, "grad_time_ms": 1510.155, "update_time_ms": 6.1, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.12011906504631042, "policy_loss": -0.006722687277942896, "vf_loss": 0.12413793057203293, "vf_explained_var": 0.8893560171127319, "kl": 0.011253206990659237, "entropy": 1.6201010942459106, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10324, "done": false, "timesteps_total": 441932, "episodes_total": 977, "training_iteration": 43, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-39-24", "timestamp": 1589877564, "time_this_iter_s": 43.87314987182617, "time_total_s": 2119.617065668106, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20441620>", "on_episode_step": "<function on_episode_step at 0x7fef20441840>", "on_episode_end": "<function on_episode_end at 0x7fef20441268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204416a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2119.617065668106, "timesteps_since_restore": 441932, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 81.54285714285716, "ram_util_percent": 29.56666666666666}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.03999540000000004, "episode_len_mean": 480.46, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03999540000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5837462723473386, "avg_speed_min": 1.2506513059576148, "avg_speed_max": 7.454872906434425, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 27.06674942712071, "mean_processing_ms": 3.0031778270208, "mean_inference_ms": 0.3755828360976867}, "off_policy_estimator": {}, "info": {"num_steps_trained": 141952, "num_steps_sampled": 452334, "sample_time_ms": 42264.419, "load_time_ms": 1.535, "grad_time_ms": 1524.418, "update_time_ms": 6.231, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6778988838195801, "policy_loss": -0.006038634572178125, "vf_loss": 0.6825401186943054, "vf_explained_var": 0.7668132781982422, "kl": 0.005816023331135511, "entropy": 1.606342077255249, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10402, "done": false, "timesteps_total": 452334, "episodes_total": 999, "training_iteration": 44, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-40-09", "timestamp": 1589877609, "time_this_iter_s": 44.152915477752686, "time_total_s": 2163.7699811458588, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20441510>", "on_episode_step": "<function on_episode_step at 0x7fef20583378>", "on_episode_end": "<function on_episode_end at 0x7fef20583bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205830d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204ffd08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2163.7699811458588, "timesteps_since_restore": 452334, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 81.04603174603173, "ram_util_percent": 29.58571428571427}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.16500559999999992, "episode_len_mean": 473.46, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16667232323232317}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6586878558025706, "avg_speed_min": 2.104103516544715, "avg_speed_max": 7.454872906434425, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.943556832846415, "mean_processing_ms": 2.9974215837584763, "mean_inference_ms": 0.3726740907827361}, "off_policy_estimator": {}, "info": {"num_steps_trained": 144512, "num_steps_sampled": 462670, "sample_time_ms": 42101.531, "load_time_ms": 1.537, "grad_time_ms": 1508.173, "update_time_ms": 6.162, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5810010433197021, "policy_loss": -0.013139313086867332, "vf_loss": 1.59282386302948, "vf_explained_var": 0.7993658781051636, "kl": 0.0054794056341052055, "entropy": 1.7728592157363892, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10336, "done": false, "timesteps_total": 462670, "episodes_total": 1023, "training_iteration": 45, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-40-52", "timestamp": 1589877652, "time_this_iter_s": 43.74661207199097, "time_total_s": 2207.5165932178497, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef21e3a730>", "on_episode_step": "<function on_episode_step at 0x7fef21e3aae8>", "on_episode_end": "<function on_episode_end at 0x7fef203f2268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203f2bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2207.5165932178497, "timesteps_since_restore": 462670, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 79.77258064516127, "ram_util_percent": 29.59193548387096}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.4650054, "episode_len_mean": 465.31, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.46970242424242425}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.7862685246318897, "avg_speed_min": 2.104103516544715, "avg_speed_max": 7.617563777749041, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.85098837097191, "mean_processing_ms": 2.996723544921939, "mean_inference_ms": 0.3706696970393748}, "off_policy_estimator": {}, "info": {"num_steps_trained": 146816, "num_steps_sampled": 472869, "sample_time_ms": 42024.057, "load_time_ms": 1.543, "grad_time_ms": 1535.963, "update_time_ms": 6.183, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1.678476095199585, "policy_loss": 0.0007471046992577612, "vf_loss": 1.6761889457702637, "vf_explained_var": 0.47734037041664124, "kl": 0.006410312373191118, "entropy": 1.6142516136169434, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10199, "done": false, "timesteps_total": 472869, "episodes_total": 1045, "training_iteration": 46, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-41-33", "timestamp": 1589877693, "time_this_iter_s": 40.28547477722168, "time_total_s": 2247.8020679950714, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e3d90>", "on_episode_step": "<function on_episode_step at 0x7fef203f22f0>", "on_episode_end": "<function on_episode_end at 0x7fef203f2a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ff840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054cbf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2247.8020679950714, "timesteps_since_restore": 472869, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 78.96206896551725, "ram_util_percent": 29.596551724137925}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.6675051, "episode_len_mean": 460.78, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6742475757575757}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.242249001368269, "avg_speed_min": 2.2426322708643305, "avg_speed_max": 7.637452955854786, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.765694708053484, "mean_processing_ms": 2.994580801139011, "mean_inference_ms": 0.36872267958065896}, "off_policy_estimator": {}, "info": {"num_steps_trained": 148480, "num_steps_sampled": 483224, "sample_time_ms": 41588.184, "load_time_ms": 1.548, "grad_time_ms": 1497.176, "update_time_ms": 6.203, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5333824157714844, "policy_loss": -0.025511903688311577, "vf_loss": 0.5546687841415405, "vf_explained_var": 0.798100471496582, "kl": 0.01758662983775139, "entropy": 1.6675039529800415, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10355, "done": false, "timesteps_total": 483224, "episodes_total": 1068, "training_iteration": 47, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-42-10", "timestamp": 1589877730, "time_this_iter_s": 37.094961166381836, "time_total_s": 2284.8970291614532, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204696a8>", "on_episode_step": "<function on_episode_step at 0x7fef20441598>", "on_episode_end": "<function on_episode_end at 0x7fef204418c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204691e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2284.8970291614532, "timesteps_since_restore": 483224, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 82.90754716981135, "ram_util_percent": 29.59622641509433}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.5675051, "episode_len_mean": 460.7, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5732374747474748}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3647140293167315, "avg_speed_min": 2.1652531861997217, "avg_speed_max": 7.637452955854786, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.653103282311676, "mean_processing_ms": 2.992009417049053, "mean_inference_ms": 0.36591654754616804}, "off_policy_estimator": {}, "info": {"num_steps_trained": 150528, "num_steps_sampled": 493532, "sample_time_ms": 41066.292, "load_time_ms": 1.504, "grad_time_ms": 1455.163, "update_time_ms": 6.263, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.1046568751335144, "policy_loss": -0.024921288713812828, "vf_loss": 0.12693965435028076, "vf_explained_var": 0.8817286491394043, "kl": 0.010981369763612747, "entropy": 1.693142056465149, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10308, "done": false, "timesteps_total": 493532, "episodes_total": 1089, "training_iteration": 48, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-42-53", "timestamp": 1589877773, "time_this_iter_s": 42.84534049034119, "time_total_s": 2327.7423696517944, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f77b8>", "on_episode_step": "<function on_episode_step at 0x7fef204f7510>", "on_episode_end": "<function on_episode_end at 0x7fef204f7400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204f79d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20441268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2327.7423696517944, "timesteps_since_restore": 493532, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 81.22459016393444, "ram_util_percent": 29.59999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.7725044, "episode_len_mean": 448.81, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.7725044}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.463448642530053, "avg_speed_min": 1.3344387966466678, "avg_speed_max": 7.637452955854786, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.55888072144043, "mean_processing_ms": 2.9915715968875123, "mean_inference_ms": 0.3635271904431874}, "off_policy_estimator": {}, "info": {"num_steps_trained": 152832, "num_steps_sampled": 503924, "sample_time_ms": 40850.644, "load_time_ms": 1.483, "grad_time_ms": 1441.51, "update_time_ms": 6.197, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2559823989868164, "policy_loss": -0.011643288657069206, "vf_loss": 1.2660064697265625, "vf_explained_var": 0.7482696771621704, "kl": 0.006738634780049324, "entropy": 1.6914541721343994, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10392, "done": false, "timesteps_total": 503924, "episodes_total": 1114, "training_iteration": 49, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-43-35", "timestamp": 1589877815, "time_this_iter_s": 41.7497718334198, "time_total_s": 2369.4921414852142, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f7620>", "on_episode_step": "<function on_episode_step at 0x7fef20469400>", "on_episode_end": "<function on_episode_end at 0x7fef204698c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20469730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204691e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2369.4921414852142, "timesteps_since_restore": 503924, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 82.25833333333334, "ram_util_percent": 29.59999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.6750049, "episode_len_mean": 451.5, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6750049}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.505235177910847, "avg_speed_min": 1.3344387966466678, "avg_speed_max": 7.963989329446148, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.479082614827156, "mean_processing_ms": 2.9899603744394843, "mean_inference_ms": 0.3615236386007616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 155264, "num_steps_sampled": 514017, "sample_time_ms": 40471.954, "load_time_ms": 1.457, "grad_time_ms": 1431.355, "update_time_ms": 6.239, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3494873642921448, "policy_loss": -0.024447154253721237, "vf_loss": 0.37078553438186646, "vf_explained_var": 0.8669167757034302, "kl": 0.0131059056147933, "entropy": 1.7078255414962769, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10093, "done": false, "timesteps_total": 514017, "episodes_total": 1135, "training_iteration": 50, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-44-16", "timestamp": 1589877856, "time_this_iter_s": 40.80148935317993, "time_total_s": 2410.293630838394, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204e36a8>", "on_episode_step": "<function on_episode_step at 0x7fef204e31e0>", "on_episode_end": "<function on_episode_end at 0x7fef204e3158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e3ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054c9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2410.293630838394, "timesteps_since_restore": 514017, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 81.61724137931034, "ram_util_percent": 29.599999999999994}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.3725053, "episode_len_mean": 459.53, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3725053}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.409449094813704, "avg_speed_min": 1.3344387966466678, "avg_speed_max": 7.963989329446148, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.37944948730265, "mean_processing_ms": 2.986795905938178, "mean_inference_ms": 0.35891586021468064}, "off_policy_estimator": {}, "info": {"num_steps_trained": 157184, "num_steps_sampled": 524462, "sample_time_ms": 40276.116, "load_time_ms": 1.439, "grad_time_ms": 1393.953, "update_time_ms": 6.21, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.21705462038516998, "policy_loss": -0.005306622479110956, "vf_loss": 0.2200389951467514, "vf_explained_var": 0.7838261127471924, "kl": 0.009664991870522499, "entropy": 1.752916932106018, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10445, "done": false, "timesteps_total": 524462, "episodes_total": 1158, "training_iteration": 51, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-44-56", "timestamp": 1589877896, "time_this_iter_s": 40.726016998291016, "time_total_s": 2451.019647836685, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f7400>", "on_episode_step": "<function on_episode_step at 0x7fef204f77b8>", "on_episode_end": "<function on_episode_end at 0x7fef204f7510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e3d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2451.019647836685, "timesteps_since_restore": 524462, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 81.87241379310345, "ram_util_percent": 29.599999999999994}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.37000520000000003, "episode_len_mean": 459.51, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.37000520000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.288678448266854, "avg_speed_min": 1.3344387966466678, "avg_speed_max": 7.963989329446148, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.293151978049227, "mean_processing_ms": 2.983935530856371, "mean_inference_ms": 0.3568047878679309}, "off_policy_estimator": {}, "info": {"num_steps_trained": 159360, "num_steps_sampled": 534670, "sample_time_ms": 40174.844, "load_time_ms": 1.442, "grad_time_ms": 1371.536, "update_time_ms": 5.836, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.20799876749515533, "policy_loss": -0.015381697565317154, "vf_loss": 0.2213428020477295, "vf_explained_var": 0.7935076355934143, "kl": 0.008480717428028584, "entropy": 1.726440191268921, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10208, "done": false, "timesteps_total": 534670, "episodes_total": 1179, "training_iteration": 52, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-45-37", "timestamp": 1589877937, "time_this_iter_s": 40.3680055141449, "time_total_s": 2491.38765335083, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583950>", "on_episode_step": "<function on_episode_step at 0x7fef203efe18>", "on_episode_end": "<function on_episode_end at 0x7fef203ef1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203ef510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2491.38765335083, "timesteps_since_restore": 534670, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 82.40689655172415, "ram_util_percent": 29.599999999999994}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.26500529999999994, "episode_len_mean": 467.49, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.26500529999999994}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3340787637853415, "avg_speed_min": 1.3344387966466678, "avg_speed_max": 7.963989329446148, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.172731207194516, "mean_processing_ms": 2.9802967130524274, "mean_inference_ms": 0.35391101954496157}, "off_policy_estimator": {}, "info": {"num_steps_trained": 161280, "num_steps_sampled": 545133, "sample_time_ms": 39600.123, "load_time_ms": 1.414, "grad_time_ms": 1334.253, "update_time_ms": 5.838, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.25755906105041504, "policy_loss": -0.00995224341750145, "vf_loss": 0.2643486261367798, "vf_explained_var": 0.7811148166656494, "kl": 0.013163016177713871, "entropy": 1.7871876955032349, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10463, "done": false, "timesteps_total": 545133, "episodes_total": 1201, "training_iteration": 53, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-46-15", "timestamp": 1589877975, "time_this_iter_s": 37.75063872337341, "time_total_s": 2529.1382920742035, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204691e0>", "on_episode_step": "<function on_episode_step at 0x7fef204ff840>", "on_episode_end": "<function on_episode_end at 0x7fef204ff730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ffd08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203f22f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2529.1382920742035, "timesteps_since_restore": 545133, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 80.62407407407403, "ram_util_percent": 29.605555555555544}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.057505499999999966, "episode_len_mean": 483.49, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.057505499999999966}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.357513263763661, "avg_speed_min": 2.4538102466464866, "avg_speed_max": 7.963989329446148, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 26.101300232922114, "mean_processing_ms": 2.976078661145171, "mean_inference_ms": 0.35222907733579784}, "off_policy_estimator": {}, "info": {"num_steps_trained": 163456, "num_steps_sampled": 555346, "sample_time_ms": 39282.236, "load_time_ms": 1.411, "grad_time_ms": 1317.583, "update_time_ms": 5.852, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13935315608978271, "policy_loss": -0.0010137356584891677, "vf_loss": 0.138730987906456, "vf_explained_var": 0.8674188256263733, "kl": 0.0068085677921772, "entropy": 1.7218950986862183, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10213, "done": false, "timesteps_total": 555346, "episodes_total": 1221, "training_iteration": 54, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-46-56", "timestamp": 1589878016, "time_this_iter_s": 40.80959725379944, "time_total_s": 2569.947889328003, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203a40d0>", "on_episode_step": "<function on_episode_step at 0x7fef203a49d8>", "on_episode_end": "<function on_episode_end at 0x7fef203a4a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203a4ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203401e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2569.947889328003, "timesteps_since_restore": 555346, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 83.54655172413793, "ram_util_percent": 29.629310344827587}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.06250559999999997, "episode_len_mean": 469.91, "episodes_this_iter": 26, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06378122448979587}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.308136486398149, "avg_speed_min": 2.4538102466464866, "avg_speed_max": 7.924636910355926, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.999824819696865, "mean_processing_ms": 2.9749608511831487, "mean_inference_ms": 0.3496888430416641}, "off_policy_estimator": {}, "info": {"num_steps_trained": 165504, "num_steps_sampled": 566215, "sample_time_ms": 39228.074, "load_time_ms": 1.402, "grad_time_ms": 1263.814, "update_time_ms": 5.866, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3240189552307129, "policy_loss": -0.016365502029657364, "vf_loss": 0.33581042289733887, "vf_explained_var": 0.7465395927429199, "kl": 0.01903707906603813, "entropy": 1.78545081615448, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10869, "done": false, "timesteps_total": 566215, "episodes_total": 1247, "training_iteration": 55, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-47-38", "timestamp": 1589878058, "time_this_iter_s": 42.66381597518921, "time_total_s": 2612.611705303192, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20340bf8>", "on_episode_step": "<function on_episode_step at 0x7fef203d12f0>", "on_episode_end": "<function on_episode_end at 0x7fef203d1d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203d1ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203a4620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2612.611705303192, "timesteps_since_restore": 566215, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 80.56393442622951, "ram_util_percent": 29.678688524590164}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.1675051, "episode_len_mean": 467.12, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17092357142857137}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.292469181993895, "avg_speed_min": 1.6421471405124304, "avg_speed_max": 7.924636910355926, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.902886106671367, "mean_processing_ms": 2.970204992403077, "mean_inference_ms": 0.3473001465057017}, "off_policy_estimator": {}, "info": {"num_steps_trained": 167808, "num_steps_sampled": 576774, "sample_time_ms": 39349.275, "load_time_ms": 1.368, "grad_time_ms": 1240.507, "update_time_ms": 5.785, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8371310830116272, "policy_loss": -0.02123321406543255, "vf_loss": 0.8543644547462463, "vf_explained_var": 0.8732118010520935, "kl": 0.016647163778543472, "entropy": 1.7741385698318481, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10559, "done": false, "timesteps_total": 576774, "episodes_total": 1270, "training_iteration": 56, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-48-20", "timestamp": 1589878100, "time_this_iter_s": 41.26575064659119, "time_total_s": 2653.8774559497833, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203d1268>", "on_episode_step": "<function on_episode_step at 0x7fef203d1730>", "on_episode_end": "<function on_episode_end at 0x7fef203d17b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203d1400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203ef510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2653.8774559497833, "timesteps_since_restore": 576774, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 79.88135593220339, "ram_util_percent": 29.684745762711863}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.1725049, "episode_len_mean": 458.9, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17602540816326528}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.378056234926799, "avg_speed_min": 1.6421471405124304, "avg_speed_max": 7.90962401998502, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.8159994878452, "mean_processing_ms": 2.9675547130912237, "mean_inference_ms": 0.3449972352233018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 169728, "num_steps_sampled": 587317, "sample_time_ms": 39690.585, "load_time_ms": 1.399, "grad_time_ms": 1241.539, "update_time_ms": 5.784, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9113592505455017, "policy_loss": -0.011229983530938625, "vf_loss": 0.9210968017578125, "vf_explained_var": 0.7595077157020569, "kl": 0.006212027743458748, "entropy": 1.784153699874878, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10543, "done": false, "timesteps_total": 587317, "episodes_total": 1293, "training_iteration": 57, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-49-00", "timestamp": 1589878140, "time_this_iter_s": 40.52104115486145, "time_total_s": 2694.398497104645, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20441730>", "on_episode_step": "<function on_episode_step at 0x7fef205ee268>", "on_episode_end": "<function on_episode_end at 0x7fef204e3b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e3e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20441840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2694.398497104645, "timesteps_since_restore": 587317, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 81.9551724137931, "ram_util_percent": 29.69482758620689}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.27500449999999993, "episode_len_mean": 455.05, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.28061683673469384}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.460638895909969, "avg_speed_min": 1.6421471405124304, "avg_speed_max": 7.90962401998502, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.817613029531444, "mean_processing_ms": 2.9711925647781414, "mean_inference_ms": 0.3452434572602708}, "off_policy_estimator": {}, "info": {"num_steps_trained": 171648, "num_steps_sampled": 597654, "sample_time_ms": 39511.858, "load_time_ms": 1.381, "grad_time_ms": 1216.853, "update_time_ms": 5.839, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5557137131690979, "policy_loss": -0.013563179410994053, "vf_loss": 0.5659621953964233, "vf_explained_var": 0.8462940454483032, "kl": 0.013795607723295689, "entropy": 1.931966781616211, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10337, "done": false, "timesteps_total": 597654, "episodes_total": 1315, "training_iteration": 58, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-49-41", "timestamp": 1589878181, "time_this_iter_s": 40.80953311920166, "time_total_s": 2735.2080302238464, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205ee950>", "on_episode_step": "<function on_episode_step at 0x7fef203ef510>", "on_episode_end": "<function on_episode_end at 0x7fef203ef1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ffd08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2735.2080302238464, "timesteps_since_restore": 597654, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 84.70344827586207, "ram_util_percent": 29.698275862068964}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.37750429999999996, "episode_len_mean": 452.79, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3813174747474747}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.451873174051033, "avg_speed_min": 1.2254697636955485, "avg_speed_max": 8.199100080626696, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.732266816527716, "mean_processing_ms": 2.966010876517203, "mean_inference_ms": 0.34278066342146923}, "off_policy_estimator": {}, "info": {"num_steps_trained": 173952, "num_steps_sampled": 607973, "sample_time_ms": 39696.73, "load_time_ms": 1.394, "grad_time_ms": 1179.09, "update_time_ms": 5.758, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2800300121307373, "policy_loss": -0.01588325947523117, "vf_loss": 1.2937283515930176, "vf_explained_var": 0.7604855298995972, "kl": 0.00909396167844534, "entropy": 1.8977857828140259, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10319, "done": false, "timesteps_total": 607973, "episodes_total": 1339, "training_iteration": 59, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-50-24", "timestamp": 1589878224, "time_this_iter_s": 43.214895486831665, "time_total_s": 2778.422925710678, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204697b8>", "on_episode_step": "<function on_episode_step at 0x7fef204f78c8>", "on_episode_end": "<function on_episode_end at 0x7fef204412f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20318d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2778.422925710678, "timesteps_since_restore": 607973, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 82.59838709677422, "ram_util_percent": 29.698387096774198}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.4800048999999999, "episode_len_mean": 448.42, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4848534343434344}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.377377952393269, "avg_speed_min": 1.2254697636955485, "avg_speed_max": 8.199100080626696, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.685069563588236, "mean_processing_ms": 2.9652910169600237, "mean_inference_ms": 0.34131843097513953}, "off_policy_estimator": {}, "info": {"num_steps_trained": 176512, "num_steps_sampled": 618259, "sample_time_ms": 40011.489, "load_time_ms": 1.396, "grad_time_ms": 1171.604, "update_time_ms": 5.836, "learner": {"av": {"cur_kl_coeff": 0.24027100205421448, "cur_lr": 4.999999873689376e-05, "total_loss": 0.40550655126571655, "policy_loss": -0.005489842034876347, "vf_loss": 0.4100942611694336, "vf_explained_var": 0.9059048891067505, "kl": 0.003754596458747983, "entropy": 1.8924448490142822, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10286, "done": false, "timesteps_total": 618259, "episodes_total": 1361, "training_iteration": 60, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-51-08", "timestamp": 1589878268, "time_this_iter_s": 43.875022888183594, "time_total_s": 2822.2979485988617, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204696a8>", "on_episode_step": "<function on_episode_step at 0x7fef20441400>", "on_episode_end": "<function on_episode_end at 0x7fef20441620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2822.2979485988617, "timesteps_since_restore": 618259, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 83.77258064516128, "ram_util_percent": 29.700000000000003}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.3775045, "episode_len_mean": 448.09, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.38131767676767675}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.455382779192874, "avg_speed_min": 1.2254697636955485, "avg_speed_max": 8.24251983620743, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.655782770105706, "mean_processing_ms": 2.966783952500773, "mean_inference_ms": 0.34025878351717637}, "off_policy_estimator": {}, "info": {"num_steps_trained": 178432, "num_steps_sampled": 628461, "sample_time_ms": 39999.873, "load_time_ms": 1.438, "grad_time_ms": 1151.603, "update_time_ms": 5.891, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8147467374801636, "policy_loss": -0.02522703818976879, "vf_loss": 0.8376100659370422, "vf_explained_var": 0.7781791687011719, "kl": 0.01967516727745533, "entropy": 1.8123878240585327, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10202, "done": false, "timesteps_total": 628461, "episodes_total": 1385, "training_iteration": 61, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-51-49", "timestamp": 1589878309, "time_this_iter_s": 40.40827941894531, "time_total_s": 2862.706228017807, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203a47b8>", "on_episode_step": "<function on_episode_step at 0x7fef20318d08>", "on_episode_end": "<function on_episode_end at 0x7fef20318a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20318ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203a4730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2862.706228017807, "timesteps_since_restore": 628461, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 83.6448275862069, "ram_util_percent": 29.698275862068964}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.4800055999999999, "episode_len_mean": 444.76, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4848541414141413}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.249294328541783, "avg_speed_min": 1.2254697636955485, "avg_speed_max": 8.320778999525114, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.617853384361982, "mean_processing_ms": 2.9645719797459424, "mean_inference_ms": 0.33909209664769846}, "off_policy_estimator": {}, "info": {"num_steps_trained": 180608, "num_steps_sampled": 638844, "sample_time_ms": 40187.588, "load_time_ms": 1.377, "grad_time_ms": 1140.152, "update_time_ms": 5.863, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7774057388305664, "policy_loss": -0.009204423055052757, "vf_loss": 1.7849152088165283, "vf_explained_var": 0.6498430967330933, "kl": 0.014106325805187225, "entropy": 1.8569746017456055, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10383, "done": false, "timesteps_total": 638844, "episodes_total": 1407, "training_iteration": 62, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-52-31", "timestamp": 1589878351, "time_this_iter_s": 42.1297767162323, "time_total_s": 2904.8360047340393, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2028f7b8>", "on_episode_step": "<function on_episode_step at 0x7fef2028ff28>", "on_episode_end": "<function on_episode_end at 0x7fef20244048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef202440d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2028fe18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2904.8360047340393, "timesteps_since_restore": 638844, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 84.06833333333334, "ram_util_percent": 29.7}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.2725055999999999, "episode_len_mean": 455.85, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27525818181818174}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.202889576253117, "avg_speed_min": 1.4224847637132816, "avg_speed_max": 8.320778999525114, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.546703068907348, "mean_processing_ms": 2.962287676650821, "mean_inference_ms": 0.33668392188944374}, "off_policy_estimator": {}, "info": {"num_steps_trained": 182912, "num_steps_sampled": 648956, "sample_time_ms": 40624.828, "load_time_ms": 1.395, "grad_time_ms": 1153.642, "update_time_ms": 5.863, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 4.999999873689376e-05, "total_loss": 0.25717413425445557, "policy_loss": -0.017617003992199898, "vf_loss": 0.2727852165699005, "vf_explained_var": 0.8259251713752747, "kl": 0.016697334125638008, "entropy": 1.7592289447784424, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10112, "done": false, "timesteps_total": 648956, "episodes_total": 1428, "training_iteration": 63, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-53-13", "timestamp": 1589878393, "time_this_iter_s": 42.2604341506958, "time_total_s": 2947.096438884735, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20318048>", "on_episode_step": "<function on_episode_step at 0x7fef203e6d90>", "on_episode_end": "<function on_episode_end at 0x7fef203e6e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203e6ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203e6378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2947.096438884735, "timesteps_since_restore": 648956, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 84.42666666666668, "ram_util_percent": 29.7}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.5775061999999999, "episode_len_mean": 439.38, "episodes_this_iter": 28, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.583339595959596}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.25724716233842, "avg_speed_min": 1.2919489654770144, "avg_speed_max": 8.320778999525114, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.5596476287048, "mean_processing_ms": 2.965096426684316, "mean_inference_ms": 0.3366338091436647}, "off_policy_estimator": {}, "info": {"num_steps_trained": 185088, "num_steps_sampled": 659354, "sample_time_ms": 40785.318, "load_time_ms": 1.44, "grad_time_ms": 1163.852, "update_time_ms": 5.882, "learner": {"av": {"cur_kl_coeff": 0.12013550102710724, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8422712087631226, "policy_loss": -0.013617511838674545, "vf_loss": 1.853175163269043, "vf_explained_var": 0.7340322732925415, "kl": 0.022586949169635773, "entropy": 1.936177372932434, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10398, "done": false, "timesteps_total": 659354, "episodes_total": 1456, "training_iteration": 64, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-53-56", "timestamp": 1589878436, "time_this_iter_s": 42.51865553855896, "time_total_s": 2989.615094423294, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203180d0>", "on_episode_step": "<function on_episode_step at 0x7fef2028f9d8>", "on_episode_end": "<function on_episode_end at 0x7fef202440d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20244048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20244d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 2989.615094423294, "timesteps_since_restore": 659354, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 82.40491803278688, "ram_util_percent": 29.7}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.6750072999999999, "episode_len_mean": 443.71, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6818255555555555}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.337443762799935, "avg_speed_min": 1.2919489654770144, "avg_speed_max": 8.583401561478446, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.526951475985747, "mean_processing_ms": 2.9642473212812424, "mean_inference_ms": 0.33536732382896534}, "off_policy_estimator": {}, "info": {"num_steps_trained": 187136, "num_steps_sampled": 669562, "sample_time_ms": 40498.459, "load_time_ms": 1.455, "grad_time_ms": 1172.563, "update_time_ms": 5.783, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 4.999999873689376e-05, "total_loss": 2.3525543212890625, "policy_loss": -0.003546684980392456, "vf_loss": 2.355064868927002, "vf_explained_var": 0.5820802450180054, "kl": 0.005749814212322235, "entropy": 1.9099637269973755, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10208, "done": false, "timesteps_total": 669562, "episodes_total": 1476, "training_iteration": 65, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-54-36", "timestamp": 1589878476, "time_this_iter_s": 39.88359785079956, "time_total_s": 3029.4986922740936, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef202448c8>", "on_episode_step": "<function on_episode_step at 0x7fef20244950>", "on_episode_end": "<function on_episode_end at 0x7fef20244a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20244ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20244ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3029.4986922740936, "timesteps_since_restore": 669562, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 83.94210526315788, "ram_util_percent": 29.712280701754384}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.3700087000000001, "episode_len_mean": 455.9, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3737461616161617}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.425685230085733, "avg_speed_min": 1.2919489654770144, "avg_speed_max": 8.583401561478446, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.48314501241423, "mean_processing_ms": 2.962314239557656, "mean_inference_ms": 0.333807123964766}, "off_policy_estimator": {}, "info": {"num_steps_trained": 188928, "num_steps_sampled": 679844, "sample_time_ms": 40330.341, "load_time_ms": 1.467, "grad_time_ms": 1171.666, "update_time_ms": 6.237, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 4.999999873689376e-05, "total_loss": 0.14502033591270447, "policy_loss": -0.01596422865986824, "vf_loss": 0.1588456779718399, "vf_explained_var": 0.886659562587738, "kl": 0.011869356967508793, "entropy": 1.8690217733383179, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10282, "done": false, "timesteps_total": 679844, "episodes_total": 1498, "training_iteration": 66, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-55-16", "timestamp": 1589878516, "time_this_iter_s": 39.57674741744995, "time_total_s": 3069.0754396915436, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20244f28>", "on_episode_step": "<function on_episode_step at 0x7fef205dac80>", "on_episode_end": "<function on_episode_end at 0x7fef205da2f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef21e3ad08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054c840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3069.0754396915436, "timesteps_since_restore": 679844, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 84.1719298245614, "ram_util_percent": 29.743859649122808}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.5725078, "episode_len_mean": 448.51, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5725078}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.541605567785026, "avg_speed_min": 1.2919489654770144, "avg_speed_max": 8.583401561478446, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.486382101776968, "mean_processing_ms": 2.964576991435734, "mean_inference_ms": 0.3336407334466116}, "off_policy_estimator": {}, "info": {"num_steps_trained": 190720, "num_steps_sampled": 690405, "sample_time_ms": 40394.848, "load_time_ms": 1.443, "grad_time_ms": 1189.141, "update_time_ms": 6.257, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 4.999999873689376e-05, "total_loss": 0.36241674423217773, "policy_loss": -0.013647856190800667, "vf_loss": 0.37310513854026794, "vf_explained_var": 0.8743303418159485, "kl": 0.016422783955931664, "entropy": 1.797066330909729, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10561, "done": false, "timesteps_total": 690405, "episodes_total": 1522, "training_iteration": 67, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-55-57", "timestamp": 1589878557, "time_this_iter_s": 41.34179759025574, "time_total_s": 3110.4172372817993, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203f28c8>", "on_episode_step": "<function on_episode_step at 0x7fef203f2620>", "on_episode_end": "<function on_episode_end at 0x7fef203f2d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203f2598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205da840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3110.4172372817993, "timesteps_since_restore": 690405, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 82.95593220338984, "ram_util_percent": 29.771186440677962}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.4725082, "episode_len_mean": 452.71, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4725082}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.703178684294062, "avg_speed_min": 1.2919489654770144, "avg_speed_max": 8.583401561478446, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.434293432433577, "mean_processing_ms": 2.9647658358060847, "mean_inference_ms": 0.3318499473640192}, "off_policy_estimator": {}, "info": {"num_steps_trained": 192896, "num_steps_sampled": 700958, "sample_time_ms": 40548.43, "load_time_ms": 1.455, "grad_time_ms": 1223.017, "update_time_ms": 6.242, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 4.999999873689376e-05, "total_loss": 0.47757548093795776, "policy_loss": -0.010759511031210423, "vf_loss": 0.4869246780872345, "vf_explained_var": 0.9033679962158203, "kl": 0.007826024666428566, "entropy": 1.7682478427886963, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10553, "done": false, "timesteps_total": 700958, "episodes_total": 1545, "training_iteration": 68, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-56-40", "timestamp": 1589878600, "time_this_iter_s": 42.6862576007843, "time_total_s": 3153.1034948825836, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205da378>", "on_episode_step": "<function on_episode_step at 0x7fef20340730>", "on_episode_end": "<function on_episode_end at 0x7fef203407b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20340840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20340b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3153.1034948825836, "timesteps_since_restore": 700958, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 84.34098360655736, "ram_util_percent": 29.77704918032787}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.36750679999999997, "episode_len_mean": 464.19, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.36750679999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5744041757887866, "avg_speed_min": 1.438693432164285, "avg_speed_max": 8.126003857274917, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.335124408615574, "mean_processing_ms": 2.959689289304596, "mean_inference_ms": 0.3289591683670524}, "off_policy_estimator": {}, "info": {"num_steps_trained": 195456, "num_steps_sampled": 711185, "sample_time_ms": 40480.022, "load_time_ms": 1.431, "grad_time_ms": 1267.874, "update_time_ms": 6.462, "learner": {"av": {"cur_kl_coeff": 0.18020324409008026, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7534390091896057, "policy_loss": -0.01953474059700966, "vf_loss": 0.769299328327179, "vf_explained_var": 0.8235514760017395, "kl": 0.020390238612890244, "entropy": 1.8114039897918701, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10227, "done": false, "timesteps_total": 711185, "episodes_total": 1567, "training_iteration": 69, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-57-23", "timestamp": 1589878643, "time_this_iter_s": 42.986762046813965, "time_total_s": 3196.0902569293976, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203f28c8>", "on_episode_step": "<function on_episode_step at 0x7fef203f2d90>", "on_episode_end": "<function on_episode_end at 0x7fef203f2598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205da840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205ee950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3196.0902569293976, "timesteps_since_restore": 711185, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 84.45409836065573, "ram_util_percent": 29.795081967213115}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.370006, "episode_len_mean": 459.7, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.370006}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.441688081613635, "avg_speed_min": 1.438693432164285, "avg_speed_max": 8.126003857274917, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.317015751591967, "mean_processing_ms": 2.9603044544273986, "mean_inference_ms": 0.32801559495576826}, "off_policy_estimator": {}, "info": {"num_steps_trained": 197376, "num_steps_sampled": 721320, "sample_time_ms": 40066.649, "load_time_ms": 1.428, "grad_time_ms": 1235.191, "update_time_ms": 6.496, "learner": {"av": {"cur_kl_coeff": 0.2703048586845398, "cur_lr": 4.999999873689376e-05, "total_loss": 0.49772536754608154, "policy_loss": -0.02190006524324417, "vf_loss": 0.5146118402481079, "vf_explained_var": 0.7699440717697144, "kl": 0.018547862768173218, "entropy": 2.020083427429199, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10135, "done": false, "timesteps_total": 721320, "episodes_total": 1588, "training_iteration": 70, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-58-02", "timestamp": 1589878682, "time_this_iter_s": 39.411908864974976, "time_total_s": 3235.5021657943726, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205ee2f0>", "on_episode_step": "<function on_episode_step at 0x7fef204567b8>", "on_episode_end": "<function on_episode_end at 0x7fef204561e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204569d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204e3d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3235.5021657943726, "timesteps_since_restore": 721320, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 83.27719298245614, "ram_util_percent": 29.791228070175443}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.1650060999999999, "episode_len_mean": 471.64, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1650060999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.397915811776472, "avg_speed_min": 1.438693432164285, "avg_speed_max": 8.126003857274917, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.284923060751577, "mean_processing_ms": 2.9582618559135936, "mean_inference_ms": 0.32686040968790325}, "off_policy_estimator": {}, "info": {"num_steps_trained": 199424, "num_steps_sampled": 731525, "sample_time_ms": 40062.903, "load_time_ms": 1.42, "grad_time_ms": 1263.048, "update_time_ms": 6.45, "learner": {"av": {"cur_kl_coeff": 0.2703048586845398, "cur_lr": 4.999999873689376e-05, "total_loss": 0.20385012030601501, "policy_loss": -0.018396597355604172, "vf_loss": 0.2179635614156723, "vf_explained_var": 0.860593318939209, "kl": 0.01584569737315178, "entropy": 1.7447259426116943, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10205, "done": false, "timesteps_total": 731525, "episodes_total": 1608, "training_iteration": 71, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-58-43", "timestamp": 1589878723, "time_this_iter_s": 40.64736986160278, "time_total_s": 3276.1495356559753, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205ee1e0>", "on_episode_step": "<function on_episode_step at 0x7fef205ee510>", "on_episode_end": "<function on_episode_end at 0x7fef205ee730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205ee048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3276.1495356559753, "timesteps_since_restore": 731525, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 84.1655172413793, "ram_util_percent": 29.79655172413793}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.16250699999999996, "episode_len_mean": 475.19, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16414848484848482}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.506147442429209, "avg_speed_min": 2.4623277741865324, "avg_speed_max": 8.126003857274917, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.23582176314632, "mean_processing_ms": 2.956889040920062, "mean_inference_ms": 0.3251523069782906}, "off_policy_estimator": {}, "info": {"num_steps_trained": 200832, "num_steps_sampled": 742072, "sample_time_ms": 39600.341, "load_time_ms": 1.423, "grad_time_ms": 1236.764, "update_time_ms": 6.332, "learner": {"av": {"cur_kl_coeff": 0.2703048586845398, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3526632487773895, "policy_loss": -0.009170553646981716, "vf_loss": 0.35895296931266785, "vf_explained_var": 0.8521882891654968, "kl": 0.010657679289579391, "entropy": 1.7453739643096924, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10547, "done": false, "timesteps_total": 742072, "episodes_total": 1632, "training_iteration": 72, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_08-59-21", "timestamp": 1589878761, "time_this_iter_s": 37.23812174797058, "time_total_s": 3313.387657403946, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203d1048>", "on_episode_step": "<function on_episode_step at 0x7fef20244400>", "on_episode_end": "<function on_episode_end at 0x7fef20244488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20244510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204e3e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3313.387657403946, "timesteps_since_restore": 742072, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 84.33396226415095, "ram_util_percent": 29.798113207547168}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.04249260000000004, "episode_len_mean": 483.05, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.042921818181818214}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.336518437056372, "avg_speed_min": 2.2807621938711344, "avg_speed_max": 7.632902936776776, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.221170633387068, "mean_processing_ms": 2.9535526856981718, "mean_inference_ms": 0.32454059395170404}, "off_policy_estimator": {}, "info": {"num_steps_trained": 203264, "num_steps_sampled": 752583, "sample_time_ms": 39756.478, "load_time_ms": 1.445, "grad_time_ms": 1266.527, "update_time_ms": 6.485, "learner": {"av": {"cur_kl_coeff": 0.2703048586845398, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6240626573562622, "policy_loss": -0.01748514547944069, "vf_loss": 0.6392391324043274, "vf_explained_var": 0.7850046157836914, "kl": 0.008540811948478222, "entropy": 1.715354084968567, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10511, "done": false, "timesteps_total": 752583, "episodes_total": 1653, "training_iteration": 73, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-00-05", "timestamp": 1589878805, "time_this_iter_s": 44.12106728553772, "time_total_s": 3357.5087246894836, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204691e0>", "on_episode_step": "<function on_episode_step at 0x7fef204560d0>", "on_episode_end": "<function on_episode_end at 0x7fef20456158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20456378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203a4f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3357.5087246894836, "timesteps_since_restore": 752583, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 83.52063492063492, "ram_util_percent": 29.799999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.1424924, "episode_len_mean": 487.12, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.14393171717171718}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.387232690246876, "avg_speed_min": 2.2807621938711344, "avg_speed_max": 8.263197379584527, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.190017015706253, "mean_processing_ms": 2.950895566288431, "mean_inference_ms": 0.32351263478891673}, "off_policy_estimator": {}, "info": {"num_steps_trained": 205696, "num_steps_sampled": 763099, "sample_time_ms": 39766.366, "load_time_ms": 1.402, "grad_time_ms": 1272.151, "update_time_ms": 6.598, "learner": {"av": {"cur_kl_coeff": 0.2703048586845398, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15871261060237885, "policy_loss": -0.0014412497403100133, "vf_loss": 0.15854604542255402, "vf_explained_var": 0.9076363444328308, "kl": 0.005948146805167198, "entropy": 1.7036828994750977, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10516, "done": false, "timesteps_total": 763099, "episodes_total": 1674, "training_iteration": 74, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-00-47", "timestamp": 1589878847, "time_this_iter_s": 42.674582719802856, "time_total_s": 3400.1833074092865, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20456268>", "on_episode_step": "<function on_episode_step at 0x7fef204ffe18>", "on_episode_end": "<function on_episode_end at 0x7fef204ff400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ffae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054cd08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3400.1833074092865, "timesteps_since_restore": 763099, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 81.50983606557377, "ram_util_percent": 29.8}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.14249250000000002, "episode_len_mean": 487.54, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.14393181818181816}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.368122646092945, "avg_speed_min": 2.263107905264048, "avg_speed_max": 8.263197379584527, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.14170669145791, "mean_processing_ms": 2.946975524033205, "mean_inference_ms": 0.32223403033150655}, "off_policy_estimator": {}, "info": {"num_steps_trained": 207616, "num_steps_sampled": 773488, "sample_time_ms": 39536.157, "load_time_ms": 1.441, "grad_time_ms": 1280.364, "update_time_ms": 7.077, "learner": {"av": {"cur_kl_coeff": 0.2703048586845398, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18519607186317444, "policy_loss": -0.014876204542815685, "vf_loss": 0.1968974620103836, "vf_explained_var": 0.8862627744674683, "kl": 0.011745357885956764, "entropy": 1.7336726188659668, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10389, "done": false, "timesteps_total": 773488, "episodes_total": 1695, "training_iteration": 75, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-01-25", "timestamp": 1589878885, "time_this_iter_s": 37.67237973213196, "time_total_s": 3437.8556871414185, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2054ce18>", "on_episode_step": "<function on_episode_step at 0x7fef2054c6a8>", "on_episode_end": "<function on_episode_end at 0x7fef2054c730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2054c7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3437.8556871414185, "timesteps_since_restore": 773488, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 82.31481481481481, "ram_util_percent": 29.799999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.1424937, "episode_len_mean": 488.48, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1424937}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.426664482445045, "avg_speed_min": 1.278354478474068, "avg_speed_max": 8.263197379584527, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.093594172507878, "mean_processing_ms": 2.943902426205673, "mean_inference_ms": 0.3210046077962447}, "off_policy_estimator": {}, "info": {"num_steps_trained": 209792, "num_steps_sampled": 784125, "sample_time_ms": 39696.779, "load_time_ms": 1.436, "grad_time_ms": 1310.98, "update_time_ms": 6.869, "learner": {"av": {"cur_kl_coeff": 0.2703048586845398, "cur_lr": 4.999999873689376e-05, "total_loss": 0.15843574702739716, "policy_loss": -0.01073174923658371, "vf_loss": 0.16784057021141052, "vf_explained_var": 0.9060546159744263, "kl": 0.004909036215394735, "entropy": 1.7658050060272217, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10637, "done": false, "timesteps_total": 784125, "episodes_total": 1718, "training_iteration": 76, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-02-07", "timestamp": 1589878927, "time_this_iter_s": 41.49030637741089, "time_total_s": 3479.3459935188293, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20469730>", "on_episode_step": "<function on_episode_step at 0x7fef20244268>", "on_episode_end": "<function on_episode_end at 0x7fef20244378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20244598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205830d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3479.3459935188293, "timesteps_since_restore": 784125, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 81.52372881355933, "ram_util_percent": 29.805084745762713}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.37000559999999993, "episode_len_mean": 459.6, "episodes_this_iter": 27, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.37000559999999993}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.436562409490724, "avg_speed_min": 1.278354478474068, "avg_speed_max": 8.263197379584527, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.065052840676977, "mean_processing_ms": 2.9426886004658543, "mean_inference_ms": 0.3204143015811074}, "off_policy_estimator": {}, "info": {"num_steps_trained": 212224, "num_steps_sampled": 794602, "sample_time_ms": 39861.444, "load_time_ms": 1.475, "grad_time_ms": 1347.984, "update_time_ms": 7.025, "learner": {"av": {"cur_kl_coeff": 0.1351524293422699, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4227266311645508, "policy_loss": -0.022932179272174835, "vf_loss": 1.4429731369018555, "vf_explained_var": 0.7904065251350403, "kl": 0.019872622564435005, "entropy": 1.687178611755371, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10477, "done": false, "timesteps_total": 794602, "episodes_total": 1745, "training_iteration": 77, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-02-50", "timestamp": 1589878970, "time_this_iter_s": 43.36112856864929, "time_total_s": 3522.7071220874786, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583c80>", "on_episode_step": "<function on_episode_step at 0x7fef20318378>", "on_episode_end": "<function on_episode_end at 0x7fef20318400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20318488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20318e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3522.7071220874786, "timesteps_since_restore": 794602, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 81.00645161290323, "ram_util_percent": 29.799999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.3750045999999999, "episode_len_mean": 452.22, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3750045999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.416742430150678, "avg_speed_min": 1.278354478474068, "avg_speed_max": 8.223098560791264, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 25.024774202376875, "mean_processing_ms": 2.9426966054901738, "mean_inference_ms": 0.3195118648251847}, "off_policy_estimator": {}, "info": {"num_steps_trained": 214400, "num_steps_sampled": 805009, "sample_time_ms": 39739.59, "load_time_ms": 1.51, "grad_time_ms": 1356.281, "update_time_ms": 7.127, "learner": {"av": {"cur_kl_coeff": 0.1351524293422699, "cur_lr": 4.999999873689376e-05, "total_loss": 0.43281570076942444, "policy_loss": -0.009722727350890636, "vf_loss": 0.43933314085006714, "vf_explained_var": 0.8549463748931885, "kl": 0.02371615171432495, "entropy": 1.8258447647094727, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10407, "done": false, "timesteps_total": 805009, "episodes_total": 1767, "training_iteration": 78, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-03-32", "timestamp": 1589879012, "time_this_iter_s": 41.55142164230347, "time_total_s": 3564.258543729782, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20318ea0>", "on_episode_step": "<function on_episode_step at 0x7fef203181e0>", "on_episode_end": "<function on_episode_end at 0x7fef20318510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20318598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204e3e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3564.258543729782, "timesteps_since_restore": 805009, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 80.5440677966102, "ram_util_percent": 29.801694915254238}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.5750046000000001, "episode_len_mean": 448.18, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5750046000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.559471004952971, "avg_speed_min": 1.278354478474068, "avg_speed_max": 8.222266621111862, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.989881624024733, "mean_processing_ms": 2.943347859804781, "mean_inference_ms": 0.3188178600850868}, "off_policy_estimator": {}, "info": {"num_steps_trained": 216448, "num_steps_sampled": 815106, "sample_time_ms": 39301.951, "load_time_ms": 1.517, "grad_time_ms": 1319.347, "update_time_ms": 7.004, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.39533984661102295, "policy_loss": -0.011880048550665379, "vf_loss": 0.4052613377571106, "vf_explained_var": 0.8977998495101929, "kl": 0.00966101698577404, "entropy": 1.8458871841430664, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10097, "done": false, "timesteps_total": 815106, "episodes_total": 1789, "training_iteration": 79, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-04-10", "timestamp": 1589879050, "time_this_iter_s": 38.23925995826721, "time_total_s": 3602.4978036880493, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20318488>", "on_episode_step": "<function on_episode_step at 0x7fef20340620>", "on_episode_end": "<function on_episode_end at 0x7fef203406a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20340730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20340ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3602.4978036880493, "timesteps_since_restore": 815106, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 81.58363636363636, "ram_util_percent": 29.801818181818177}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.8775054, "episode_len_mean": 439.76, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8775054}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4336741724797415, "avg_speed_min": 1.506921498982905, "avg_speed_max": 7.844515562777056, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.956699920804184, "mean_processing_ms": 2.9425047362411423, "mean_inference_ms": 0.3180395612258232}, "off_policy_estimator": {}, "info": {"num_steps_trained": 218624, "num_steps_sampled": 825506, "sample_time_ms": 39641.759, "load_time_ms": 1.515, "grad_time_ms": 1348.07, "update_time_ms": 7.213, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0296231508255005, "policy_loss": -0.015624994412064552, "vf_loss": 1.0436615943908691, "vf_explained_var": 0.8372576832771301, "kl": 0.007826338522136211, "entropy": 1.802451491355896, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 825506, "episodes_total": 1812, "training_iteration": 80, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-04-53", "timestamp": 1589879093, "time_this_iter_s": 43.09949445724487, "time_total_s": 3645.597298145294, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f70d0>", "on_episode_step": "<function on_episode_step at 0x7fef204f7e18>", "on_episode_end": "<function on_episode_end at 0x7fef204f7ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204f7158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3645.597298145294, "timesteps_since_restore": 825506, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 81.4049180327869, "ram_util_percent": 29.82786885245902}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.37000500000000003, "episode_len_mean": 459.38, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.37374242424242426}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.310243381627013, "avg_speed_min": 1.648416500313979, "avg_speed_max": 8.12673572869712, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.883877374162992, "mean_processing_ms": 2.9381025760124158, "mean_inference_ms": 0.31617546732831087}, "off_policy_estimator": {}, "info": {"num_steps_trained": 220928, "num_steps_sampled": 835747, "sample_time_ms": 39540.236, "load_time_ms": 1.493, "grad_time_ms": 1357.681, "update_time_ms": 7.288, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2911033034324646, "policy_loss": -0.006351133808493614, "vf_loss": 0.2955142557621002, "vf_explained_var": 0.8412945866584778, "kl": 0.009570353664457798, "entropy": 1.7932363748550415, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10241, "done": false, "timesteps_total": 835747, "episodes_total": 1833, "training_iteration": 81, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-05-33", "timestamp": 1589879133, "time_this_iter_s": 39.73041582107544, "time_total_s": 3685.3277139663696, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20340158>", "on_episode_step": "<function on_episode_step at 0x7fef20340400>", "on_episode_end": "<function on_episode_end at 0x7fef20340488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20340950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3685.3277139663696, "timesteps_since_restore": 835747, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 81.56315789473683, "ram_util_percent": 29.857894736842105}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.2625052, "episode_len_mean": 470.86, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.26515676767676766}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.223027869348929, "avg_speed_min": 2.2496141152637694, "avg_speed_max": 8.12673572869712, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.838398552057726, "mean_processing_ms": 2.9358636343757483, "mean_inference_ms": 0.3151997626805759}, "off_policy_estimator": {}, "info": {"num_steps_trained": 223744, "num_steps_sampled": 845887, "sample_time_ms": 40236.918, "load_time_ms": 1.505, "grad_time_ms": 1444.627, "update_time_ms": 7.256, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.24114036560058594, "policy_loss": -0.013906771317124367, "vf_loss": 0.25338807702064514, "vf_explained_var": 0.8676243424415588, "kl": 0.008183637633919716, "entropy": 1.7647075653076172, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10140, "done": false, "timesteps_total": 845887, "episodes_total": 1853, "training_iteration": 82, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-06-18", "timestamp": 1589879178, "time_this_iter_s": 45.074549198150635, "time_total_s": 3730.4022631645203, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2026c0d0>", "on_episode_step": "<function on_episode_step at 0x7fef2026c400>", "on_episode_end": "<function on_episode_end at 0x7fef2026c1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2026c488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20318b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3730.4022631645203, "timesteps_since_restore": 845887, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 81.9203125, "ram_util_percent": 29.881250000000005}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.2625073, "episode_len_mean": 470.86, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2651588888888889}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.104780166901368, "avg_speed_min": 2.2496141152637694, "avg_speed_max": 8.12673572869712, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.821925956832715, "mean_processing_ms": 2.9378393672078364, "mean_inference_ms": 0.31488603797987197}, "off_policy_estimator": {}, "info": {"num_steps_trained": 226176, "num_steps_sampled": 856090, "sample_time_ms": 40265.748, "load_time_ms": 1.539, "grad_time_ms": 1438.694, "update_time_ms": 6.997, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.13973912596702576, "policy_loss": -0.005924082826822996, "vf_loss": 0.14424672722816467, "vf_explained_var": 0.9276406168937683, "kl": 0.006986985914409161, "entropy": 1.7389975786209106, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10203, "done": false, "timesteps_total": 856090, "episodes_total": 1875, "training_iteration": 83, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-07-03", "timestamp": 1589879223, "time_this_iter_s": 44.34722113609314, "time_total_s": 3774.7494843006134, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205ee488>", "on_episode_step": "<function on_episode_step at 0x7fef204f72f0>", "on_episode_end": "<function on_episode_end at 0x7fef204f71e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204f7d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3774.7494843006134, "timesteps_since_restore": 856090, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 81.31093750000001, "ram_util_percent": 29.887500000000003}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.06250649999999998, "episode_len_mean": 474.29, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06313787878787876}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.077115247174561, "avg_speed_min": 2.2496141152637694, "avg_speed_max": 8.12673572869712, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.79509383033686, "mean_processing_ms": 2.9373868524355906, "mean_inference_ms": 0.31436010255165076}, "off_policy_estimator": {}, "info": {"num_steps_trained": 228224, "num_steps_sampled": 866494, "sample_time_ms": 39963.005, "load_time_ms": 1.528, "grad_time_ms": 1407.9, "update_time_ms": 6.864, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.49532389640808105, "policy_loss": -0.011490321718156338, "vf_loss": 0.5041996240615845, "vf_explained_var": 0.8307700157165527, "kl": 0.01289706863462925, "entropy": 1.6628906726837158, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10404, "done": false, "timesteps_total": 866494, "episodes_total": 1898, "training_iteration": 84, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-07-42", "timestamp": 1589879262, "time_this_iter_s": 39.33479928970337, "time_total_s": 3814.0842835903168, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203400d0>", "on_episode_step": "<function on_episode_step at 0x7fef20244730>", "on_episode_end": "<function on_episode_end at 0x7fef202447b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef202449d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204412f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3814.0842835903168, "timesteps_since_restore": 866494, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 80.33928571428571, "ram_util_percent": 29.896428571428572}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.1374931, "episode_len_mean": 478.92, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13888191919191917}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.012051309390574, "avg_speed_min": 1.16486183591156, "avg_speed_max": 8.12673572869712, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.777325532962124, "mean_processing_ms": 2.9339363307722794, "mean_inference_ms": 0.314179976994456}, "off_policy_estimator": {}, "info": {"num_steps_trained": 230784, "num_steps_sampled": 876653, "sample_time_ms": 40483.831, "load_time_ms": 1.496, "grad_time_ms": 1435.525, "update_time_ms": 6.61, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.34102103114128113, "policy_loss": -0.013565423898398876, "vf_loss": 0.3531635105609894, "vf_explained_var": 0.8239822387695312, "kl": 0.007019101642072201, "entropy": 1.7391077280044556, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10159, "done": false, "timesteps_total": 876653, "episodes_total": 1918, "training_iteration": 85, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-08-25", "timestamp": 1589879305, "time_this_iter_s": 43.148929595947266, "time_total_s": 3857.233213186264, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204417b8>", "on_episode_step": "<function on_episode_step at 0x7fef201ceea0>", "on_episode_end": "<function on_episode_end at 0x7fef201cef28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20417048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204176a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3857.233213186264, "timesteps_since_restore": 876653, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 81.31612903225808, "ram_util_percent": 29.898387096774204}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.1374919, "episode_len_mean": 479.61, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1374919}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8475444229791016, "avg_speed_min": 1.16486183591156, "avg_speed_max": 7.543773415487165, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.760115388427803, "mean_processing_ms": 2.932691503715519, "mean_inference_ms": 0.31387111306124493}, "off_policy_estimator": {}, "info": {"num_steps_trained": 233088, "num_steps_sampled": 886805, "sample_time_ms": 40659.02, "load_time_ms": 1.494, "grad_time_ms": 1419.004, "update_time_ms": 6.336, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2339639961719513, "policy_loss": -0.010651015676558018, "vf_loss": 0.24245765805244446, "vf_explained_var": 0.8885557651519775, "kl": 0.01064162328839302, "entropy": 1.6204302310943604, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10152, "done": false, "timesteps_total": 886805, "episodes_total": 1939, "training_iteration": 86, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-09-09", "timestamp": 1589879349, "time_this_iter_s": 43.07131242752075, "time_total_s": 3900.304525613785, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203a4158>", "on_episode_step": "<function on_episode_step at 0x7fef203a4950>", "on_episode_end": "<function on_episode_end at 0x7fef204e3730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204e3620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20318e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3900.304525613785, "timesteps_since_restore": 886805, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 81.44590163934426, "ram_util_percent": 29.90000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.03749300000000001, "episode_len_mean": 480.01, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03749300000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8482973817134196, "avg_speed_min": 1.16486183591156, "avg_speed_max": 7.899409606144421, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.74173348397185, "mean_processing_ms": 2.9323036273487433, "mean_inference_ms": 0.31350657612009497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 235008, "num_steps_sampled": 897398, "sample_time_ms": 40418.225, "load_time_ms": 1.474, "grad_time_ms": 1388.319, "update_time_ms": 6.115, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.4039282202720642, "policy_loss": -0.021531037986278534, "vf_loss": 0.42145460844039917, "vf_explained_var": 0.8761127591133118, "kl": 0.01975366286933422, "entropy": 1.6509231328964233, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10593, "done": false, "timesteps_total": 897398, "episodes_total": 1962, "training_iteration": 87, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-09-49", "timestamp": 1589879389, "time_this_iter_s": 40.64199376106262, "time_total_s": 3940.9465193748474, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204ff9d8>", "on_episode_step": "<function on_episode_step at 0x7fef20244510>", "on_episode_end": "<function on_episode_end at 0x7fef20244598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20244620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20456a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3940.9465193748474, "timesteps_since_restore": 897398, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 83.4155172413793, "ram_util_percent": 29.900000000000006}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.1399935, "episode_len_mean": 485.01, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1399935}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.03529582016755, "avg_speed_min": 1.16486183591156, "avg_speed_max": 7.899409606144421, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.703176442676096, "mean_processing_ms": 2.927564699695335, "mean_inference_ms": 0.3126655947001682}, "off_policy_estimator": {}, "info": {"num_steps_trained": 236928, "num_steps_sampled": 907912, "sample_time_ms": 40459.192, "load_time_ms": 1.414, "grad_time_ms": 1354.288, "update_time_ms": 5.937, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18498344719409943, "policy_loss": -0.008417723700404167, "vf_loss": 0.19148781895637512, "vf_explained_var": 0.9001837968826294, "kl": 0.009437971748411655, "entropy": 1.6690691709518433, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10514, "done": false, "timesteps_total": 907912, "episodes_total": 1984, "training_iteration": 88, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-10-31", "timestamp": 1589879431, "time_this_iter_s": 41.61673903465271, "time_total_s": 3982.5632584095, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20456378>", "on_episode_step": "<function on_episode_step at 0x7fef204560d0>", "on_episode_end": "<function on_episode_end at 0x7fef20244400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2024a488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201dabf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 3982.5632584095, "timesteps_since_restore": 907912, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 81.02333333333334, "ram_util_percent": 29.90000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.1374923, "episode_len_mean": 477.43, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1374923}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.127923047542155, "avg_speed_min": 1.16486183591156, "avg_speed_max": 7.899409606144421, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.686251601885395, "mean_processing_ms": 2.9270575149263105, "mean_inference_ms": 0.31218109338492595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 239104, "num_steps_sampled": 918073, "sample_time_ms": 40622.676, "load_time_ms": 1.386, "grad_time_ms": 1343.316, "update_time_ms": 5.902, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.19096848368644714, "policy_loss": -0.011477909982204437, "vf_loss": 0.2004190981388092, "vf_explained_var": 0.893344521522522, "kl": 0.010000037960708141, "entropy": 1.7923675775527954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10161, "done": false, "timesteps_total": 918073, "episodes_total": 2005, "training_iteration": 89, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-11-11", "timestamp": 1589879471, "time_this_iter_s": 39.75796890258789, "time_total_s": 4022.321227312088, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2024a7b8>", "on_episode_step": "<function on_episode_step at 0x7fef2026c2f0>", "on_episode_end": "<function on_episode_end at 0x7fef20441730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2026c048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4022.321227312088, "timesteps_since_restore": 918073, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 80.76785714285714, "ram_util_percent": 29.900000000000002}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.1399923, "episode_len_mean": 480.87, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1399923}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.186792608601848, "avg_speed_min": 1.2792058261519423, "avg_speed_max": 7.899409606144421, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.647748870317624, "mean_processing_ms": 2.924295889697349, "mean_inference_ms": 0.31122256652595537}, "off_policy_estimator": {}, "info": {"num_steps_trained": 241280, "num_steps_sampled": 928178, "sample_time_ms": 40522.934, "load_time_ms": 1.392, "grad_time_ms": 1316.296, "update_time_ms": 5.545, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.11070667207241058, "policy_loss": -0.028781261295080185, "vf_loss": 0.13588757812976837, "vf_explained_var": 0.935142993927002, "kl": 0.017759444192051888, "entropy": 1.663231372833252, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10105, "done": false, "timesteps_total": 928178, "episodes_total": 2025, "training_iteration": 90, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-11-53", "timestamp": 1589879513, "time_this_iter_s": 41.82784390449524, "time_total_s": 4064.1490712165833, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203a4bf8>", "on_episode_step": "<function on_episode_step at 0x7fef204177b8>", "on_episode_end": "<function on_episode_end at 0x7fef204179d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204178c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203a4ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4064.1490712165833, "timesteps_since_restore": 928178, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 83.595, "ram_util_percent": 29.90000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.0, "episode_reward_mean": 0.24249239999999997, "episode_len_mean": 485.11, "episodes_this_iter": 22, "policy_reward_min": {"av": 0.0}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24249239999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 4.099295288358322, "avg_speed_min": 1.2792058261519423, "avg_speed_max": 7.899409606144421, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.64168681296847, "mean_processing_ms": 2.922132026103603, "mean_inference_ms": 0.3110505246696164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 243456, "num_steps_sampled": 938606, "sample_time_ms": 40788.899, "load_time_ms": 1.384, "grad_time_ms": 1285.52, "update_time_ms": 5.611, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2538298964500427, "policy_loss": -0.006058814469724894, "vf_loss": 0.25833696126937866, "vf_explained_var": 0.8876963257789612, "kl": 0.007654343266040087, "entropy": 1.7500019073486328, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10428, "done": false, "timesteps_total": 938606, "episodes_total": 2047, "training_iteration": 91, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-12-35", "timestamp": 1589879555, "time_this_iter_s": 42.08375859260559, "time_total_s": 4106.232829809189, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201a5840>", "on_episode_step": "<function on_episode_step at 0x7fef20318ae8>", "on_episode_end": "<function on_episode_end at 0x7fef20318b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20318bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20318840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4106.232829809189, "timesteps_since_restore": 938606, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 82.36999999999999, "ram_util_percent": 29.90000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.03249150000000003, "episode_len_mean": 468.3, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03249150000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.213828433551725, "avg_speed_min": 1.2792058261519423, "avg_speed_max": 7.718007427993533, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.609230874851843, "mean_processing_ms": 2.9225915253963457, "mean_inference_ms": 0.3100179818259077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 245504, "num_steps_sampled": 948707, "sample_time_ms": 40377.73, "load_time_ms": 1.364, "grad_time_ms": 1224.18, "update_time_ms": 5.672, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6788133382797241, "policy_loss": -0.0048059094697237015, "vf_loss": 0.6814314723014832, "vf_explained_var": 0.8728842735290527, "kl": 0.010791735723614693, "entropy": 1.7814332246780396, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10101, "done": false, "timesteps_total": 948707, "episodes_total": 2070, "training_iteration": 92, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-13-15", "timestamp": 1589879595, "time_this_iter_s": 40.35022330284119, "time_total_s": 4146.58305311203, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203e62f0>", "on_episode_step": "<function on_episode_step at 0x7fef20244158>", "on_episode_end": "<function on_episode_end at 0x7fef20244268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20244378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204560d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4146.58305311203, "timesteps_since_restore": 948707, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 82.24655172413792, "ram_util_percent": 29.906896551724145}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.02749230000000001, "episode_len_mean": 459.81, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.027769999999999993}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.168965313152218, "avg_speed_min": 1.6063107027715704, "avg_speed_max": 7.22932515494111, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.596629903996085, "mean_processing_ms": 2.921217097193049, "mean_inference_ms": 0.3096133664880985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 247424, "num_steps_sampled": 959198, "sample_time_ms": 40001.908, "load_time_ms": 1.325, "grad_time_ms": 1205.733, "update_time_ms": 5.835, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.18328534066677094, "policy_loss": -0.01990067958831787, "vf_loss": 0.20116618275642395, "vf_explained_var": 0.9347959756851196, "kl": 0.009963217191398144, "entropy": 1.7554851770401, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10491, "done": false, "timesteps_total": 959198, "episodes_total": 2095, "training_iteration": 93, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-13-56", "timestamp": 1589879636, "time_this_iter_s": 40.40781044960022, "time_total_s": 4186.99086356163, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201a5840>", "on_episode_step": "<function on_episode_step at 0x7fef200a2d08>", "on_episode_end": "<function on_episode_end at 0x7fef200a2d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200a2e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20456158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4186.99086356163, "timesteps_since_restore": 959198, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 83.12931034482759, "ram_util_percent": 29.936206896551727}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.029992099999999994, "episode_len_mean": 467.39, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.030295050505050485}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.102635426317685, "avg_speed_min": 1.6063107027715704, "avg_speed_max": 7.22932515494111, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.566304634307745, "mean_processing_ms": 2.921923986211995, "mean_inference_ms": 0.30869529514540756}, "off_policy_estimator": {}, "info": {"num_steps_trained": 249600, "num_steps_sampled": 969823, "sample_time_ms": 40092.391, "load_time_ms": 1.36, "grad_time_ms": 1231.279, "update_time_ms": 5.811, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 4.999999873689376e-05, "total_loss": 0.10598023980855942, "policy_loss": -0.018630122765898705, "vf_loss": 0.12053683400154114, "vf_explained_var": 0.945276141166687, "kl": 0.02009345218539238, "entropy": 1.742870569229126, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10625, "done": false, "timesteps_total": 969823, "episodes_total": 2116, "training_iteration": 94, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-14-36", "timestamp": 1589879676, "time_this_iter_s": 40.494444847106934, "time_total_s": 4227.485308408737, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef200a2488>", "on_episode_step": "<function on_episode_step at 0x7fef204f7d90>", "on_episode_end": "<function on_episode_end at 0x7fef20469268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204698c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20441378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4227.485308408737, "timesteps_since_restore": 969823, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 83.28070175438596, "ram_util_percent": 29.985964912280703}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.0700092, "episode_len_mean": 462.61, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07071636363636365}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2955455266377305, "avg_speed_min": 1.6063107027715704, "avg_speed_max": 7.468542043269175, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.549333044812812, "mean_processing_ms": 2.9216077875629116, "mean_inference_ms": 0.30818938611417485}, "off_policy_estimator": {}, "info": {"num_steps_trained": 251520, "num_steps_sampled": 980479, "sample_time_ms": 39872.384, "load_time_ms": 1.339, "grad_time_ms": 1198.114, "update_time_ms": 5.696, "learner": {"av": {"cur_kl_coeff": 0.30409297347068787, "cur_lr": 4.999999873689376e-05, "total_loss": 0.4422662854194641, "policy_loss": -0.0081888847053051, "vf_loss": 0.4489564597606659, "vf_explained_var": 0.8856837749481201, "kl": 0.00492820143699646, "entropy": 1.712072730064392, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10656, "done": false, "timesteps_total": 980479, "episodes_total": 2139, "training_iteration": 95, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-15-17", "timestamp": 1589879717, "time_this_iter_s": 40.62142038345337, "time_total_s": 4268.106728792191, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2026c378>", "on_episode_step": "<function on_episode_step at 0x7fef204f71e0>", "on_episode_end": "<function on_episode_end at 0x7fef2054c950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2054cd08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054c8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4268.106728792191, "timesteps_since_restore": 980479, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 83.6258620689655, "ram_util_percent": 29.99137931034483}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -9.75003, "episode_reward_mean": 0.12998850000000003, "episode_len_mean": 463.33, "episodes_this_iter": 22, "policy_reward_min": {"av": -9.75003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13130151515151517}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.213338701367858, "avg_speed_min": 1.2597576996581783, "avg_speed_max": 7.468542043269175, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.504193479883305, "mean_processing_ms": 2.9197230142691613, "mean_inference_ms": 0.3068692747867494}, "off_policy_estimator": {}, "info": {"num_steps_trained": 253696, "num_steps_sampled": 990808, "sample_time_ms": 39740.394, "load_time_ms": 1.336, "grad_time_ms": 1175.784, "update_time_ms": 5.763, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 4.999999873689376e-05, "total_loss": 0.26110100746154785, "policy_loss": -0.011015401221811771, "vf_loss": 0.2713390290737152, "vf_explained_var": 0.8967525362968445, "kl": 0.005112919956445694, "entropy": 1.7706152200698853, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10329, "done": false, "timesteps_total": 990808, "episodes_total": 2161, "training_iteration": 96, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-15-59", "timestamp": 1589879759, "time_this_iter_s": 41.52794051170349, "time_total_s": 4309.634669303894, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20456158>", "on_episode_step": "<function on_episode_step at 0x7fef200a2488>", "on_episode_end": "<function on_episode_end at 0x7fef20469268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204698c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054cea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4309.634669303894, "timesteps_since_restore": 990808, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 83.15333333333332, "ram_util_percent": 29.993333333333332}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.06751379999999997, "episode_len_mean": 468.34, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06751379999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.293221560769838, "avg_speed_min": 1.2597576996581783, "avg_speed_max": 7.468542043269175, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.514522811013986, "mean_processing_ms": 2.9195940439574577, "mean_inference_ms": 0.30696793522022126}, "off_policy_estimator": {}, "info": {"num_steps_trained": 255488, "num_steps_sampled": 1001224, "sample_time_ms": 39620.814, "load_time_ms": 1.295, "grad_time_ms": 1155.856, "update_time_ms": 5.843, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4305975437164307, "policy_loss": -0.007342164870351553, "vf_loss": 1.435690999031067, "vf_explained_var": 0.7227364778518677, "kl": 0.014788493514060974, "entropy": 1.6580123901367188, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10416, "done": false, "timesteps_total": 1001224, "episodes_total": 2184, "training_iteration": 97, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-16-38", "timestamp": 1589879798, "time_this_iter_s": 39.24695301055908, "time_total_s": 4348.881622314453, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20441378>", "on_episode_step": "<function on_episode_step at 0x7fef20441840>", "on_episode_end": "<function on_episode_end at 0x7fef20441a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20318400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4348.881622314453, "timesteps_since_restore": 1001224, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 83.23749999999998, "ram_util_percent": 30.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.16751609999999995, "episode_len_mean": 468.17, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16751609999999995}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.336714052501191, "avg_speed_min": 1.2597576996581783, "avg_speed_max": 7.468542043269175, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.492379599746208, "mean_processing_ms": 2.9186406458636003, "mean_inference_ms": 0.30628718421281725}, "off_policy_estimator": {}, "info": {"num_steps_trained": 257792, "num_steps_sampled": 1011441, "sample_time_ms": 39613.423, "load_time_ms": 1.301, "grad_time_ms": 1177.327, "update_time_ms": 5.781, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 4.999999873689376e-05, "total_loss": 0.2954027056694031, "policy_loss": -0.006568984594196081, "vf_loss": 0.30122196674346924, "vf_explained_var": 0.9241477251052856, "kl": 0.00493084080517292, "entropy": 1.8154144287109375, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10217, "done": false, "timesteps_total": 1011441, "episodes_total": 2204, "training_iteration": 98, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-17-20", "timestamp": 1589879840, "time_this_iter_s": 41.75955033302307, "time_total_s": 4390.641172647476, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2009a400>", "on_episode_step": "<function on_episode_step at 0x7fef2009abf8>", "on_episode_end": "<function on_episode_end at 0x7fef2009ac80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2009ad08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2009aae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4390.641172647476, "timesteps_since_restore": 1011441, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 83.40499999999999, "ram_util_percent": 29.996666666666666}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.17001589999999997, "episode_len_mean": 468.58, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17001589999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.379034939825665, "avg_speed_min": 1.2597576996581783, "avg_speed_max": 7.468542043269175, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.460739351617235, "mean_processing_ms": 2.917906409240704, "mean_inference_ms": 0.30523619794718515}, "off_policy_estimator": {}, "info": {"num_steps_trained": 259456, "num_steps_sampled": 1021981, "sample_time_ms": 39564.583, "load_time_ms": 1.283, "grad_time_ms": 1151.081, "update_time_ms": 5.688, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 4.999999873689376e-05, "total_loss": 1.3232190608978271, "policy_loss": -0.006974607240408659, "vf_loss": 1.3293863534927368, "vf_explained_var": 0.8398532867431641, "kl": 0.010616768151521683, "entropy": 1.7002182006835938, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10540, "done": false, "timesteps_total": 1021981, "episodes_total": 2227, "training_iteration": 99, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-17-59", "timestamp": 1589879879, "time_this_iter_s": 39.00693488121033, "time_total_s": 4429.6481075286865, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2009ad90>", "on_episode_step": "<function on_episode_step at 0x7fef20244f28>", "on_episode_end": "<function on_episode_end at 0x7fef20244378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200a2488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2026c1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4429.6481075286865, "timesteps_since_restore": 1021981, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 84.60545454545456, "ram_util_percent": 29.994545454545456}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.17001479999999997, "episode_len_mean": 468.9, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17001479999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.245412995797563, "avg_speed_min": 1.2597576996581783, "avg_speed_max": 7.210559635396709, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.447118702549172, "mean_processing_ms": 2.9167733917954966, "mean_inference_ms": 0.30474053812732416}, "off_policy_estimator": {}, "info": {"num_steps_trained": 262016, "num_steps_sampled": 1032161, "sample_time_ms": 39592.98, "load_time_ms": 1.298, "grad_time_ms": 1208.424, "update_time_ms": 5.724, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 4.999999873689376e-05, "total_loss": 0.34550002217292786, "policy_loss": -0.011079510673880577, "vf_loss": 0.3550044894218445, "vf_explained_var": 0.8774380683898926, "kl": 0.020718101412057877, "entropy": 1.5581380128860474, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10180, "done": false, "timesteps_total": 1032161, "episodes_total": 2247, "training_iteration": 100, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-18-42", "timestamp": 1589879922, "time_this_iter_s": 42.686962366104126, "time_total_s": 4472.335069894791, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2024a400>", "on_episode_step": "<function on_episode_step at 0x7fef2024a488>", "on_episode_end": "<function on_episode_end at 0x7fef2024a620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2024a730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187d1d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4472.335069894791, "timesteps_since_restore": 1032161, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 83.7983606557377, "ram_util_percent": 30.004918032786886}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": -0.5800117999999999, "episode_len_mean": 452.88, "episodes_this_iter": 28, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5800117999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.200199204546013, "avg_speed_min": 1.7969804504166085, "avg_speed_max": 7.186391264412314, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.440230693829395, "mean_processing_ms": 2.9163755308650114, "mean_inference_ms": 0.30437801097376044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 264064, "num_steps_sampled": 1042665, "sample_time_ms": 39528.751, "load_time_ms": 1.338, "grad_time_ms": 1226.05, "update_time_ms": 5.651, "learner": {"av": {"cur_kl_coeff": 0.11403486877679825, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0323429107666016, "policy_loss": -0.020334087312221527, "vf_loss": 1.0499796867370605, "vf_explained_var": 0.9267802834510803, "kl": 0.02365356683731079, "entropy": 1.5250117778778076, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10504, "done": false, "timesteps_total": 1042665, "episodes_total": 2275, "training_iteration": 101, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-19-23", "timestamp": 1589879963, "time_this_iter_s": 41.61888885498047, "time_total_s": 4513.953958749771, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187d1840>", "on_episode_step": "<function on_episode_step at 0x7fef20441158>", "on_episode_end": "<function on_episode_end at 0x7fef20441268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205ee950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4513.953958749771, "timesteps_since_restore": 1042665, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 80.46499999999999, "ram_util_percent": 30.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": -0.3725119, "episode_len_mean": 465.15, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3725119}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.126290858923155, "avg_speed_min": 1.7969804504166085, "avg_speed_max": 7.193532387850983, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.40533197705202, "mean_processing_ms": 2.915477465190983, "mean_inference_ms": 0.3033908465675538}, "off_policy_estimator": {}, "info": {"num_steps_trained": 266240, "num_steps_sampled": 1053157, "sample_time_ms": 39677.134, "load_time_ms": 1.342, "grad_time_ms": 1245.024, "update_time_ms": 5.662, "learner": {"av": {"cur_kl_coeff": 0.17105230689048767, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3573057949542999, "policy_loss": -0.015212378464639187, "vf_loss": 0.3700833320617676, "vf_explained_var": 0.9056839942932129, "kl": 0.01423464436084032, "entropy": 1.496516466140747, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10492, "done": false, "timesteps_total": 1053157, "episodes_total": 2296, "training_iteration": 102, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-20-06", "timestamp": 1589880006, "time_this_iter_s": 42.0240957736969, "time_total_s": 4555.978054523468, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187d1b70>", "on_episode_step": "<function on_episode_step at 0x7fef187e72f0>", "on_episode_end": "<function on_episode_end at 0x7fef187e7378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187e7400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187b71e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4555.978054523468, "timesteps_since_restore": 1053157, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 83.37166666666666, "ram_util_percent": 30.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": -0.27001109999999995, "episode_len_mean": 468.78, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27001109999999995}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.109368524331921, "avg_speed_min": 1.7969804504166085, "avg_speed_max": 7.2561794622259095, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.39669324972637, "mean_processing_ms": 2.9156693275475916, "mean_inference_ms": 0.3030878448386899}, "off_policy_estimator": {}, "info": {"num_steps_trained": 268672, "num_steps_sampled": 1063552, "sample_time_ms": 39906.497, "load_time_ms": 1.308, "grad_time_ms": 1257.229, "update_time_ms": 5.536, "learner": {"av": {"cur_kl_coeff": 0.17105230689048767, "cur_lr": 4.999999873689376e-05, "total_loss": 0.34312310814857483, "policy_loss": -0.029964396730065346, "vf_loss": 0.3685307800769806, "vf_explained_var": 0.8872165679931641, "kl": 0.026639455929398537, "entropy": 1.624393105506897, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10395, "done": false, "timesteps_total": 1063552, "episodes_total": 2316, "training_iteration": 103, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-20-48", "timestamp": 1589880048, "time_this_iter_s": 42.82202625274658, "time_total_s": 4598.800080776215, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187e7268>", "on_episode_step": "<function on_episode_step at 0x7fef2009a620>", "on_episode_end": "<function on_episode_end at 0x7fef2009a6a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2009a730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2009a9d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4598.800080776215, "timesteps_since_restore": 1063552, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 83.17704918032788, "ram_util_percent": 30.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": -0.4775096, "episode_len_mean": 452.23, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4823329292929292}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.993486134711321, "avg_speed_min": 1.7969804504166085, "avg_speed_max": 7.2561794622259095, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.397415771425894, "mean_processing_ms": 2.917406295041732, "mean_inference_ms": 0.3032016984085735}, "off_policy_estimator": {}, "info": {"num_steps_trained": 270848, "num_steps_sampled": 1073879, "sample_time_ms": 39836.402, "load_time_ms": 1.308, "grad_time_ms": 1254.55, "update_time_ms": 5.572, "learner": {"av": {"cur_kl_coeff": 0.2565784454345703, "cur_lr": 4.999999873689376e-05, "total_loss": 0.894315242767334, "policy_loss": -0.01976056583225727, "vf_loss": 0.9120385646820068, "vf_explained_var": 0.8454563021659851, "kl": 0.007939944975078106, "entropy": 1.4987518787384033, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10327, "done": false, "timesteps_total": 1073879, "episodes_total": 2340, "training_iteration": 104, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-21-28", "timestamp": 1589880088, "time_this_iter_s": 39.76867866516113, "time_total_s": 4638.568759441376, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2009a400>", "on_episode_step": "<function on_episode_step at 0x7fef200a2048>", "on_episode_end": "<function on_episode_end at 0x7fef200a2d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200a2e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef200a28c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4638.568759441376, "timesteps_since_restore": 1073879, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 80.96666666666665, "ram_util_percent": 30.00350877192982}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": -0.3750098, "episode_len_mean": 456.01, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.38266306122448984}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.151642104617697, "avg_speed_min": 1.7969804504166085, "avg_speed_max": 7.905908204437667, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.355134621377182, "mean_processing_ms": 2.9149988732797, "mean_inference_ms": 0.30217228563512877}, "off_policy_estimator": {}, "info": {"num_steps_trained": 272896, "num_steps_sampled": 1084147, "sample_time_ms": 39679.787, "load_time_ms": 1.362, "grad_time_ms": 1261.461, "update_time_ms": 5.594, "learner": {"av": {"cur_kl_coeff": 0.2565784454345703, "cur_lr": 4.999999873689376e-05, "total_loss": 0.3167777955532074, "policy_loss": -0.006001763045787811, "vf_loss": 0.32100608944892883, "vf_explained_var": 0.8897734880447388, "kl": 0.0069119734689593315, "entropy": 1.4578540325164795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10268, "done": false, "timesteps_total": 1084147, "episodes_total": 2361, "training_iteration": 105, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-22-07", "timestamp": 1589880127, "time_this_iter_s": 39.12407827377319, "time_total_s": 4677.692837715149, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187bd1e0>", "on_episode_step": "<function on_episode_step at 0x7fef187bd8c8>", "on_episode_end": "<function on_episode_end at 0x7fef187bd378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187bd598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20583268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4677.692837715149, "timesteps_since_restore": 1084147, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 81.07678571428572, "ram_util_percent": 30.017857142857142}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0, "episode_reward_mean": 0.037491199999999975, "episode_len_mean": 475.52, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.0}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03825632653061223}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.114064795485994, "avg_speed_min": 1.1358714160669194, "avg_speed_max": 8.014282893742248, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.339077467973635, "mean_processing_ms": 2.914061882225894, "mean_inference_ms": 0.3019426879084216}, "off_policy_estimator": {}, "info": {"num_steps_trained": 275328, "num_steps_sampled": 1094343, "sample_time_ms": 39822.122, "load_time_ms": 1.375, "grad_time_ms": 1305.214, "update_time_ms": 5.796, "learner": {"av": {"cur_kl_coeff": 0.2565784454345703, "cur_lr": 4.999999873689376e-05, "total_loss": 0.354030579328537, "policy_loss": -0.008928248658776283, "vf_loss": 0.36083778738975525, "vf_explained_var": 0.8858866691589355, "kl": 0.008266615681350231, "entropy": 1.393923044204712, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10196, "done": false, "timesteps_total": 1094343, "episodes_total": 2382, "training_iteration": 106, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-22-51", "timestamp": 1589880171, "time_this_iter_s": 43.3974347114563, "time_total_s": 4721.090272426605, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187bd840>", "on_episode_step": "<function on_episode_step at 0x7fef204f7d90>", "on_episode_end": "<function on_episode_end at 0x7fef20340ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203406a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204419d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4721.090272426605, "timesteps_since_restore": 1094343, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 81.19032258064516, "ram_util_percent": 30.04677419354838}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0, "episode_reward_mean": -0.07250679999999998, "episode_len_mean": 459.35, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.0}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07398653061224489}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.232567050700407, "avg_speed_min": 1.1358714160669194, "avg_speed_max": 8.014282893742248, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.29479080969389, "mean_processing_ms": 2.9130662423307916, "mean_inference_ms": 0.3009114341854132}, "off_policy_estimator": {}, "info": {"num_steps_trained": 276864, "num_steps_sampled": 1104790, "sample_time_ms": 39691.632, "load_time_ms": 1.44, "grad_time_ms": 1305.223, "update_time_ms": 5.884, "learner": {"av": {"cur_kl_coeff": 0.2565784454345703, "cur_lr": 4.999999873689376e-05, "total_loss": 0.37055501341819763, "policy_loss": -0.03892706707119942, "vf_loss": 0.40432342886924744, "vf_explained_var": 0.9459932446479797, "kl": 0.020105520263314247, "entropy": 1.5266538858413696, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10447, "done": false, "timesteps_total": 1104790, "episodes_total": 2407, "training_iteration": 107, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-23-29", "timestamp": 1589880209, "time_this_iter_s": 37.946457386016846, "time_total_s": 4759.036729812622, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2009ae18>", "on_episode_step": "<function on_episode_step at 0x7fef2009aea0>", "on_episode_end": "<function on_episode_end at 0x7fef187e7400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187e7620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20469268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4759.036729812622, "timesteps_since_restore": 1104790, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 79.0925925925926, "ram_util_percent": 30.075925925925915}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0, "episode_reward_mean": 0.024993299999999996, "episode_len_mean": 459.2, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.0}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.025503367346938807}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4637468785958, "avg_speed_min": 1.1358714160669194, "avg_speed_max": 8.014282893742248, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.26713036270241, "mean_processing_ms": 2.912565910226967, "mean_inference_ms": 0.30032037966906316}, "off_policy_estimator": {}, "info": {"num_steps_trained": 278784, "num_steps_sampled": 1114950, "sample_time_ms": 39357.303, "load_time_ms": 1.441, "grad_time_ms": 1292.92, "update_time_ms": 6.186, "learner": {"av": {"cur_kl_coeff": 0.38486766815185547, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5125951170921326, "policy_loss": -0.01453393790870905, "vf_loss": 0.5236151218414307, "vf_explained_var": 0.887982189655304, "kl": 0.009130427613854408, "entropy": 1.4217311143875122, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10160, "done": false, "timesteps_total": 1114950, "episodes_total": 2428, "training_iteration": 108, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-24-07", "timestamp": 1589880247, "time_this_iter_s": 38.29404807090759, "time_total_s": 4797.33077788353, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20244268>", "on_episode_step": "<function on_episode_step at 0x7fef186b6ae8>", "on_episode_end": "<function on_episode_end at 0x7fef186b6b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef186b6bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1871e1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4797.33077788353, "timesteps_since_restore": 1114950, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 79.98148148148148, "ram_util_percent": 30.092592592592585}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.07500630000000003, "episode_len_mean": 460.17, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07500630000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.370866492985423, "avg_speed_min": 1.1358714160669194, "avg_speed_max": 8.147761114606878, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.256068979661922, "mean_processing_ms": 2.911059558780366, "mean_inference_ms": 0.3001441529176519}, "off_policy_estimator": {}, "info": {"num_steps_trained": 280704, "num_steps_sampled": 1125351, "sample_time_ms": 39438.573, "load_time_ms": 1.463, "grad_time_ms": 1313.522, "update_time_ms": 6.357, "learner": {"av": {"cur_kl_coeff": 0.38486766815185547, "cur_lr": 4.999999873689376e-05, "total_loss": 0.811976432800293, "policy_loss": -0.014425572007894516, "vf_loss": 0.8227123618125916, "vf_explained_var": 0.9025324583053589, "kl": 0.009586763568222523, "entropy": 1.4215798377990723, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10401, "done": false, "timesteps_total": 1125351, "episodes_total": 2452, "training_iteration": 109, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-24-47", "timestamp": 1589880287, "time_this_iter_s": 40.02886462211609, "time_total_s": 4837.359642505646, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1871e268>", "on_episode_step": "<function on_episode_step at 0x7fef204419d8>", "on_episode_end": "<function on_episode_end at 0x7fef20441840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20441950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054cea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4837.359642505646, "timesteps_since_restore": 1125351, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 79.61379310344827, "ram_util_percent": 30.093103448275855}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.4825068999999999, "episode_len_mean": 447.43, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4825068999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.506898238603861, "avg_speed_min": 1.4089181837552613, "avg_speed_max": 8.147761114606878, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.24814173234363, "mean_processing_ms": 2.911472353145897, "mean_inference_ms": 0.3000955103040479}, "off_policy_estimator": {}, "info": {"num_steps_trained": 282880, "num_steps_sampled": 1135646, "sample_time_ms": 39311.428, "load_time_ms": 1.441, "grad_time_ms": 1283.078, "update_time_ms": 6.305, "learner": {"av": {"cur_kl_coeff": 0.38486766815185547, "cur_lr": 4.999999873689376e-05, "total_loss": 0.855894148349762, "policy_loss": -0.009807955473661423, "vf_loss": 0.8643178343772888, "vf_explained_var": 0.9351394772529602, "kl": 0.003596862778067589, "entropy": 1.448483943939209, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10295, "done": false, "timesteps_total": 1135646, "episodes_total": 2475, "training_iteration": 110, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-25-29", "timestamp": 1589880329, "time_this_iter_s": 41.11159944534302, "time_total_s": 4878.471241950989, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187e7378>", "on_episode_step": "<function on_episode_step at 0x7fef187e7b70>", "on_episode_end": "<function on_episode_end at 0x7fef187e78c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20583378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef200a2268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4878.471241950989, "timesteps_since_restore": 1135646, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 83.57413793103447, "ram_util_percent": 30.098275862068963}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.48000640000000006, "episode_len_mean": 451.22, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.48000640000000006}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.571950253057184, "avg_speed_min": 1.7617661668145919, "avg_speed_max": 8.147761114606878, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.21768115410326, "mean_processing_ms": 2.910341106566483, "mean_inference_ms": 0.29942020239036327}, "off_policy_estimator": {}, "info": {"num_steps_trained": 285184, "num_steps_sampled": 1145823, "sample_time_ms": 39246.492, "load_time_ms": 1.439, "grad_time_ms": 1307.409, "update_time_ms": 6.415, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5803602337837219, "policy_loss": -0.022214479744434357, "vf_loss": 0.5997934937477112, "vf_explained_var": 0.8894800543785095, "kl": 0.014452755451202393, "entropy": 1.4881376028060913, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10177, "done": false, "timesteps_total": 1145823, "episodes_total": 2497, "training_iteration": 111, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-26-10", "timestamp": 1589880370, "time_this_iter_s": 41.210731506347656, "time_total_s": 4919.681973457336, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185c18c8>", "on_episode_step": "<function on_episode_step at 0x7fef186b6488>", "on_episode_end": "<function on_episode_end at 0x7fef186b6620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef186b6510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2024a6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4919.681973457336, "timesteps_since_restore": 1145823, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 79.4, "ram_util_percent": 30.099999999999994}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.5800067999999999, "episode_len_mean": 452.43, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5800067999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3147926409923665, "avg_speed_min": 1.3172085873994175, "avg_speed_max": 8.147761114606878, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.198850217101594, "mean_processing_ms": 2.9112685278698347, "mean_inference_ms": 0.2991157543213484}, "off_policy_estimator": {}, "info": {"num_steps_trained": 287232, "num_steps_sampled": 1156000, "sample_time_ms": 38991.827, "load_time_ms": 1.471, "grad_time_ms": 1290.821, "update_time_ms": 6.438, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6779043674468994, "policy_loss": -0.008187578991055489, "vf_loss": 0.684298038482666, "vf_explained_var": 0.8978005647659302, "kl": 0.009322462603449821, "entropy": 1.5020644664764404, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10177, "done": false, "timesteps_total": 1156000, "episodes_total": 2519, "training_iteration": 112, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-26-49", "timestamp": 1589880409, "time_this_iter_s": 39.31208086013794, "time_total_s": 4958.994054317474, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f72f0>", "on_episode_step": "<function on_episode_step at 0x7fef185b4268>", "on_episode_end": "<function on_episode_end at 0x7fef185b42f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef185b4378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185b49d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 4958.994054317474, "timesteps_since_restore": 1156000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 80.14464285714287, "ram_util_percent": 30.098214285714285}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.8875061999999998, "episode_len_mean": 440.54, "episodes_this_iter": 26, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8964709090909089}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.25186793154125, "avg_speed_min": 1.3172085873994175, "avg_speed_max": 8.32193273836195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.198359820995833, "mean_processing_ms": 2.912195930632238, "mean_inference_ms": 0.2993893680958479}, "off_policy_estimator": {}, "info": {"num_steps_trained": 289152, "num_steps_sampled": 1166546, "sample_time_ms": 38899.664, "load_time_ms": 1.485, "grad_time_ms": 1268.437, "update_time_ms": 6.421, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 2.0375194549560547, "policy_loss": -0.009634299203753471, "vf_loss": 2.045322895050049, "vf_explained_var": 0.8562865853309631, "kl": 0.009514275006949902, "entropy": 1.4782720804214478, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10546, "done": false, "timesteps_total": 1166546, "episodes_total": 2545, "training_iteration": 113, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-27-31", "timestamp": 1589880451, "time_this_iter_s": 41.67517590522766, "time_total_s": 5000.669230222702, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20340b70>", "on_episode_step": "<function on_episode_step at 0x7fef1858f730>", "on_episode_end": "<function on_episode_end at 0x7fef1858f7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1858f598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1858fd90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5000.669230222702, "timesteps_since_restore": 1166546, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 79.67, "ram_util_percent": 30.09999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.8875059000000001, "episode_len_mean": 440.13, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8964706060606061}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.508073424086781, "avg_speed_min": 1.3172085873994175, "avg_speed_max": 8.32193273836195, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.141810600398195, "mean_processing_ms": 2.9127731148067655, "mean_inference_ms": 0.29812725076518976}, "off_policy_estimator": {}, "info": {"num_steps_trained": 290816, "num_steps_sampled": 1177065, "sample_time_ms": 38852.382, "load_time_ms": 1.437, "grad_time_ms": 1231.225, "update_time_ms": 6.647, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.591778039932251, "policy_loss": -0.019083919003605843, "vf_loss": 0.6092084646224976, "vf_explained_var": 0.9417225122451782, "kl": 0.008592586033046246, "entropy": 1.5347862243652344, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10519, "done": false, "timesteps_total": 1177065, "episodes_total": 2570, "training_iteration": 114, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-28-10", "timestamp": 1589880490, "time_this_iter_s": 38.92427635192871, "time_total_s": 5039.593506574631, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef200a2598>", "on_episode_step": "<function on_episode_step at 0x7fef2009a598>", "on_episode_end": "<function on_episode_end at 0x7fef2009aa60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2009a510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187d18c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5039.593506574631, "timesteps_since_restore": 1177065, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 82.98727272727275, "ram_util_percent": 30.099999999999987}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.9900068999999999, "episode_len_mean": 435.54, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -1.0000069696969698}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.682917901732095, "avg_speed_min": 1.3172085873994175, "avg_speed_max": 8.628290244088792, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.10908040448161, "mean_processing_ms": 2.914458521020725, "mean_inference_ms": 0.29734166526799066}, "off_policy_estimator": {}, "info": {"num_steps_trained": 292736, "num_steps_sampled": 1187708, "sample_time_ms": 38870.161, "load_time_ms": 1.393, "grad_time_ms": 1219.916, "update_time_ms": 6.836, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5615289807319641, "policy_loss": -0.01717679388821125, "vf_loss": 0.5770086646080017, "vf_explained_var": 0.9319007396697998, "kl": 0.008818849921226501, "entropy": 1.524027705192566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10643, "done": false, "timesteps_total": 1187708, "episodes_total": 2595, "training_iteration": 115, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-28-49", "timestamp": 1589880529, "time_this_iter_s": 39.18791580200195, "time_total_s": 5078.781422376633, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185d58c8>", "on_episode_step": "<function on_episode_step at 0x7fef185d5730>", "on_episode_end": "<function on_episode_end at 0x7fef185d5488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef185d50d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203406a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5078.781422376633, "timesteps_since_restore": 1187708, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 81.36071428571428, "ram_util_percent": 30.105357142857144}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.9875074, "episode_len_mean": 438.93, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.997482222222222}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.811045312071386, "avg_speed_min": 2.210124505599386, "avg_speed_max": 8.628290244088792, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.109376298573665, "mean_processing_ms": 2.915958573595311, "mean_inference_ms": 0.2973284328810037}, "off_policy_estimator": {}, "info": {"num_steps_trained": 294784, "num_steps_sampled": 1197894, "sample_time_ms": 38620.825, "load_time_ms": 1.39, "grad_time_ms": 1188.181, "update_time_ms": 6.679, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8444112539291382, "policy_loss": -0.023383408784866333, "vf_loss": 0.8662551641464233, "vf_explained_var": 0.8490379452705383, "kl": 0.008000113070011139, "entropy": 1.462477684020996, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10186, "done": false, "timesteps_total": 1197894, "episodes_total": 2615, "training_iteration": 116, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-29-30", "timestamp": 1589880570, "time_this_iter_s": 40.578041791915894, "time_total_s": 5119.359464168549, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186b6378>", "on_episode_step": "<function on_episode_step at 0x7fef18526d08>", "on_episode_end": "<function on_episode_end at 0x7fef18526d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18526e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187bd2f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5119.359464168549, "timesteps_since_restore": 1197894, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 82.39137931034485, "ram_util_percent": 30.1051724137931}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.9925066, "episode_len_mean": 430.52, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -1.002531919191919}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.776232486200792, "avg_speed_min": 1.5365255433723939, "avg_speed_max": 8.628290244088792, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.089612798765135, "mean_processing_ms": 2.9172620412589163, "mean_inference_ms": 0.2967865428756975}, "off_policy_estimator": {}, "info": {"num_steps_trained": 296832, "num_steps_sampled": 1208163, "sample_time_ms": 38819.215, "load_time_ms": 1.36, "grad_time_ms": 1208.099, "update_time_ms": 6.509, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6687750816345215, "policy_loss": -0.020247437059879303, "vf_loss": 1.686380386352539, "vf_explained_var": 0.8327049016952515, "kl": 0.013728965073823929, "entropy": 1.4390506744384766, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10269, "done": false, "timesteps_total": 1208163, "episodes_total": 2640, "training_iteration": 117, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-30-10", "timestamp": 1589880610, "time_this_iter_s": 40.123589515686035, "time_total_s": 5159.483053684235, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185a9048>", "on_episode_step": "<function on_episode_step at 0x7fef187d1c80>", "on_episode_end": "<function on_episode_end at 0x7fef187d1e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187d1ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185618c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5159.483053684235, "timesteps_since_restore": 1208163, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 81.21896551724137, "ram_util_percent": 30.134482758620685}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.6850065000000001, "episode_len_mean": 441.99, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6850065000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.661543471355146, "avg_speed_min": 1.5365255433723939, "avg_speed_max": 8.628290244088792, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.06581781574646, "mean_processing_ms": 2.917086921082166, "mean_inference_ms": 0.2961528884618876}, "off_policy_estimator": {}, "info": {"num_steps_trained": 299008, "num_steps_sampled": 1218432, "sample_time_ms": 39010.751, "load_time_ms": 1.408, "grad_time_ms": 1227.635, "update_time_ms": 6.416, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.611273467540741, "policy_loss": -0.011938873678445816, "vf_loss": 0.6214158535003662, "vf_explained_var": 0.8941675424575806, "kl": 0.009335832670331001, "entropy": 1.4885108470916748, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10269, "done": false, "timesteps_total": 1218432, "episodes_total": 2662, "training_iteration": 118, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-30-51", "timestamp": 1589880651, "time_this_iter_s": 40.40687298774719, "time_total_s": 5199.889926671982, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185a92f0>", "on_episode_step": "<function on_episode_step at 0x7fef201a57b8>", "on_episode_end": "<function on_episode_end at 0x7fef201a5840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a5950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201da1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5199.889926671982, "timesteps_since_restore": 1218432, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 80.72280701754386, "ram_util_percent": 30.168421052631572}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.6825064000000002, "episode_len_mean": 445.9, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6894004040404043}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.790931276066708, "avg_speed_min": 1.5365255433723939, "avg_speed_max": 8.60858445414151, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.04986728801984, "mean_processing_ms": 2.916641404564749, "mean_inference_ms": 0.2958576775811772}, "off_policy_estimator": {}, "info": {"num_steps_trained": 300288, "num_steps_sampled": 1228908, "sample_time_ms": 38532.401, "load_time_ms": 1.383, "grad_time_ms": 1190.784, "update_time_ms": 6.58, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7724669575691223, "policy_loss": -0.02101913094520569, "vf_loss": 0.7901719808578491, "vf_explained_var": 0.9134648442268372, "kl": 0.01722225360572338, "entropy": 1.505380392074585, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10476, "done": false, "timesteps_total": 1228908, "episodes_total": 2687, "training_iteration": 119, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-31-26", "timestamp": 1589880686, "time_this_iter_s": 34.87792229652405, "time_total_s": 5234.767848968506, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1871eb70>", "on_episode_step": "<function on_episode_step at 0x7fef1871ef28>", "on_episode_end": "<function on_episode_end at 0x7fef1871eea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a52f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201a5400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5234.767848968506, "timesteps_since_restore": 1228908, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 82.57600000000001, "ram_util_percent": 30.176}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.5825066, "episode_len_mean": 446.06, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.588390505050505}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.708276146323668, "avg_speed_min": 1.5365255433723939, "avg_speed_max": 8.461584587591425, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 24.000241032961757, "mean_processing_ms": 2.9158301034899794, "mean_inference_ms": 0.2946526374887151}, "off_policy_estimator": {}, "info": {"num_steps_trained": 302464, "num_steps_sampled": 1239490, "sample_time_ms": 38809.046, "load_time_ms": 1.422, "grad_time_ms": 1179.911, "update_time_ms": 7.12, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.581849217414856, "policy_loss": -0.009810589253902435, "vf_loss": 1.5903959274291992, "vf_explained_var": 0.7619701623916626, "kl": 0.006568170618265867, "entropy": 1.4961168766021729, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10582, "done": false, "timesteps_total": 1239490, "episodes_total": 2710, "training_iteration": 120, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-32-09", "timestamp": 1589880729, "time_this_iter_s": 43.774813413619995, "time_total_s": 5278.542662382126, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201cebf8>", "on_episode_step": "<function on_episode_step at 0x7fef1871ed08>", "on_episode_end": "<function on_episode_end at 0x7fef1871e0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1871e158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187b7730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5278.542662382126, "timesteps_since_restore": 1239490, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 81.49365079365079, "ram_util_percent": 30.18888888888889}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.3800068, "episode_len_mean": 450.39, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.38384525252525253}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5819827033048055, "avg_speed_min": 1.2723460186560656, "avg_speed_max": 8.461584587591425, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.978018317826763, "mean_processing_ms": 2.913981123317821, "mean_inference_ms": 0.294164885134936}, "off_policy_estimator": {}, "info": {"num_steps_trained": 304768, "num_steps_sampled": 1250050, "sample_time_ms": 38975.284, "load_time_ms": 1.389, "grad_time_ms": 1144.866, "update_time_ms": 6.982, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6252733469009399, "policy_loss": -0.008949258364737034, "vf_loss": 0.6329480409622192, "vf_explained_var": 0.8477384448051453, "kl": 0.006623490713536739, "entropy": 1.4595482349395752, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10560, "done": false, "timesteps_total": 1250050, "episodes_total": 2732, "training_iteration": 121, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-32-52", "timestamp": 1589880772, "time_this_iter_s": 42.520379304885864, "time_total_s": 5321.063041687012, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203e62f0>", "on_episode_step": "<function on_episode_step at 0x7fef203e68c8>", "on_episode_end": "<function on_episode_end at 0x7fef203e6378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203e6048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203e6bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5321.063041687012, "timesteps_since_restore": 1250050, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 83.33333333333331, "ram_util_percent": 30.2}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.2725069, "episode_len_mean": 463.42, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2752594949494949}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.702820650879521, "avg_speed_min": 1.2723460186560656, "avg_speed_max": 8.461584587591425, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.95161175181685, "mean_processing_ms": 2.9149122432796926, "mean_inference_ms": 0.2934233293534274}, "off_policy_estimator": {}, "info": {"num_steps_trained": 306816, "num_steps_sampled": 1260681, "sample_time_ms": 39022.86, "load_time_ms": 1.389, "grad_time_ms": 1149.122, "update_time_ms": 6.993, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.1528191566467285, "policy_loss": -0.016560371965169907, "vf_loss": 1.1655769348144531, "vf_explained_var": 0.8450409173965454, "kl": 0.01976141892373562, "entropy": 1.5307083129882812, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10631, "done": false, "timesteps_total": 1260681, "episodes_total": 2754, "training_iteration": 122, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-33-32", "timestamp": 1589880812, "time_this_iter_s": 39.82918858528137, "time_total_s": 5360.892230272293, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203e6510>", "on_episode_step": "<function on_episode_step at 0x7fef203e6f28>", "on_episode_end": "<function on_episode_end at 0x7fef187b7840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187b7158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187b7268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5360.892230272293, "timesteps_since_restore": 1260681, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 79.92280701754386, "ram_util_percent": 30.2}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.2700065, "episode_len_mean": 467.85, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27273383838383836}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.712361443848706, "avg_speed_min": 1.2723460186560656, "avg_speed_max": 8.134849889983482, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.9109906992372, "mean_processing_ms": 2.912230042882757, "mean_inference_ms": 0.2924163234052242}, "off_policy_estimator": {}, "info": {"num_steps_trained": 308608, "num_steps_sampled": 1271124, "sample_time_ms": 38700.625, "load_time_ms": 1.374, "grad_time_ms": 1122.943, "update_time_ms": 7.018, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5287507176399231, "policy_loss": -0.01772075705230236, "vf_loss": 0.5439120531082153, "vf_explained_var": 0.8911561369895935, "kl": 0.01330006867647171, "entropy": 1.5065468549728394, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10443, "done": false, "timesteps_total": 1271124, "episodes_total": 2775, "training_iteration": 123, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-34-10", "timestamp": 1589880850, "time_this_iter_s": 38.1883909702301, "time_total_s": 5399.080621242523, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203e60d0>", "on_episode_step": "<function on_episode_step at 0x7fef20417950>", "on_episode_end": "<function on_episode_end at 0x7fef20417b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20417c80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20417400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5399.080621242523, "timesteps_since_restore": 1271124, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 80.92363636363635, "ram_util_percent": 30.201818181818183}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.16750739999999997, "episode_len_mean": 471.34, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1691993939393939}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4951869493533385, "avg_speed_min": 1.2723460186560656, "avg_speed_max": 8.162131567362293, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.888086618271974, "mean_processing_ms": 2.9127219302113296, "mean_inference_ms": 0.29182326801032116}, "off_policy_estimator": {}, "info": {"num_steps_trained": 311040, "num_steps_sampled": 1281452, "sample_time_ms": 39160.974, "load_time_ms": 1.401, "grad_time_ms": 1142.147, "update_time_ms": 6.651, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.189771294593811, "policy_loss": -0.005033882800489664, "vf_loss": 1.1936603784561157, "vf_explained_var": 0.8044663667678833, "kl": 0.0059495959430933, "entropy": 1.465213418006897, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10328, "done": false, "timesteps_total": 1281452, "episodes_total": 2797, "training_iteration": 124, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-34-54", "timestamp": 1589880894, "time_this_iter_s": 43.71480703353882, "time_total_s": 5442.795428276062, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201cea60>", "on_episode_step": "<function on_episode_step at 0x7fef201a57b8>", "on_episode_end": "<function on_episode_end at 0x7fef201a5bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a59d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201a58c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5442.795428276062, "timesteps_since_restore": 1281452, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 82.85967741935484, "ram_util_percent": 30.200000000000003}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.06500719999999995, "episode_len_mean": 475.44, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06566383838383834}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.454041948351188, "avg_speed_min": 1.4140229572580132, "avg_speed_max": 8.162131567362293, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.86848387611415, "mean_processing_ms": 2.9128121230283437, "mean_inference_ms": 0.2912176635162055}, "off_policy_estimator": {}, "info": {"num_steps_trained": 313088, "num_steps_sampled": 1291794, "sample_time_ms": 39482.883, "load_time_ms": 1.386, "grad_time_ms": 1130.239, "update_time_ms": 6.465, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.266366720199585, "policy_loss": -0.014042634516954422, "vf_loss": 1.2778310775756836, "vf_explained_var": 0.8200817108154297, "kl": 0.013398176059126854, "entropy": 1.4864321947097778, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10342, "done": false, "timesteps_total": 1291794, "episodes_total": 2819, "training_iteration": 125, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-35-36", "timestamp": 1589880936, "time_this_iter_s": 42.283021688461304, "time_total_s": 5485.078449964523, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583158>", "on_episode_step": "<function on_episode_step at 0x7fef205ee950>", "on_episode_end": "<function on_episode_end at 0x7fef201a5158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a5730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1871e510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5485.078449964523, "timesteps_since_restore": 1291794, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 85.27540983606558, "ram_util_percent": 30.2}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.17000569999999993, "episode_len_mean": 467.51, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17172292929292926}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.453035901221801, "avg_speed_min": 1.4140229572580132, "avg_speed_max": 8.162131567362293, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.85121454723134, "mean_processing_ms": 2.9104133359805133, "mean_inference_ms": 0.2907634625185808}, "off_policy_estimator": {}, "info": {"num_steps_trained": 315264, "num_steps_sampled": 1302233, "sample_time_ms": 39556.778, "load_time_ms": 1.377, "grad_time_ms": 1126.81, "update_time_ms": 6.3, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0182523727416992, "policy_loss": -0.010829512029886246, "vf_loss": 1.0270953178405762, "vf_explained_var": 0.8788737058639526, "kl": 0.010323558002710342, "entropy": 1.4914469718933105, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10439, "done": false, "timesteps_total": 1302233, "episodes_total": 2843, "training_iteration": 126, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-36-18", "timestamp": 1589880978, "time_this_iter_s": 41.280216693878174, "time_total_s": 5526.3586666584015, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1871ee18>", "on_episode_step": "<function on_episode_step at 0x7fef204ff048>", "on_episode_end": "<function on_episode_end at 0x7fef204ffbf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20456ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204566a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5526.3586666584015, "timesteps_since_restore": 1302233, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 81.85254237288136, "ram_util_percent": 30.2}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.2725062999999999, "episode_len_mean": 463.41, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27525888888888883}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.307945217937456, "avg_speed_min": 1.4140229572580132, "avg_speed_max": 8.162131567362293, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.846492484604486, "mean_processing_ms": 2.9109039955121063, "mean_inference_ms": 0.29053044634441805}, "off_policy_estimator": {}, "info": {"num_steps_trained": 317568, "num_steps_sampled": 1312461, "sample_time_ms": 39636.169, "load_time_ms": 1.367, "grad_time_ms": 1118.886, "update_time_ms": 6.148, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0217814445495605, "policy_loss": -0.0020488472655415535, "vf_loss": 1.0226831436157227, "vf_explained_var": 0.8266189098358154, "kl": 0.005960898939520121, "entropy": 1.3285049200057983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10228, "done": false, "timesteps_total": 1312461, "episodes_total": 2865, "training_iteration": 127, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-36-59", "timestamp": 1589881019, "time_this_iter_s": 40.835911989212036, "time_total_s": 5567.1945786476135, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20583c80>", "on_episode_step": "<function on_episode_step at 0x7fef205832f0>", "on_episode_end": "<function on_episode_end at 0x7fef205ee488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef224002f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20417950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5567.1945786476135, "timesteps_since_restore": 1312461, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 80.90344827586206, "ram_util_percent": 30.2}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.37500659999999997, "episode_len_mean": 459.36, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3826597959183673}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.391762177533146, "avg_speed_min": 1.4140229572580132, "avg_speed_max": 8.162131567362293, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.843106869200057, "mean_processing_ms": 2.909798124163272, "mean_inference_ms": 0.29039765610159207}, "off_policy_estimator": {}, "info": {"num_steps_trained": 319360, "num_steps_sampled": 1322807, "sample_time_ms": 39491.656, "load_time_ms": 1.306, "grad_time_ms": 1074.259, "update_time_ms": 6.036, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7261018753051758, "policy_loss": -0.00698442617431283, "vf_loss": 0.7314954996109009, "vf_explained_var": 0.9034637808799744, "kl": 0.00826727133244276, "entropy": 1.3696610927581787, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10346, "done": false, "timesteps_total": 1322807, "episodes_total": 2887, "training_iteration": 128, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-37-37", "timestamp": 1589881057, "time_this_iter_s": 38.51127076148987, "time_total_s": 5605.705849409103, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204419d8>", "on_episode_step": "<function on_episode_step at 0x7fef201a58c8>", "on_episode_end": "<function on_episode_end at 0x7fef201a59d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a5bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201a56a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5605.705849409103, "timesteps_since_restore": 1322807, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 82.28727272727274, "ram_util_percent": 30.200000000000003}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.2725061, "episode_len_mean": 462.81, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27806744897959185}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.545858481432628, "avg_speed_min": 1.8257617842178833, "avg_speed_max": 7.911835957422391, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.835583792212944, "mean_processing_ms": 2.90958176014988, "mean_inference_ms": 0.2902294260578625}, "off_policy_estimator": {}, "info": {"num_steps_trained": 320640, "num_steps_sampled": 1333005, "sample_time_ms": 39361.608, "load_time_ms": 1.314, "grad_time_ms": 1076.948, "update_time_ms": 5.802, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6019083261489868, "policy_loss": -0.018036464229226112, "vf_loss": 0.6180391907691956, "vf_explained_var": 0.8626812696456909, "kl": 0.009902817197144032, "entropy": 1.407024621963501, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10198, "done": false, "timesteps_total": 1333005, "episodes_total": 2908, "training_iteration": 129, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-38-11", "timestamp": 1589881091, "time_this_iter_s": 33.60359501838684, "time_total_s": 5639.30944442749, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201cea60>", "on_episode_step": "<function on_episode_step at 0x7fef20340268>", "on_episode_end": "<function on_episode_end at 0x7fef20340598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20340620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203e68c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5639.30944442749, "timesteps_since_restore": 1333005, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 79.16041666666666, "ram_util_percent": 30.2}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": 0.03499399999999999, "episode_len_mean": 474.5, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.035708163265306125}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.663605167503435, "avg_speed_min": 1.8503381238489565, "avg_speed_max": 7.911835957422391, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.817556469918937, "mean_processing_ms": 2.9099637466696158, "mean_inference_ms": 0.2897672842513901}, "off_policy_estimator": {}, "info": {"num_steps_trained": 322560, "num_steps_sampled": 1343368, "sample_time_ms": 39014.165, "load_time_ms": 1.314, "grad_time_ms": 1052.446, "update_time_ms": 5.524, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6231613755226135, "policy_loss": -0.0017641462618485093, "vf_loss": 0.6234735250473022, "vf_explained_var": 0.8847802877426147, "kl": 0.007545242086052895, "entropy": 1.3106526136398315, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10363, "done": false, "timesteps_total": 1343368, "episodes_total": 2930, "training_iteration": 130, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-38-51", "timestamp": 1589881131, "time_this_iter_s": 40.051180839538574, "time_total_s": 5679.360625267029, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203400d0>", "on_episode_step": "<function on_episode_step at 0x7fef20340488>", "on_episode_end": "<function on_episode_end at 0x7fef203402f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20340048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20441d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5679.360625267029, "timesteps_since_restore": 1343368, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 82.63333333333333, "ram_util_percent": 30.2}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": 0.0374932, "episode_len_mean": 478.96, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.037871919191919186}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.650641096080908, "avg_speed_min": 1.8503381238489565, "avg_speed_max": 7.911835957422391, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.787833978756684, "mean_processing_ms": 2.907777819543432, "mean_inference_ms": 0.2891362766268821}, "off_policy_estimator": {}, "info": {"num_steps_trained": 324608, "num_steps_sampled": 1353768, "sample_time_ms": 38685.313, "load_time_ms": 1.35, "grad_time_ms": 1070.0, "update_time_ms": 5.518, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7768287658691406, "policy_loss": -0.009595178067684174, "vf_loss": 0.7840232849121094, "vf_explained_var": 0.8624928593635559, "kl": 0.01247512549161911, "entropy": 1.3397526741027832, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10400, "done": false, "timesteps_total": 1353768, "episodes_total": 2951, "training_iteration": 131, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-39-30", "timestamp": 1589881170, "time_this_iter_s": 39.40997552871704, "time_total_s": 5718.770600795746, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203a4378>", "on_episode_step": "<function on_episode_step at 0x7fef187b7950>", "on_episode_end": "<function on_episode_end at 0x7fef187b77b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187b7b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203a4840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5718.770600795746, "timesteps_since_restore": 1353768, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 79.09642857142856, "ram_util_percent": 30.23035714285714}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": 0.1374937, "episode_len_mean": 478.52, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.14029969387755103}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.827204224698393, "avg_speed_min": 1.8503381238489565, "avg_speed_max": 7.911835957422391, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.75894991932538, "mean_processing_ms": 2.9056201252797216, "mean_inference_ms": 0.288564745152373}, "off_policy_estimator": {}, "info": {"num_steps_trained": 326272, "num_steps_sampled": 1364063, "sample_time_ms": 38331.072, "load_time_ms": 1.301, "grad_time_ms": 1040.198, "update_time_ms": 5.48, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5518666505813599, "policy_loss": -0.01711960695683956, "vf_loss": 0.5664954781532288, "vf_explained_var": 0.9038181900978088, "kl": 0.012943556532263756, "entropy": 1.3597615957260132, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10295, "done": false, "timesteps_total": 1364063, "episodes_total": 2973, "training_iteration": 132, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-40-06", "timestamp": 1589881206, "time_this_iter_s": 35.98814249038696, "time_total_s": 5754.758743286133, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20417950>", "on_episode_step": "<function on_episode_step at 0x7fef22400ea0>", "on_episode_end": "<function on_episode_end at 0x7fef22400f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203a46a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203a4400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5754.758743286133, "timesteps_since_restore": 1364063, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 79.12115384615383, "ram_util_percent": 30.240384615384617}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0, "episode_reward_mean": 0.032492300000000036, "episode_len_mean": 470.04, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.0}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.033497216494845376}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.812957927006345, "avg_speed_min": 1.8503381238489565, "avg_speed_max": 7.652197020315809, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.730545601181475, "mean_processing_ms": 2.904969788488426, "mean_inference_ms": 0.28790540561535155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 327936, "num_steps_sampled": 1374612, "sample_time_ms": 38343.958, "load_time_ms": 1.325, "grad_time_ms": 1043.328, "update_time_ms": 5.437, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.49279072880744934, "policy_loss": -0.020677166059613228, "vf_loss": 0.5113134980201721, "vf_explained_var": 0.9409877061843872, "kl": 0.01119548175483942, "entropy": 1.3749117851257324, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10549, "done": false, "timesteps_total": 1374612, "episodes_total": 2997, "training_iteration": 133, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-40-45", "timestamp": 1589881245, "time_this_iter_s": 38.348132610321045, "time_total_s": 5793.106875896454, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201daf28>", "on_episode_step": "<function on_episode_step at 0x7fef1871e840>", "on_episode_end": "<function on_episode_end at 0x7fef1871e048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1871e2f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201dae18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5793.106875896454, "timesteps_since_restore": 1374612, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 81.86111111111113, "ram_util_percent": 30.27407407407407}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0, "episode_reward_mean": 0.032491599999999995, "episode_len_mean": 469.97, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.0}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.033496494845360825}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.8911838995269195, "avg_speed_min": 1.8503381238489565, "avg_speed_max": 7.652197020315809, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.698590378071202, "mean_processing_ms": 2.905744220133962, "mean_inference_ms": 0.2871136946816614}, "off_policy_estimator": {}, "info": {"num_steps_trained": 329600, "num_steps_sampled": 1384871, "sample_time_ms": 37573.523, "load_time_ms": 1.36, "grad_time_ms": 1016.879, "update_time_ms": 5.544, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6101338863372803, "policy_loss": -0.011821984313428402, "vf_loss": 0.6198101043701172, "vf_explained_var": 0.8895241022109985, "kl": 0.011150805279612541, "entropy": 1.3773131370544434, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10259, "done": false, "timesteps_total": 1384871, "episodes_total": 3018, "training_iteration": 134, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-41-21", "timestamp": 1589881281, "time_this_iter_s": 35.74879217147827, "time_total_s": 5828.855668067932, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef224002f0>", "on_episode_step": "<function on_episode_step at 0x7fef186c08c8>", "on_episode_end": "<function on_episode_end at 0x7fef186c0950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef186c09d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201a5488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5828.855668067932, "timesteps_since_restore": 1384871, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 82.14807692307691, "ram_util_percent": 30.28076923076923}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00001, "episode_reward_mean": -0.4250086999999999, "episode_len_mean": 457.35, "episodes_this_iter": 24, "policy_reward_min": {"av": -15.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4381532989690722}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.86213260501057, "avg_speed_min": 2.4035799632094, "avg_speed_max": 7.629952589409868, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.66930297741495, "mean_processing_ms": 2.9045513944481227, "mean_inference_ms": 0.28650996503553716}, "off_policy_estimator": {}, "info": {"num_steps_trained": 331520, "num_steps_sampled": 1395111, "sample_time_ms": 37148.197, "load_time_ms": 1.37, "grad_time_ms": 1043.3, "update_time_ms": 5.621, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 2.3740720748901367, "policy_loss": -0.01707901619374752, "vf_loss": 2.3892059326171875, "vf_explained_var": 0.8477105498313904, "kl": 0.010106195695698261, "entropy": 1.4149764776229858, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10240, "done": false, "timesteps_total": 1395111, "episodes_total": 3042, "training_iteration": 135, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-41-59", "timestamp": 1589881319, "time_this_iter_s": 38.29851794242859, "time_total_s": 5867.154186010361, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20340b70>", "on_episode_step": "<function on_episode_step at 0x7fef187b7598>", "on_episode_end": "<function on_episode_end at 0x7fef187b7950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187b7d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187d1ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5867.154186010361, "timesteps_since_restore": 1395111, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 80.9814814814815, "ram_util_percent": 30.28518518518518}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00001, "episode_reward_mean": -0.62751, "episode_len_mean": 454.81, "episodes_this_iter": 23, "policy_reward_min": {"av": -15.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.633848484848485}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.767914228071188, "avg_speed_min": 1.7345235442288514, "avg_speed_max": 7.629952589409868, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.647411744961474, "mean_processing_ms": 2.9052723622638883, "mean_inference_ms": 0.28599017240303065}, "off_policy_estimator": {}, "info": {"num_steps_trained": 333824, "num_steps_sampled": 1405408, "sample_time_ms": 37209.048, "load_time_ms": 1.371, "grad_time_ms": 1072.345, "update_time_ms": 6.305, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.515596866607666, "policy_loss": -0.011050255969166756, "vf_loss": 1.5249491930007935, "vf_explained_var": 0.8449490666389465, "kl": 0.008823923766613007, "entropy": 1.299580454826355, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10297, "done": false, "timesteps_total": 1405408, "episodes_total": 3065, "training_iteration": 136, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-42-41", "timestamp": 1589881361, "time_this_iter_s": 42.18818926811218, "time_total_s": 5909.342375278473, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2238a0d0>", "on_episode_step": "<function on_episode_step at 0x7fef201da158>", "on_episode_end": "<function on_episode_end at 0x7fef201da2f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201da400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201da1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5909.342375278473, "timesteps_since_restore": 1405408, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 79.9032786885246, "ram_util_percent": 30.298360655737707}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00001, "episode_reward_mean": -0.6275075, "episode_len_mean": 455.01, "episodes_this_iter": 22, "policy_reward_min": {"av": -15.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6275075}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.796665188244704, "avg_speed_min": 1.7345235442288514, "avg_speed_max": 7.629952589409868, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.633851835733694, "mean_processing_ms": 2.9062180200963486, "mean_inference_ms": 0.28568272212637036}, "off_policy_estimator": {}, "info": {"num_steps_trained": 335360, "num_steps_sampled": 1415742, "sample_time_ms": 36616.033, "load_time_ms": 1.336, "grad_time_ms": 1056.664, "update_time_ms": 6.451, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7080068588256836, "policy_loss": -0.01088954508304596, "vf_loss": 0.7168375849723816, "vf_explained_var": 0.8765552043914795, "kl": 0.010699037462472916, "entropy": 1.3879314661026, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10334, "done": false, "timesteps_total": 1415742, "episodes_total": 3087, "training_iteration": 137, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-43-16", "timestamp": 1589881396, "time_this_iter_s": 34.75746393203735, "time_total_s": 5944.09983921051, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef200a2488>", "on_episode_step": "<function on_episode_step at 0x7fef200a2400>", "on_episode_end": "<function on_episode_end at 0x7fef200a2f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200a2048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef200a2b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5944.09983921051, "timesteps_since_restore": 1415742, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 82.33877551020407, "ram_util_percent": 30.3}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00001, "episode_reward_mean": -0.5225082, "episode_len_mean": 463.28, "episodes_this_iter": 22, "policy_reward_min": {"av": -15.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5225082}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.633341293546493, "avg_speed_min": 1.7345235442288514, "avg_speed_max": 7.860306243012378, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.60188503000555, "mean_processing_ms": 2.9036259921165897, "mean_inference_ms": 0.28512243874661425}, "off_policy_estimator": {}, "info": {"num_steps_trained": 337408, "num_steps_sampled": 1426218, "sample_time_ms": 36643.522, "load_time_ms": 1.341, "grad_time_ms": 1092.069, "update_time_ms": 6.428, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.3044546842575073, "policy_loss": -0.01701885648071766, "vf_loss": 1.3190191984176636, "vf_explained_var": 0.8102816343307495, "kl": 0.012754475697875023, "entropy": 1.3056683540344238, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10476, "done": false, "timesteps_total": 1426218, "episodes_total": 3109, "training_iteration": 138, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-43-55", "timestamp": 1589881435, "time_this_iter_s": 39.139975786209106, "time_total_s": 5983.239814996719, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20340510>", "on_episode_step": "<function on_episode_step at 0x7fef2054cd90>", "on_episode_end": "<function on_episode_end at 0x7fef2054cea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187b7b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204ff8c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 5983.239814996719, "timesteps_since_restore": 1426218, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 80.03928571428571, "ram_util_percent": 30.300000000000004}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.1650074, "episode_len_mean": 475.67, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1650074}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.569825670279259, "avg_speed_min": 1.7345235442288514, "avg_speed_max": 7.860306243012378, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.57345976883335, "mean_processing_ms": 2.903398365244582, "mean_inference_ms": 0.2845197560583528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 339712, "num_steps_sampled": 1436497, "sample_time_ms": 37257.517, "load_time_ms": 1.361, "grad_time_ms": 1151.662, "update_time_ms": 6.541, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6199108958244324, "policy_loss": -0.017824770882725716, "vf_loss": 0.6342139840126038, "vf_explained_var": 0.8976510167121887, "kl": 0.018300427123904228, "entropy": 1.2675142288208008, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10279, "done": false, "timesteps_total": 1436497, "episodes_total": 3129, "training_iteration": 139, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-44-36", "timestamp": 1589881476, "time_this_iter_s": 40.33805012702942, "time_total_s": 6023.577865123749, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186c01e0>", "on_episode_step": "<function on_episode_step at 0x7fef2024a0d0>", "on_episode_end": "<function on_episode_end at 0x7fef2024a158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2024a1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2026c7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6023.577865123749, "timesteps_since_restore": 1436497, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 82.13103448275861, "ram_util_percent": 30.301724137931036}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.16750739999999995, "episode_len_mean": 471.76, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16750739999999995}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.477584982517474, "avg_speed_min": 1.3114372543654924, "avg_speed_max": 7.860306243012378, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.56553879356334, "mean_processing_ms": 2.9024348402452516, "mean_inference_ms": 0.28441383574457674}, "off_policy_estimator": {}, "info": {"num_steps_trained": 342144, "num_steps_sampled": 1447101, "sample_time_ms": 37570.241, "load_time_ms": 1.336, "grad_time_ms": 1203.156, "update_time_ms": 6.331, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.340071201324463, "policy_loss": -0.02140231430530548, "vf_loss": 1.3590573072433472, "vf_explained_var": 0.8399147391319275, "kl": 0.01255589909851551, "entropy": 1.2630040645599365, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10604, "done": false, "timesteps_total": 1447101, "episodes_total": 3153, "training_iteration": 140, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-45-20", "timestamp": 1589881520, "time_this_iter_s": 43.692936420440674, "time_total_s": 6067.270801544189, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186b60d0>", "on_episode_step": "<function on_episode_step at 0x7fef20244620>", "on_episode_end": "<function on_episode_end at 0x7fef20244730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef202447b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20244400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6067.270801544189, "timesteps_since_restore": 1447101, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 82.18870967741935, "ram_util_percent": 30.299999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.167508, "episode_len_mean": 471.38, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1692}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.509058232803695, "avg_speed_min": 1.3114372543654924, "avg_speed_max": 7.95022171414302, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.550810443218275, "mean_processing_ms": 2.901749908129618, "mean_inference_ms": 0.2841730495666823}, "off_policy_estimator": {}, "info": {"num_steps_trained": 344064, "num_steps_sampled": 1457386, "sample_time_ms": 37441.468, "load_time_ms": 1.329, "grad_time_ms": 1200.046, "update_time_ms": 6.554, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 2.2736761569976807, "policy_loss": -0.016812069341540337, "vf_loss": 2.2867963314056396, "vf_explained_var": 0.7845019698143005, "kl": 0.01918339915573597, "entropy": 1.4281708002090454, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10285, "done": false, "timesteps_total": 1457386, "episodes_total": 3174, "training_iteration": 141, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-45-58", "timestamp": 1589881558, "time_this_iter_s": 38.09426140785217, "time_total_s": 6105.365062952042, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201da840>", "on_episode_step": "<function on_episode_step at 0x7fef187e7ea0>", "on_episode_end": "<function on_episode_end at 0x7fef187e7c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187e7bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187bda60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6105.365062952042, "timesteps_since_restore": 1457386, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 79.75636363636363, "ram_util_percent": 30.299999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.2750089, "episode_len_mean": 459.84, "episodes_this_iter": 26, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.28062132653061217}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.446450666690507, "avg_speed_min": 1.3114372543654924, "avg_speed_max": 7.95022171414302, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.54324891774903, "mean_processing_ms": 2.9014416031317434, "mean_inference_ms": 0.28410071136051757}, "off_policy_estimator": {}, "info": {"num_steps_trained": 345728, "num_steps_sampled": 1467965, "sample_time_ms": 37558.044, "load_time_ms": 1.329, "grad_time_ms": 1209.122, "update_time_ms": 6.543, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5426230430603027, "policy_loss": -0.023256100714206696, "vf_loss": 1.5630887746810913, "vf_explained_var": 0.8697615265846252, "kl": 0.01450113020837307, "entropy": 1.409717321395874, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10579, "done": false, "timesteps_total": 1467965, "episodes_total": 3200, "training_iteration": 142, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-46-35", "timestamp": 1589881595, "time_this_iter_s": 37.24499797821045, "time_total_s": 6142.610060930252, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef200a28c8>", "on_episode_step": "<function on_episode_step at 0x7fef1864a950>", "on_episode_end": "<function on_episode_end at 0x7fef1864a9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1864aa60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef200d0158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6142.610060930252, "timesteps_since_restore": 1467965, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 77.93018867924529, "ram_util_percent": 30.298113207547168}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.3775092, "episode_len_mean": 456.16, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.38521346938775514}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.29864107855013, "avg_speed_min": 1.3114372543654924, "avg_speed_max": 8.319182595800122, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.525631073872656, "mean_processing_ms": 2.900487956986675, "mean_inference_ms": 0.2837625883997879}, "off_policy_estimator": {}, "info": {"num_steps_trained": 348160, "num_steps_sampled": 1478310, "sample_time_ms": 37971.863, "load_time_ms": 1.315, "grad_time_ms": 1265.057, "update_time_ms": 6.641, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0269615650177002, "policy_loss": -0.004241969436407089, "vf_loss": 1.0295138359069824, "vf_explained_var": 0.8795478940010071, "kl": 0.008781468495726585, "entropy": 1.3777211904525757, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10345, "done": false, "timesteps_total": 1478310, "episodes_total": 3221, "training_iteration": 143, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-47-18", "timestamp": 1589881638, "time_this_iter_s": 43.051506757736206, "time_total_s": 6185.661567687988, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20441048>", "on_episode_step": "<function on_episode_step at 0x7fef18703598>", "on_episode_end": "<function on_episode_end at 0x7fef18703620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187036a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18703bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6185.661567687988, "timesteps_since_restore": 1478310, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 82.72622950819671, "ram_util_percent": 30.3}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.27500919999999995, "episode_len_mean": 459.68, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.28351463917525765}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.555145213607721, "avg_speed_min": 1.3760713647586669, "avg_speed_max": 8.319182595800122, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.501321438852827, "mean_processing_ms": 2.899844042953355, "mean_inference_ms": 0.283197405403301}, "off_policy_estimator": {}, "info": {"num_steps_trained": 349952, "num_steps_sampled": 1488459, "sample_time_ms": 38199.48, "load_time_ms": 1.269, "grad_time_ms": 1282.527, "update_time_ms": 6.954, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6210817098617554, "policy_loss": -0.010230610147118568, "vf_loss": 0.6288580894470215, "vf_explained_var": 0.9328134655952454, "kl": 0.012753480114042759, "entropy": 1.3793145418167114, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10149, "done": false, "timesteps_total": 1488459, "episodes_total": 3243, "training_iteration": 144, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-47-57", "timestamp": 1589881677, "time_this_iter_s": 38.203404664993286, "time_total_s": 6223.864972352982, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204ff9d8>", "on_episode_step": "<function on_episode_step at 0x7fef204ff950>", "on_episode_end": "<function on_episode_end at 0x7fef204ff400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef186c0f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef186c0d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6223.864972352982, "timesteps_since_restore": 1488459, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 81.46545454545453, "ram_util_percent": 30.299999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.48001000000000005, "episode_len_mean": 451.48, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4948556701030928}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.517330652235436, "avg_speed_min": 1.3760713647586669, "avg_speed_max": 8.319182595800122, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.477567560625353, "mean_processing_ms": 2.899712837557891, "mean_inference_ms": 0.282783560468783}, "off_policy_estimator": {}, "info": {"num_steps_trained": 351872, "num_steps_sampled": 1498583, "sample_time_ms": 38278.049, "load_time_ms": 1.281, "grad_time_ms": 1270.644, "update_time_ms": 6.986, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 3.189845561981201, "policy_loss": -0.011502289213240147, "vf_loss": 3.1991658210754395, "vf_explained_var": 0.6994038224220276, "kl": 0.011340385302901268, "entropy": 1.3746399879455566, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10124, "done": false, "timesteps_total": 1498583, "episodes_total": 3266, "training_iteration": 145, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-48-36", "timestamp": 1589881716, "time_this_iter_s": 38.96649193763733, "time_total_s": 6262.831464290619, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18756bf8>", "on_episode_step": "<function on_episode_step at 0x7fef18756b70>", "on_episode_end": "<function on_episode_end at 0x7fef18756ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1847d510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18756ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6262.831464290619, "timesteps_since_restore": 1498583, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 79.17999999999999, "ram_util_percent": 30.299999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.2725115, "episode_len_mean": 463.43, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2809396907216494}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.397235699884412, "avg_speed_min": 1.3760713647586669, "avg_speed_max": 8.319182595800122, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.451642492312256, "mean_processing_ms": 2.899741814235721, "mean_inference_ms": 0.2821360290860108}, "off_policy_estimator": {}, "info": {"num_steps_trained": 354048, "num_steps_sampled": 1508699, "sample_time_ms": 38050.626, "load_time_ms": 1.292, "grad_time_ms": 1244.908, "update_time_ms": 6.474, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8263119459152222, "policy_loss": -0.013402157463133335, "vf_loss": 0.8373020887374878, "vf_explained_var": 0.8782719373703003, "kl": 0.012534133158624172, "entropy": 1.2372465133666992, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10116, "done": false, "timesteps_total": 1508699, "episodes_total": 3286, "training_iteration": 146, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-49-15", "timestamp": 1589881755, "time_this_iter_s": 39.654409408569336, "time_total_s": 6302.485873699188, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186c0d08>", "on_episode_step": "<function on_episode_step at 0x7fef204ffd08>", "on_episode_end": "<function on_episode_end at 0x7fef204ffea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ffe18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef186c0e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6302.485873699188, "timesteps_since_restore": 1508699, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 80.33684210526317, "ram_util_percent": 30.3}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00008, "episode_reward_mean": -0.5225140999999999, "episode_len_mean": 458.62, "episodes_this_iter": 25, "policy_reward_min": {"av": -15.00008}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5331776530612244}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.532130975703297, "avg_speed_min": 2.610432896782344, "avg_speed_max": 8.014214055465482, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.438103177567342, "mean_processing_ms": 2.8991660130354187, "mean_inference_ms": 0.281805198018299}, "off_policy_estimator": {}, "info": {"num_steps_trained": 355840, "num_steps_sampled": 1519347, "sample_time_ms": 38592.591, "load_time_ms": 1.3, "grad_time_ms": 1254.833, "update_time_ms": 6.438, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 2.1052515506744385, "policy_loss": -0.02062251605093479, "vf_loss": 2.1229681968688965, "vf_explained_var": 0.8749765753746033, "kl": 0.015099367126822472, "entropy": 1.1876331567764282, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10648, "done": false, "timesteps_total": 1519347, "episodes_total": 3311, "training_iteration": 147, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-49-56", "timestamp": 1589881796, "time_this_iter_s": 40.269628047943115, "time_total_s": 6342.755501747131, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18422510>", "on_episode_step": "<function on_episode_step at 0x7fef18422598>", "on_episode_end": "<function on_episode_end at 0x7fef18422378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18422840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18422bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6342.755501747131, "timesteps_since_restore": 1519347, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 83.85689655172412, "ram_util_percent": 30.315517241379315}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00008, "episode_reward_mean": -0.42001600000000006, "episode_len_mean": 457.91, "episodes_this_iter": 22, "policy_reward_min": {"av": -15.00008}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.43300618556701026}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.400531499696428, "avg_speed_min": 2.6323990593465556, "avg_speed_max": 8.014214055465482, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.424044228423096, "mean_processing_ms": 2.900063629963461, "mean_inference_ms": 0.28143101259562014}, "off_policy_estimator": {}, "info": {"num_steps_trained": 358272, "num_steps_sampled": 1529695, "sample_time_ms": 38861.911, "load_time_ms": 1.353, "grad_time_ms": 1278.492, "update_time_ms": 6.45, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.674024224281311, "policy_loss": -0.009117585606873035, "vf_loss": 1.6813024282455444, "vf_explained_var": 0.8284039497375488, "kl": 0.009557741694152355, "entropy": 1.1922560930252075, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10348, "done": false, "timesteps_total": 1529695, "episodes_total": 3333, "training_iteration": 148, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-50-38", "timestamp": 1589881838, "time_this_iter_s": 42.07383608818054, "time_total_s": 6384.829337835312, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18422268>", "on_episode_step": "<function on_episode_step at 0x7fef18703620>", "on_episode_end": "<function on_episode_end at 0x7fef187036a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18703510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185a9048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6384.829337835312, "timesteps_since_restore": 1529695, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 82.86333333333337, "ram_util_percent": 30.33666666666667}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00008, "episode_reward_mean": -0.6200211999999999, "episode_len_mean": 458.55, "episodes_this_iter": 25, "policy_reward_min": {"av": -15.00008}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6262840404040405}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2857671917693185, "avg_speed_min": 2.6323990593465556, "avg_speed_max": 8.014214055465482, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.414314148509156, "mean_processing_ms": 2.900351692615079, "mean_inference_ms": 0.28124358870772376}, "off_policy_estimator": {}, "info": {"num_steps_trained": 360192, "num_steps_sampled": 1540056, "sample_time_ms": 38771.111, "load_time_ms": 1.344, "grad_time_ms": 1259.536, "update_time_ms": 6.336, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 3.7603759765625, "policy_loss": -0.023440008983016014, "vf_loss": 3.780437707901001, "vf_explained_var": 0.8087500929832458, "kl": 0.01755412481725216, "entropy": 1.4241652488708496, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10361, "done": false, "timesteps_total": 1540056, "episodes_total": 3358, "training_iteration": 149, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-51-17", "timestamp": 1589881877, "time_this_iter_s": 39.24275016784668, "time_total_s": 6424.072088003159, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18703598>", "on_episode_step": "<function on_episode_step at 0x7fef184b9730>", "on_episode_end": "<function on_episode_end at 0x7fef184b9840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef184b9d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef184b9ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6424.072088003159, "timesteps_since_restore": 1540056, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 83.20714285714287, "ram_util_percent": 30.357142857142858}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00008, "episode_reward_mean": -0.8300225, "episode_len_mean": 442.09, "episodes_this_iter": 24, "policy_reward_min": {"av": -15.00008}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8469617346938776}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.322622141815707, "avg_speed_min": 2.590591037732328, "avg_speed_max": 7.099054439189475, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.412112928383166, "mean_processing_ms": 2.9021808869845445, "mean_inference_ms": 0.28123272464259164}, "off_policy_estimator": {}, "info": {"num_steps_trained": 362496, "num_steps_sampled": 1550387, "sample_time_ms": 38696.552, "load_time_ms": 1.345, "grad_time_ms": 1216.527, "update_time_ms": 6.67, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7176023721694946, "policy_loss": -0.01327928714454174, "vf_loss": 1.7284455299377441, "vf_explained_var": 0.8650689721107483, "kl": 0.01266115065664053, "entropy": 1.207339882850647, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10331, "done": false, "timesteps_total": 1550387, "episodes_total": 3382, "training_iteration": 150, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-52-00", "timestamp": 1589881920, "time_this_iter_s": 42.51779818534851, "time_total_s": 6466.589886188507, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187b7f28>", "on_episode_step": "<function on_episode_step at 0x7fef205ee488>", "on_episode_end": "<function on_episode_end at 0x7fef18703620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187036a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18703510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6466.589886188507, "timesteps_since_restore": 1550387, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 81.32786885245902, "ram_util_percent": 30.363934426229513}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.885022, "episode_len_mean": 438.66, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.9030836734693877}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4224485372740965, "avg_speed_min": 2.590591037732328, "avg_speed_max": 7.336502076164986, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.409290030239234, "mean_processing_ms": 2.9026221519613102, "mean_inference_ms": 0.2811648556971857}, "off_policy_estimator": {}, "info": {"num_steps_trained": 364160, "num_steps_sampled": 1560695, "sample_time_ms": 38849.086, "load_time_ms": 1.296, "grad_time_ms": 1178.204, "update_time_ms": 6.389, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8340615034103394, "policy_loss": -0.014820391312241554, "vf_loss": 1.8456450700759888, "vf_explained_var": 0.9116984605789185, "kl": 0.016820041462779045, "entropy": 1.6003508567810059, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10308, "done": false, "timesteps_total": 1560695, "episodes_total": 3407, "training_iteration": 151, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-52-39", "timestamp": 1589881959, "time_this_iter_s": 39.23532152175903, "time_total_s": 6505.825207710266, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18422e18>", "on_episode_step": "<function on_episode_step at 0x7fef18422d90>", "on_episode_end": "<function on_episode_end at 0x7fef18422950>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1847d598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204ffbf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6505.825207710266, "timesteps_since_restore": 1560695, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 82.42499999999998, "ram_util_percent": 30.38571428571429}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.9900223, "episode_len_mean": 435.57, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -1.0000225252525252}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.551232687912983, "avg_speed_min": 1.407311177326537, "avg_speed_max": 7.336502076164986, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.397565244989682, "mean_processing_ms": 2.9025359948484106, "mean_inference_ms": 0.2809037987783553}, "off_policy_estimator": {}, "info": {"num_steps_trained": 365952, "num_steps_sampled": 1570861, "sample_time_ms": 39151.787, "load_time_ms": 1.352, "grad_time_ms": 1160.925, "update_time_ms": 6.414, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 3.135394334793091, "policy_loss": -0.016682567074894905, "vf_loss": 3.1496055126190186, "vf_explained_var": 0.8153285384178162, "kl": 0.012841290794312954, "entropy": 1.4371687173843384, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10166, "done": false, "timesteps_total": 1570861, "episodes_total": 3428, "training_iteration": 152, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-53-19", "timestamp": 1589881999, "time_this_iter_s": 40.09928274154663, "time_total_s": 6545.924490451813, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20456730>", "on_episode_step": "<function on_episode_step at 0x7fef18422f28>", "on_episode_end": "<function on_episode_end at 0x7fef204ff730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1864a8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef200a2158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6545.924490451813, "timesteps_since_restore": 1570861, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 83.87543859649124, "ram_util_percent": 30.394736842105264}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.6825217000000002, "episode_len_mean": 447.94, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6894158585858586}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5413407953079705, "avg_speed_min": 1.407311177326537, "avg_speed_max": 7.336502076164986, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.382562264936677, "mean_processing_ms": 2.9016851182646453, "mean_inference_ms": 0.28038857700954983}, "off_policy_estimator": {}, "info": {"num_steps_trained": 368000, "num_steps_sampled": 1581066, "sample_time_ms": 38879.331, "load_time_ms": 1.405, "grad_time_ms": 1119.825, "update_time_ms": 6.318, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0583610534667969, "policy_loss": -0.012947537004947662, "vf_loss": 1.0690388679504395, "vf_explained_var": 0.8946679830551147, "kl": 0.01179511845111847, "entropy": 1.3500049114227295, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10205, "done": false, "timesteps_total": 1581066, "episodes_total": 3449, "training_iteration": 153, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-53-59", "timestamp": 1589882039, "time_this_iter_s": 39.90999507904053, "time_total_s": 6585.834485530853, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18373ea0>", "on_episode_step": "<function on_episode_step at 0x7fef1832aae8>", "on_episode_end": "<function on_episode_end at 0x7fef1832abf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1832ac80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1832a6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6585.834485530853, "timesteps_since_restore": 1581066, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 82.34912280701755, "ram_util_percent": 30.39649122807018}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.6850201000000001, "episode_len_mean": 444.28, "episodes_this_iter": 26, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6850201000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.568453353394376, "avg_speed_min": 1.277279732412845, "avg_speed_max": 7.458226200539938, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.394530871952487, "mean_processing_ms": 2.9034862712267837, "mean_inference_ms": 0.280567960732018}, "off_policy_estimator": {}, "info": {"num_steps_trained": 369920, "num_steps_sampled": 1591492, "sample_time_ms": 39192.67, "load_time_ms": 1.406, "grad_time_ms": 1120.671, "update_time_ms": 5.964, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.9843065738677979, "policy_loss": -0.006255724932998419, "vf_loss": 1.9894862174987793, "vf_explained_var": 0.8308990597724915, "kl": 0.005592926871031523, "entropy": 1.407377004623413, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10426, "done": false, "timesteps_total": 1591492, "episodes_total": 3475, "training_iteration": 154, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-54-41", "timestamp": 1589882081, "time_this_iter_s": 41.34347677230835, "time_total_s": 6627.177962303162, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef184b9ae8>", "on_episode_step": "<function on_episode_step at 0x7fef182bed90>", "on_episode_end": "<function on_episode_end at 0x7fef182bee18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef182beea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef182c0488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6627.177962303162, "timesteps_since_restore": 1591492, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 80.29661016949154, "ram_util_percent": 30.398305084745772}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00005, "episode_reward_mean": -0.6850204, "episode_len_mean": 445.18, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6850204}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.554935579643991, "avg_speed_min": 1.2587958935068386, "avg_speed_max": 7.607331048886633, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.380252299584303, "mean_processing_ms": 2.9032521243864045, "mean_inference_ms": 0.2800582143058248}, "off_policy_estimator": {}, "info": {"num_steps_trained": 372224, "num_steps_sampled": 1601793, "sample_time_ms": 39545.954, "load_time_ms": 1.394, "grad_time_ms": 1152.26, "update_time_ms": 6.074, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 3.2664451599121094, "policy_loss": -0.004087704699486494, "vf_loss": 3.2690036296844482, "vf_explained_var": 0.765256404876709, "kl": 0.00794877391308546, "entropy": 1.358919382095337, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10301, "done": false, "timesteps_total": 1601793, "episodes_total": 3496, "training_iteration": 155, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-55-23", "timestamp": 1589882123, "time_this_iter_s": 42.816057443618774, "time_total_s": 6669.99401974678, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef200a2b70>", "on_episode_step": "<function on_episode_step at 0x7fef200a2598>", "on_episode_end": "<function on_episode_end at 0x7fef200a2c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200a2d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187569d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6669.99401974678, "timesteps_since_restore": 1601793, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 85.08360655737707, "ram_util_percent": 30.40491803278689}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00005, "episode_reward_mean": -0.3775221999999999, "episode_len_mean": 456.33, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3813355555555555}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3344183006560995, "avg_speed_min": 1.2587958935068386, "avg_speed_max": 7.607331048886633, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.368139432350045, "mean_processing_ms": 2.903868665136914, "mean_inference_ms": 0.2797012186299921}, "off_policy_estimator": {}, "info": {"num_steps_trained": 374272, "num_steps_sampled": 1612180, "sample_time_ms": 39591.503, "load_time_ms": 1.393, "grad_time_ms": 1149.438, "update_time_ms": 5.954, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.5372651815414429, "policy_loss": -0.00863414816558361, "vf_loss": 0.5438300371170044, "vf_explained_var": 0.9397033452987671, "kl": 0.010753474198281765, "entropy": 1.3290588855743408, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10387, "done": false, "timesteps_total": 1612180, "episodes_total": 3519, "training_iteration": 156, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-56-04", "timestamp": 1589882164, "time_this_iter_s": 40.07821035385132, "time_total_s": 6710.072230100632, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef182e6f28>", "on_episode_step": "<function on_episode_step at 0x7fef182c0620>", "on_episode_end": "<function on_episode_end at 0x7fef182c0510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20456510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187562f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6710.072230100632, "timesteps_since_restore": 1612180, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 83.6842105263158, "ram_util_percent": 30.400000000000002}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00005, "episode_reward_mean": -0.5850205999999999, "episode_len_mean": 443.41, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5969597959183672}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.311397616812323, "avg_speed_min": 1.2587958935068386, "avg_speed_max": 7.607331048886633, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.373310975683925, "mean_processing_ms": 2.905760492230738, "mean_inference_ms": 0.2797099067523113}, "off_policy_estimator": {}, "info": {"num_steps_trained": 376192, "num_steps_sampled": 1622599, "sample_time_ms": 39566.632, "load_time_ms": 1.396, "grad_time_ms": 1162.428, "update_time_ms": 6.239, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9623242616653442, "policy_loss": -0.014055504463613033, "vf_loss": 0.9742317795753479, "vf_explained_var": 0.9128908514976501, "kl": 0.011162380687892437, "entropy": 1.3036503791809082, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10419, "done": false, "timesteps_total": 1622599, "episodes_total": 3543, "training_iteration": 157, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-56-44", "timestamp": 1589882204, "time_this_iter_s": 40.15584206581116, "time_total_s": 6750.228072166443, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef182e6ea0>", "on_episode_step": "<function on_episode_step at 0x7fef2054c620>", "on_episode_end": "<function on_episode_end at 0x7fef2054c0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2238a0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20244c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6750.228072166443, "timesteps_since_restore": 1622599, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 83.63620689655173, "ram_util_percent": 30.400000000000006}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.4800191000000001, "episode_len_mean": 452.28, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.48981540816326524}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.250710077546729, "avg_speed_min": 1.2587958935068386, "avg_speed_max": 7.891802160618596, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.356681786816754, "mean_processing_ms": 2.9041887130954596, "mean_inference_ms": 0.27918540818150184}, "off_policy_estimator": {}, "info": {"num_steps_trained": 378496, "num_steps_sampled": 1633087, "sample_time_ms": 39679.506, "load_time_ms": 1.382, "grad_time_ms": 1151.877, "update_time_ms": 6.343, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7995637655258179, "policy_loss": -0.014959437772631645, "vf_loss": 1.8127002716064453, "vf_explained_var": 0.8584108352661133, "kl": 0.009472977370023727, "entropy": 1.2796006202697754, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10488, "done": false, "timesteps_total": 1633087, "episodes_total": 3567, "training_iteration": 158, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-57-27", "timestamp": 1589882247, "time_this_iter_s": 43.10020589828491, "time_total_s": 6793.328278064728, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187bd488>", "on_episode_step": "<function on_episode_step at 0x7fef2024a510>", "on_episode_end": "<function on_episode_end at 0x7fef2024a378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2024aae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2024a158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6793.328278064728, "timesteps_since_restore": 1633087, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 82.03934426229506, "ram_util_percent": 30.40000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.4800189, "episode_len_mean": 451.62, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.4898152040816326}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.283162014957435, "avg_speed_min": 1.2587958935068386, "avg_speed_max": 7.891802160618596, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.342547292473622, "mean_processing_ms": 2.9039153710359695, "mean_inference_ms": 0.27882431969700344}, "off_policy_estimator": {}, "info": {"num_steps_trained": 380288, "num_steps_sampled": 1643752, "sample_time_ms": 39598.94, "load_time_ms": 1.385, "grad_time_ms": 1143.319, "update_time_ms": 6.526, "learner": {"av": {"cur_kl_coeff": 0.19243383407592773, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9477510452270508, "policy_loss": -0.023832708597183228, "vf_loss": 0.9669462442398071, "vf_explained_var": 0.9114853739738464, "kl": 0.02409954182803631, "entropy": 1.3508527278900146, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10665, "done": false, "timesteps_total": 1643752, "episodes_total": 3590, "training_iteration": 159, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-58-06", "timestamp": 1589882286, "time_this_iter_s": 38.35314345359802, "time_total_s": 6831.681421518326, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2026c158>", "on_episode_step": "<function on_episode_step at 0x7fef2026c730>", "on_episode_end": "<function on_episode_end at 0x7fef2026c840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2026ca60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18756488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6831.681421518326, "timesteps_since_restore": 1643752, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 82.16000000000003, "ram_util_percent": 30.400000000000013}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.47752029999999995, "episode_len_mean": 456.02, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.48234373737373737}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.461719066365336, "avg_speed_min": 1.4327266449551632, "avg_speed_max": 7.891802160618596, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.31914544173169, "mean_processing_ms": 2.9020455287619984, "mean_inference_ms": 0.2781971769523387}, "off_policy_estimator": {}, "info": {"num_steps_trained": 382208, "num_steps_sampled": 1654051, "sample_time_ms": 39163.964, "load_time_ms": 1.384, "grad_time_ms": 1142.672, "update_time_ms": 6.315, "learner": {"av": {"cur_kl_coeff": 0.2886507511138916, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5656867027282715, "policy_loss": -0.010014837607741356, "vf_loss": 1.5741634368896484, "vf_explained_var": 0.8783977031707764, "kl": 0.00532887177541852, "entropy": 1.4634003639221191, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10299, "done": false, "timesteps_total": 1654051, "episodes_total": 3611, "training_iteration": 160, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-58-44", "timestamp": 1589882324, "time_this_iter_s": 38.160247564315796, "time_total_s": 6869.841669082642, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187bda60>", "on_episode_step": "<function on_episode_step at 0x7fef2009ae18>", "on_episode_end": "<function on_episode_end at 0x7fef2009a730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2009a598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201dae18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6869.841669082642, "timesteps_since_restore": 1654051, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 81.69272727272728, "ram_util_percent": 30.405454545454553}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.3725200999999999, "episode_len_mean": 464.71, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3725200999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.2832237930699115, "avg_speed_min": 1.4327266449551632, "avg_speed_max": 7.891802160618596, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.306695896754334, "mean_processing_ms": 2.9007442863496773, "mean_inference_ms": 0.277920902651006}, "off_policy_estimator": {}, "info": {"num_steps_trained": 384128, "num_steps_sampled": 1664452, "sample_time_ms": 39162.542, "load_time_ms": 1.42, "grad_time_ms": 1174.106, "update_time_ms": 6.348, "learner": {"av": {"cur_kl_coeff": 0.2886507511138916, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9872104525566101, "policy_loss": -0.008751118555665016, "vf_loss": 0.9932185411453247, "vf_explained_var": 0.8988216519355774, "kl": 0.009502955712378025, "entropy": 1.1728390455245972, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10401, "done": false, "timesteps_total": 1664452, "episodes_total": 3633, "training_iteration": 161, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_09-59-23", "timestamp": 1589882363, "time_this_iter_s": 39.530898094177246, "time_total_s": 6909.372567176819, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2026ca60>", "on_episode_step": "<function on_episode_step at 0x7fef187bd2f0>", "on_episode_end": "<function on_episode_end at 0x7fef187bd488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187bd400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187bd048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6909.372567176819, "timesteps_since_restore": 1664452, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 82.53392857142856, "ram_util_percent": 30.439285714285717}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": -0.3775185999999999, "episode_len_mean": 451.77, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3852230612244897}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.408923410123269, "avg_speed_min": 1.5419963705485478, "avg_speed_max": 7.717166993758518, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.304876986403386, "mean_processing_ms": 2.9022380642889734, "mean_inference_ms": 0.27791703478257135}, "off_policy_estimator": {}, "info": {"num_steps_trained": 386176, "num_steps_sampled": 1674799, "sample_time_ms": 39144.764, "load_time_ms": 1.433, "grad_time_ms": 1229.557, "update_time_ms": 6.336, "learner": {"av": {"cur_kl_coeff": 0.2886507511138916, "cur_lr": 4.999999873689376e-05, "total_loss": 3.7904255390167236, "policy_loss": -0.010740171186625957, "vf_loss": 3.799750328063965, "vf_explained_var": 0.7668057084083557, "kl": 0.0049030976369977, "entropy": 1.4291760921478271, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10347, "done": false, "timesteps_total": 1674799, "episodes_total": 3658, "training_iteration": 162, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-00-04", "timestamp": 1589882404, "time_this_iter_s": 40.479517221450806, "time_total_s": 6949.85208439827, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201a5488>", "on_episode_step": "<function on_episode_step at 0x7fef201a5950>", "on_episode_end": "<function on_episode_end at 0x7fef201a5a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a5bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203d1598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6949.85208439827, "timesteps_since_restore": 1674799, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 82.75862068965517, "ram_util_percent": 30.479310344827585}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.2725191, "episode_len_mean": 459.8, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27808071428571424}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.391701844447875, "avg_speed_min": 1.9374386426949122, "avg_speed_max": 7.717166993758518, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.2880051024883, "mean_processing_ms": 2.901347482004449, "mean_inference_ms": 0.2775204133537143}, "off_policy_estimator": {}, "info": {"num_steps_trained": 388480, "num_steps_sampled": 1685007, "sample_time_ms": 39286.931, "load_time_ms": 1.376, "grad_time_ms": 1255.458, "update_time_ms": 6.487, "learner": {"av": {"cur_kl_coeff": 0.1443253755569458, "cur_lr": 4.999999873689376e-05, "total_loss": 1.736143946647644, "policy_loss": -0.010470583103597164, "vf_loss": 1.7456789016723633, "vf_explained_var": 0.8698226809501648, "kl": 0.00648335600271821, "entropy": 1.322554111480713, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10208, "done": false, "timesteps_total": 1685007, "episodes_total": 3680, "training_iteration": 163, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-00-46", "timestamp": 1589882446, "time_this_iter_s": 41.59603452682495, "time_total_s": 6991.448118925095, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2024a158>", "on_episode_step": "<function on_episode_step at 0x7fef203d1c80>", "on_episode_end": "<function on_episode_end at 0x7fef203d1bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203d17b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054c1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 6991.448118925095, "timesteps_since_restore": 1685007, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 81.1322033898305, "ram_util_percent": 30.486440677966105}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.4750188999999999, "episode_len_mean": 455.65, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.48471316326530606}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.486129502209267, "avg_speed_min": 2.0990508431049277, "avg_speed_max": 8.171935721844779, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.272502281100973, "mean_processing_ms": 2.900633331450869, "mean_inference_ms": 0.2771325197594411}, "off_policy_estimator": {}, "info": {"num_steps_trained": 390272, "num_steps_sampled": 1695321, "sample_time_ms": 39082.065, "load_time_ms": 1.402, "grad_time_ms": 1253.312, "update_time_ms": 6.509, "learner": {"av": {"cur_kl_coeff": 0.1443253755569458, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7898797988891602, "policy_loss": -0.007630514446645975, "vf_loss": 1.7966564893722534, "vf_explained_var": 0.8603782653808594, "kl": 0.005917391739785671, "entropy": 1.385522723197937, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10314, "done": false, "timesteps_total": 1695321, "episodes_total": 3702, "training_iteration": 164, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-01-25", "timestamp": 1589882485, "time_this_iter_s": 39.26998853683472, "time_total_s": 7030.718107461929, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2054cc80>", "on_episode_step": "<function on_episode_step at 0x7fef201ce1e0>", "on_episode_end": "<function on_episode_end at 0x7fef201ce730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201ce7b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef205dac80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7030.718107461929, "timesteps_since_restore": 1695321, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 82.49642857142858, "ram_util_percent": 30.489285714285717}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.6800159999999998, "episode_len_mean": 447.31, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.6938938775510203}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.420902974553433, "avg_speed_min": 2.0990508431049277, "avg_speed_max": 8.171935721844779, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.2780215355993, "mean_processing_ms": 2.9015918769852607, "mean_inference_ms": 0.2772419886253578}, "off_policy_estimator": {}, "info": {"num_steps_trained": 392448, "num_steps_sampled": 1705697, "sample_time_ms": 39083.077, "load_time_ms": 1.416, "grad_time_ms": 1237.56, "update_time_ms": 6.241, "learner": {"av": {"cur_kl_coeff": 0.1443253755569458, "cur_lr": 4.999999873689376e-05, "total_loss": 2.3331546783447266, "policy_loss": -0.012193218804895878, "vf_loss": 2.3433752059936523, "vf_explained_var": 0.8607853055000305, "kl": 0.01366578321903944, "entropy": 1.2504780292510986, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10376, "done": false, "timesteps_total": 1705697, "episodes_total": 3726, "training_iteration": 165, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-02-08", "timestamp": 1589882528, "time_this_iter_s": 42.66464948654175, "time_total_s": 7073.382756948471, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2024a158>", "on_episode_step": "<function on_episode_step at 0x7fef20244b70>", "on_episode_end": "<function on_episode_end at 0x7fef20244c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20244f28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18756620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7073.382756948471, "timesteps_since_restore": 1705697, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 83.67049180327867, "ram_util_percent": 30.49508196721311}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.8800181, "episode_len_mean": 452.47, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.8800181}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.431687368061995, "avg_speed_min": 1.2945204748521495, "avg_speed_max": 8.171935721844779, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.259156141723533, "mean_processing_ms": 2.9009618800822854, "mean_inference_ms": 0.27666065130863254}, "off_policy_estimator": {}, "info": {"num_steps_trained": 394240, "num_steps_sampled": 1715935, "sample_time_ms": 38943.979, "load_time_ms": 1.39, "grad_time_ms": 1222.593, "update_time_ms": 6.317, "learner": {"av": {"cur_kl_coeff": 0.1443253755569458, "cur_lr": 4.999999873689376e-05, "total_loss": 1.1893545389175415, "policy_loss": -0.024431491270661354, "vf_loss": 1.2112367153167725, "vf_explained_var": 0.9270038604736328, "kl": 0.017662744969129562, "entropy": 1.329830527305603, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10238, "done": false, "timesteps_total": 1715935, "episodes_total": 3749, "training_iteration": 166, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-02-46", "timestamp": 1589882566, "time_this_iter_s": 38.536627531051636, "time_total_s": 7111.919384479523, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201ce378>", "on_episode_step": "<function on_episode_step at 0x7fef201ce730>", "on_episode_end": "<function on_episode_end at 0x7fef201ce1e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205dac80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20244158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7111.919384479523, "timesteps_since_restore": 1715935, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 83.96545454545453, "ram_util_percent": 30.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000079999999999, "episode_reward_mean": -0.5725186, "episode_len_mean": 464.02, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.000079999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.5725186}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.450096771147229, "avg_speed_min": 1.2945204748521495, "avg_speed_max": 8.171935721844779, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.25327751563128, "mean_processing_ms": 2.9009570823136572, "mean_inference_ms": 0.27638153534113635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 395904, "num_steps_sampled": 1726333, "sample_time_ms": 38947.71, "load_time_ms": 1.374, "grad_time_ms": 1191.451, "update_time_ms": 6.182, "learner": {"av": {"cur_kl_coeff": 0.1443253755569458, "cur_lr": 4.999999873689376e-05, "total_loss": 0.9319307804107666, "policy_loss": -0.02282446250319481, "vf_loss": 0.951535165309906, "vf_explained_var": 0.8753643035888672, "kl": 0.022311227396130562, "entropy": 1.3552254438400269, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10398, "done": false, "timesteps_total": 1726333, "episodes_total": 3770, "training_iteration": 167, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-03-26", "timestamp": 1589882606, "time_this_iter_s": 39.878117084503174, "time_total_s": 7151.797501564026, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205da378>", "on_episode_step": "<function on_episode_step at 0x7fef20469730>", "on_episode_end": "<function on_episode_end at 0x7fef203d1598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203d1268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203d1048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7151.797501564026, "timesteps_since_restore": 1726333, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 82.95789473684209, "ram_util_percent": 30.49824561403509}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000079999999999, "episode_reward_mean": -0.675021, "episode_len_mean": 460.03, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.000079999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.675021}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.437543221226762, "avg_speed_min": 1.2945204748521495, "avg_speed_max": 7.125551865524204, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.237990715722468, "mean_processing_ms": 2.8999642228796967, "mean_inference_ms": 0.27587627438070983}, "off_policy_estimator": {}, "info": {"num_steps_trained": 398080, "num_steps_sampled": 1736429, "sample_time_ms": 38728.926, "load_time_ms": 1.35, "grad_time_ms": 1187.406, "update_time_ms": 5.986, "learner": {"av": {"cur_kl_coeff": 0.2164880633354187, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6892995834350586, "policy_loss": -0.007254163268953562, "vf_loss": 1.6950825452804565, "vf_explained_var": 0.8282885551452637, "kl": 0.006795775610953569, "entropy": 1.3509184122085571, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10096, "done": false, "timesteps_total": 1736429, "episodes_total": 3790, "training_iteration": 168, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-04-07", "timestamp": 1589882647, "time_this_iter_s": 40.86874771118164, "time_total_s": 7192.6662492752075, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef200a20d0>", "on_episode_step": "<function on_episode_step at 0x7fef203f2510>", "on_episode_end": "<function on_episode_end at 0x7fef203f22f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203f27b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203f2a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7192.6662492752075, "timesteps_since_restore": 1736429, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 82.46949152542372, "ram_util_percent": 30.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.47752269999999997, "episode_len_mean": 456.63, "episodes_this_iter": 26, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.48234616161616156}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3110150702656815, "avg_speed_min": 1.2885585300816147, "avg_speed_max": 7.245791214952637, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.250822510053954, "mean_processing_ms": 2.9010071429265714, "mean_inference_ms": 0.2760229973486881}, "off_policy_estimator": {}, "info": {"num_steps_trained": 400128, "num_steps_sampled": 1746979, "sample_time_ms": 39104.53, "load_time_ms": 1.408, "grad_time_ms": 1192.583, "update_time_ms": 5.883, "learner": {"av": {"cur_kl_coeff": 0.2164880633354187, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6121516227722168, "policy_loss": -0.015087377279996872, "vf_loss": 1.6250278949737549, "vf_explained_var": 0.8981763124465942, "kl": 0.01021319255232811, "entropy": 1.2656433582305908, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10550, "done": false, "timesteps_total": 1746979, "episodes_total": 3816, "training_iteration": 169, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-04-50", "timestamp": 1589882690, "time_this_iter_s": 42.156471729278564, "time_total_s": 7234.822721004486, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1847d7b8>", "on_episode_step": "<function on_episode_step at 0x7fef1847d6a8>", "on_episode_end": "<function on_episode_end at 0x7fef1847d840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1847d730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203f2840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7234.822721004486, "timesteps_since_restore": 1746979, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 81.22666666666667, "ram_util_percent": 30.498333333333335}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.38002109999999995, "episode_len_mean": 453.62, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.38385969696969696}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.264980221789076, "avg_speed_min": 1.2725450792444757, "avg_speed_max": 7.256422918079225, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.23688443469976, "mean_processing_ms": 2.9004365621315986, "mean_inference_ms": 0.2756206820062208}, "off_policy_estimator": {}, "info": {"num_steps_trained": 402304, "num_steps_sampled": 1757016, "sample_time_ms": 39403.389, "load_time_ms": 1.448, "grad_time_ms": 1213.713, "update_time_ms": 5.714, "learner": {"av": {"cur_kl_coeff": 0.2164880633354187, "cur_lr": 4.999999873689376e-05, "total_loss": 0.832891583442688, "policy_loss": -0.007530557923018932, "vf_loss": 0.8386836647987366, "vf_explained_var": 0.9261218309402466, "kl": 0.008030368946492672, "entropy": 1.2811607122421265, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10037, "done": false, "timesteps_total": 1757016, "episodes_total": 3837, "training_iteration": 170, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-05-31", "timestamp": 1589882731, "time_this_iter_s": 41.35801935195923, "time_total_s": 7276.180740356445, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1847da60>", "on_episode_step": "<function on_episode_step at 0x7fef20244bf8>", "on_episode_end": "<function on_episode_end at 0x7fef20244488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef202449d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203a4d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7276.180740356445, "timesteps_since_restore": 1757016, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 82.82372881355931, "ram_util_percent": 30.501694915254237}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.17502249999999997, "episode_len_mean": 460.92, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17679040404040405}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3172176765859716, "avg_speed_min": 1.2725450792444757, "avg_speed_max": 7.256422918079225, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.22918354851708, "mean_processing_ms": 2.8997462348892515, "mean_inference_ms": 0.27532901531716586}, "off_policy_estimator": {}, "info": {"num_steps_trained": 403840, "num_steps_sampled": 1767123, "sample_time_ms": 38982.251, "load_time_ms": 1.411, "grad_time_ms": 1195.111, "update_time_ms": 5.709, "learner": {"av": {"cur_kl_coeff": 0.2164880633354187, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8479047417640686, "policy_loss": -0.01497216522693634, "vf_loss": 0.8579621911048889, "vf_explained_var": 0.9106078147888184, "kl": 0.022701434791088104, "entropy": 1.5640004873275757, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10107, "done": false, "timesteps_total": 1767123, "episodes_total": 3859, "training_iteration": 171, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-06-06", "timestamp": 1589882766, "time_this_iter_s": 35.13986897468567, "time_total_s": 7311.320609331131, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1847d840>", "on_episode_step": "<function on_episode_step at 0x7fef200a2840>", "on_episode_end": "<function on_episode_end at 0x7fef200a2730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200a21e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef183dd7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7311.320609331131, "timesteps_since_restore": 1767123, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 82.168, "ram_util_percent": 30.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.17752379999999998, "episode_len_mean": 456.4, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.18114673469387754}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.362796859753195, "avg_speed_min": 1.2725450792444757, "avg_speed_max": 7.256422918079225, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.23073456453741, "mean_processing_ms": 2.899932747653718, "mean_inference_ms": 0.2752970623805752}, "off_policy_estimator": {}, "info": {"num_steps_trained": 405504, "num_steps_sampled": 1777376, "sample_time_ms": 38911.526, "load_time_ms": 1.342, "grad_time_ms": 1136.116, "update_time_ms": 5.732, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8631044626235962, "policy_loss": -0.012031291611492634, "vf_loss": 0.8702625632286072, "vf_explained_var": 0.8920930624008179, "kl": 0.01500671450048685, "entropy": 1.2382937669754028, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10253, "done": false, "timesteps_total": 1777376, "episodes_total": 3880, "training_iteration": 172, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-06-45", "timestamp": 1589882805, "time_this_iter_s": 39.17901015281677, "time_total_s": 7350.499619483948, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205dac80>", "on_episode_step": "<function on_episode_step at 0x7fef201ce268>", "on_episode_end": "<function on_episode_end at 0x7fef187bdae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187bd510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef200a20d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7350.499619483948, "timesteps_since_restore": 1777376, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 84.43214285714285, "ram_util_percent": 30.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.032476599999999994, "episode_len_mean": 472.6, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03280464646464649}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.496430862595881, "avg_speed_min": 1.2725450792444757, "avg_speed_max": 8.04468012184372, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.213573938721762, "mean_processing_ms": 2.8995366725003318, "mean_inference_ms": 0.2746920273019651}, "off_policy_estimator": {}, "info": {"num_steps_trained": 407296, "num_steps_sampled": 1787672, "sample_time_ms": 38807.09, "load_time_ms": 1.331, "grad_time_ms": 1086.312, "update_time_ms": 5.737, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 0.7688116431236267, "policy_loss": -0.010505096055567265, "vf_loss": 0.7772531509399414, "vf_explained_var": 0.9188438057899475, "kl": 0.00635484978556633, "entropy": 1.5121556520462036, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10296, "done": false, "timesteps_total": 1787672, "episodes_total": 3901, "training_iteration": 173, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-07-26", "timestamp": 1589882846, "time_this_iter_s": 40.05019736289978, "time_total_s": 7390.5498168468475, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186c0c80>", "on_episode_step": "<function on_episode_step at 0x7fef18422d08>", "on_episode_end": "<function on_episode_end at 0x7fef184222f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18422488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef184221e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7390.5498168468475, "timesteps_since_restore": 1787672, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 83.81929824561404, "ram_util_percent": 30.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": 0.0, "episode_reward_mean": 0.23997610000000005, "episode_len_mean": 483.02, "episodes_this_iter": 21, "policy_reward_min": {"av": 0.0}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.24240010101010104}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 4.503040897439579, "avg_speed_min": 1.653412528050939, "avg_speed_max": 8.04468012184372, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.19430373187479, "mean_processing_ms": 2.898164575316282, "mean_inference_ms": 0.27410967252504986}, "off_policy_estimator": {}, "info": {"num_steps_trained": 409472, "num_steps_sampled": 1797767, "sample_time_ms": 38979.127, "load_time_ms": 1.316, "grad_time_ms": 1112.957, "update_time_ms": 5.79, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 0.8498091697692871, "policy_loss": -0.002081521786749363, "vf_loss": 0.850236177444458, "vf_explained_var": 0.9198717474937439, "kl": 0.005094984546303749, "entropy": 1.291874885559082, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10095, "done": false, "timesteps_total": 1797767, "episodes_total": 3922, "training_iteration": 174, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-08-07", "timestamp": 1589882887, "time_this_iter_s": 41.25704741477966, "time_total_s": 7431.806864261627, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186c0e18>", "on_episode_step": "<function on_episode_step at 0x7fef20142268>", "on_episode_end": "<function on_episode_end at 0x7fef201422f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20142378>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201428c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7431.806864261627, "timesteps_since_restore": 1797767, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 81.71694915254237, "ram_util_percent": 30.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": 0.034976300000000016, "episode_len_mean": 474.32, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.035329595959595984}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.61754629532487, "avg_speed_min": 2.3722080328146493, "avg_speed_max": 8.04468012184372, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.196675763737193, "mean_processing_ms": 2.8982690782529428, "mean_inference_ms": 0.2740550773758137}, "off_policy_estimator": {}, "info": {"num_steps_trained": 410880, "num_steps_sampled": 1808154, "sample_time_ms": 38480.016, "load_time_ms": 1.313, "grad_time_ms": 1070.465, "update_time_ms": 6.0, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.1075421571731567, "policy_loss": -0.014228861778974533, "vf_loss": 1.1176432371139526, "vf_explained_var": 0.9335149526596069, "kl": 0.01271185651421547, "entropy": 1.2438668012619019, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10387, "done": false, "timesteps_total": 1808154, "episodes_total": 3946, "training_iteration": 175, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-08-44", "timestamp": 1589882924, "time_this_iter_s": 37.251614570617676, "time_total_s": 7469.058478832245, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186c0c80>", "on_episode_step": "<function on_episode_step at 0x7fef203f2c80>", "on_episode_end": "<function on_episode_end at 0x7fef203f2048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203f2510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187bd268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7469.058478832245, "timesteps_since_restore": 1808154, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 82.40370370370368, "ram_util_percent": 30.5}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": 0.0374792, "episode_len_mean": 479.27, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0374792}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.509891491248286, "avg_speed_min": 2.044372576152793, "avg_speed_max": 8.04468012184372, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.18965806178469, "mean_processing_ms": 2.8976455521163142, "mean_inference_ms": 0.2736943442085329}, "off_policy_estimator": {}, "info": {"num_steps_trained": 412800, "num_steps_sampled": 1818689, "sample_time_ms": 38705.776, "load_time_ms": 1.319, "grad_time_ms": 1080.023, "update_time_ms": 6.082, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.116812825202942, "policy_loss": -0.01649608090519905, "vf_loss": 1.127881646156311, "vf_explained_var": 0.8884065747261047, "kl": 0.01671314239501953, "entropy": 1.299751877784729, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10535, "done": false, "timesteps_total": 1818689, "episodes_total": 3968, "training_iteration": 176, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-09-25", "timestamp": 1589882965, "time_this_iter_s": 40.89705038070679, "time_total_s": 7509.955529212952, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187bd6a8>", "on_episode_step": "<function on_episode_step at 0x7fef185a99d8>", "on_episode_end": "<function on_episode_end at 0x7fef185a9bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef185a9ea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187b0378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7509.955529212952, "timesteps_since_restore": 1818689, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 83.80344827586205, "ram_util_percent": 30.515517241379307}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.06502400000000001, "episode_len_mean": 475.59, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06502400000000001}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.433346590167193, "avg_speed_min": 2.044372576152793, "avg_speed_max": 7.645884296988231, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.18463729322483, "mean_processing_ms": 2.8968704423272085, "mean_inference_ms": 0.2734536434724699}, "off_policy_estimator": {}, "info": {"num_steps_trained": 415360, "num_steps_sampled": 1829198, "sample_time_ms": 39084.953, "load_time_ms": 1.372, "grad_time_ms": 1153.725, "update_time_ms": 5.881, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6370700597763062, "policy_loss": -0.011577591300010681, "vf_loss": 1.6458669900894165, "vf_explained_var": 0.8796717524528503, "kl": 0.008563105948269367, "entropy": 1.3413803577423096, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10509, "done": false, "timesteps_total": 1829198, "episodes_total": 3990, "training_iteration": 177, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-10-10", "timestamp": 1589883010, "time_this_iter_s": 44.40720009803772, "time_total_s": 7554.362729310989, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187b0620>", "on_episode_step": "<function on_episode_step at 0x7fef182079d8>", "on_episode_end": "<function on_episode_end at 0x7fef18207a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18207ae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18207840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7554.362729310989, "timesteps_since_restore": 1829198, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 84.78253968253965, "ram_util_percent": 30.57619047619047}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.27002119999999996, "episode_len_mean": 467.34, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27002119999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.310598177688089, "avg_speed_min": 2.044372576152793, "avg_speed_max": 7.645884296988231, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.186008711704886, "mean_processing_ms": 2.89628271670043, "mean_inference_ms": 0.27348147931125105}, "off_policy_estimator": {}, "info": {"num_steps_trained": 417536, "num_steps_sampled": 1839736, "sample_time_ms": 39307.256, "load_time_ms": 1.36, "grad_time_ms": 1150.699, "update_time_ms": 6.054, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.1064003705978394, "policy_loss": -0.01830495521426201, "vf_loss": 1.1221354007720947, "vf_explained_var": 0.9104971289634705, "kl": 0.007913628593087196, "entropy": 1.2601957321166992, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10538, "done": false, "timesteps_total": 1839736, "episodes_total": 4013, "training_iteration": 178, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-10-53", "timestamp": 1589883053, "time_this_iter_s": 43.05947184562683, "time_total_s": 7597.422201156616, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18207950>", "on_episode_step": "<function on_episode_step at 0x7fef1846cbf8>", "on_episode_end": "<function on_episode_end at 0x7fef1846cc80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1846cd08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef184ec400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7597.422201156616, "timesteps_since_restore": 1839736, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 82.43870967741935, "ram_util_percent": 30.58225806451612}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.16502289999999997, "episode_len_mean": 475.56, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16502289999999997}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.160590887898718, "avg_speed_min": 2.044372576152793, "avg_speed_max": 7.130082900697156, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.16934855077005, "mean_processing_ms": 2.895203906876511, "mean_inference_ms": 0.2729781013080213}, "off_policy_estimator": {}, "info": {"num_steps_trained": 419968, "num_steps_sampled": 1850210, "sample_time_ms": 39443.056, "load_time_ms": 1.324, "grad_time_ms": 1191.832, "update_time_ms": 6.03, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.1649727821350098, "policy_loss": -0.017787769436836243, "vf_loss": 1.1805278062820435, "vf_explained_var": 0.8863069415092468, "kl": 0.006875455379486084, "entropy": 1.2958145141601562, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10474, "done": false, "timesteps_total": 1850210, "episodes_total": 4033, "training_iteration": 179, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-11-37", "timestamp": 1589883097, "time_this_iter_s": 43.9283390045166, "time_total_s": 7641.350540161133, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201421e0>", "on_episode_step": "<function on_episode_step at 0x7fef201428c8>", "on_episode_end": "<function on_episode_end at 0x7fef1846ca60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1846cae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1846c730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7641.350540161133, "timesteps_since_restore": 1850210, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 81.86984126984126, "ram_util_percent": 30.577777777777765}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.1700228, "episode_len_mean": 468.24, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.171740202020202}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.9814358307427278, "avg_speed_min": 1.278847067173131, "avg_speed_max": 7.130082900697156, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.181248862259316, "mean_processing_ms": 2.8954002977674542, "mean_inference_ms": 0.2732906611834348}, "off_policy_estimator": {}, "info": {"num_steps_trained": 422400, "num_steps_sampled": 1860658, "sample_time_ms": 39384.606, "load_time_ms": 1.264, "grad_time_ms": 1196.516, "update_time_ms": 5.992, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2740434408187866, "policy_loss": -0.012003736570477486, "vf_loss": 1.2833548784255981, "vf_explained_var": 0.8981183767318726, "kl": 0.00829092413187027, "entropy": 1.2936593294143677, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10448, "done": false, "timesteps_total": 1860658, "episodes_total": 4057, "training_iteration": 180, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-12-18", "timestamp": 1589883138, "time_this_iter_s": 40.820642948150635, "time_total_s": 7682.171183109283, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186c0158>", "on_episode_step": "<function on_episode_step at 0x7fef186c0b70>", "on_episode_end": "<function on_episode_end at 0x7fef186c0bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef186c0d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef183dd620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7682.171183109283, "timesteps_since_restore": 1860658, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 78.80344827586208, "ram_util_percent": 30.593103448275855}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.3725205000000001, "episode_len_mean": 464.47, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.37628333333333336}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8885295010396077, "avg_speed_min": 1.278847067173131, "avg_speed_max": 7.025442561333651, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.179544162799942, "mean_processing_ms": 2.896115457256505, "mean_inference_ms": 0.27327982461881684}, "off_policy_estimator": {}, "info": {"num_steps_trained": 424832, "num_steps_sampled": 1870927, "sample_time_ms": 40027.163, "load_time_ms": 1.342, "grad_time_ms": 1239.021, "update_time_ms": 6.036, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.942488193511963, "policy_loss": -0.007705787196755409, "vf_loss": 1.9471954107284546, "vf_explained_var": 0.8730571269989014, "kl": 0.009233939461410046, "entropy": 1.2911498546600342, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10269, "done": false, "timesteps_total": 1870927, "episodes_total": 4079, "training_iteration": 181, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-13-00", "timestamp": 1589883180, "time_this_iter_s": 41.98578095436096, "time_total_s": 7724.156964063644, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186c0950>", "on_episode_step": "<function on_episode_step at 0x7fef18207bf8>", "on_episode_end": "<function on_episode_end at 0x7fef184ec400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef184ec488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187b0bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7724.156964063644, "timesteps_since_restore": 1870927, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 81.42, "ram_util_percent": 30.598333333333326}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.16752000000000003, "episode_len_mean": 472.31, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1692121212121212}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.95967455590578, "avg_speed_min": 1.278847067173131, "avg_speed_max": 7.094417702885653, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.169056212636434, "mean_processing_ms": 2.895870771372744, "mean_inference_ms": 0.27305793393436245}, "off_policy_estimator": {}, "info": {"num_steps_trained": 426624, "num_steps_sampled": 1881336, "sample_time_ms": 39964.667, "load_time_ms": 1.351, "grad_time_ms": 1269.721, "update_time_ms": 6.045, "learner": {"av": {"cur_kl_coeff": 0.32473209500312805, "cur_lr": 4.999999873689376e-05, "total_loss": 1.0112594366073608, "policy_loss": 0.004948303569108248, "vf_loss": 1.004939317703247, "vf_explained_var": 0.8820837140083313, "kl": 0.0042239646427333355, "entropy": 1.4295037984848022, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10409, "done": false, "timesteps_total": 1881336, "episodes_total": 4100, "training_iteration": 182, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-13-39", "timestamp": 1589883219, "time_this_iter_s": 38.86148285865784, "time_total_s": 7763.018446922302, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef181adc80>", "on_episode_step": "<function on_episode_step at 0x7fed545c4f28>", "on_episode_end": "<function on_episode_end at 0x7fef1807a048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1807a0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1807a730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7763.018446922302, "timesteps_since_restore": 1881336, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 82.03272727272726, "ram_util_percent": 30.599999999999987}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.16752189999999995, "episode_len_mean": 472.26, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16921404040404037}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.999877931600513, "avg_speed_min": 1.278847067173131, "avg_speed_max": 7.094417702885653, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.166840084382766, "mean_processing_ms": 2.8958101970796144, "mean_inference_ms": 0.27308356315767435}, "off_policy_estimator": {}, "info": {"num_steps_trained": 428928, "num_steps_sampled": 1891629, "sample_time_ms": 39996.434, "load_time_ms": 1.361, "grad_time_ms": 1317.637, "update_time_ms": 5.947, "learner": {"av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1.187598705291748, "policy_loss": -0.008536581881344318, "vf_loss": 1.1945334672927856, "vf_explained_var": 0.8953385949134827, "kl": 0.009866131469607353, "entropy": 1.3272243738174438, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10293, "done": false, "timesteps_total": 1891629, "episodes_total": 4121, "training_iteration": 183, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-14-20", "timestamp": 1589883260, "time_this_iter_s": 40.85015678405762, "time_total_s": 7803.86860370636, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1807ae18>", "on_episode_step": "<function on_episode_step at 0x7fed5450e840>", "on_episode_end": "<function on_episode_end at 0x7fed5450e8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed5450e950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed5450eea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7803.86860370636, "timesteps_since_restore": 1891629, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 80.40677966101696, "ram_util_percent": 30.599999999999994}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.16501920000000003, "episode_len_mean": 476.88, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16501920000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.06900437405555, "avg_speed_min": 1.278847067173131, "avg_speed_max": 7.324368825788883, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.152772803486588, "mean_processing_ms": 2.8945121050147704, "mean_inference_ms": 0.2728565073193369}, "off_policy_estimator": {}, "info": {"num_steps_trained": 430976, "num_steps_sampled": 1902045, "sample_time_ms": 39901.612, "load_time_ms": 1.355, "grad_time_ms": 1304.65, "update_time_ms": 5.95, "learner": {"av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1.091006875038147, "policy_loss": -0.01860933005809784, "vf_loss": 1.1073273420333862, "vf_explained_var": 0.9099311828613281, "kl": 0.014097163453698158, "entropy": 1.529856562614441, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10416, "done": false, "timesteps_total": 1902045, "episodes_total": 4143, "training_iteration": 184, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-15-00", "timestamp": 1589883300, "time_this_iter_s": 40.180962324142456, "time_total_s": 7844.049566030502, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed544de7b8>", "on_episode_step": "<function on_episode_step at 0x7fed544de840>", "on_episode_end": "<function on_episode_end at 0x7fed544de8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed544de950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187bdae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7844.049566030502, "timesteps_since_restore": 1902045, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 81.96842105263157, "ram_util_percent": 30.599999999999998}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.1600191, "episode_len_mean": 484.11, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1600191}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.315447605850475, "avg_speed_min": 2.4715158197218825, "avg_speed_max": 7.747534778430495, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.137398447416544, "mean_processing_ms": 2.8928002440476552, "mean_inference_ms": 0.272562826902207}, "off_policy_estimator": {}, "info": {"num_steps_trained": 432768, "num_steps_sampled": 1912451, "sample_time_ms": 40078.091, "load_time_ms": 1.328, "grad_time_ms": 1318.511, "update_time_ms": 5.963, "learner": {"av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1.3016955852508545, "policy_loss": -0.010062353685498238, "vf_loss": 1.3099089860916138, "vf_explained_var": 0.8987634778022766, "kl": 0.01138700358569622, "entropy": 1.4366592168807983, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10406, "done": false, "timesteps_total": 1912451, "episodes_total": 4165, "training_iteration": 185, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-15-39", "timestamp": 1589883339, "time_this_iter_s": 39.15508031845093, "time_total_s": 7883.204646348953, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed5448f620>", "on_episode_step": "<function on_episode_step at 0x7fef18703f28>", "on_episode_end": "<function on_episode_end at 0x7fef18703598>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18703e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed5450e950>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7883.204646348953, "timesteps_since_restore": 1912451, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 81.675, "ram_util_percent": 30.612500000000004}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.05752309999999999, "episode_len_mean": 487.88, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.05752309999999999}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.528748819671891, "avg_speed_min": 2.599304452448362, "avg_speed_max": 7.747534778430495, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.126211027073264, "mean_processing_ms": 2.8920761238653823, "mean_inference_ms": 0.27230809684388374}, "off_policy_estimator": {}, "info": {"num_steps_trained": 434432, "num_steps_sampled": 1922934, "sample_time_ms": 39813.882, "load_time_ms": 1.326, "grad_time_ms": 1312.81, "update_time_ms": 5.856, "learner": {"av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 0.6111873388290405, "policy_loss": -0.015443304553627968, "vf_loss": 0.6245455145835876, "vf_explained_var": 0.9308130741119385, "kl": 0.012841780669987202, "entropy": 1.7018853425979614, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10483, "done": false, "timesteps_total": 1922934, "episodes_total": 4186, "training_iteration": 186, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-16-18", "timestamp": 1589883378, "time_this_iter_s": 38.19742751121521, "time_total_s": 7921.4020738601685, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed5448f510>", "on_episode_step": "<function on_episode_step at 0x7fed542b7c80>", "on_episode_end": "<function on_episode_end at 0x7fed542b7d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed542b7d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed54366488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7921.4020738601685, "timesteps_since_restore": 1922934, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 81.16363636363639, "ram_util_percent": 30.661818181818184}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.1600262, "episode_len_mean": 484.15, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1600262}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.424184020051422, "avg_speed_min": 2.599304452448362, "avg_speed_max": 7.747534778430495, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.114157012908546, "mean_processing_ms": 2.8912129924669214, "mean_inference_ms": 0.27206782792197065}, "off_policy_estimator": {}, "info": {"num_steps_trained": 436608, "num_steps_sampled": 1933253, "sample_time_ms": 39268.791, "load_time_ms": 1.302, "grad_time_ms": 1289.224, "update_time_ms": 6.083, "learner": {"av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 3.033832311630249, "policy_loss": -0.014587335288524628, "vf_loss": 3.0452651977539062, "vf_explained_var": 0.769711971282959, "kl": 0.019427331164479256, "entropy": 1.4444085359573364, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10319, "done": false, "timesteps_total": 1933253, "episodes_total": 4207, "training_iteration": 187, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-16-56", "timestamp": 1589883416, "time_this_iter_s": 38.72593307495117, "time_total_s": 7960.12800693512, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed5447b950>", "on_episode_step": "<function on_episode_step at 0x7fef1846c510>", "on_episode_end": "<function on_episode_end at 0x7fef1846c730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1846c8c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1846c268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7960.12800693512, "timesteps_since_restore": 1933253, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 79.92363636363639, "ram_util_percent": 30.683636363636364}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": 0.0424714, "episode_len_mean": 488.48, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0424714}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.544953226824535, "avg_speed_min": 1.8709042327440963, "avg_speed_max": 7.747534778430495, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.1014905682199, "mean_processing_ms": 2.8904808905355437, "mean_inference_ms": 0.2718056999284831}, "off_policy_estimator": {}, "info": {"num_steps_trained": 438528, "num_steps_sampled": 1943459, "sample_time_ms": 38749.131, "load_time_ms": 1.3, "grad_time_ms": 1275.557, "update_time_ms": 6.098, "learner": {"av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2893433570861816, "policy_loss": -0.01180525217205286, "vf_loss": 1.2990028858184814, "vf_explained_var": 0.8916206359863281, "kl": 0.01321615744382143, "entropy": 1.6335816383361816, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10206, "done": false, "timesteps_total": 1943459, "episodes_total": 4228, "training_iteration": 188, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-17-34", "timestamp": 1589883454, "time_this_iter_s": 37.726943254470825, "time_total_s": 7997.85495018959, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54300ea0>", "on_episode_step": "<function on_episode_step at 0x7fed5448f598>", "on_episode_end": "<function on_episode_end at 0x7fed5448f0d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed5448f158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed5448fd08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 7997.85495018959, "timesteps_since_restore": 1943459, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 81.44074074074075, "ram_util_percent": 30.69074074074074}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.16253150000000002, "episode_len_mean": 480.86, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.16253150000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.39339579267164, "avg_speed_min": 1.8709042327440963, "avg_speed_max": 7.450716700717946, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.092105119845932, "mean_processing_ms": 2.890097193149287, "mean_inference_ms": 0.2716199545856123}, "off_policy_estimator": {}, "info": {"num_steps_trained": 440704, "num_steps_sampled": 1953837, "sample_time_ms": 38293.782, "load_time_ms": 1.282, "grad_time_ms": 1255.49, "update_time_ms": 6.167, "learner": {"av": {"cur_kl_coeff": 0.16236604750156403, "cur_lr": 4.999999873689376e-05, "total_loss": 2.232914686203003, "policy_loss": -0.025982357561588287, "vf_loss": 2.2549657821655273, "vf_explained_var": 0.8450570702552795, "kl": 0.024212496355175972, "entropy": 1.4238948822021484, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10378, "done": false, "timesteps_total": 1953837, "episodes_total": 4250, "training_iteration": 189, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-18-13", "timestamp": 1589883493, "time_this_iter_s": 39.17596960067749, "time_total_s": 8037.030919790268, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef20142b70>", "on_episode_step": "<function on_episode_step at 0x7fef182be0d0>", "on_episode_end": "<function on_episode_end at 0x7fef182be2f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef182be6a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef187b7b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8037.030919790268, "timesteps_since_restore": 1953837, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 80.06428571428572, "ram_util_percent": 30.69464285714285}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.06752830000000003, "episode_len_mean": 473.03, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06752830000000003}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.187346507344406, "avg_speed_min": 1.2092226017577947, "avg_speed_max": 7.450716700717946, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.08626132887209, "mean_processing_ms": 2.8904786747807356, "mean_inference_ms": 0.2716029516394041}, "off_policy_estimator": {}, "info": {"num_steps_trained": 442880, "num_steps_sampled": 1963992, "sample_time_ms": 38189.177, "load_time_ms": 1.306, "grad_time_ms": 1247.004, "update_time_ms": 6.738, "learner": {"av": {"cur_kl_coeff": 0.24354907870292664, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2365083694458008, "policy_loss": -0.01422439981251955, "vf_loss": 1.248185634613037, "vf_explained_var": 0.8791755437850952, "kl": 0.010458065196871758, "entropy": 1.2750635147094727, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10155, "done": false, "timesteps_total": 1963992, "episodes_total": 4273, "training_iteration": 190, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-18-53", "timestamp": 1589883533, "time_this_iter_s": 39.69708490371704, "time_total_s": 8076.728004693985, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187b7bf8>", "on_episode_step": "<function on_episode_step at 0x7fef1847d1e0>", "on_episode_end": "<function on_episode_end at 0x7fef203f26a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203f2d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203f2ae8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8076.728004693985, "timesteps_since_restore": 1963992, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 80.74035087719298, "ram_util_percent": 30.696491228070172}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": -0.17502099999999995, "episode_len_mean": 459.96, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17678888888888888}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.147101089854217, "avg_speed_min": 1.2092226017577947, "avg_speed_max": 7.450716700717946, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.08244251476711, "mean_processing_ms": 2.891226229139984, "mean_inference_ms": 0.27156666828464443}, "off_policy_estimator": {}, "info": {"num_steps_trained": 444928, "num_steps_sampled": 1974177, "sample_time_ms": 38130.575, "load_time_ms": 1.278, "grad_time_ms": 1231.675, "update_time_ms": 6.712, "learner": {"av": {"cur_kl_coeff": 0.24354907870292664, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7250769138336182, "policy_loss": -0.017293725162744522, "vf_loss": 1.7398240566253662, "vf_explained_var": 0.8680673837661743, "kl": 0.010456044226884842, "entropy": 1.3411986827850342, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10185, "done": false, "timesteps_total": 1974177, "episodes_total": 4297, "training_iteration": 191, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-19-34", "timestamp": 1589883574, "time_this_iter_s": 41.24606537818909, "time_total_s": 8117.974070072174, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed5447be18>", "on_episode_step": "<function on_episode_step at 0x7fed5447ba60>", "on_episode_end": "<function on_episode_end at 0x7fed5447b8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed5447b840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef182be7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8117.974070072174, "timesteps_since_restore": 1974177, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 81.03898305084746, "ram_util_percent": 30.7}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.4875192, "episode_len_mean": 440.73, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.49244363636363625}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.131004110928319, "avg_speed_min": 1.2092226017577947, "avg_speed_max": 7.660269463046504, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.086007704157122, "mean_processing_ms": 2.8922857750575486, "mean_inference_ms": 0.2716992417039938}, "off_policy_estimator": {}, "info": {"num_steps_trained": 447104, "num_steps_sampled": 1984348, "sample_time_ms": 38376.62, "load_time_ms": 1.319, "grad_time_ms": 1249.333, "update_time_ms": 6.796, "learner": {"av": {"cur_kl_coeff": 0.24354907870292664, "cur_lr": 4.999999873689376e-05, "total_loss": 2.5874760150909424, "policy_loss": -0.020112402737140656, "vf_loss": 2.6031079292297363, "vf_explained_var": 0.9025368690490723, "kl": 0.018396887928247452, "entropy": 1.293105959892273, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10171, "done": false, "timesteps_total": 1984348, "episodes_total": 4321, "training_iteration": 192, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-20-16", "timestamp": 1589883616, "time_this_iter_s": 41.498862743377686, "time_total_s": 8159.472932815552, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185a9b70>", "on_episode_step": "<function on_episode_step at 0x7fef20318488>", "on_episode_end": "<function on_episode_end at 0x7fef20318510>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20318598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185a91e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8159.472932815552, "timesteps_since_restore": 1984348, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 81.51525423728815, "ram_util_percent": 30.698305084745762}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.2850135999999999, "episode_len_mean": 443.19, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2878925252525252}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.159445182983219, "avg_speed_min": 1.2092226017577947, "avg_speed_max": 7.660269463046504, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.074587623666005, "mean_processing_ms": 2.892366094523664, "mean_inference_ms": 0.2714667882976618}, "off_policy_estimator": {}, "info": {"num_steps_trained": 449280, "num_steps_sampled": 1994666, "sample_time_ms": 38438.352, "load_time_ms": 1.348, "grad_time_ms": 1230.749, "update_time_ms": 6.727, "learner": {"av": {"cur_kl_coeff": 0.24354907870292664, "cur_lr": 4.999999873689376e-05, "total_loss": 1.383839726448059, "policy_loss": -0.02045472338795662, "vf_loss": 1.398240089416504, "vf_explained_var": 0.8738293647766113, "kl": 0.024859817698597908, "entropy": 1.4638023376464844, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10318, "done": false, "timesteps_total": 1994666, "episodes_total": 4343, "training_iteration": 193, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-20-57", "timestamp": 1589883657, "time_this_iter_s": 41.277222871780396, "time_total_s": 8200.750155687332, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed5447bbf8>", "on_episode_step": "<function on_episode_step at 0x7fed5447b598>", "on_episode_end": "<function on_episode_end at 0x7fef20318400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1847d048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203f2ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8200.750155687332, "timesteps_since_restore": 1994666, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 83.01355932203391, "ram_util_percent": 30.7}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.2775171, "episode_len_mean": 455.23, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.28032030303030303}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.320210409551072, "avg_speed_min": 1.2826329873191964, "avg_speed_max": 7.83788103110964, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.053149879859276, "mean_processing_ms": 2.890841985480999, "mean_inference_ms": 0.27093286766714636}, "off_policy_estimator": {}, "info": {"num_steps_trained": 450816, "num_steps_sampled": 2004960, "sample_time_ms": 38146.853, "load_time_ms": 1.351, "grad_time_ms": 1203.413, "update_time_ms": 6.635, "learner": {"av": {"cur_kl_coeff": 0.36532360315322876, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4606622457504272, "policy_loss": -0.006663220468908548, "vf_loss": 1.4634342193603516, "vf_explained_var": 0.8921553492546082, "kl": 0.010651018470525742, "entropy": 1.3569892644882202, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10294, "done": false, "timesteps_total": 2004960, "episodes_total": 4364, "training_iteration": 194, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-21-34", "timestamp": 1589883694, "time_this_iter_s": 36.99143671989441, "time_total_s": 8237.741592407227, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f7b70>", "on_episode_step": "<function on_episode_step at 0x7fef182be8c8>", "on_episode_end": "<function on_episode_end at 0x7fef182be9d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef182beea0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1847d268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8237.741592407227, "timesteps_since_restore": 2004960, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 83.5358490566038, "ram_util_percent": 30.701886792452832}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": -0.0725159, "episode_len_mean": 463.05, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07324838383838383}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.349342388518834, "avg_speed_min": 1.2826329873191964, "avg_speed_max": 7.83788103110964, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 23.046659211918072, "mean_processing_ms": 2.890866051326357, "mean_inference_ms": 0.27068692306762565}, "off_policy_estimator": {}, "info": {"num_steps_trained": 452992, "num_steps_sampled": 2015156, "sample_time_ms": 38165.302, "load_time_ms": 1.364, "grad_time_ms": 1212.617, "update_time_ms": 6.48, "learner": {"av": {"cur_kl_coeff": 0.36532360315322876, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4143439531326294, "policy_loss": -0.02648027054965496, "vf_loss": 1.4349231719970703, "vf_explained_var": 0.8990120887756348, "kl": 0.01615312695503235, "entropy": 1.445084810256958, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10196, "done": false, "timesteps_total": 2015156, "episodes_total": 4384, "training_iteration": 195, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-22-14", "timestamp": 1589883734, "time_this_iter_s": 39.42632079124451, "time_total_s": 8277.167913198471, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204f7a60>", "on_episode_step": "<function on_episode_step at 0x7fef200b0a60>", "on_episode_end": "<function on_episode_end at 0x7fef200b0b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200b0bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef200b0e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8277.167913198471, "timesteps_since_restore": 2015156, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 82.29464285714286, "ram_util_percent": 30.699999999999996}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.27251919999999996, "episode_len_mean": 463.3, "episodes_this_iter": 25, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2752719191919192}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.500277433758672, "avg_speed_min": 2.0645500596437447, "avg_speed_max": 7.83788103110964, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.037639461495154, "mean_processing_ms": 2.8900424641112483, "mean_inference_ms": 0.27050853386736556}, "off_policy_estimator": {}, "info": {"num_steps_trained": 454528, "num_steps_sampled": 2025442, "sample_time_ms": 38215.779, "load_time_ms": 1.363, "grad_time_ms": 1194.75, "update_time_ms": 6.471, "learner": {"av": {"cur_kl_coeff": 0.36532360315322876, "cur_lr": 4.999999873689376e-05, "total_loss": 4.77193546295166, "policy_loss": -0.01525890827178955, "vf_loss": 4.783681869506836, "vf_explained_var": 0.8416460156440735, "kl": 0.009615317918360233, "entropy": 1.3845950365066528, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10286, "done": false, "timesteps_total": 2025442, "episodes_total": 4409, "training_iteration": 196, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-22-53", "timestamp": 1589883773, "time_this_iter_s": 38.515339374542236, "time_total_s": 8315.683252573013, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1847dc80>", "on_episode_step": "<function on_episode_step at 0x7fef204f7268>", "on_episode_end": "<function on_episode_end at 0x7fef204f77b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200b09d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1847d488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8315.683252573013, "timesteps_since_restore": 2025442, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 79.94727272727275, "ram_util_percent": 30.700000000000003}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.06251699999999999, "episode_len_mean": 479.75, "episodes_this_iter": 21, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.0631484848484848}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 4.453448244535741, "avg_speed_min": 2.0645500596437447, "avg_speed_max": 7.83788103110964, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.00980550466882, "mean_processing_ms": 2.888572658702439, "mean_inference_ms": 0.26988030203690844}, "off_policy_estimator": {}, "info": {"num_steps_trained": 456448, "num_steps_sampled": 2035967, "sample_time_ms": 38345.119, "load_time_ms": 1.36, "grad_time_ms": 1176.884, "update_time_ms": 6.328, "learner": {"av": {"cur_kl_coeff": 0.36532360315322876, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7888352870941162, "policy_loss": -0.010387817397713661, "vf_loss": 1.7962886095046997, "vf_explained_var": 0.8415960073471069, "kl": 0.008032516576349735, "entropy": 1.3759093284606934, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10525, "done": false, "timesteps_total": 2035967, "episodes_total": 4430, "training_iteration": 197, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-23-32", "timestamp": 1589883812, "time_this_iter_s": 39.83315181732178, "time_total_s": 8355.516404390335, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185a98c8>", "on_episode_step": "<function on_episode_step at 0x7fef187d1158>", "on_episode_end": "<function on_episode_end at 0x7fef187d12f0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187d1400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185a9730>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8355.516404390335, "timesteps_since_restore": 2035967, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 82.88070175438597, "ram_util_percent": 30.701754385964907}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.0600203, "episode_len_mean": 483.99, "episodes_this_iter": 21, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.060626565656565636}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 4.553618441651708, "avg_speed_min": 2.0645500596437447, "avg_speed_max": 7.83788103110964, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.005634852397087, "mean_processing_ms": 2.8884537332051714, "mean_inference_ms": 0.2697486646791994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 458368, "num_steps_sampled": 2046455, "sample_time_ms": 38523.624, "load_time_ms": 1.371, "grad_time_ms": 1167.923, "update_time_ms": 6.302, "learner": {"av": {"cur_kl_coeff": 0.36532360315322876, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4828896522521973, "policy_loss": -0.004181787371635437, "vf_loss": 1.4851725101470947, "vf_explained_var": 0.8748723864555359, "kl": 0.0051970514468848705, "entropy": 1.2933001518249512, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10488, "done": false, "timesteps_total": 2046455, "episodes_total": 4451, "training_iteration": 198, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-24-12", "timestamp": 1589883852, "time_this_iter_s": 39.420156955718994, "time_total_s": 8394.936561346054, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18756f28>", "on_episode_step": "<function on_episode_step at 0x7fef20340158>", "on_episode_end": "<function on_episode_end at 0x7fef20340620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef20340730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef186b6f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8394.936561346054, "timesteps_since_restore": 2046455, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 82.09107142857144, "ram_util_percent": 30.707142857142856}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.21251919999999994, "episode_len_mean": 480.13, "episodes_this_iter": 22, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.21466585858585857}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 4.414469967108299, "avg_speed_min": 2.0645500596437447, "avg_speed_max": 7.181101259785974, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 23.00202951238414, "mean_processing_ms": 2.887541031012544, "mean_inference_ms": 0.2696739660970393}, "off_policy_estimator": {}, "info": {"num_steps_trained": 460672, "num_steps_sampled": 2057083, "sample_time_ms": 38856.854, "load_time_ms": 1.364, "grad_time_ms": 1142.71, "update_time_ms": 6.146, "learner": {"av": {"cur_kl_coeff": 0.36532360315322876, "cur_lr": 4.999999873689376e-05, "total_loss": 1.284548282623291, "policy_loss": -0.007731026969850063, "vf_loss": 1.2899565696716309, "vf_explained_var": 0.9121872782707214, "kl": 0.006358293816447258, "entropy": 1.3052364587783813, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10628, "done": false, "timesteps_total": 2057083, "episodes_total": 4473, "training_iteration": 199, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-24-54", "timestamp": 1589883894, "time_this_iter_s": 42.250219106674194, "time_total_s": 8437.186780452728, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2026cc80>", "on_episode_step": "<function on_episode_step at 0x7fef2026c8c8>", "on_episode_end": "<function on_episode_end at 0x7fef2026cae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2026cf28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2026c7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8437.186780452728, "timesteps_since_restore": 2057083, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 82.26166666666667, "ram_util_percent": 30.71833333333333}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.06502599999999997, "episode_len_mean": 476.07, "episodes_this_iter": 23, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06568282828282826}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 4.387030158277082, "avg_speed_min": 1.5867308746945377, "avg_speed_max": 7.181101259785974, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 22.99972806707462, "mean_processing_ms": 2.887760195985684, "mean_inference_ms": 0.2695456281646531}, "off_policy_estimator": {}, "info": {"num_steps_trained": 462464, "num_steps_sampled": 2067543, "sample_time_ms": 39014.579, "load_time_ms": 1.34, "grad_time_ms": 1104.979, "update_time_ms": 5.629, "learner": {"av": {"cur_kl_coeff": 0.36532360315322876, "cur_lr": 4.999999873689376e-05, "total_loss": 0.833168089389801, "policy_loss": -0.005065873730927706, "vf_loss": 0.8368896842002869, "vf_explained_var": 0.9199761748313904, "kl": 0.003679839428514242, "entropy": 1.7005401849746704, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10460, "done": false, "timesteps_total": 2067543, "episodes_total": 4496, "training_iteration": 200, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-25-35", "timestamp": 1589883935, "time_this_iter_s": 40.888497829437256, "time_total_s": 8478.075278282166, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203a4400>", "on_episode_step": "<function on_episode_step at 0x7fef204ff950>", "on_episode_end": "<function on_episode_end at 0x7fef204ff8c8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204ffc80>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef204ffe18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8478.075278282166, "timesteps_since_restore": 2067543, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 83.48474576271187, "ram_util_percent": 30.76779661016949}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.012523499999999996, "episode_len_mean": 480.13, "episodes_this_iter": 21, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.012649999999999979}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.46439377148068, "avg_speed_min": 1.5867308746945377, "avg_speed_max": 8.01389488998452, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 22.987505868672702, "mean_processing_ms": 2.8871579247611, "mean_inference_ms": 0.2692702188027087}, "off_policy_estimator": {}, "info": {"num_steps_trained": 464512, "num_steps_sampled": 2077747, "sample_time_ms": 38573.443, "load_time_ms": 1.366, "grad_time_ms": 1107.227, "update_time_ms": 5.552, "learner": {"av": {"cur_kl_coeff": 0.18266180157661438, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7832422256469727, "policy_loss": -0.025343917310237885, "vf_loss": 1.8046748638153076, "vf_explained_var": 0.8788480758666992, "kl": 0.021412186324596405, "entropy": 1.3755450248718262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10204, "done": false, "timesteps_total": 2077747, "episodes_total": 4517, "training_iteration": 201, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-26-12", "timestamp": 1589883972, "time_this_iter_s": 36.86238884925842, "time_total_s": 8514.937667131424, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185a9598>", "on_episode_step": "<function on_episode_step at 0x7fef201a5c80>", "on_episode_end": "<function on_episode_end at 0x7fef204ffd90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201da1e0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18703a60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8514.937667131424, "timesteps_since_restore": 2077747, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 79.21538461538461, "ram_util_percent": 30.767307692307693}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.11752379999999997, "episode_len_mean": 471.49, "episodes_this_iter": 21, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.11992224489795915}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.3961600767731515, "avg_speed_min": 1.5867308746945377, "avg_speed_max": 8.01389488998452, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 22.98914126571005, "mean_processing_ms": 2.8870193405890308, "mean_inference_ms": 0.2693203829549603}, "off_policy_estimator": {}, "info": {"num_steps_trained": 466688, "num_steps_sampled": 2087909, "sample_time_ms": 38498.015, "load_time_ms": 1.33, "grad_time_ms": 1095.598, "update_time_ms": 5.472, "learner": {"av": {"cur_kl_coeff": 0.27399271726608276, "cur_lr": 4.999999873689376e-05, "total_loss": 2.138787269592285, "policy_loss": -0.011241602711379528, "vf_loss": 2.1478099822998047, "vf_explained_var": 0.8538335561752319, "kl": 0.008098388090729713, "entropy": 1.3840932846069336, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10162, "done": false, "timesteps_total": 2087909, "episodes_total": 4538, "training_iteration": 202, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-26-53", "timestamp": 1589884013, "time_this_iter_s": 40.62667226791382, "time_total_s": 8555.564339399338, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef203a42f0>", "on_episode_step": "<function on_episode_step at 0x7fef185d5e18>", "on_episode_end": "<function on_episode_end at 0x7fef185d5268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef185d52f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed5450e6a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8555.564339399338, "timesteps_since_restore": 2087909, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 81.07758620689656, "ram_util_percent": 30.79310344827586}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -15.00002, "episode_reward_mean": -0.2225223, "episode_len_mean": 463.64, "episodes_this_iter": 22, "policy_reward_min": {"av": -15.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.22706357142857136}, "custom_metrics": {"num_ped_collisions_mean": 0.01, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.296649561588739, "avg_speed_min": 1.5867308746945377, "avg_speed_max": 8.01389488998452, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": 500, "avg_rl_veh_arrival_max": 500}, "sampler_perf": {"mean_env_wait_ms": 22.989194499601634, "mean_processing_ms": 2.886708291201488, "mean_inference_ms": 0.2693126651388616}, "off_policy_estimator": {}, "info": {"num_steps_trained": 468864, "num_steps_sampled": 2098133, "sample_time_ms": 38513.485, "load_time_ms": 1.297, "grad_time_ms": 1094.259, "update_time_ms": 5.494, "learner": {"av": {"cur_kl_coeff": 0.27399271726608276, "cur_lr": 4.999999873689376e-05, "total_loss": 1.3641583919525146, "policy_loss": 0.0001685877941781655, "vf_loss": 1.3625342845916748, "vf_explained_var": 0.9285776615142822, "kl": 0.005312495864927769, "entropy": 1.4929627180099487, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10224, "done": false, "timesteps_total": 2098133, "episodes_total": 4560, "training_iteration": 203, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-27-34", "timestamp": 1589884054, "time_this_iter_s": 41.41771912574768, "time_total_s": 8596.982058525085, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1838d9d8>", "on_episode_step": "<function on_episode_step at 0x7fef1838d840>", "on_episode_end": "<function on_episode_end at 0x7fef1838d158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1838d268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1838dc80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8596.982058525085, "timesteps_since_restore": 2098133, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 82.86166666666666, "ram_util_percent": 30.796666666666667}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00002, "episode_reward_mean": -0.17751869999999997, "episode_len_mean": 455.72, "episodes_this_iter": 26, "policy_reward_min": {"av": -10.00002}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17931181818181816}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.214956570509335, "avg_speed_min": 1.5867308746945377, "avg_speed_max": 8.037377667202284, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.98698610330043, "mean_processing_ms": 2.8859205054750827, "mean_inference_ms": 0.2693659308705041}, "off_policy_estimator": {}, "info": {"num_steps_trained": 470912, "num_steps_sampled": 2108775, "sample_time_ms": 38990.858, "load_time_ms": 1.335, "grad_time_ms": 1128.415, "update_time_ms": 5.641, "learner": {"av": {"cur_kl_coeff": 0.27399271726608276, "cur_lr": 4.999999873689376e-05, "total_loss": 3.9265098571777344, "policy_loss": -0.004440865479409695, "vf_loss": 3.930020570755005, "vf_explained_var": 0.771946132183075, "kl": 0.003393983468413353, "entropy": 1.3550740480422974, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10642, "done": false, "timesteps_total": 2108775, "episodes_total": 4586, "training_iteration": 204, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-28-16", "timestamp": 1589884096, "time_this_iter_s": 42.107213497161865, "time_total_s": 8639.089272022247, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef182bed90>", "on_episode_step": "<function on_episode_step at 0x7fef182beea0>", "on_episode_end": "<function on_episode_end at 0x7fed5447b378>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed5447bbf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef182f9d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8639.089272022247, "timesteps_since_restore": 2108775, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 82.61833333333333, "ram_util_percent": 30.796666666666667}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.37751889999999994, "episode_len_mean": 455.66, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.3813322222222222}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.040290948606158, "avg_speed_min": 1.6642219003810217, "avg_speed_max": 8.037377667202284, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.988603513937235, "mean_processing_ms": 2.8859629669443816, "mean_inference_ms": 0.26938470163324213}, "off_policy_estimator": {}, "info": {"num_steps_trained": 473344, "num_steps_sampled": 2119231, "sample_time_ms": 39370.377, "load_time_ms": 1.345, "grad_time_ms": 1164.443, "update_time_ms": 5.654, "learner": {"av": {"cur_kl_coeff": 0.13699635863304138, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7925529479980469, "policy_loss": -0.018897416070103645, "vf_loss": 1.8092386722564697, "vf_explained_var": 0.8934858441352844, "kl": 0.016145601868629456, "entropy": 1.4037134647369385, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10456, "done": false, "timesteps_total": 2119231, "episodes_total": 4608, "training_iteration": 205, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-29-00", "timestamp": 1589884140, "time_this_iter_s": 43.588878870010376, "time_total_s": 8682.678150892258, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54366950>", "on_episode_step": "<function on_episode_step at 0x7fed54366f28>", "on_episode_end": "<function on_episode_end at 0x7fed54366620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54366730>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185d5f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8682.678150892258, "timesteps_since_restore": 2119231, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 83.89032258064516, "ram_util_percent": 30.799999999999997}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.17252320000000002, "episode_len_mean": 463.84, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17252320000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.1634624488186125, "avg_speed_min": 1.6642219003810217, "avg_speed_max": 8.037377667202284, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.98282669938625, "mean_processing_ms": 2.885448398733565, "mean_inference_ms": 0.2691824640896796}, "off_policy_estimator": {}, "info": {"num_steps_trained": 475008, "num_steps_sampled": 2130011, "sample_time_ms": 39474.647, "load_time_ms": 1.349, "grad_time_ms": 1188.327, "update_time_ms": 5.634, "learner": {"av": {"cur_kl_coeff": 0.13699635863304138, "cur_lr": 4.999999873689376e-05, "total_loss": 1.201564073562622, "policy_loss": -0.017477484419941902, "vf_loss": 1.2152255773544312, "vf_explained_var": 0.8930400609970093, "kl": 0.027855264022946358, "entropy": 1.7476484775543213, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10780, "done": false, "timesteps_total": 2130011, "episodes_total": 4631, "training_iteration": 206, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-29-40", "timestamp": 1589884180, "time_this_iter_s": 39.80101776123047, "time_total_s": 8722.479168653488, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54366158>", "on_episode_step": "<function on_episode_step at 0x7fed545adf28>", "on_episode_end": "<function on_episode_end at 0x7fed54566048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed545ade18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed54566620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8722.479168653488, "timesteps_since_restore": 2130011, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 83.63684210526316, "ram_util_percent": 30.8}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.17502189999999998, "episode_len_mean": 460.28, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17502189999999998}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.222291594928126, "avg_speed_min": 1.3437055755461869, "avg_speed_max": 8.469425432378781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.980587915218248, "mean_processing_ms": 2.885399332143406, "mean_inference_ms": 0.2690617491386902}, "off_policy_estimator": {}, "info": {"num_steps_trained": 476928, "num_steps_sampled": 2140387, "sample_time_ms": 39431.336, "load_time_ms": 1.355, "grad_time_ms": 1180.61, "update_time_ms": 5.847, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.651903510093689, "policy_loss": -0.005501598585397005, "vf_loss": 1.6554718017578125, "vf_explained_var": 0.8725061416625977, "kl": 0.009408104233443737, "entropy": 1.4208930730819702, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10376, "done": false, "timesteps_total": 2140387, "episodes_total": 4652, "training_iteration": 207, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-30-19", "timestamp": 1589884219, "time_this_iter_s": 39.328898429870605, "time_total_s": 8761.808067083359, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed545668c8>", "on_episode_step": "<function on_episode_step at 0x7fef185d5d90>", "on_episode_end": "<function on_episode_end at 0x7fef185d5268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef185d5d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185d51e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8761.808067083359, "timesteps_since_restore": 2140387, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 85.10357142857141, "ram_util_percent": 30.800000000000004}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.17252089999999998, "episode_len_mean": 463.88, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17604173469387763}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.440046313879915, "avg_speed_min": 1.3437055755461869, "avg_speed_max": 8.469425432378781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.973296845903242, "mean_processing_ms": 2.8855136000673265, "mean_inference_ms": 0.268654597964826}, "off_policy_estimator": {}, "info": {"num_steps_trained": 478592, "num_steps_sampled": 2150650, "sample_time_ms": 39415.282, "load_time_ms": 1.33, "grad_time_ms": 1153.663, "update_time_ms": 5.979, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 3.38468074798584, "policy_loss": -0.007890386506915092, "vf_loss": 3.390883445739746, "vf_explained_var": 0.8327106833457947, "kl": 0.008214173838496208, "entropy": 1.4147757291793823, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10263, "done": false, "timesteps_total": 2150650, "episodes_total": 4676, "training_iteration": 208, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-30-59", "timestamp": 1589884259, "time_this_iter_s": 38.99095129966736, "time_total_s": 8800.799018383026, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54366d90>", "on_episode_step": "<function on_episode_step at 0x7fed54545a60>", "on_episode_end": "<function on_episode_end at 0x7fed54545ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54545b70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185d5598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8800.799018383026, "timesteps_since_restore": 2150650, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 83.77678571428571, "ram_util_percent": 30.800000000000004}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.1750198, "episode_len_mean": 459.37, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.18043278350515463}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.721113143335398, "avg_speed_min": 1.3437055755461869, "avg_speed_max": 8.469425432378781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.96390802974132, "mean_processing_ms": 2.885077942957249, "mean_inference_ms": 0.26834117805461605}, "off_policy_estimator": {}, "info": {"num_steps_trained": 480384, "num_steps_sampled": 2161033, "sample_time_ms": 39113.502, "load_time_ms": 1.322, "grad_time_ms": 1130.726, "update_time_ms": 6.138, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4669586420059204, "policy_loss": -0.015008482150733471, "vf_loss": 1.478307843208313, "vf_explained_var": 0.8692563772201538, "kl": 0.01780639961361885, "entropy": 1.333099603652954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10383, "done": false, "timesteps_total": 2161033, "episodes_total": 4698, "training_iteration": 209, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-31-38", "timestamp": 1589884298, "time_this_iter_s": 39.00496959686279, "time_total_s": 8839.803987979889, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed5432c620>", "on_episode_step": "<function on_episode_step at 0x7fed5432c598>", "on_episode_end": "<function on_episode_end at 0x7fed54366158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54366e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed544ded08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8839.803987979889, "timesteps_since_restore": 2161033, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 83.91454545454546, "ram_util_percent": 30.807272727272725}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.07251969999999998, "episode_len_mean": 463.2, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07476257731958762}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.834542230807657, "avg_speed_min": 1.3437055755461869, "avg_speed_max": 8.469425432378781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.955875532213494, "mean_processing_ms": 2.8856465436848406, "mean_inference_ms": 0.2679799996548957}, "off_policy_estimator": {}, "info": {"num_steps_trained": 482176, "num_steps_sampled": 2171332, "sample_time_ms": 38862.031, "load_time_ms": 1.32, "grad_time_ms": 1133.919, "update_time_ms": 6.144, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8819475173950195, "policy_loss": -0.007841179147362709, "vf_loss": 1.8874132633209229, "vf_explained_var": 0.8677772283554077, "kl": 0.011558621190488338, "entropy": 1.4567292928695679, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10299, "done": false, "timesteps_total": 2171332, "episodes_total": 4719, "training_iteration": 210, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-32-16", "timestamp": 1589884336, "time_this_iter_s": 38.40649938583374, "time_total_s": 8878.210487365723, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18296e18>", "on_episode_step": "<function on_episode_step at 0x7fef182026a8>", "on_episode_end": "<function on_episode_end at 0x7fef18202730>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef182027b8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18202598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8878.210487365723, "timesteps_since_restore": 2171332, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 82.95818181818181, "ram_util_percent": 30.834545454545456}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.0725222, "episode_len_mean": 462.9, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07554395833333333}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.87323754793615, "avg_speed_min": 1.3437055755461869, "avg_speed_max": 8.469425432378781, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.950589698760506, "mean_processing_ms": 2.885607720044042, "mean_inference_ms": 0.26778613509282395}, "off_policy_estimator": {}, "info": {"num_steps_trained": 483840, "num_steps_sampled": 2181703, "sample_time_ms": 38997.443, "load_time_ms": 1.301, "grad_time_ms": 1101.914, "update_time_ms": 6.288, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.503077745437622, "policy_loss": -0.01111507322639227, "vf_loss": 1.512782335281372, "vf_explained_var": 0.8874077200889587, "kl": 0.0068636490032076836, "entropy": 1.4945528507232666, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10371, "done": false, "timesteps_total": 2181703, "episodes_total": 4741, "training_iteration": 211, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-32-54", "timestamp": 1589884374, "time_this_iter_s": 37.89299702644348, "time_total_s": 8916.103484392166, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed5432c510>", "on_episode_step": "<function on_episode_step at 0x7fef18296ea0>", "on_episode_end": "<function on_episode_end at 0x7fef18296d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18202620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef180db7b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8916.103484392166, "timesteps_since_restore": 2181703, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 82.34814814814817, "ram_util_percent": 30.87037037037037}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": 0.03247730000000002, "episode_len_mean": 471.23, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.033481752577319605}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.647483073465004, "avg_speed_min": 1.3446952165493071, "avg_speed_max": 8.809427487611142, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.9496063513456, "mean_processing_ms": 2.884702468510659, "mean_inference_ms": 0.26773374180375875}, "off_policy_estimator": {}, "info": {"num_steps_trained": 485760, "num_steps_sampled": 2192226, "sample_time_ms": 38947.124, "load_time_ms": 1.344, "grad_time_ms": 1105.879, "update_time_ms": 6.369, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4798412322998047, "policy_loss": -0.016741624101996422, "vf_loss": 1.4930559396743774, "vf_explained_var": 0.8814691305160522, "kl": 0.01716325618326664, "entropy": 1.1625908613204956, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10523, "done": false, "timesteps_total": 2192226, "episodes_total": 4764, "training_iteration": 212, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-33-34", "timestamp": 1589884414, "time_this_iter_s": 40.16763758659363, "time_total_s": 8956.27112197876, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185a9598>", "on_episode_step": "<function on_episode_step at 0x7fef182f9ae8>", "on_episode_end": "<function on_episode_end at 0x7fef182f9d08>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef182f92f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185d5ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 8956.27112197876, "timesteps_since_restore": 2192226, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 82.84482758620692, "ram_util_percent": 30.88275862068966}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": 0.02997909999999999, "episode_len_mean": 466.71, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.030590918367346953}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.464577511428413, "avg_speed_min": 1.3446952165493071, "avg_speed_max": 8.809427487611142, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.93281775403971, "mean_processing_ms": 2.884650886050762, "mean_inference_ms": 0.26726847972265994}, "off_policy_estimator": {}, "info": {"num_steps_trained": 488192, "num_steps_sampled": 2202857, "sample_time_ms": 39200.503, "load_time_ms": 1.344, "grad_time_ms": 1108.224, "update_time_ms": 6.406, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 2.3758063316345215, "policy_loss": -0.010967290960252285, "vf_loss": 2.3841259479522705, "vf_explained_var": 0.8309261202812195, "kl": 0.012882968410849571, "entropy": 1.048499345779419, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10631, "done": false, "timesteps_total": 2202857, "episodes_total": 4788, "training_iteration": 213, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-34-18", "timestamp": 1589884458, "time_this_iter_s": 43.975438594818115, "time_total_s": 9000.246560573578, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef1810c7b8>", "on_episode_step": "<function on_episode_step at 0x7fed54566b70>", "on_episode_end": "<function on_episode_end at 0x7fed54366158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54366488>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed54366e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9000.246560573578, "timesteps_since_restore": 2202857, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 82.3758064516129, "ram_util_percent": 30.90000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.07252069999999998, "episode_len_mean": 462.69, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07325323232323237}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.480572183580379, "avg_speed_min": 1.3446952165493071, "avg_speed_max": 8.809427487611142, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.932477107879095, "mean_processing_ms": 2.884277721398155, "mean_inference_ms": 0.26730622523685565}, "off_policy_estimator": {}, "info": {"num_steps_trained": 490112, "num_steps_sampled": 2213309, "sample_time_ms": 38934.579, "load_time_ms": 1.297, "grad_time_ms": 1073.641, "update_time_ms": 6.258, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2677947282791138, "policy_loss": -0.006932585500180721, "vf_loss": 1.2736371755599976, "vf_explained_var": 0.8911372423171997, "kl": 0.005304780788719654, "entropy": 1.5241773128509521, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10452, "done": false, "timesteps_total": 2213309, "episodes_total": 4810, "training_iteration": 214, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-34-57", "timestamp": 1589884497, "time_this_iter_s": 39.09848594665527, "time_total_s": 9039.345046520233, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed541c2730>", "on_episode_step": "<function on_episode_step at 0x7fed541c26a8>", "on_episode_end": "<function on_episode_end at 0x7fed541c2f28>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed541df048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed541c2ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9039.345046520233, "timesteps_since_restore": 2213309, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 83.43392857142858, "ram_util_percent": 30.89821428571429}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": 0.032480599999999984, "episode_len_mean": 471.19, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.032480599999999984}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.398673128511607, "avg_speed_min": 1.3446952165493071, "avg_speed_max": 8.809427487611142, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.92830207388668, "mean_processing_ms": 2.8839076814270648, "mean_inference_ms": 0.2671493692011075}, "off_policy_estimator": {}, "info": {"num_steps_trained": 492416, "num_steps_sampled": 2223810, "sample_time_ms": 38909.134, "load_time_ms": 1.293, "grad_time_ms": 1039.665, "update_time_ms": 6.272, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5650944709777832, "policy_loss": -0.010255436412990093, "vf_loss": 1.5725048780441284, "vf_explained_var": 0.8703256249427795, "kl": 0.013844354078173637, "entropy": 1.128100872039795, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10501, "done": false, "timesteps_total": 2223810, "episodes_total": 4831, "training_iteration": 215, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-35-41", "timestamp": 1589884541, "time_this_iter_s": 42.98921465873718, "time_total_s": 9082.33426117897, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18192268>", "on_episode_step": "<function on_episode_step at 0x7fed542746a8>", "on_episode_end": "<function on_episode_end at 0x7fed54274620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54441048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed54274ea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9082.33426117897, "timesteps_since_restore": 2223810, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 82.84838709677419, "ram_util_percent": 30.90000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00003, "episode_reward_mean": -0.0675165, "episode_len_mean": 471.2, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00003}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.0675165}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.330614921426152, "avg_speed_min": 1.6571822157707872, "avg_speed_max": 7.648386519070736, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.921531617590905, "mean_processing_ms": 2.8838614214140974, "mean_inference_ms": 0.26693800716540045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 494592, "num_steps_sampled": 2234239, "sample_time_ms": 39062.455, "load_time_ms": 1.333, "grad_time_ms": 1066.217, "update_time_ms": 6.288, "learner": {"av": {"cur_kl_coeff": 0.20549453794956207, "cur_lr": 4.999999873689376e-05, "total_loss": 1.541914939880371, "policy_loss": -0.009206992574036121, "vf_loss": 1.5504519939422607, "vf_explained_var": 0.9061897397041321, "kl": 0.0032609549816697836, "entropy": 1.3909916877746582, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10429, "done": false, "timesteps_total": 2234239, "episodes_total": 4853, "training_iteration": 216, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-36-22", "timestamp": 1589884582, "time_this_iter_s": 41.5996732711792, "time_total_s": 9123.93393445015, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54274950>", "on_episode_step": "<function on_episode_step at 0x7fed542749d8>", "on_episode_end": "<function on_episode_end at 0x7fed54274a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54274d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18296840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9123.93393445015, "timesteps_since_restore": 2234239, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 84.6322033898305, "ram_util_percent": 30.900000000000006}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": -0.17001739999999996, "episode_len_mean": 467.86, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17001739999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.4471951415336175, "avg_speed_min": 1.571418559659066, "avg_speed_max": 8.071878768365098, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.935362589743633, "mean_processing_ms": 2.8841026899496596, "mean_inference_ms": 0.26728607714555525}, "off_policy_estimator": {}, "info": {"num_steps_trained": 496384, "num_steps_sampled": 2244712, "sample_time_ms": 39232.734, "load_time_ms": 1.333, "grad_time_ms": 1073.771, "update_time_ms": 6.152, "learner": {"av": {"cur_kl_coeff": 0.10274726897478104, "cur_lr": 4.999999873689376e-05, "total_loss": 6.002683162689209, "policy_loss": -0.0169058945029974, "vf_loss": 6.017099857330322, "vf_explained_var": 0.8179045915603638, "kl": 0.0242228452116251, "entropy": 1.4175406694412231, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10473, "done": false, "timesteps_total": 2244712, "episodes_total": 4877, "training_iteration": 217, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-37-03", "timestamp": 1589884623, "time_this_iter_s": 41.10525298118591, "time_total_s": 9165.039187431335, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18296d90>", "on_episode_step": "<function on_episode_step at 0x7fed54566d08>", "on_episode_end": "<function on_episode_end at 0x7fed54566488>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54566400>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed54566510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9165.039187431335, "timesteps_since_restore": 2244712, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 84.46271186440678, "ram_util_percent": 30.901694915254243}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": 0.0324819, "episode_len_mean": 471.9, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.0324819}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.468800177088552, "avg_speed_min": 1.571418559659066, "avg_speed_max": 8.071878768365098, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.936505744069493, "mean_processing_ms": 2.883467962559018, "mean_inference_ms": 0.26727887233446546}, "off_policy_estimator": {}, "info": {"num_steps_trained": 498176, "num_steps_sampled": 2255192, "sample_time_ms": 39432.692, "load_time_ms": 1.385, "grad_time_ms": 1087.009, "update_time_ms": 6.115, "learner": {"av": {"cur_kl_coeff": 0.15412090718746185, "cur_lr": 4.999999873689376e-05, "total_loss": 2.2511394023895264, "policy_loss": -0.0082422886043787, "vf_loss": 2.2582223415374756, "vf_explained_var": 0.8570846915245056, "kl": 0.007524013519287109, "entropy": 1.3548574447631836, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10480, "done": false, "timesteps_total": 2255192, "episodes_total": 4900, "training_iteration": 218, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-37-45", "timestamp": 1589884665, "time_this_iter_s": 41.123796224594116, "time_total_s": 9206.16298365593, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54566d90>", "on_episode_step": "<function on_episode_step at 0x7fed545662f0>", "on_episode_end": "<function on_episode_end at 0x7fed54566620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed545669d8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed543667b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9206.16298365593, "timesteps_since_restore": 2255192, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 82.95084745762712, "ram_util_percent": 30.900000000000006}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": 0.03248260000000002, "episode_len_mean": 471.9, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03248260000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.402815896457053, "avg_speed_min": 1.571418559659066, "avg_speed_max": 8.071878768365098, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.939594901067448, "mean_processing_ms": 2.8835008753354696, "mean_inference_ms": 0.2672693690214197}, "off_policy_estimator": {}, "info": {"num_steps_trained": 500608, "num_steps_sampled": 2265786, "sample_time_ms": 39740.494, "load_time_ms": 1.395, "grad_time_ms": 1132.148, "update_time_ms": 6.011, "learner": {"av": {"cur_kl_coeff": 0.15412090718746185, "cur_lr": 4.999999873689376e-05, "total_loss": 2.1727445125579834, "policy_loss": -0.01013847254216671, "vf_loss": 2.1802024841308594, "vf_explained_var": 0.8283239603042603, "kl": 0.017391767352819443, "entropy": 0.8529008626937866, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10594, "done": false, "timesteps_total": 2265786, "episodes_total": 4921, "training_iteration": 219, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-38-27", "timestamp": 1589884707, "time_this_iter_s": 42.53365969657898, "time_total_s": 9248.696643352509, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed543662f0>", "on_episode_step": "<function on_episode_step at 0x7fed543661e0>", "on_episode_end": "<function on_episode_end at 0x7fed543660d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed543666a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed5432c1e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9248.696643352509, "timesteps_since_restore": 2265786, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 82.41833333333334, "ram_util_percent": 30.90000000000001}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.17501919999999996, "episode_len_mean": 460.21, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17501919999999996}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.383601226721408, "avg_speed_min": 1.5419229074681042, "avg_speed_max": 8.071878768365098, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.94330325249842, "mean_processing_ms": 2.8829417845286907, "mean_inference_ms": 0.2673634384648229}, "off_policy_estimator": {}, "info": {"num_steps_trained": 502784, "num_steps_sampled": 2276195, "sample_time_ms": 39905.117, "load_time_ms": 1.404, "grad_time_ms": 1176.308, "update_time_ms": 6.017, "learner": {"av": {"cur_kl_coeff": 0.15412090718746185, "cur_lr": 4.999999873689376e-05, "total_loss": 2.2700135707855225, "policy_loss": -0.022559676319360733, "vf_loss": 2.288825511932373, "vf_explained_var": 0.8999857306480408, "kl": 0.02431635744869709, "entropy": 1.5275497436523438, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10409, "done": false, "timesteps_total": 2276195, "episodes_total": 4945, "training_iteration": 220, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-39-08", "timestamp": 1589884748, "time_this_iter_s": 40.49655294418335, "time_total_s": 9289.193196296692, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54566268>", "on_episode_step": "<function on_episode_step at 0x7fed545666a8>", "on_episode_end": "<function on_episode_end at 0x7fed54566c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54566d90>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18296268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9289.193196296692, "timesteps_since_restore": 2276195, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 80.87758620689655, "ram_util_percent": 30.900000000000006}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.07001940000000002, "episode_len_mean": 468.65, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07001940000000002}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.24478608268778, "avg_speed_min": 1.4309862524953614, "avg_speed_max": 8.066420389988268, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.925569995917648, "mean_processing_ms": 2.882027882399409, "mean_inference_ms": 0.2668654697589794}, "off_policy_estimator": {}, "info": {"num_steps_trained": 504832, "num_steps_sampled": 2286596, "sample_time_ms": 40000.203, "load_time_ms": 1.378, "grad_time_ms": 1203.535, "update_time_ms": 6.427, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.5320396423339844, "policy_loss": -0.00693153589963913, "vf_loss": 1.5368576049804688, "vf_explained_var": 0.8852419853210449, "kl": 0.009142180904746056, "entropy": 1.448971152305603, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10401, "done": false, "timesteps_total": 2286596, "episodes_total": 4966, "training_iteration": 221, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-39-47", "timestamp": 1589884787, "time_this_iter_s": 39.1181480884552, "time_total_s": 9328.311344385147, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185268c8>", "on_episode_step": "<function on_episode_step at 0x7fef18526950>", "on_episode_end": "<function on_episode_end at 0x7fef185269d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18526a60>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed544da400>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9328.311344385147, "timesteps_since_restore": 2286596, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 83.84285714285713, "ram_util_percent": 30.900000000000002}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.1700213, "episode_len_mean": 469.88, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1700213}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.265212670549018, "avg_speed_min": 1.2574687537216374, "avg_speed_max": 8.066420389988268, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.918528390668975, "mean_processing_ms": 2.8814528612682966, "mean_inference_ms": 0.26667980864832674}, "off_policy_estimator": {}, "info": {"num_steps_trained": 506752, "num_steps_sampled": 2297150, "sample_time_ms": 39948.252, "load_time_ms": 1.338, "grad_time_ms": 1196.134, "update_time_ms": 6.328, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7267957925796509, "policy_loss": -0.0018608416430652142, "vf_loss": 1.7269619703292847, "vf_explained_var": 0.9002171754837036, "kl": 0.007331590633839369, "entropy": 1.4720251560211182, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10554, "done": false, "timesteps_total": 2297150, "episodes_total": 4990, "training_iteration": 222, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-40-27", "timestamp": 1589884827, "time_this_iter_s": 39.570473194122314, "time_total_s": 9367.88181757927, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185267b8>", "on_episode_step": "<function on_episode_step at 0x7fef18526e18>", "on_episode_end": "<function on_episode_end at 0x7fef18526ea0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18526840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2009aa60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9367.88181757927, "timesteps_since_restore": 2297150, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 82.53928571428573, "ram_util_percent": 30.90535714285715}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.1750231, "episode_len_mean": 461.63, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1750231}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.381701861663065, "avg_speed_min": 1.2574687537216374, "avg_speed_max": 8.066420389988268, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.923988240935373, "mean_processing_ms": 2.881926108495073, "mean_inference_ms": 0.2668063299698817}, "off_policy_estimator": {}, "info": {"num_steps_trained": 508672, "num_steps_sampled": 2307486, "sample_time_ms": 39541.231, "load_time_ms": 1.339, "grad_time_ms": 1182.085, "update_time_ms": 6.273, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.544749140739441, "policy_loss": -0.0031337642576545477, "vf_loss": 1.5461763143539429, "vf_explained_var": 0.8948602080345154, "kl": 0.00738266296684742, "entropy": 1.2143906354904175, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10336, "done": false, "timesteps_total": 2307486, "episodes_total": 5012, "training_iteration": 223, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-41-06", "timestamp": 1589884866, "time_this_iter_s": 39.76509642601013, "time_total_s": 9407.64691400528, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18526d90>", "on_episode_step": "<function on_episode_step at 0x7fef201ce950>", "on_episode_end": "<function on_episode_end at 0x7fef201cea60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201ceae8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2054c378>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9407.64691400528, "timesteps_since_restore": 2307486, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 81.93508771929824, "ram_util_percent": 30.961403508771934}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.0001, "episode_reward_mean": -0.1725231, "episode_len_mean": 465.4, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.0001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1725231}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.433514038791301, "avg_speed_min": 1.2574687537216374, "avg_speed_max": 8.066420389988268, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.90769178218109, "mean_processing_ms": 2.881282358876673, "mean_inference_ms": 0.26636528256951353}, "off_policy_estimator": {}, "info": {"num_steps_trained": 510592, "num_steps_sampled": 2317963, "sample_time_ms": 39541.377, "load_time_ms": 1.328, "grad_time_ms": 1186.046, "update_time_ms": 6.348, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4159849882125854, "policy_loss": -0.005882560275495052, "vf_loss": 1.419914722442627, "vf_explained_var": 0.8809877634048462, "kl": 0.008447927422821522, "entropy": 1.3050543069839478, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10477, "done": false, "timesteps_total": 2317963, "episodes_total": 5033, "training_iteration": 224, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-41-46", "timestamp": 1589884906, "time_this_iter_s": 39.142948627471924, "time_total_s": 9446.789862632751, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2009a7b8>", "on_episode_step": "<function on_episode_step at 0x7fef2009ad90>", "on_episode_end": "<function on_episode_end at 0x7fef2009a620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2009abf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef201ce158>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9446.789862632751, "timesteps_since_restore": 2317963, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 83.23571428571428, "ram_util_percent": 30.994642857142853}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00007, "episode_reward_mean": 0.13497749999999997, "episode_len_mean": 476.02, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00007}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1363409090909091}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.531909458634196, "avg_speed_min": 1.2574687537216374, "avg_speed_max": 7.8438675011173, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.90066683119401, "mean_processing_ms": 2.880827181567864, "mean_inference_ms": 0.26618617700297764}, "off_policy_estimator": {}, "info": {"num_steps_trained": 512384, "num_steps_sampled": 2328502, "sample_time_ms": 39100.192, "load_time_ms": 1.352, "grad_time_ms": 1192.284, "update_time_ms": 6.395, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.1365036964416504, "policy_loss": -0.018464189022779465, "vf_loss": 1.1522893905639648, "vf_explained_var": 0.9165260195732117, "kl": 0.011585965752601624, "entropy": 1.2184568643569946, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10539, "done": false, "timesteps_total": 2328502, "episodes_total": 5055, "training_iteration": 225, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-42-24", "timestamp": 1589884944, "time_this_iter_s": 38.64379954338074, "time_total_s": 9485.433662176132, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201ce950>", "on_episode_step": "<function on_episode_step at 0x7fef201a5400>", "on_episode_end": "<function on_episode_end at 0x7fef201a5a60>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a5510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1847d840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9485.433662176132, "timesteps_since_restore": 2328502, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 82.92363636363636, "ram_util_percent": 31.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00001, "episode_reward_mean": 0.13248010000000002, "episode_len_mean": 471.7, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00001}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13381828282828284}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.692619640614801, "avg_speed_min": 1.2574687537216374, "avg_speed_max": 8.2418060439628, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.888756720896016, "mean_processing_ms": 2.8798853079475077, "mean_inference_ms": 0.26591032061208564}, "off_policy_estimator": {}, "info": {"num_steps_trained": 514048, "num_steps_sampled": 2338914, "sample_time_ms": 38906.212, "load_time_ms": 1.311, "grad_time_ms": 1159.964, "update_time_ms": 6.675, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.3598527908325195, "policy_loss": -0.016919352114200592, "vf_loss": 2.373713493347168, "vf_explained_var": 0.8508833646774292, "kl": 0.013229132629930973, "entropy": 1.3778306245803833, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10412, "done": false, "timesteps_total": 2338914, "episodes_total": 5077, "training_iteration": 226, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-43-04", "timestamp": 1589884984, "time_this_iter_s": 39.337780475616455, "time_total_s": 9524.771442651749, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef2009a7b8>", "on_episode_step": "<function on_episode_step at 0x7fef201a5268>", "on_episode_end": "<function on_episode_end at 0x7fef201a5e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef201a52f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203d1510>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9524.771442651749, "timesteps_since_restore": 2338914, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 83.24385964912281, "ram_util_percent": 31.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": 0.029979500000000013, "episode_len_mean": 466.23, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03059132653061224}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.876742919688178, "avg_speed_min": 1.5395929896617053, "avg_speed_max": 8.2418060439628, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.875783867988385, "mean_processing_ms": 2.8793526357119985, "mean_inference_ms": 0.2655256040256044}, "off_policy_estimator": {}, "info": {"num_steps_trained": 515328, "num_steps_sampled": 2349415, "sample_time_ms": 38585.387, "load_time_ms": 1.283, "grad_time_ms": 1103.154, "update_time_ms": 6.731, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6015523672103882, "policy_loss": -0.007476876024156809, "vf_loss": 1.6065998077392578, "vf_explained_var": 0.8815271258354187, "kl": 0.010509231127798557, "entropy": 1.601586937904358, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10501, "done": false, "timesteps_total": 2349415, "episodes_total": 5101, "training_iteration": 227, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-43-41", "timestamp": 1589885021, "time_this_iter_s": 37.3286452293396, "time_total_s": 9562.100087881088, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201a5488>", "on_episode_step": "<function on_episode_step at 0x7fef203d1840>", "on_episode_end": "<function on_episode_end at 0x7fef203d1ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef203d1620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203d1bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9562.100087881088, "timesteps_since_restore": 2349415, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 84.34150943396226, "ram_util_percent": 31.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": 0.03248240000000002, "episode_len_mean": 470.0, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.03348701030927838}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.925264602141892, "avg_speed_min": 1.5395929896617053, "avg_speed_max": 8.2418060439628, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.85866724533266, "mean_processing_ms": 2.8778595654589196, "mean_inference_ms": 0.26504752800538617}, "off_policy_estimator": {}, "info": {"num_steps_trained": 517120, "num_steps_sampled": 2359952, "sample_time_ms": 38503.446, "load_time_ms": 1.238, "grad_time_ms": 1096.076, "update_time_ms": 6.599, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.7016910314559937, "policy_loss": -0.01857580430805683, "vf_loss": 1.7166403532028198, "vf_explained_var": 0.8600765466690063, "kl": 0.015686776489019394, "entropy": 1.1126638650894165, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10537, "done": false, "timesteps_total": 2359952, "episodes_total": 5123, "training_iteration": 228, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-44-22", "timestamp": 1589885062, "time_this_iter_s": 40.23235273361206, "time_total_s": 9602.3324406147, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef186b6840>", "on_episode_step": "<function on_episode_step at 0x7fef185d5ea0>", "on_episode_end": "<function on_episode_end at 0x7fef185d5ae8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef185d5510>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1871e048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9602.3324406147, "timesteps_since_restore": 2359952, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 84.03859649122805, "ram_util_percent": 31.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.000029999999999, "episode_reward_mean": 0.029981300000000006, "episode_len_mean": 465.5, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.000029999999999}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.031230520833333348}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.868972456195931, "avg_speed_min": 1.5395929896617053, "avg_speed_max": 8.38320510425461, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.8577015716828, "mean_processing_ms": 2.8778719324730098, "mean_inference_ms": 0.26491118906208966}, "off_policy_estimator": {}, "info": {"num_steps_trained": 519168, "num_steps_sampled": 2370501, "sample_time_ms": 38325.453, "load_time_ms": 1.234, "grad_time_ms": 1074.471, "update_time_ms": 6.517, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.0757362842559814, "policy_loss": -0.008458048105239868, "vf_loss": 2.0825276374816895, "vf_explained_var": 0.8545700907707214, "kl": 0.00720860343426466, "entropy": 1.0827525854110718, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10549, "done": false, "timesteps_total": 2370501, "episodes_total": 5145, "training_iteration": 229, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-45-02", "timestamp": 1589885102, "time_this_iter_s": 40.53919816017151, "time_total_s": 9642.871638774872, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18703d90>", "on_episode_step": "<function on_episode_step at 0x7fef18422598>", "on_episode_end": "<function on_episode_end at 0x7fef18422b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18422d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18703d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9642.871638774872, "timesteps_since_restore": 2370501, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 82.77241379310345, "ram_util_percent": 31.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.07251949999999996, "episode_len_mean": 461.59, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.0747623711340206}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.7200651608416955, "avg_speed_min": 1.5314467166247863, "avg_speed_max": 8.38320510425461, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.845380794668586, "mean_processing_ms": 2.878104239826903, "mean_inference_ms": 0.2644608097774455}, "off_policy_estimator": {}, "info": {"num_steps_trained": 521216, "num_steps_sampled": 2380920, "sample_time_ms": 38459.986, "load_time_ms": 1.226, "grad_time_ms": 1047.312, "update_time_ms": 6.442, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 4.723340034484863, "policy_loss": -0.009258517064154148, "vf_loss": 4.731240749359131, "vf_explained_var": 0.8440858125686646, "kl": 0.00587350782006979, "entropy": 1.4149410724639893, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10419, "done": false, "timesteps_total": 2380920, "episodes_total": 5169, "training_iteration": 230, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-45-44", "timestamp": 1589885144, "time_this_iter_s": 41.56795263290405, "time_total_s": 9684.439591407776, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18561d90>", "on_episode_step": "<function on_episode_step at 0x7fef18561c80>", "on_episode_end": "<function on_episode_end at 0x7fef18561bf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187e7950>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2009ad90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9684.439591407776, "timesteps_since_restore": 2380920, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 83.19999999999999, "ram_util_percent": 31.0}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.17251969999999997, "episode_len_mean": 463.17, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17604051020408162}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.639174828027167, "avg_speed_min": 1.5314467166247863, "avg_speed_max": 8.38320510425461, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.858723279555555, "mean_processing_ms": 2.8791136647366233, "mean_inference_ms": 0.2646656296970461}, "off_policy_estimator": {}, "info": {"num_steps_trained": 523136, "num_steps_sampled": 2391436, "sample_time_ms": 38722.237, "load_time_ms": 1.244, "grad_time_ms": 1021.204, "update_time_ms": 6.046, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.5678558349609375, "policy_loss": -0.020598748698830605, "vf_loss": 2.5841152667999268, "vf_explained_var": 0.87613844871521, "kl": 0.018769172951579094, "entropy": 1.199367642402649, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10516, "done": false, "timesteps_total": 2391436, "episodes_total": 5192, "training_iteration": 231, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-46-25", "timestamp": 1589885185, "time_this_iter_s": 41.47690033912659, "time_total_s": 9725.916491746902, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18561f28>", "on_episode_step": "<function on_episode_step at 0x7fef18561e18>", "on_episode_end": "<function on_episode_end at 0x7fef187e7158>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef186b68c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20142268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9725.916491746902, "timesteps_since_restore": 2391436, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 84.8813559322034, "ram_util_percent": 31.015254237288133}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.1750197, "episode_len_mean": 456.82, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17678757575757573}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.704977974127279, "avg_speed_min": 1.2933486596844188, "avg_speed_max": 8.38320510425461, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.862540385211897, "mean_processing_ms": 2.8799070975699834, "mean_inference_ms": 0.26468948498581657}, "off_policy_estimator": {}, "info": {"num_steps_trained": 524928, "num_steps_sampled": 2402007, "sample_time_ms": 38668.491, "load_time_ms": 1.236, "grad_time_ms": 998.944, "update_time_ms": 6.011, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 3.0772271156311035, "policy_loss": -0.02042303793132305, "vf_loss": 3.094897747039795, "vf_explained_var": 0.894342303276062, "kl": 0.01190868578851223, "entropy": 1.4337399005889893, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10571, "done": false, "timesteps_total": 2402007, "episodes_total": 5216, "training_iteration": 232, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-47-04", "timestamp": 1589885224, "time_this_iter_s": 38.80955171585083, "time_total_s": 9764.726043462753, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18106950>", "on_episode_step": "<function on_episode_step at 0x7fef187b02f0>", "on_episode_end": "<function on_episode_end at 0x7fef187b0048>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef187b0620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18106598>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9764.726043462753, "timesteps_since_restore": 2402007, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 81.00363636363637, "ram_util_percent": 31.06545454545454}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.17751809999999993, "episode_len_mean": 452.98, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.179311212121212}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.685548155586909, "avg_speed_min": 1.2933486596844188, "avg_speed_max": 8.38320510425461, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.856807336840976, "mean_processing_ms": 2.8798610174034764, "mean_inference_ms": 0.2645153566593045}, "off_policy_estimator": {}, "info": {"num_steps_trained": 526720, "num_steps_sampled": 2412345, "sample_time_ms": 38408.591, "load_time_ms": 1.233, "grad_time_ms": 1002.72, "update_time_ms": 5.963, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8736293315887451, "policy_loss": -0.01270391047000885, "vf_loss": 1.882756233215332, "vf_explained_var": 0.8635140061378479, "kl": 0.015472461469471455, "entropy": 1.2561265230178833, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10338, "done": false, "timesteps_total": 2412345, "episodes_total": 5237, "training_iteration": 233, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-47-42", "timestamp": 1589885262, "time_this_iter_s": 37.20509362220764, "time_total_s": 9801.931137084961, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187b0e18>", "on_episode_step": "<function on_episode_step at 0x7fef182447b8>", "on_episode_end": "<function on_episode_end at 0x7fef18244840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef182448c8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed541dfd08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9801.931137084961, "timesteps_since_restore": 2412345, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 80.68518518518519, "ram_util_percent": 31.088888888888878}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": 0.02998270000000001, "episode_len_mean": 465.76, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.030285555555555576}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.763814844432754, "avg_speed_min": 1.2933486596844188, "avg_speed_max": 8.028587627955217, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.847248433705495, "mean_processing_ms": 2.8789523265663077, "mean_inference_ms": 0.26425178300073765}, "off_policy_estimator": {}, "info": {"num_steps_trained": 528640, "num_steps_sampled": 2422708, "sample_time_ms": 38174.776, "load_time_ms": 1.247, "grad_time_ms": 1021.565, "update_time_ms": 6.153, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.0510261058807373, "policy_loss": -0.019823940470814705, "vf_loss": 2.0683913230895996, "vf_explained_var": 0.8789850473403931, "kl": 0.010635431855916977, "entropy": 1.139301061630249, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10363, "done": false, "timesteps_total": 2422708, "episodes_total": 5258, "training_iteration": 234, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-48-19", "timestamp": 1589885299, "time_this_iter_s": 36.99585008621216, "time_total_s": 9838.926987171173, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef200b0ea0>", "on_episode_step": "<function on_episode_step at 0x7fef205da378>", "on_episode_end": "<function on_episode_end at 0x7fef205da840>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef205dab70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef182be268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9838.926987171173, "timesteps_since_restore": 2422708, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 82.6942307692308, "ram_util_percent": 31.09999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -9.75005, "episode_reward_mean": 0.13498570000000001, "episode_len_mean": 473.13, "episodes_this_iter": 22, "policy_reward_min": {"av": -9.75005}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13634919191919193}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.863876340952752, "avg_speed_min": 1.2933486596844188, "avg_speed_max": 8.58615672937116, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.830719470019275, "mean_processing_ms": 2.8783167069217406, "mean_inference_ms": 0.2638971498436595}, "off_policy_estimator": {}, "info": {"num_steps_trained": 530688, "num_steps_sampled": 2433149, "sample_time_ms": 38038.916, "load_time_ms": 1.223, "grad_time_ms": 1026.121, "update_time_ms": 6.024, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.8852304220199585, "policy_loss": -0.00682610459625721, "vf_loss": 1.889890193939209, "vf_explained_var": 0.8692284822463989, "kl": 0.009370063431560993, "entropy": 0.888590931892395, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10441, "done": false, "timesteps_total": 2433149, "episodes_total": 5280, "training_iteration": 235, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-48-56", "timestamp": 1589885336, "time_this_iter_s": 37.32644248008728, "time_total_s": 9876.25342965126, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef205da2f0>", "on_episode_step": "<function on_episode_step at 0x7fed54595d08>", "on_episode_end": "<function on_episode_end at 0x7fed54595d90>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54595e18>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef185d5c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9876.25342965126, "timesteps_since_restore": 2433149, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 80.01851851851852, "ram_util_percent": 31.096296296296284}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": 0.12998649999999998, "episode_len_mean": 468.88, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1326392857142857}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.643607232043956, "avg_speed_min": 1.297275520135445, "avg_speed_max": 8.58615672937116, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.820671815187648, "mean_processing_ms": 2.8774692701609528, "mean_inference_ms": 0.26375238664156464}, "off_policy_estimator": {}, "info": {"num_steps_trained": 532864, "num_steps_sampled": 2443683, "sample_time_ms": 38002.127, "load_time_ms": 1.261, "grad_time_ms": 1053.474, "update_time_ms": 5.759, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.4364774227142334, "policy_loss": -0.007746485993266106, "vf_loss": 2.442981004714966, "vf_explained_var": 0.8557211756706238, "kl": 0.005376877728849649, "entropy": 1.4089679718017578, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10534, "done": false, "timesteps_total": 2443683, "episodes_total": 5304, "training_iteration": 236, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-49-35", "timestamp": 1589885375, "time_this_iter_s": 39.24260330200195, "time_total_s": 9915.496032953262, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54456268>", "on_episode_step": "<function on_episode_step at 0x7fed545d2ea0>", "on_episode_end": "<function on_episode_end at 0x7fed545d20d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed545d2158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed545d2c80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9915.496032953262, "timesteps_since_restore": 2443683, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 80.68571428571428, "ram_util_percent": 31.098214285714285}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": 0.1324851, "episode_len_mean": 472.57, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.1351888775510204}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.512765898363273, "avg_speed_min": 1.297275520135445, "avg_speed_max": 8.58615672937116, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.80938083380429, "mean_processing_ms": 2.8777047212291196, "mean_inference_ms": 0.2635573972364098}, "off_policy_estimator": {}, "info": {"num_steps_trained": 534656, "num_steps_sampled": 2454194, "sample_time_ms": 38062.576, "load_time_ms": 1.285, "grad_time_ms": 1109.349, "update_time_ms": 5.903, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6081069707870483, "policy_loss": -0.0068227690644562244, "vf_loss": 1.6135995388031006, "vf_explained_var": 0.9034217000007629, "kl": 0.005755249876528978, "entropy": 1.3089512586593628, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10511, "done": false, "timesteps_total": 2454194, "episodes_total": 5326, "training_iteration": 237, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-50-14", "timestamp": 1589885414, "time_this_iter_s": 38.49378275871277, "time_total_s": 9953.989815711975, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54000950>", "on_episode_step": "<function on_episode_step at 0x7fed54000ae8>", "on_episode_end": "<function on_episode_end at 0x7fed54000b70>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed54000bf8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed54217e18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9953.989815711975, "timesteps_since_restore": 2454194, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 81.49454545454547, "ram_util_percent": 31.099999999999987}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": 0.134984, "episode_len_mean": 476.41, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13773877551020408}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.566862414825171, "avg_speed_min": 1.297275520135445, "avg_speed_max": 8.58615672937116, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.80385393246052, "mean_processing_ms": 2.8777955519449865, "mean_inference_ms": 0.26348258367391236}, "off_policy_estimator": {}, "info": {"num_steps_trained": 536576, "num_steps_sampled": 2464695, "sample_time_ms": 38036.991, "load_time_ms": 1.35, "grad_time_ms": 1134.5, "update_time_ms": 6.024, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6631946563720703, "policy_loss": 0.0005004793638363481, "vf_loss": 1.661396861076355, "vf_explained_var": 0.8956644535064697, "kl": 0.005610884167253971, "entropy": 1.0875682830810547, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10501, "done": false, "timesteps_total": 2464695, "episodes_total": 5347, "training_iteration": 238, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-50-54", "timestamp": 1589885454, "time_this_iter_s": 40.23586988449097, "time_total_s": 9994.225685596466, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed4668a158>", "on_episode_step": "<function on_episode_step at 0x7fed466821e0>", "on_episode_end": "<function on_episode_end at 0x7fed46682268>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed466822f0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed46682840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 9994.225685596466, "timesteps_since_restore": 2464695, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 82.67017543859649, "ram_util_percent": 31.154385964912276}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00009, "episode_reward_mean": 0.13498500000000002, "episode_len_mean": 476.7, "episodes_this_iter": 21, "policy_reward_min": {"av": -10.00009}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.13634848484848486}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.488973215180106, "avg_speed_min": 1.2623117067555942, "avg_speed_max": 8.005369589596791, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.799958286424516, "mean_processing_ms": 2.8770064600732583, "mean_inference_ms": 0.26343746435725224}, "off_policy_estimator": {}, "info": {"num_steps_trained": 538752, "num_steps_sampled": 2475023, "sample_time_ms": 38131.98, "load_time_ms": 1.363, "grad_time_ms": 1155.253, "update_time_ms": 6.122, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.663262128829956, "policy_loss": -0.011051040142774582, "vf_loss": 2.672379970550537, "vf_explained_var": 0.8396403789520264, "kl": 0.008362464606761932, "entropy": 0.9244989156723022, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10328, "done": false, "timesteps_total": 2475023, "episodes_total": 5368, "training_iteration": 239, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-51-36", "timestamp": 1589885496, "time_this_iter_s": 41.69874882698059, "time_total_s": 10035.924434423447, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed46770158>", "on_episode_step": "<function on_episode_step at 0x7fed46765bf8>", "on_episode_end": "<function on_episode_end at 0x7fed46765c80>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed46765d08>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed5423c0d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10035.924434423447, "timesteps_since_restore": 2475023, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 83.48166666666665, "ram_util_percent": 31.189999999999998}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.07001419999999997, "episode_len_mean": 464.47, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07144306122448979}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.556784483633012, "avg_speed_min": 1.2623117067555942, "avg_speed_max": 8.005369589596791, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.804611033998576, "mean_processing_ms": 2.8769093226832814, "mean_inference_ms": 0.2635883004699497}, "off_policy_estimator": {}, "info": {"num_steps_trained": 540800, "num_steps_sampled": 2485276, "sample_time_ms": 38007.957, "load_time_ms": 1.382, "grad_time_ms": 1174.83, "update_time_ms": 6.291, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 4.212610721588135, "policy_loss": -0.019794711843132973, "vf_loss": 4.228785991668701, "vf_explained_var": 0.8841729164123535, "kl": 0.01565609872341156, "entropy": 1.2013031244277954, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10253, "done": false, "timesteps_total": 2485276, "episodes_total": 5392, "training_iteration": 240, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-52-17", "timestamp": 1589885537, "time_this_iter_s": 40.52742648124695, "time_total_s": 10076.451860904694, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed465baa60>", "on_episode_step": "<function on_episode_step at 0x7fed4656a730>", "on_episode_end": "<function on_episode_end at 0x7fed4656a7b8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed4656a840>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed4656aea0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10076.451860904694, "timesteps_since_restore": 2485276, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 82.01034482758621, "ram_util_percent": 31.19655172413793}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.062514, "episode_len_mean": 476.17, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.06314545454545456}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.573333764651193, "avg_speed_min": 1.2623117067555942, "avg_speed_max": 8.02911721192877, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.786959345452104, "mean_processing_ms": 2.87556833697639, "mean_inference_ms": 0.2631785871968769}, "off_policy_estimator": {}, "info": {"num_steps_trained": 542720, "num_steps_sampled": 2495819, "sample_time_ms": 37751.491, "load_time_ms": 1.346, "grad_time_ms": 1196.667, "update_time_ms": 6.243, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.2291982173919678, "policy_loss": -0.014458531513810158, "vf_loss": 2.2408602237701416, "vf_explained_var": 0.845815896987915, "kl": 0.012096126563847065, "entropy": 0.9482676386833191, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10543, "done": false, "timesteps_total": 2495819, "episodes_total": 5414, "training_iteration": 241, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-52-56", "timestamp": 1589885576, "time_this_iter_s": 39.13295388221741, "time_total_s": 10115.584814786911, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed46770268>", "on_episode_step": "<function on_episode_step at 0x7fed4656a1e0>", "on_episode_end": "<function on_episode_end at 0x7fed465babf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed465bab70>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed467701e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10115.584814786911, "timesteps_since_restore": 2495819, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 81.73928571428571, "ram_util_percent": 31.198214285714283}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.27001259999999994, "episode_len_mean": 464.46, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.27274000000000004}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5194035008937155, "avg_speed_min": 1.2623117067555942, "avg_speed_max": 8.553778951618401, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.78884835262052, "mean_processing_ms": 2.8757433747353396, "mean_inference_ms": 0.2632037571357406}, "off_policy_estimator": {}, "info": {"num_steps_trained": 544896, "num_steps_sampled": 2506353, "sample_time_ms": 38010.409, "load_time_ms": 1.355, "grad_time_ms": 1236.154, "update_time_ms": 6.574, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.688230276107788, "policy_loss": -0.006724940612912178, "vf_loss": 1.692103385925293, "vf_explained_var": 0.9079405069351196, "kl": 0.012336288578808308, "entropy": 0.9368757605552673, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10534, "done": false, "timesteps_total": 2506353, "episodes_total": 5437, "training_iteration": 242, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-53-38", "timestamp": 1589885618, "time_this_iter_s": 41.79966473579407, "time_total_s": 10157.384479522705, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed4656a9d8>", "on_episode_step": "<function on_episode_step at 0x7fed46654048>", "on_episode_end": "<function on_episode_end at 0x7fed466826a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed46682620>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fed46682d90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10157.384479522705, "timesteps_since_restore": 2506353, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 83.48305084745763, "ram_util_percent": 31.12033898305084}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.27251319999999996, "episode_len_mean": 459.73, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.28094144329896914}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.6228328450767195, "avg_speed_min": 1.2623117067555942, "avg_speed_max": 8.594191040149475, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.78009834623197, "mean_processing_ms": 2.875806116634771, "mean_inference_ms": 0.26304784138422116}, "off_policy_estimator": {}, "info": {"num_steps_trained": 546304, "num_steps_sampled": 2516639, "sample_time_ms": 37567.137, "load_time_ms": 1.355, "grad_time_ms": 1211.392, "update_time_ms": 7.058, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 0.744845449924469, "policy_loss": -0.003507833229377866, "vf_loss": 0.7442611455917358, "vf_explained_var": 0.9384694695472717, "kl": 0.017701290547847748, "entropy": 1.4101675748825073, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10286, "done": false, "timesteps_total": 2516639, "episodes_total": 5459, "training_iteration": 243, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-54-10", "timestamp": 1589885650, "time_this_iter_s": 32.529478788375854, "time_total_s": 10189.913958311081, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54217510>", "on_episode_step": "<function on_episode_step at 0x7fef20318f28>", "on_episode_end": "<function on_episode_end at 0x7fef181060d0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18106158>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18106840>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10189.913958311081, "timesteps_since_restore": 2516639, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 80.20212765957447, "ram_util_percent": 31.09787234042552}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00004, "episode_reward_mean": -0.2725170999999999, "episode_len_mean": 459.38, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00004}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.2780786734693877}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.778555275979681, "avg_speed_min": 1.56695194918132, "avg_speed_max": 8.594191040149475, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.773391427797684, "mean_processing_ms": 2.876465678496633, "mean_inference_ms": 0.26287982011187494}, "off_policy_estimator": {}, "info": {"num_steps_trained": 548608, "num_steps_sampled": 2527246, "sample_time_ms": 38040.761, "load_time_ms": 1.356, "grad_time_ms": 1231.085, "update_time_ms": 6.847, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 5.086904525756836, "policy_loss": -0.004139526281505823, "vf_loss": 5.089012622833252, "vf_explained_var": 0.8195211887359619, "kl": 0.008785120211541653, "entropy": 1.1678378582000732, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10607, "done": false, "timesteps_total": 2527246, "episodes_total": 5483, "training_iteration": 244, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-54-52", "timestamp": 1589885692, "time_this_iter_s": 41.92578744888306, "time_total_s": 10231.839745759964, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fed54300598>", "on_episode_step": "<function on_episode_step at 0x7fef18703158>", "on_episode_end": "<function on_episode_end at 0x7fef187031e0>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef18703268>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18703bf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10231.839745759964, "timesteps_since_restore": 2527246, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 80.75833333333334, "ram_util_percent": 31.09999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.1725156, "episode_len_mean": 463.66, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.1760363265306122}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.709036261083581, "avg_speed_min": 1.56695194918132, "avg_speed_max": 8.594191040149475, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.765449040190497, "mean_processing_ms": 2.876424754019771, "mean_inference_ms": 0.26279840826583506}, "off_policy_estimator": {}, "info": {"num_steps_trained": 550528, "num_steps_sampled": 2537671, "sample_time_ms": 38104.834, "load_time_ms": 1.411, "grad_time_ms": 1213.386, "update_time_ms": 6.877, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.6877855062484741, "policy_loss": -0.0116755785420537, "vf_loss": 1.6975147724151611, "vf_explained_var": 0.9079275131225586, "kl": 0.008419755846261978, "entropy": 1.3978949785232544, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10425, "done": false, "timesteps_total": 2537671, "episodes_total": 5505, "training_iteration": 245, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-55-30", "timestamp": 1589885730, "time_this_iter_s": 37.79305648803711, "time_total_s": 10269.632802248001, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef187030d0>", "on_episode_step": "<function on_episode_step at 0x7fed54217598>", "on_episode_end": "<function on_episode_end at 0x7fed54217620>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fed542176a8>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef18422488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10269.632802248001, "timesteps_since_restore": 2537671, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 79.79074074074073, "ram_util_percent": 31.09999999999999}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": 0.0299839, "episode_len_mean": 466.91, "episodes_this_iter": 23, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": 0.030911237113402063}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.8368459204615855, "avg_speed_min": 1.8512796535683098, "avg_speed_max": 8.594191040149475, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.755254374385625, "mean_processing_ms": 2.876319677252373, "mean_inference_ms": 0.2627412968287366}, "off_policy_estimator": {}, "info": {"num_steps_trained": 552320, "num_steps_sampled": 2548344, "sample_time_ms": 37238.836, "load_time_ms": 1.424, "grad_time_ms": 1217.114, "update_time_ms": 6.961, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 2.0342676639556885, "policy_loss": -0.014058157801628113, "vf_loss": 2.0456137657165527, "vf_explained_var": 0.9086967706680298, "kl": 0.011731008067727089, "entropy": 1.428712248802185, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10673, "done": false, "timesteps_total": 2548344, "episodes_total": 5528, "training_iteration": 246, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-56-01", "timestamp": 1589885761, "time_this_iter_s": 30.619818687438965, "time_total_s": 10300.25262093544, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef204ffea0>", "on_episode_step": "<function on_episode_step at 0x7fef201a5268>", "on_episode_end": "<function on_episode_end at 0x7fef201a5e18>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef1847d048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef1847dd90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10300.25262093544, "timesteps_since_restore": 2548344, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 77.26136363636363, "ram_util_percent": 29.495454545454546}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.07751689999999999, "episode_len_mean": 454.82, "episodes_this_iter": 25, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07991432989690718}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.5660455618759, "avg_speed_min": 1.8512796535683098, "avg_speed_max": 8.273393494073645, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.739135280241086, "mean_processing_ms": 2.8769055499630345, "mean_inference_ms": 0.2625321461079816}, "off_policy_estimator": {}, "info": {"num_steps_trained": 554240, "num_steps_sampled": 2558956, "sample_time_ms": 37308.227, "load_time_ms": 1.411, "grad_time_ms": 1207.347, "update_time_ms": 7.919, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.898003339767456, "policy_loss": 0.0017344524385407567, "vf_loss": 1.894525408744812, "vf_explained_var": 0.8824979066848755, "kl": 0.007541882339864969, "entropy": 1.7698521614074707, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10612, "done": false, "timesteps_total": 2558956, "episodes_total": 5553, "training_iteration": 247, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-56-40", "timestamp": 1589885800, "time_this_iter_s": 39.09625554084778, "time_total_s": 10339.348876476288, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201a50d0>", "on_episode_step": "<function on_episode_step at 0x7fef204ff048>", "on_episode_end": "<function on_episode_end at 0x7fef204ff400>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef204fff28>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef203d1268>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10339.348876476288, "timesteps_since_restore": 2558956, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 82.8727272727273, "ram_util_percent": 34.66363636363637}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00006, "episode_reward_mean": -0.075017, "episode_len_mean": 459.28, "episodes_this_iter": 20, "policy_reward_min": {"av": -10.00006}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.07654795918367342}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.647538593472958, "avg_speed_min": 1.8512796535683098, "avg_speed_max": 8.586834205275759, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.729917490381563, "mean_processing_ms": 2.8768136261493478, "mean_inference_ms": 0.26249282051776335}, "off_policy_estimator": {}, "info": {"num_steps_trained": 556160, "num_steps_sampled": 2569349, "sample_time_ms": 37082.654, "load_time_ms": 1.35, "grad_time_ms": 1213.389, "update_time_ms": 7.723, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.2284140586853027, "policy_loss": -0.018797338008880615, "vf_loss": 1.2448076009750366, "vf_explained_var": 0.9324296116828918, "kl": 0.01039747055619955, "entropy": 1.2762247323989868, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10393, "done": false, "timesteps_total": 2569349, "episodes_total": 5573, "training_iteration": 248, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-57-18", "timestamp": 1589885838, "time_this_iter_s": 38.03187847137451, "time_total_s": 10377.380754947662, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef18422400>", "on_episode_step": "<function on_episode_step at 0x7fed5448ff28>", "on_episode_end": "<function on_episode_end at 0x7fef200a26a8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef200a2048>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef20142d08>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10377.380754947662, "timesteps_since_restore": 2569349, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 79.78545454545456, "ram_util_percent": 34.74181818181818}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00013, "episode_reward_mean": -0.17251829999999996, "episode_len_mean": 462.66, "episodes_this_iter": 22, "policy_reward_min": {"av": -10.00013}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.17603908163265305}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.711982577772605, "avg_speed_min": 1.8512796535683098, "avg_speed_max": 8.586834205275759, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.708223877921352, "mean_processing_ms": 2.876511654518112, "mean_inference_ms": 0.2621543712782432}, "off_policy_estimator": {}, "info": {"num_steps_trained": 558336, "num_steps_sampled": 2579746, "sample_time_ms": 36813.026, "load_time_ms": 1.346, "grad_time_ms": 1214.736, "update_time_ms": 7.727, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 1.4957387447357178, "policy_loss": -0.006504903547465801, "vf_loss": 1.4992886781692505, "vf_explained_var": 0.9084194898605347, "kl": 0.012781518511474133, "entropy": 1.1613116264343262, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10397, "done": false, "timesteps_total": 2579746, "episodes_total": 5595, "training_iteration": 249, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-57-57", "timestamp": 1589885877, "time_this_iter_s": 39.013421297073364, "time_total_s": 10416.394176244736, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef201ce9d8>", "on_episode_step": "<function on_episode_step at 0x7fef1847d598>", "on_episode_end": "<function on_episode_end at 0x7fef184b99d8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef184b9598>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef184b9488>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10416.394176244736, "timesteps_since_restore": 2579746, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 80.53272727272726, "ram_util_percent": 34.79454545454545}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
{"episode_reward_max": 0.25, "episode_reward_min": -10.00013, "episode_reward_mean": -0.2800195, "episode_len_mean": 449.49, "episodes_this_iter": 24, "policy_reward_min": {"av": -10.00013}, "policy_reward_max": {"av": 0.25}, "policy_reward_mean": {"av": -0.28867989690721646}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.725696947396747, "avg_speed_min": 1.8512796535683098, "avg_speed_max": 8.586834205275759, "avg_rl_veh_arrival_mean": NaN, "avg_rl_veh_arrival_min": NaN, "avg_rl_veh_arrival_max": NaN}, "sampler_perf": {"mean_env_wait_ms": 22.70471233743656, "mean_processing_ms": 2.8777908798497878, "mean_inference_ms": 0.26219958269033866}, "off_policy_estimator": {}, "info": {"num_steps_trained": 560128, "num_steps_sampled": 2590093, "sample_time_ms": 36489.737, "load_time_ms": 1.381, "grad_time_ms": 1198.068, "update_time_ms": 7.723, "learner": {"av": {"cur_kl_coeff": 0.23118135333061218, "cur_lr": 4.999999873689376e-05, "total_loss": 3.885815382003784, "policy_loss": -0.006080896593630314, "vf_loss": 3.8903939723968506, "vf_explained_var": 0.8332229852676392, "kl": 0.006498171482235193, "entropy": 1.2909018993377686, "entropy_coeff": 0.0}}}, "timesteps_this_iter": 10347, "done": true, "timesteps_total": 2590093, "episodes_total": 5619, "training_iteration": 250, "experiment_id": "c80afdb32c9848648b507278290ed211", "date": "2020-05-19_10-58-35", "timestamp": 1589885915, "time_this_iter_s": 37.12854886054993, "time_total_s": 10453.522725105286, "pid": 88210, "hostname": "ip-172-31-27-18", "node_ip": "172.31.27.18", "config": {"num_workers": 7, "num_envs_per_worker": 1, "sample_batch_size": 200, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 10000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.995, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"maddpg\": false,\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_ped_radius\": 22,\n            \"search_veh_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_0_no_grid_env.Bayesian0NoGridEnv\",\n    \"exp_tag\": \"bayesian_0_no_grid_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 5,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_0.Bayesian0Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\",\n            \"ped_1\",\n            \"ped_2\",\n            \"ped_3\",\n            \"ped_4\",\n            \"ped_5\",\n            \"ped_6\",\n            \"ped_7\",\n            \"ped_8\",\n            \"ped_9\",\n            \"ped_10\",\n            \"ped_11\",\n            \"ped_12\",\n            \"ped_13\",\n            \"ped_14\"\n        ],\n        \"num_pedestrians\": 15,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_1\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"44.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_1\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_10\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_10\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_11\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"49.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_11\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_12\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_12\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_13\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"50.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_13\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_14\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"51.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_14\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_2\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_2\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_3\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"45.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_3\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_4\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_4\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_5\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"46.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_5\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_6\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_6\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_7\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"47.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_7\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_8\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.0\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_8\",\n                \"to\": \"(1.1)--(1.0)\"\n            },\n            \"ped_9\": {\n                \"arrivalPos\": \"5\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"48.5\",\n                \"from\": \"(1.2)--(1.1)\",\n                \"id\": \"ped_9\",\n                \"to\": \"(1.1)--(1.0)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.2,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"0.25\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"depart_pos\": 0,\n            \"depart_time\": \"3.5\",\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian0NoGridEnv-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 5e-05, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7fef185269d8>", "on_episode_step": "<function on_episode_step at 0x7fed5448f1e0>", "on_episode_end": "<function on_episode_end at 0x7fed5448fbf8>", "on_sample_end": null, "on_train_result": "<function setup_exps_PPO.<locals>.on_train_result at 0x7fef2009a0d0>", "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(24,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7fef2009a620>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": false}, "time_since_restore": 10453.522725105286, "timesteps_since_restore": 2590093, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 81.00188679245284, "ram_util_percent": 34.8}, "num_healthy_workers": 7, "trial_id": "47a38e54", "experiment_tag": "0_gamma=0.995"}
