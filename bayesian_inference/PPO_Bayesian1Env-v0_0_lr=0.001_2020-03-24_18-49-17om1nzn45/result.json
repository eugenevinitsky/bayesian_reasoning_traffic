{"episode_reward_max": 1.5916230168269894, "episode_reward_min": 0.19730691358537528, "episode_reward_mean": 0.8147238393854028, "episode_len_mean": 500.0, "episodes_this_iter": 16, "policy_reward_mean": {"av": 0.37244518371904134}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.7636658979146063, "avg_speed_min": 0.39619862165737973, "avg_speed_max": 1.1350246844213772, "avg_rl_veh_arrival_mean": 500.3125, "avg_rl_veh_arrival_min": 498.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 10.879907924562247, "mean_processing_ms": 2.3626053996974443, "mean_inference_ms": 1.2396784827676863}, "off_policy_estimator": {}, "info": {"num_steps_trained": 11200, "num_steps_sampled": 11200, "sample_time_ms": 30713.834, "grad_time_ms": 742.069, "update_time_ms": 371.479, "opt_peak_throughput": 15092.941, "sample_peak_throughput": 364.657, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.20000000298023224, "cur_lr": 0.0010000000474974513, "total_loss": -0.07099886983633041, "policy_loss": -0.07727514952421188, "vf_loss": 0.0061970301903784275, "vf_explained_var": 0.03171074390411377, "kl": 0.00039629830280318856, "entropy": 1.4182785749435425, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 11200, "episodes_total": 16, "training_iteration": 1, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-49-56", "timestamp": 1585100996, "time_this_iter_s": 31.868377923965454, "time_total_s": 31.868377923965454, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2d1e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 31.868377923965454, "timesteps_since_restore": 11200, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.18695652173914, "ram_util_percent": 52.67391304347826}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 2.0607482871221876, "episode_reward_min": 0.017418077947989514, "episode_reward_mean": 0.8346756262669968, "episode_len_mean": 471.1860465116279, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.33232455490260043}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.023255813953488372, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 0.964485209755103, "avg_speed_min": 0.1802927038159179, "avg_speed_max": 2.169767731627311, "avg_rl_veh_arrival_mean": 466.7906976744186, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 10.343717963871047, "mean_processing_ms": 2.7165552977890295, "mean_inference_ms": 1.1897961459993904}, "off_policy_estimator": {}, "info": {"num_steps_trained": 22400, "num_steps_sampled": 22400, "sample_time_ms": 26929.141, "grad_time_ms": 647.436, "update_time_ms": 188.26, "opt_peak_throughput": 17299.0, "sample_peak_throughput": 415.906, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 0.0010000000474974513, "total_loss": -0.04814781993627548, "policy_loss": -0.06415651738643646, "vf_loss": 0.01576528325676918, "vf_explained_var": 0.033392488956451416, "kl": 0.0024340704549103975, "entropy": 1.4135069847106934, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 22400, "episodes_total": 43, "training_iteration": 2, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-50-19", "timestamp": 1585101019, "time_this_iter_s": 23.721587419509888, "time_total_s": 55.58996534347534, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2dd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2dd90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2de18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4b4510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 55.58996534347534, "timesteps_since_restore": 22400, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 51.758823529411764, "ram_util_percent": 53.69117647058823}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 2.689606240792368, "episode_reward_min": -2.063134670757277, "episode_reward_mean": 0.9182505251476498, "episode_len_mean": 462.6666666666667, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.34812794634718586}, "custom_metrics": {"num_ped_collisions_mean": 0.014492753623188406, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.043478260869565216, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.1843093886621467, "avg_speed_min": 0.1802927038159179, "avg_speed_max": 3.2102235216781985, "avg_rl_veh_arrival_mean": 453.64251207729467, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 10.294573562654563, "mean_processing_ms": 2.8597329956253827, "mean_inference_ms": 1.1814829672842364}, "off_policy_estimator": {}, "info": {"num_steps_trained": 33600, "num_steps_sampled": 33600, "sample_time_ms": 26742.546, "grad_time_ms": 671.752, "update_time_ms": 128.058, "opt_peak_throughput": 16672.816, "sample_peak_throughput": 418.808, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.0009863362647593021, "policy_loss": -0.07565172761678696, "vf_loss": 0.0761931836605072, "vf_explained_var": 0.0786428451538086, "kl": 0.008897995576262474, "entropy": 1.4055300951004028, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 33600, "episodes_total": 69, "training_iteration": 3, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-50-47", "timestamp": 1585101047, "time_this_iter_s": 27.125957250595093, "time_total_s": 82.71592259407043, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4b47b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4b4840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4b48c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4b4f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 82.71592259407043, "timesteps_since_restore": 33600, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 54.46153846153846, "ram_util_percent": 53.26410256410257}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0021854853114807, "episode_reward_min": -2.4270966623694004, "episode_reward_mean": 1.1194078654489148, "episode_len_mean": 466.17391304347825, "episodes_this_iter": 23, "policy_reward_mean": {"av": 0.4103008909215145}, "custom_metrics": {"num_ped_collisions_mean": 0.021739130434782608, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.043478260869565216, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.4423620465114189, "avg_speed_min": 0.1802927038159179, "avg_speed_max": 3.2102235216781985, "avg_rl_veh_arrival_mean": 445.73369565217394, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 10.17656307762313, "mean_processing_ms": 2.9134639478308095, "mean_inference_ms": 1.1687747189056694}, "off_policy_estimator": {}, "info": {"num_steps_trained": 44800, "num_steps_sampled": 44800, "sample_time_ms": 25609.059, "grad_time_ms": 649.309, "update_time_ms": 97.763, "opt_peak_throughput": 17249.094, "sample_peak_throughput": 437.345, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": -0.05121506005525589, "policy_loss": -0.11598380655050278, "vf_loss": 0.06437700986862183, "vf_explained_var": 0.12095272541046143, "kl": 0.007834721356630325, "entropy": 1.3920767307281494, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 44800, "episodes_total": 92, "training_iteration": 4, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-51-09", "timestamp": 1585101069, "time_this_iter_s": 22.822553634643555, "time_total_s": 105.53847622871399, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2d0d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4c2158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 105.53847622871399, "timesteps_since_restore": 44800, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 52.384375000000006, "ram_util_percent": 53.38125}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0021854853114807, "episode_reward_min": -2.4521426388034664, "episode_reward_mean": 1.2338906030098231, "episode_len_mean": 460.49, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.4284342371561886}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.7820930199729694, "avg_speed_min": 0.1802927038159179, "avg_speed_max": 3.712000135530191, "avg_rl_veh_arrival_mean": 425.87333333333333, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 9.910998207710424, "mean_processing_ms": 3.047765356725594, "mean_inference_ms": 1.1402958659563314}, "off_policy_estimator": {}, "info": {"num_steps_trained": 56000, "num_steps_sampled": 56000, "sample_time_ms": 24909.701, "grad_time_ms": 602.224, "update_time_ms": 80.079, "opt_peak_throughput": 18597.719, "sample_peak_throughput": 449.624, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.11457870900630951, "policy_loss": -0.02888410910964012, "vf_loss": 0.14310012757778168, "vf_explained_var": 0.10222917795181274, "kl": 0.007252924609929323, "entropy": 1.4043385982513428, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 56000, "episodes_total": 117, "training_iteration": 5, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-51-32", "timestamp": 1585101092, "time_this_iter_s": 22.549569368362427, "time_total_s": 128.08804559707642, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4c2378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4c2488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4c2510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4c2b70>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 128.08804559707642, "timesteps_since_restore": 56000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 53.509375000000006, "ram_util_percent": 53.453125}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.03342832800128, "episode_reward_min": -2.4521426388034664, "episode_reward_mean": 1.404254935770319, "episode_len_mean": 461.18, "episodes_this_iter": 23, "policy_reward_mean": {"av": 0.4776377332552105}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1183910563252626, "avg_speed_min": 0.24649953793849072, "avg_speed_max": 3.712000135530191, "avg_rl_veh_arrival_mean": 404.01166666666666, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 9.677539489472162, "mean_processing_ms": 3.084473961402805, "mean_inference_ms": 1.1204390411622824}, "off_policy_estimator": {}, "info": {"num_steps_trained": 67200, "num_steps_sampled": 67200, "sample_time_ms": 24330.473, "grad_time_ms": 557.805, "update_time_ms": 69.293, "opt_peak_throughput": 20078.698, "sample_peak_throughput": 460.328, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.030588064342737198, "policy_loss": -0.04349635913968086, "vf_loss": 0.07381275296211243, "vf_explained_var": 0.16610288619995117, "kl": 0.005433414131402969, "entropy": 1.406265139579773, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 67200, "episodes_total": 140, "training_iteration": 6, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-51-54", "timestamp": 1585101114, "time_this_iter_s": 21.795570373535156, "time_total_s": 149.88361597061157, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4c2d90>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4c2ea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4c2f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4c8620>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 149.88361597061157, "timesteps_since_restore": 67200, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.41875, "ram_util_percent": 53.6875}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.03342832800128, "episode_reward_min": -2.8800601853558945, "episode_reward_mean": 1.4170723660875646, "episode_len_mean": 449.99, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.48364244576367404}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3711656687161566, "avg_speed_min": 0.6115818502691243, "avg_speed_max": 3.712000135530191, "avg_rl_veh_arrival_mean": 376.50833333333327, "avg_rl_veh_arrival_min": 115.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 9.319075209134429, "mean_processing_ms": 3.109211907171665, "mean_inference_ms": 1.076364065428199}, "off_policy_estimator": {}, "info": {"num_steps_trained": 78400, "num_steps_sampled": 78400, "sample_time_ms": 23882.82, "grad_time_ms": 535.572, "update_time_ms": 61.543, "opt_peak_throughput": 20912.208, "sample_peak_throughput": 468.956, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.22333501279354095, "policy_loss": 0.016131795942783356, "vf_loss": 0.20682847499847412, "vf_explained_var": 0.09778159856796265, "kl": 0.007494866847991943, "entropy": 1.390651822090149, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 78400, "episodes_total": 169, "training_iteration": 7, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-52-15", "timestamp": 1585101135, "time_this_iter_s": 21.633199214935303, "time_total_s": 171.51681518554688, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4c2158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4c21e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4c22f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2db70>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 171.51681518554688, "timesteps_since_restore": 78400, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.87419354838711, "ram_util_percent": 53.53870967741935}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.058247042065309, "episode_reward_min": -2.8800601853558945, "episode_reward_mean": 1.2415670895983133, "episode_len_mean": 433.36, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.428126582620108}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.430697220900227, "avg_speed_min": 0.5861785039775119, "avg_speed_max": 3.781469242675319, "avg_rl_veh_arrival_mean": 356.74, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 9.018694605629536, "mean_processing_ms": 3.134231611300242, "mean_inference_ms": 1.0421931456701228}, "off_policy_estimator": {}, "info": {"num_steps_trained": 89600, "num_steps_sampled": 89600, "sample_time_ms": 23582.558, "grad_time_ms": 523.214, "update_time_ms": 55.422, "opt_peak_throughput": 21406.167, "sample_peak_throughput": 474.927, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.12171821296215057, "policy_loss": -0.012014703825116158, "vf_loss": 0.13344545662403107, "vf_explained_var": 0.15758943557739258, "kl": 0.005748986732214689, "entropy": 1.3927502632141113, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 89600, "episodes_total": 195, "training_iteration": 8, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-52-37", "timestamp": 1585101157, "time_this_iter_s": 21.950130224227905, "time_total_s": 193.46694540977478, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2dd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df06378>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4b4730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4c87b8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 193.46694540977478, "timesteps_since_restore": 89600, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 45.316129032258075, "ram_util_percent": 53.47741935483871}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.216049573448826, "episode_reward_min": -2.8800601853558945, "episode_reward_mean": 1.2649332337276395, "episode_len_mean": 427.56, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4392129283776527}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.12, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4628703147346847, "avg_speed_min": 0.1677098364356954, "avg_speed_max": 3.781469242675319, "avg_rl_veh_arrival_mean": 348.57333333333327, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.774006792495602, "mean_processing_ms": 3.1434314974016373, "mean_inference_ms": 1.0137409617945594}, "off_policy_estimator": {}, "info": {"num_steps_trained": 100800, "num_steps_sampled": 100800, "sample_time_ms": 23386.264, "grad_time_ms": 511.759, "update_time_ms": 50.05, "opt_peak_throughput": 21885.31, "sample_peak_throughput": 478.914, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.10469172894954681, "policy_loss": -0.025337278842926025, "vf_loss": 0.12962695956230164, "vf_explained_var": 0.19339263439178467, "kl": 0.00804076250642538, "entropy": 1.4050148725509644, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 100800, "episodes_total": 219, "training_iteration": 9, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-53-00", "timestamp": 1585101180, "time_this_iter_s": 22.26215696334839, "time_total_s": 215.72910237312317, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4c8a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4c8ae8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4c8b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc54268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 215.72910237312317, "timesteps_since_restore": 100800, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 46.1125, "ram_util_percent": 53.465625}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.216049573448826, "episode_reward_min": -2.8800601853558945, "episode_reward_mean": 1.2346538399587783, "episode_len_mean": 423.91, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.428699249985687}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.503320804178495, "avg_speed_min": 0.1677098364356954, "avg_speed_max": 3.781469242675319, "avg_rl_veh_arrival_mean": 349.14, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.580964747580774, "mean_processing_ms": 3.1652520322600926, "mean_inference_ms": 0.9894241771461034}, "off_policy_estimator": {}, "info": {"num_steps_trained": 112000, "num_steps_sampled": 112000, "sample_time_ms": 23242.303, "grad_time_ms": 511.799, "update_time_ms": 45.671, "opt_peak_throughput": 21883.589, "sample_peak_throughput": 481.88, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.2568597197532654, "policy_loss": 0.060309067368507385, "vf_loss": 0.19614097476005554, "vf_explained_var": 0.11775922775268555, "kl": 0.008194508031010628, "entropy": 1.4072774648666382, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 112000, "episodes_total": 246, "training_iteration": 10, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-53-22", "timestamp": 1585101202, "time_this_iter_s": 22.493221044540405, "time_total_s": 238.22232341766357, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2db70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2de18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4c22f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 238.22232341766357, "timesteps_since_restore": 112000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 47.16875, "ram_util_percent": 53.515625}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.216049573448826, "episode_reward_min": -2.6666305909309496, "episode_reward_mean": 1.3153112538238878, "episode_len_mean": 437.9, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4504490595287289}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5443253876100838, "avg_speed_min": 0.1677098364356954, "avg_speed_max": 3.781469242675319, "avg_rl_veh_arrival_mean": 359.455, "avg_rl_veh_arrival_min": 55.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.44074041858908, "mean_processing_ms": 3.1616027524962633, "mean_inference_ms": 0.9746610874670867}, "off_policy_estimator": {}, "info": {"num_steps_trained": 123200, "num_steps_sampled": 123200, "sample_time_ms": 22408.617, "grad_time_ms": 478.342, "update_time_ms": 9.171, "opt_peak_throughput": 23414.201, "sample_peak_throughput": 499.808, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.09398277848958969, "policy_loss": -0.024319596588611603, "vf_loss": 0.11801777780056, "vf_explained_var": 0.15435940027236938, "kl": 0.005692515056580305, "entropy": 1.4146784543991089, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 123200, "episodes_total": 270, "training_iteration": 11, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-53-45", "timestamp": 1585101225, "time_this_iter_s": 22.8087260723114, "time_total_s": 261.031049489975, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4c2e18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4c20d0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4c2048>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc54400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 261.031049489975, "timesteps_since_restore": 123200, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 45.353125000000006, "ram_util_percent": 53.615624999999994}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.216049573448826, "episode_reward_min": -2.5779344161562987, "episode_reward_mean": 1.4059577680493, "episode_len_mean": 450.57, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.4782169279079253}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.597504000330927, "avg_speed_min": 0.1677098364356954, "avg_speed_max": 3.764400133721364, "avg_rl_veh_arrival_mean": 369.2033333333334, "avg_rl_veh_arrival_min": 57.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.337792816499576, "mean_processing_ms": 3.160637827917973, "mean_inference_ms": 0.9630838381523311}, "off_policy_estimator": {}, "info": {"num_steps_trained": 134400, "num_steps_sampled": 134400, "sample_time_ms": 22199.495, "grad_time_ms": 455.615, "update_time_ms": 9.407, "opt_peak_throughput": 24582.175, "sample_peak_throughput": 504.516, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.06899875402450562, "policy_loss": -0.029231922701001167, "vf_loss": 0.09794755280017853, "vf_explained_var": 0.20007312297821045, "kl": 0.005662476643919945, "entropy": 1.3801807165145874, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 134400, "episodes_total": 295, "training_iteration": 12, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-54-07", "timestamp": 1585101247, "time_this_iter_s": 21.39793825149536, "time_total_s": 282.42898774147034, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc54620>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc54730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc547b8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc54e18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 282.42898774147034, "timesteps_since_restore": 134400, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 44.5774193548387, "ram_util_percent": 53.535483870967724}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1139688481715044, "episode_reward_min": -2.5779344161562987, "episode_reward_mean": 1.2919568323603159, "episode_len_mean": 448.17, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.44245096998640954}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.5470585370994403, "avg_speed_min": 0.7756527534917922, "avg_speed_max": 4.336798388702935, "avg_rl_veh_arrival_mean": 372.23333333333335, "avg_rl_veh_arrival_min": 108.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.219705732143542, "mean_processing_ms": 3.1649217487529757, "mean_inference_ms": 0.9533208562785112}, "off_policy_estimator": {}, "info": {"num_steps_trained": 145600, "num_steps_sampled": 145600, "sample_time_ms": 21736.045, "grad_time_ms": 415.403, "update_time_ms": 9.105, "opt_peak_throughput": 26961.785, "sample_peak_throughput": 515.273, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.243752583861351, "policy_loss": 0.038337912410497665, "vf_loss": 0.20457401871681213, "vf_explained_var": 0.13425755500793457, "kl": 0.01681261882185936, "entropy": 1.3973579406738281, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 145600, "episodes_total": 320, "training_iteration": 13, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-54-29", "timestamp": 1585101269, "time_this_iter_s": 22.068150520324707, "time_total_s": 304.49713826179504, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4c2268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df20f28>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df20ea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 304.49713826179504, "timesteps_since_restore": 145600, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 42.084375, "ram_util_percent": 53.599999999999994}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1139688481715044, "episode_reward_min": -2.5779344161562987, "episode_reward_mean": 1.3392525194373537, "episode_len_mean": 454.8, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.4570827711390285}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.416466110794903, "avg_speed_min": 0.3858937262989229, "avg_speed_max": 4.336798388702935, "avg_rl_veh_arrival_mean": 387.41666666666663, "avg_rl_veh_arrival_min": 103.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.147998671467784, "mean_processing_ms": 3.166501789218054, "mean_inference_ms": 0.9473632936771189}, "off_policy_estimator": {}, "info": {"num_steps_trained": 156800, "num_steps_sampled": 156800, "sample_time_ms": 21938.46, "grad_time_ms": 400.596, "update_time_ms": 8.807, "opt_peak_throughput": 27958.349, "sample_peak_throughput": 510.519, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.1321249008178711, "policy_loss": 0.013290918432176113, "vf_loss": 0.1181984394788742, "vf_explained_var": 0.15126442909240723, "kl": 0.012711364775896072, "entropy": 1.4099230766296387, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 156800, "episodes_total": 347, "training_iteration": 14, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-54-53", "timestamp": 1585101293, "time_this_iter_s": 24.684861421585083, "time_total_s": 329.1819996833801, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4c87b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4c88c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4b4730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc63048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 329.1819996833801, "timesteps_since_restore": 156800, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 50.21142857142858, "ram_util_percent": 53.52857142857143}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.095854114743771, "episode_reward_min": -2.640233254485344, "episode_reward_mean": 1.3108928338404626, "episode_len_mean": 445.5, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.447403697556472}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.455268298484393, "avg_speed_min": 0.3858937262989229, "avg_speed_max": 4.336798388702935, "avg_rl_veh_arrival_mean": 374.59666666666664, "avg_rl_veh_arrival_min": 103.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.09798422659521, "mean_processing_ms": 3.1693276716733374, "mean_inference_ms": 0.9424248892038483}, "off_policy_estimator": {}, "info": {"num_steps_trained": 168000, "num_steps_sampled": 168000, "sample_time_ms": 21922.66, "grad_time_ms": 406.437, "update_time_ms": 8.596, "opt_peak_throughput": 27556.545, "sample_peak_throughput": 510.887, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.1469339281320572, "policy_loss": -0.020378384739160538, "vf_loss": 0.166848286986351, "vf_explained_var": 0.11291146278381348, "kl": 0.009279717691242695, "entropy": 1.407086730003357, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 168000, "episodes_total": 372, "training_iteration": 15, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-55-16", "timestamp": 1585101316, "time_this_iter_s": 22.44420027732849, "time_total_s": 351.6261999607086, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc632f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc63378>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc63400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc63a60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 351.6261999607086, "timesteps_since_restore": 168000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 47.11875, "ram_util_percent": 53.534375}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.095854114743771, "episode_reward_min": -2.640233254485344, "episode_reward_mean": 1.2875461213146862, "episode_len_mean": 431.35, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.4501909515086316}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3502035117002613, "avg_speed_min": 0.3858937262989229, "avg_speed_max": 4.336798388702935, "avg_rl_veh_arrival_mean": 361.99, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.06606868038187, "mean_processing_ms": 3.176620923052541, "mean_inference_ms": 0.9396026514899077}, "off_policy_estimator": {}, "info": {"num_steps_trained": 179200, "num_steps_sampled": 179200, "sample_time_ms": 22122.931, "grad_time_ms": 416.922, "update_time_ms": 7.556, "opt_peak_throughput": 26863.544, "sample_peak_throughput": 506.262, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.07386387139558792, "policy_loss": -0.027438398450613022, "vf_loss": 0.10097265988588333, "vf_explained_var": 0.13234037160873413, "kl": 0.006592243909835815, "entropy": 1.4033573865890503, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 179200, "episodes_total": 398, "training_iteration": 16, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-55-40", "timestamp": 1585101340, "time_this_iter_s": 23.89419150352478, "time_total_s": 375.5203914642334, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc54950>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc548c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc542f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d1e0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 375.5203914642334, "timesteps_since_restore": 179200, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 46.3470588235294, "ram_util_percent": 53.8029411764706}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.123524631464794, "episode_reward_min": -2.6959971636197517, "episode_reward_mean": 1.2017505264973944, "episode_len_mean": 427.82, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.4201924917823057}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.337443060461939, "avg_speed_min": 0.3858937262989229, "avg_speed_max": 3.978568122506862, "avg_rl_veh_arrival_mean": 372.32, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.065592448533135, "mean_processing_ms": 3.186028163005793, "mean_inference_ms": 0.9379077078220992}, "off_policy_estimator": {}, "info": {"num_steps_trained": 190400, "num_steps_sampled": 190400, "sample_time_ms": 22345.624, "grad_time_ms": 417.076, "update_time_ms": 6.58, "opt_peak_throughput": 26853.606, "sample_peak_throughput": 501.217, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.2320178747177124, "policy_loss": 0.025316014885902405, "vf_loss": 0.20609843730926514, "vf_explained_var": 0.10868895053863525, "kl": 0.012066377326846123, "entropy": 1.3882009983062744, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 190400, "episodes_total": 425, "training_iteration": 17, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-56-04", "timestamp": 1585101364, "time_this_iter_s": 23.84803605079651, "time_total_s": 399.3684275150299, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2df28>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d8c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df202f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 399.3684275150299, "timesteps_since_restore": 190400, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 47.482352941176465, "ram_util_percent": 53.65882352941177}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.123524631464794, "episode_reward_min": -2.6959971636197517, "episode_reward_mean": 1.200591178172339, "episode_len_mean": 424.83, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.422743372595894}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.267028168621118, "avg_speed_min": 0.3025120016951182, "avg_speed_max": 3.681667026303969, "avg_rl_veh_arrival_mean": 371.56666666666666, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.05147370463689, "mean_processing_ms": 3.197845845970525, "mean_inference_ms": 0.936422014315181}, "off_policy_estimator": {}, "info": {"num_steps_trained": 201600, "num_steps_sampled": 201600, "sample_time_ms": 22595.986, "grad_time_ms": 412.159, "update_time_ms": 5.879, "opt_peak_throughput": 27173.95, "sample_peak_throughput": 495.663, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.0799286887049675, "policy_loss": -0.01468194555491209, "vf_loss": 0.0942334458231926, "vf_explained_var": 0.16213279962539673, "kl": 0.007544033695012331, "entropy": 1.3701815605163574, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 201600, "episodes_total": 452, "training_iteration": 18, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-56-28", "timestamp": 1585101388, "time_this_iter_s": 24.391279935836792, "time_total_s": 423.7597074508667, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df06378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df06d08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df060d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df06d90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 423.7597074508667, "timesteps_since_restore": 201600, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 47.04, "ram_util_percent": 53.56571428571428}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.123524631464794, "episode_reward_min": -2.6959971636197517, "episode_reward_mean": 1.1060709052270539, "episode_len_mean": 421.47, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.3922237252578205}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1673704567068053, "avg_speed_min": 0.16783962123328514, "avg_speed_max": 4.0958569004730885, "avg_rl_veh_arrival_mean": 378.485, "avg_rl_veh_arrival_min": 56.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.034102222592347, "mean_processing_ms": 3.206559929017309, "mean_inference_ms": 0.9356679191499854}, "off_policy_estimator": {}, "info": {"num_steps_trained": 212800, "num_steps_sampled": 212800, "sample_time_ms": 22652.322, "grad_time_ms": 407.636, "update_time_ms": 5.716, "opt_peak_throughput": 27475.47, "sample_peak_throughput": 494.431, "opt_samples": 11200.0, "learner": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 0.0010000000474974513, "total_loss": 0.28077349066734314, "policy_loss": 0.04523226618766785, "vf_loss": 0.23450171947479248, "vf_explained_var": 0.16242796182632446, "kl": 0.020789381116628647, "entropy": 1.3872100114822388, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 212800, "episodes_total": 477, "training_iteration": 19, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-56-51", "timestamp": 1585101411, "time_this_iter_s": 22.774057388305664, "time_total_s": 446.53376483917236, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc63378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc632f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc63268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc63ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 446.53376483917236, "timesteps_since_restore": 212800, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 46.690625, "ram_util_percent": 53.590625}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.123524631464794, "episode_reward_min": -2.730858925902695, "episode_reward_mean": 1.0697536298302976, "episode_len_mean": 431.12, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.37273645638686337}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 2.180893366573733, "avg_speed_min": 0.16783962123328514, "avg_speed_max": 4.0958569004730885, "avg_rl_veh_arrival_mean": 385.6183333333333, "avg_rl_veh_arrival_min": 56.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.039816540410333, "mean_processing_ms": 3.202110363673481, "mean_inference_ms": 0.9368947193977288}, "off_policy_estimator": {}, "info": {"num_steps_trained": 224048, "num_steps_sampled": 224048, "sample_time_ms": 22679.322, "grad_time_ms": 400.977, "update_time_ms": 5.589, "opt_peak_throughput": 27943.753, "sample_peak_throughput": 494.054, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.2063627392053604, "policy_loss": 0.035006679594516754, "vf_loss": 0.17049141228199005, "vf_explained_var": 0.2125934362411499, "kl": 0.01152834203094244, "entropy": 1.4247382879257202, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11248, "done": false, "timesteps_total": 224048, "episodes_total": 502, "training_iteration": 20, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-57-14", "timestamp": 1585101434, "time_this_iter_s": 22.681819677352905, "time_total_s": 469.21558451652527, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df20268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df200d0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df20f28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d620>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 469.21558451652527, "timesteps_since_restore": 224048, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 45.11212121212121, "ram_util_percent": 53.512121212121215}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1890436639493918, "episode_reward_min": -2.730858925902695, "episode_reward_mean": 0.9940854928335793, "episode_len_mean": 430.94, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.34637125185839}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2525588892047974, "avg_speed_min": 0.16783962123328514, "avg_speed_max": 5.374227927899113, "avg_rl_veh_arrival_mean": 376.39166666666665, "avg_rl_veh_arrival_min": 56.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.000012253449023, "mean_processing_ms": 3.205805239489682, "mean_inference_ms": 0.9339872955292252}, "off_policy_estimator": {}, "info": {"num_steps_trained": 235248, "num_steps_sampled": 235248, "sample_time_ms": 22654.766, "grad_time_ms": 389.312, "update_time_ms": 5.365, "opt_peak_throughput": 28780.999, "sample_peak_throughput": 494.589, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.21792836487293243, "policy_loss": 0.019517531618475914, "vf_loss": 0.19700053334236145, "vf_explained_var": 0.14659762382507324, "kl": 0.018802836537361145, "entropy": 1.3998396396636963, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 235248, "episodes_total": 530, "training_iteration": 21, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-57-36", "timestamp": 1585101456, "time_this_iter_s": 22.43933629989624, "time_total_s": 491.6549208164215, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2d0d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2dc80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2dae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc54158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 491.6549208164215, "timesteps_since_restore": 235248, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 41.553125, "ram_util_percent": 53.575}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1890436639493918, "episode_reward_min": -2.730858925902695, "episode_reward_mean": 0.9173416000858162, "episode_len_mean": 419.88, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.32414897529534153}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2741607108933697, "avg_speed_min": 0.16783962123328514, "avg_speed_max": 5.374227927899113, "avg_rl_veh_arrival_mean": 372.885, "avg_rl_veh_arrival_min": 56.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.950772944107853, "mean_processing_ms": 3.212045372115883, "mean_inference_ms": 0.9300494412524957}, "off_policy_estimator": {}, "info": {"num_steps_trained": 246448, "num_steps_sampled": 246448, "sample_time_ms": 22741.016, "grad_time_ms": 403.41, "update_time_ms": 5.068, "opt_peak_throughput": 27775.186, "sample_peak_throughput": 492.713, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.2354481816291809, "policy_loss": 0.004668602254241705, "vf_loss": 0.23009997606277466, "vf_explained_var": 0.13006412982940674, "kl": 0.009060963988304138, "entropy": 1.4205180406570435, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 246448, "episodes_total": 557, "training_iteration": 22, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-57-58", "timestamp": 1585101478, "time_this_iter_s": 22.409228801727295, "time_total_s": 514.0641496181488, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc54ae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc54bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc54840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4cb0d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 514.0641496181488, "timesteps_since_restore": 246448, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 42.178125, "ram_util_percent": 53.462500000000006}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1890436639493918, "episode_reward_min": -2.730858925902695, "episode_reward_mean": 1.0120787742522068, "episode_len_mean": 433.59, "episodes_this_iter": 23, "policy_reward_mean": {"av": 0.35387369729098145}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2953706304611834, "avg_speed_min": 0.18048144363905824, "avg_speed_max": 5.374227927899113, "avg_rl_veh_arrival_mean": 379.9066666666667, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.918003145275082, "mean_processing_ms": 3.208953664720487, "mean_inference_ms": 0.9283968112066653}, "off_policy_estimator": {}, "info": {"num_steps_trained": 257648, "num_steps_sampled": 257648, "sample_time_ms": 22705.184, "grad_time_ms": 407.77, "update_time_ms": 5.587, "opt_peak_throughput": 27478.266, "sample_peak_throughput": 493.491, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.04407667741179466, "policy_loss": -0.056982364505529404, "vf_loss": 0.10030245780944824, "vf_explained_var": 0.137384295463562, "kl": 0.010088237933814526, "entropy": 1.4169658422470093, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 257648, "episodes_total": 580, "training_iteration": 23, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-58-20", "timestamp": 1585101500, "time_this_iter_s": 21.763198614120483, "time_total_s": 535.8273482322693, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4cb378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4cb400>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4cb488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4cbae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 535.8273482322693, "timesteps_since_restore": 257648, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 48.33870967741935, "ram_util_percent": 53.60645161290321}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1890436639493918, "episode_reward_min": -2.726459506789807, "episode_reward_mean": 1.1607274385478417, "episode_len_mean": 444.68, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.3961527094019938}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3735497751413646, "avg_speed_min": 0.18048144363905824, "avg_speed_max": 5.374227927899113, "avg_rl_veh_arrival_mean": 386.06666666666666, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.8743357426474, "mean_processing_ms": 3.2101222233543463, "mean_inference_ms": 0.9261462244743409}, "off_policy_estimator": {}, "info": {"num_steps_trained": 268848, "num_steps_sampled": 268848, "sample_time_ms": 22606.208, "grad_time_ms": 406.658, "update_time_ms": 5.694, "opt_peak_throughput": 27553.369, "sample_peak_throughput": 495.651, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.13601821660995483, "policy_loss": -0.009422657079994678, "vf_loss": 0.14483214914798737, "vf_explained_var": 0.12142276763916016, "kl": 0.008116223849356174, "entropy": 1.4111710786819458, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 268848, "episodes_total": 604, "training_iteration": 24, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-58-44", "timestamp": 1585101524, "time_this_iter_s": 23.689262866973877, "time_total_s": 559.5166110992432, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc540d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc54378>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc54950>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2dd90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 559.5166110992432, "timesteps_since_restore": 268848, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 46.923529411764704, "ram_util_percent": 53.705882352941174}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1512512004950493, "episode_reward_min": -2.726459506789807, "episode_reward_mean": 1.2310065206260519, "episode_len_mean": 452.87, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4215775755568671}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3104491246846384, "avg_speed_min": 0.032998478023231484, "avg_speed_max": 4.01299537174912, "avg_rl_veh_arrival_mean": 393.3066666666666, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.853261902373298, "mean_processing_ms": 3.2045849378962936, "mean_inference_ms": 0.9265838664116207}, "off_policy_estimator": {}, "info": {"num_steps_trained": 280048, "num_steps_sampled": 280048, "sample_time_ms": 22689.625, "grad_time_ms": 404.61, "update_time_ms": 5.677, "opt_peak_throughput": 27692.872, "sample_peak_throughput": 493.829, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.057026974856853485, "policy_loss": -0.039341654628515244, "vf_loss": 0.09582990407943726, "vf_explained_var": 0.1917715072631836, "kl": 0.007182872388511896, "entropy": 1.403154730796814, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 280048, "episodes_total": 628, "training_iteration": 25, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_18-59-07", "timestamp": 1585101547, "time_this_iter_s": 23.26507329940796, "time_total_s": 582.7816843986511, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2d510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d400>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df202f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 582.7816843986511, "timesteps_since_restore": 280048, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 49.375757575757575, "ram_util_percent": 53.621212121212125}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1512512004950493, "episode_reward_min": -2.672498016454914, "episode_reward_mean": 1.4170034842173809, "episode_len_mean": 457.93, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.48862189110944176}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3179023468537787, "avg_speed_min": 0.032998478023231484, "avg_speed_max": 4.01299537174912, "avg_rl_veh_arrival_mean": 380.51499999999993, "avg_rl_veh_arrival_min": 50.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.8595785705647305, "mean_processing_ms": 3.2028460057477925, "mean_inference_ms": 0.9301238312459422}, "off_policy_estimator": {}, "info": {"num_steps_trained": 291248, "num_steps_sampled": 291248, "sample_time_ms": 23126.385, "grad_time_ms": 407.476, "update_time_ms": 5.58, "opt_peak_throughput": 27498.037, "sample_peak_throughput": 484.503, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.07500000298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.005240385886281729, "policy_loss": -0.01938803866505623, "vf_loss": 0.024357125163078308, "vf_explained_var": 0.4502638578414917, "kl": 0.0036172624677419662, "entropy": 1.4297678470611572, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 291248, "episodes_total": 654, "training_iteration": 26, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-00-03", "timestamp": 1585101603, "time_this_iter_s": 28.291756868362427, "time_total_s": 611.0734412670135, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2db70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d6a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d2f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 611.0734412670135, "timesteps_since_restore": 291248, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 33.56708860759494, "ram_util_percent": 54.3379746835443}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0265944793036845, "episode_reward_min": -2.672498016454914, "episode_reward_mean": 1.3377906009356995, "episode_len_mean": 441.08, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.4661291292458884}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3104471479918716, "avg_speed_min": 0.032998478023231484, "avg_speed_max": 3.672758349535254, "avg_rl_veh_arrival_mean": 372.35, "avg_rl_veh_arrival_min": 50.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.919034509262492, "mean_processing_ms": 3.2124871592309265, "mean_inference_ms": 0.9386483443552686}, "off_policy_estimator": {}, "info": {"num_steps_trained": 302448, "num_steps_sampled": 302448, "sample_time_ms": 23523.809, "grad_time_ms": 401.401, "update_time_ms": 6.527, "opt_peak_throughput": 27914.242, "sample_peak_throughput": 476.317, "opt_samples": 11204.8, "learner": {"av": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.18213310837745667, "policy_loss": 0.02692675031721592, "vf_loss": 0.15449805557727814, "vf_explained_var": 0.1399214267730713, "kl": 0.018886350095272064, "entropy": 1.4527406692504883, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 302448, "episodes_total": 683, "training_iteration": 27, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-00-30", "timestamp": 1585101630, "time_this_iter_s": 27.766225337982178, "time_total_s": 638.8396666049957, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc54158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc54bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc54ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4cb0d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 638.8396666049957, "timesteps_since_restore": 302448, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 56.995000000000005}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.102135011539721, "episode_reward_min": -2.672498016454914, "episode_reward_mean": 1.4608074935556468, "episode_len_mean": 450.26, "episodes_this_iter": 20, "policy_reward_mean": {"av": 0.5089921580333265}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3620393374578477, "avg_speed_min": 0.032998478023231484, "avg_speed_max": 4.528534384207749, "avg_rl_veh_arrival_mean": 372.8783333333333, "avg_rl_veh_arrival_min": 50.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.972356822608501, "mean_processing_ms": 3.2176709660548704, "mean_inference_ms": 0.9461779942650407}, "off_policy_estimator": {}, "info": {"num_steps_trained": 313686, "num_steps_sampled": 313686, "sample_time_ms": 23917.516, "grad_time_ms": 423.533, "update_time_ms": 6.388, "opt_peak_throughput": 26464.503, "sample_peak_throughput": 468.636, "opt_samples": 11208.6, "learner": {"av": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 0.0010000000474974513, "total_loss": -0.02560434862971306, "policy_loss": -0.0446825809776783, "vf_loss": 0.01880156248807907, "vf_explained_var": 0.5293419361114502, "kl": 0.007377974689006805, "entropy": 1.438485860824585, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11238, "done": false, "timesteps_total": 313686, "episodes_total": 703, "training_iteration": 28, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-00-59", "timestamp": 1585101659, "time_this_iter_s": 28.565032243728638, "time_total_s": 667.4046988487244, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4cbb70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4cbc80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4cbd08>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58400>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 667.4046988487244, "timesteps_since_restore": 313686, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 62.01500000000001, "ram_util_percent": 56.92999999999999}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.102135011539721, "episode_reward_min": -2.3752739923799853, "episode_reward_mean": 1.4537994243382724, "episode_len_mean": 445.45, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.5083214770413541}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.357800419959058, "avg_speed_min": 0.35940101185475737, "avg_speed_max": 4.528534384207749, "avg_rl_veh_arrival_mean": 361.12166666666667, "avg_rl_veh_arrival_min": 48.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.061368310172742, "mean_processing_ms": 3.22694336026222, "mean_inference_ms": 0.9577741595782379}, "off_policy_estimator": {}, "info": {"num_steps_trained": 324897, "num_steps_sampled": 324897, "sample_time_ms": 24392.964, "grad_time_ms": 434.309, "update_time_ms": 7.338, "opt_peak_throughput": 25810.398, "sample_peak_throughput": 459.546, "opt_samples": 11209.7, "learner": {"av": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.10076812654733658, "policy_loss": -0.015824787318706512, "vf_loss": 0.11602934449911118, "vf_explained_var": 0.2097080945968628, "kl": 0.01502838172018528, "entropy": 1.3958820104599, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11211, "done": false, "timesteps_total": 324897, "episodes_total": 729, "training_iteration": 29, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-01-27", "timestamp": 1585101687, "time_this_iter_s": 27.650449514389038, "time_total_s": 695.0551483631134, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc542f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc54268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc548c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2dc80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 695.0551483631134, "timesteps_since_restore": 324897, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 56.86, "ram_util_percent": 56.13249999999999}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.102135011539721, "episode_reward_min": -2.8718194781376583, "episode_reward_mean": 1.2685819048581701, "episode_len_mean": 435.39, "episodes_this_iter": 32, "policy_reward_mean": {"av": 0.44356010659376577}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.363548635677961, "avg_speed_min": 0.10101207146409097, "avg_speed_max": 4.528534384207749, "avg_rl_veh_arrival_mean": 366.42166666666674, "avg_rl_veh_arrival_min": 48.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.135000680158742, "mean_processing_ms": 3.246056984878555, "mean_inference_ms": 0.9683779375160264}, "off_policy_estimator": {}, "info": {"num_steps_trained": 336097, "num_steps_sampled": 336097, "sample_time_ms": 24904.816, "grad_time_ms": 421.464, "update_time_ms": 7.408, "opt_peak_throughput": 26585.637, "sample_peak_throughput": 449.909, "opt_samples": 11204.9, "learner": {"av": {"cur_kl_coeff": 0.03750000149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.3782830536365509, "policy_loss": 0.08101226389408112, "vf_loss": 0.2961694300174713, "vf_explained_var": 0.10176271200180054, "kl": 0.029374107718467712, "entropy": 1.4459123611450195, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 336097, "episodes_total": 761, "training_iteration": 30, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-01-54", "timestamp": 1585101714, "time_this_iter_s": 27.671015739440918, "time_total_s": 722.7261641025543, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2dd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc589d8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 722.7261641025543, "timesteps_since_restore": 336097, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 52.70769230769232, "ram_util_percent": 55.72564102564102}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2585510967851437, "episode_reward_min": -2.8718194781376583, "episode_reward_mean": 1.0891876246164427, "episode_len_mean": 418.85, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.3876112543119014}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3597284267731684, "avg_speed_min": 0.10101207146409097, "avg_speed_max": 4.528534384207749, "avg_rl_veh_arrival_mean": 356.5666666666667, "avg_rl_veh_arrival_min": 48.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.194564422310826, "mean_processing_ms": 3.2573634403052605, "mean_inference_ms": 0.9766377354691526}, "off_policy_estimator": {}, "info": {"num_steps_trained": 347297, "num_steps_sampled": 347297, "sample_time_ms": 25644.45, "grad_time_ms": 431.306, "update_time_ms": 7.423, "opt_peak_throughput": 25979.0, "sample_peak_throughput": 436.933, "opt_samples": 11204.9, "learner": {"av": {"cur_kl_coeff": 0.05624999850988388, "cur_lr": 0.0010000000474974513, "total_loss": 0.28321078419685364, "policy_loss": 0.02495618909597397, "vf_loss": 0.25773757696151733, "vf_explained_var": 0.11974388360977173, "kl": 0.009191314689815044, "entropy": 1.4455695152282715, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 347297, "episodes_total": 787, "training_iteration": 31, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-02-24", "timestamp": 1585101744, "time_this_iter_s": 29.938371419906616, "time_total_s": 752.6645355224609, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58bf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58d08>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58d90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc70488>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 752.6645355224609, "timesteps_since_restore": 347297, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 54.3046511627907, "ram_util_percent": 55.7232558139535}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2585510967851437, "episode_reward_min": -2.8718194781376583, "episode_reward_mean": 0.9032077178715744, "episode_len_mean": 401.26, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.3248948625437318}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.4020415799935737, "avg_speed_min": 0.10101207146409097, "avg_speed_max": 5.706201089948948, "avg_rl_veh_arrival_mean": 349.93833333333333, "avg_rl_veh_arrival_min": 48.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.219765340039224, "mean_processing_ms": 3.27099210069507, "mean_inference_ms": 0.98141694189067}, "off_policy_estimator": {}, "info": {"num_steps_trained": 358512, "num_steps_sampled": 358512, "sample_time_ms": 26278.842, "grad_time_ms": 422.327, "update_time_ms": 7.506, "opt_peak_throughput": 26534.919, "sample_peak_throughput": 426.442, "opt_samples": 11206.4, "learner": {"av": {"cur_kl_coeff": 0.05624999850988388, "cur_lr": 0.0010000000474974513, "total_loss": 0.17737874388694763, "policy_loss": -0.014349970035254955, "vf_loss": 0.19079460203647614, "vf_explained_var": 0.13356196880340576, "kl": 0.016606733202934265, "entropy": 1.4472390413284302, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11215, "done": false, "timesteps_total": 358512, "episodes_total": 814, "training_iteration": 32, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-02-53", "timestamp": 1585101773, "time_this_iter_s": 28.661551475524902, "time_total_s": 781.3260869979858, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc706a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc707b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc70840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc70ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 781.3260869979858, "timesteps_since_restore": 358512, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 53.3219512195122, "ram_util_percent": 55.882926829268285}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2585510967851437, "episode_reward_min": -2.8106818164695566, "episode_reward_mean": 0.9355954628817724, "episode_len_mean": 413.42, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.32943502214146925}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.419265727714593, "avg_speed_min": 0.12200132738346478, "avg_speed_max": 5.706201089948948, "avg_rl_veh_arrival_mean": 357.3166666666667, "avg_rl_veh_arrival_min": 95.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.249177319248338, "mean_processing_ms": 3.279618614308913, "mean_inference_ms": 0.9873033014456483}, "off_policy_estimator": {}, "info": {"num_steps_trained": 369799, "num_steps_sampled": 369799, "sample_time_ms": 27009.166, "grad_time_ms": 456.762, "update_time_ms": 7.138, "opt_peak_throughput": 24553.505, "sample_peak_throughput": 415.233, "opt_samples": 11215.1, "learner": {"av": {"cur_kl_coeff": 0.05624999850988388, "cur_lr": 0.0010000000474974513, "total_loss": 0.11143611371517181, "policy_loss": -0.01923278160393238, "vf_loss": 0.13003920018672943, "vf_explained_var": 0.21980124711990356, "kl": 0.011194774881005287, "entropy": 1.4643360376358032, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11287, "done": false, "timesteps_total": 369799, "episodes_total": 839, "training_iteration": 33, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-03-23", "timestamp": 1585101803, "time_this_iter_s": 29.42511820793152, "time_total_s": 810.7512052059174, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc588c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2dc80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 810.7512052059174, "timesteps_since_restore": 369799, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 53.93095238095237, "ram_util_percent": 56.419047619047625}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2585510967851437, "episode_reward_min": -2.8012267377682165, "episode_reward_mean": 1.0715640404496278, "episode_len_mean": 425.37, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.3759873826139045}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.597567472810734, "avg_speed_min": 0.12200132738346478, "avg_speed_max": 5.706201089948948, "avg_rl_veh_arrival_mean": 340.29666666666674, "avg_rl_veh_arrival_min": 95.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.28013484695188, "mean_processing_ms": 3.286496480813126, "mean_inference_ms": 0.99364897592012}, "off_policy_estimator": {}, "info": {"num_steps_trained": 380999, "num_steps_sampled": 380999, "sample_time_ms": 27352.075, "grad_time_ms": 448.408, "update_time_ms": 7.297, "opt_peak_throughput": 25010.907, "sample_peak_throughput": 410.027, "opt_samples": 11215.1, "learner": {"av": {"cur_kl_coeff": 0.05624999850988388, "cur_lr": 0.0010000000474974513, "total_loss": 0.10898087173700333, "policy_loss": -0.03305451571941376, "vf_loss": 0.14107127487659454, "vf_explained_var": 0.18406826257705688, "kl": 0.017138950526714325, "entropy": 1.444293737411499, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 380999, "episodes_total": 866, "training_iteration": 34, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-03-50", "timestamp": 1585101830, "time_this_iter_s": 27.035644054412842, "time_total_s": 837.7868492603302, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2d730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d7b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc549d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4cbc80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 837.7868492603302, "timesteps_since_restore": 380999, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 62.23333333333334, "ram_util_percent": 57.26923076923076}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1654467557222916, "episode_reward_min": -2.8012267377682165, "episode_reward_mean": 1.2415008403748105, "episode_len_mean": 443.5, "episodes_this_iter": 21, "policy_reward_mean": {"av": 0.42958506587363676}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7060826670670957, "avg_speed_min": 0.12200132738346478, "avg_speed_max": 5.706201089948948, "avg_rl_veh_arrival_mean": 336.21, "avg_rl_veh_arrival_min": 95.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.29277189364847, "mean_processing_ms": 3.2899784297191697, "mean_inference_ms": 0.9960451078582787}, "off_policy_estimator": {}, "info": {"num_steps_trained": 392276, "num_steps_sampled": 392276, "sample_time_ms": 27202.691, "grad_time_ms": 427.306, "update_time_ms": 7.251, "opt_peak_throughput": 26264.083, "sample_peak_throughput": 412.562, "opt_samples": 11222.8, "learner": {"av": {"cur_kl_coeff": 0.05624999850988388, "cur_lr": 0.0010000000474974513, "total_loss": -0.05308567360043526, "policy_loss": -0.08186209946870804, "vf_loss": 0.028320614248514175, "vf_explained_var": 0.4880378842353821, "kl": 0.00810324028134346, "entropy": 1.4346280097961426, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11277, "done": false, "timesteps_total": 392276, "episodes_total": 887, "training_iteration": 35, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-04-11", "timestamp": 1585101851, "time_this_iter_s": 21.552642107009888, "time_total_s": 859.3394913673401, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4cb1e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4cb268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4cb0d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc750d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 859.3394913673401, "timesteps_since_restore": 392276, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 52.879999999999995, "ram_util_percent": 57.653333333333336}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1654467557222916, "episode_reward_min": -2.5859667767591326, "episode_reward_mean": 1.3143120583601948, "episode_len_mean": 445.06, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.4532110546069636}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8521517178089426, "avg_speed_min": 0.0673687679189627, "avg_speed_max": 5.180482670227208, "avg_rl_veh_arrival_mean": 327.91666666666674, "avg_rl_veh_arrival_min": 91.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.307289883765689, "mean_processing_ms": 3.290284796928237, "mean_inference_ms": 0.9986375034615019}, "off_policy_estimator": {}, "info": {"num_steps_trained": 403522, "num_steps_sampled": 403522, "sample_time_ms": 26996.519, "grad_time_ms": 421.403, "update_time_ms": 8.254, "opt_peak_throughput": 26642.887, "sample_peak_throughput": 415.883, "opt_samples": 11227.4, "learner": {"av": {"cur_kl_coeff": 0.05624999850988388, "cur_lr": 0.0010000000474974513, "total_loss": 0.2647664546966553, "policy_loss": 0.03382066637277603, "vf_loss": 0.22911196947097778, "vf_explained_var": 0.07973659038543701, "kl": 0.03260079398751259, "entropy": 1.4688776731491089, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11246, "done": false, "timesteps_total": 403522, "episodes_total": 915, "training_iteration": 36, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-04-37", "timestamp": 1585101877, "time_this_iter_s": 26.19249939918518, "time_total_s": 885.5319907665253, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2dae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2db70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc588c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 885.5319907665253, "timesteps_since_restore": 403522, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 50.38157894736842, "ram_util_percent": 57.907894736842096}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2297160530606703, "episode_reward_min": -2.5766213657566817, "episode_reward_mean": 1.3087952655933328, "episode_len_mean": 442.17, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.4497578232279495}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8740913127890435, "avg_speed_min": 0.0673687679189627, "avg_speed_max": 5.180482670227208, "avg_rl_veh_arrival_mean": 328.20833333333326, "avg_rl_veh_arrival_min": 91.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.317398061518515, "mean_processing_ms": 3.2886801527975535, "mean_inference_ms": 0.9997775486004639}, "off_policy_estimator": {}, "info": {"num_steps_trained": 414722, "num_steps_sampled": 414722, "sample_time_ms": 27171.598, "grad_time_ms": 429.422, "update_time_ms": 7.34, "opt_peak_throughput": 26145.378, "sample_peak_throughput": 413.204, "opt_samples": 11227.4, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.12562747299671173, "policy_loss": 0.04225422441959381, "vf_loss": 0.08277294784784317, "vf_explained_var": 0.16736257076263428, "kl": 0.007114673499017954, "entropy": 1.4471091032028198, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 414722, "episodes_total": 943, "training_iteration": 37, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-05-07", "timestamp": 1585101907, "time_this_iter_s": 29.593438863754272, "time_total_s": 915.1254296302795, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc586a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc75268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 915.1254296302795, "timesteps_since_restore": 414722, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 55.18333333333333, "ram_util_percent": 58.07857142857142}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2297160530606703, "episode_reward_min": -2.662850328035904, "episode_reward_mean": 1.3595109414959676, "episode_len_mean": 447.49, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4671858905484426}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8138474341811412, "avg_speed_min": 0.0673687679189627, "avg_speed_max": 5.000183583466304, "avg_rl_veh_arrival_mean": 335.955, "avg_rl_veh_arrival_min": 91.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.333531934431292, "mean_processing_ms": 3.293299982091981, "mean_inference_ms": 0.9999287515900788}, "off_policy_estimator": {}, "info": {"num_steps_trained": 426011, "num_steps_sampled": 426011, "sample_time_ms": 27076.199, "grad_time_ms": 433.439, "update_time_ms": 7.597, "opt_peak_throughput": 25914.827, "sample_peak_throughput": 414.848, "opt_samples": 11232.5, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 0.0010000000474974513, "total_loss": -0.0038390217814594507, "policy_loss": -0.04196552559733391, "vf_loss": 0.03765128180384636, "vf_explained_var": 0.3100607991218567, "kl": 0.005632160231471062, "entropy": 1.4485455751419067, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11289, "done": false, "timesteps_total": 426011, "episodes_total": 967, "training_iteration": 38, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-05-35", "timestamp": 1585101935, "time_this_iter_s": 27.641650676727295, "time_total_s": 942.7670803070068, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc75510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc75598>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc75620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc75c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 942.7670803070068, "timesteps_since_restore": 426011, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 56.1974358974359, "ram_util_percent": 57.97692307692307}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2297160530606703, "episode_reward_min": -2.662850328035904, "episode_reward_mean": 1.1194077467983552, "episode_len_mean": 436.85, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.3914013100693551}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.682519301637917, "avg_speed_min": 0.052864856161709814, "avg_speed_max": 5.912213432746695, "avg_rl_veh_arrival_mean": 344.0966666666667, "avg_rl_veh_arrival_min": 91.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.34963269638362, "mean_processing_ms": 3.2941987947302804, "mean_inference_ms": 1.0011863439316382}, "off_policy_estimator": {}, "info": {"num_steps_trained": 437298, "num_steps_sampled": 437298, "sample_time_ms": 27151.158, "grad_time_ms": 437.172, "update_time_ms": 6.752, "opt_peak_throughput": 25710.927, "sample_peak_throughput": 413.982, "opt_samples": 11240.1, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.32179710268974304, "policy_loss": 0.07113754004240036, "vf_loss": 0.2492552548646927, "vf_explained_var": 0.14402025938034058, "kl": 0.016643082723021507, "entropy": 1.4687426090240479, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11287, "done": false, "timesteps_total": 437298, "episodes_total": 994, "training_iteration": 39, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-06-03", "timestamp": 1585101963, "time_this_iter_s": 28.438157081604004, "time_total_s": 971.2052373886108, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc587b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2dc80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d0d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 971.2052373886108, "timesteps_since_restore": 437298, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 54.74878048780487, "ram_util_percent": 58.06341463414634}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2297160530606703, "episode_reward_min": -2.662850328035904, "episode_reward_mean": 0.9458484839996742, "episode_len_mean": 415.09, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.3342220791518284}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6256870204244653, "avg_speed_min": 0.052864856161709814, "avg_speed_max": 5.912213432746695, "avg_rl_veh_arrival_mean": 345.3716666666667, "avg_rl_veh_arrival_min": 98.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.382276661350803, "mean_processing_ms": 3.308310906390714, "mean_inference_ms": 1.0033130815705678}, "off_policy_estimator": {}, "info": {"num_steps_trained": 448498, "num_steps_sampled": 448498, "sample_time_ms": 27452.103, "grad_time_ms": 436.821, "update_time_ms": 7.288, "opt_peak_throughput": 25731.578, "sample_peak_throughput": 409.444, "opt_samples": 11240.1, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.2591415345668793, "policy_loss": 0.019057562574744225, "vf_loss": 0.23916012048721313, "vf_explained_var": 0.11589038372039795, "kl": 0.010948272421956062, "entropy": 1.4945464134216309, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 448498, "episodes_total": 1022, "training_iteration": 40, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-06-34", "timestamp": 1585101994, "time_this_iter_s": 30.68281579017639, "time_total_s": 1001.8880531787872, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4cbc80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4cbb70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc549d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc75e18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1001.8880531787872, "timesteps_since_restore": 448498, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 54.19772727272727, "ram_util_percent": 58.177272727272744}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1045001001794423, "episode_reward_min": -2.5927072812495977, "episode_reward_mean": 0.924382165115857, "episode_len_mean": 410.9, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.33013648754137764}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7781572628876123, "avg_speed_min": 0.052864856161709814, "avg_speed_max": 5.912213432746695, "avg_rl_veh_arrival_mean": 334.925, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.412462342571668, "mean_processing_ms": 3.3144243802421203, "mean_inference_ms": 1.006801690717304}, "off_policy_estimator": {}, "info": {"num_steps_trained": 459698, "num_steps_sampled": 459698, "sample_time_ms": 27418.661, "grad_time_ms": 437.714, "update_time_ms": 7.327, "opt_peak_throughput": 25679.119, "sample_peak_throughput": 409.943, "opt_samples": 11240.1, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.23464713990688324, "policy_loss": -0.01077442616224289, "vf_loss": 0.24466769397258759, "vf_explained_var": 0.1679447889328003, "kl": 0.008934222161769867, "entropy": 1.462531328201294, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 459698, "episodes_total": 1050, "training_iteration": 41, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-07-04", "timestamp": 1585102024, "time_this_iter_s": 29.619555473327637, "time_total_s": 1031.5076086521149, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc8c0d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc8c1e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc8c268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc8c8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1031.5076086521149, "timesteps_since_restore": 459698, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 57.480952380952374, "ram_util_percent": 59.56190476190477}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.207151370254249, "episode_reward_min": -2.8416003369414713, "episode_reward_mean": 0.9144950054067899, "episode_len_mean": 403.82, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.325443062422345}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7904862953627725, "avg_speed_min": 0.052864856161709814, "avg_speed_max": 5.209453776521478, "avg_rl_veh_arrival_mean": 338.5516666666666, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.433464281214839, "mean_processing_ms": 3.319305312744666, "mean_inference_ms": 1.0085832493434577}, "off_policy_estimator": {}, "info": {"num_steps_trained": 470898, "num_steps_sampled": 470898, "sample_time_ms": 27208.984, "grad_time_ms": 441.267, "update_time_ms": 7.822, "opt_peak_throughput": 25468.907, "sample_peak_throughput": 413.047, "opt_samples": 11238.6, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.06191469728946686, "policy_loss": -0.05084899440407753, "vf_loss": 0.11213364452123642, "vf_explained_var": 0.19384151697158813, "kl": 0.007467213086783886, "entropy": 1.4632192850112915, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 470898, "episodes_total": 1076, "training_iteration": 42, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-07-30", "timestamp": 1585102050, "time_this_iter_s": 26.596115112304688, "time_total_s": 1058.1037237644196, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4cb0d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4cb1e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4cb268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d268>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1058.1037237644196, "timesteps_since_restore": 470898, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 50.97105263157895, "ram_util_percent": 60.40526315789474}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.207151370254249, "episode_reward_min": -2.8416003369414713, "episode_reward_mean": 1.1089639458377798, "episode_len_mean": 414.57, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.3904802626189365}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.943807589407403, "avg_speed_min": 0.12609294807320842, "avg_speed_max": 5.209453776521478, "avg_rl_veh_arrival_mean": 332.965, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.447054661506217, "mean_processing_ms": 3.3262841211948, "mean_inference_ms": 1.0089283741120738}, "off_policy_estimator": {}, "info": {"num_steps_trained": 482108, "num_steps_sampled": 482108, "sample_time_ms": 26570.183, "grad_time_ms": 399.265, "update_time_ms": 8.88, "opt_peak_throughput": 28128.94, "sample_peak_throughput": 422.688, "opt_samples": 11230.9, "learner": {"av": {"cur_kl_coeff": 0.08437500149011612, "cur_lr": 0.0010000000474974513, "total_loss": 0.2670927345752716, "policy_loss": -0.0012460319558158517, "vf_loss": 0.26662304997444153, "vf_explained_var": 0.16046857833862305, "kl": 0.020333988592028618, "entropy": 1.4973331689834595, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11210, "done": false, "timesteps_total": 482108, "episodes_total": 1100, "training_iteration": 43, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-07-53", "timestamp": 1585102073, "time_this_iter_s": 22.60521674156189, "time_total_s": 1080.7089405059814, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc588c8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc586a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc8ca60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1080.7089405059814, "timesteps_since_restore": 482108, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 53.98125, "ram_util_percent": 60.0}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.207151370254249, "episode_reward_min": -2.8416003369414713, "episode_reward_mean": 1.294860411346913, "episode_len_mean": 442.43, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4496043094954558}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9829249601812347, "avg_speed_min": 0.20782497413512466, "avg_speed_max": 5.209453776521478, "avg_rl_veh_arrival_mean": 341.07333333333327, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.442866512030827, "mean_processing_ms": 3.3237045990438, "mean_inference_ms": 1.008497328954951}, "off_policy_estimator": {}, "info": {"num_steps_trained": 493353, "num_steps_sampled": 493353, "sample_time_ms": 26143.502, "grad_time_ms": 395.626, "update_time_ms": 9.512, "opt_peak_throughput": 28399.032, "sample_peak_throughput": 429.759, "opt_samples": 11235.4, "learner": {"av": {"cur_kl_coeff": 0.12656250596046448, "cur_lr": 0.0010000000474974513, "total_loss": 0.08941001445055008, "policy_loss": -0.032143302261829376, "vf_loss": 0.12048382312059402, "vf_explained_var": 0.17777478694915771, "kl": 0.008450150489807129, "entropy": 1.4756879806518555, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11245, "done": false, "timesteps_total": 493353, "episodes_total": 1124, "training_iteration": 44, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-08-16", "timestamp": 1585102096, "time_this_iter_s": 22.733983278274536, "time_total_s": 1103.442923784256, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc8cd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc8cd90>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc8ce18>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc19510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1103.442923784256, "timesteps_since_restore": 493353, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 51.63939393939393, "ram_util_percent": 60.17272727272727}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.207151370254249, "episode_reward_min": -2.8416003369414713, "episode_reward_mean": 1.3868819262179184, "episode_len_mean": 459.98, "episodes_this_iter": 23, "policy_reward_mean": {"av": 0.4733385413713031}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9933526113781745, "avg_speed_min": 0.20782497413512466, "avg_speed_max": 5.209453776521478, "avg_rl_veh_arrival_mean": 346.03166666666664, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.41551543176215, "mean_processing_ms": 3.319205918707498, "mean_inference_ms": 1.0054906417095169}, "off_policy_estimator": {}, "info": {"num_steps_trained": 504553, "num_steps_sampled": 504553, "sample_time_ms": 26130.794, "grad_time_ms": 407.869, "update_time_ms": 9.473, "opt_peak_throughput": 27527.698, "sample_peak_throughput": 429.673, "opt_samples": 11227.7, "learner": {"av": {"cur_kl_coeff": 0.12656250596046448, "cur_lr": 0.0010000000474974513, "total_loss": -0.0041457186453044415, "policy_loss": -0.055932026356458664, "vf_loss": 0.051259733736515045, "vf_explained_var": 0.3989905118942261, "kl": 0.004160621203482151, "entropy": 1.4722098112106323, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 504553, "episodes_total": 1147, "training_iteration": 45, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-08-37", "timestamp": 1585102117, "time_this_iter_s": 21.55465865135193, "time_total_s": 1124.997582435608, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc587b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58400>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1124.997582435608, "timesteps_since_restore": 504553, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 51.57419354838709, "ram_util_percent": 60.396774193548396}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1946070937129973, "episode_reward_min": -2.7638587125605514, "episode_reward_mean": 1.2902500468776368, "episode_len_mean": 454.45, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.44035837777393744}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.00976498414757, "avg_speed_min": 0.16295042290241604, "avg_speed_max": 5.208030778111956, "avg_rl_veh_arrival_mean": 339.605, "avg_rl_veh_arrival_min": 140.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.390009659813673, "mean_processing_ms": 3.3195076533436003, "mean_inference_ms": 1.0020751676245838}, "off_policy_estimator": {}, "info": {"num_steps_trained": 515833, "num_steps_sampled": 515833, "sample_time_ms": 25890.264, "grad_time_ms": 410.771, "update_time_ms": 8.711, "opt_peak_throughput": 27341.517, "sample_peak_throughput": 433.796, "opt_samples": 11231.1, "learner": {"av": {"cur_kl_coeff": 0.06328125298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.22051148116588593, "policy_loss": 0.04507247358560562, "vf_loss": 0.17460255324840546, "vf_explained_var": 0.2270517349243164, "kl": 0.01321814488619566, "entropy": 1.4954012632369995, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11280, "done": false, "timesteps_total": 515833, "episodes_total": 1175, "training_iteration": 46, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-09-01", "timestamp": 1585102141, "time_this_iter_s": 23.7942476272583, "time_total_s": 1148.7918300628662, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4cbd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4cb1e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4cb0d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc196a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1148.7918300628662, "timesteps_since_restore": 515833, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 49.30882352941177, "ram_util_percent": 60.54117647058824}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.18960516306068, "episode_reward_min": -2.7638587125605514, "episode_reward_mean": 1.190202415699408, "episode_len_mean": 445.86, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.40483075363925447}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.044572559628129, "avg_speed_min": 0.16295042290241604, "avg_speed_max": 5.208030778111956, "avg_rl_veh_arrival_mean": 337.0433333333333, "avg_rl_veh_arrival_min": 137.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.364453492592574, "mean_processing_ms": 3.315821936478758, "mean_inference_ms": 0.999000655860216}, "off_policy_estimator": {}, "info": {"num_steps_trained": 527208, "num_steps_sampled": 527208, "sample_time_ms": 25187.66, "grad_time_ms": 400.593, "update_time_ms": 8.557, "opt_peak_throughput": 28079.874, "sample_peak_throughput": 446.592, "opt_samples": 11248.6, "learner": {"av": {"cur_kl_coeff": 0.06328125298023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.5545618534088135, "policy_loss": 0.08209778368473053, "vf_loss": 0.4702751040458679, "vf_explained_var": 0.08701884746551514, "kl": 0.03459031507372856, "entropy": 1.5095281600952148, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11375, "done": false, "timesteps_total": 527208, "episodes_total": 1201, "training_iteration": 47, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-09-23", "timestamp": 1585102163, "time_this_iter_s": 22.467679738998413, "time_total_s": 1171.2595098018646, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc198c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc199d8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc23158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1171.2595098018646, "timesteps_since_restore": 527208, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 49.675, "ram_util_percent": 60.581250000000004}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.18960516306068, "episode_reward_min": -2.569623079145013, "episode_reward_mean": 1.1980035413261179, "episode_len_mean": 444.91, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.40887492878024506}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0677277965835277, "avg_speed_min": 0.16295042290241604, "avg_speed_max": 5.418209417676045, "avg_rl_veh_arrival_mean": 330.8466666666667, "avg_rl_veh_arrival_min": 122.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.333958064260829, "mean_processing_ms": 3.313307999418737, "mean_inference_ms": 0.9950735503899608}, "off_policy_estimator": {}, "info": {"num_steps_trained": 538569, "num_steps_sampled": 538569, "sample_time_ms": 24602.326, "grad_time_ms": 373.416, "update_time_ms": 8.559, "opt_peak_throughput": 30142.781, "sample_peak_throughput": 457.51, "opt_samples": 11255.8, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 0.0010000000474974513, "total_loss": -0.028080709278583527, "policy_loss": -0.0943283960223198, "vf_loss": 0.06538085639476776, "vf_explained_var": 0.252666175365448, "kl": 0.009131904691457748, "entropy": 1.4656885862350464, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11361, "done": false, "timesteps_total": 538569, "episodes_total": 1227, "training_iteration": 48, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-09-45", "timestamp": 1585102185, "time_this_iter_s": 21.512038946151733, "time_total_s": 1192.7715487480164, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2d730>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d7b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d0d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2da60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1192.7715487480164, "timesteps_since_restore": 538569, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 52.18333333333333, "ram_util_percent": 58.94333333333334}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0716108388133954, "episode_reward_min": -2.569623079145013, "episode_reward_mean": 1.1151926153693998, "episode_len_mean": 436.24, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.3819152792360958}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.210979604622618, "avg_speed_min": 0.942660279481084, "avg_speed_max": 5.757077283023692, "avg_rl_veh_arrival_mean": 326.36, "avg_rl_veh_arrival_min": 122.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.296992664555061, "mean_processing_ms": 3.3123247471358526, "mean_inference_ms": 0.9905686607366172}, "off_policy_estimator": {}, "info": {"num_steps_trained": 549894, "num_steps_sampled": 549894, "sample_time_ms": 23702.671, "grad_time_ms": 353.55, "update_time_ms": 8.443, "opt_peak_throughput": 31847.28, "sample_peak_throughput": 475.035, "opt_samples": 11259.6, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 0.0010000000474974513, "total_loss": 0.27259746193885803, "policy_loss": 0.003560734447091818, "vf_loss": 0.2679693102836609, "vf_explained_var": 0.080433189868927, "kl": 0.011244612745940685, "entropy": 1.4959737062454224, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11325, "done": false, "timesteps_total": 549894, "episodes_total": 1253, "training_iteration": 49, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-10-04", "timestamp": 1585102204, "time_this_iter_s": 19.232650995254517, "time_total_s": 1212.0041997432709, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc586a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc8cd90>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc23378>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1212.0041997432709, "timesteps_since_restore": 549894, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 41.41785714285714, "ram_util_percent": 58.30357142857143}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0915620061244216, "episode_reward_min": -2.703720221304067, "episode_reward_mean": 1.1415477837416186, "episode_len_mean": 436.04, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.3949992331285877}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1976764369608786, "avg_speed_min": 0.2893704699230745, "avg_speed_max": 5.757077283023692, "avg_rl_veh_arrival_mean": 331.8366666666667, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.26332451236998, "mean_processing_ms": 3.3090205226799565, "mean_inference_ms": 0.9860947909068511}, "off_policy_estimator": {}, "info": {"num_steps_trained": 561134, "num_steps_sampled": 561134, "sample_time_ms": 22837.043, "grad_time_ms": 356.387, "update_time_ms": 8.953, "opt_peak_throughput": 31604.956, "sample_peak_throughput": 493.216, "opt_samples": 11263.6, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 0.0010000000474974513, "total_loss": 0.21662873029708862, "policy_loss": 0.004544789902865887, "vf_loss": 0.21082568168640137, "vf_explained_var": 0.09615927934646606, "kl": 0.01325523667037487, "entropy": 1.468130350112915, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11240, "done": false, "timesteps_total": 561134, "episodes_total": 1280, "training_iteration": 50, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-10-30", "timestamp": 1585102230, "time_this_iter_s": 22.060458183288574, "time_total_s": 1234.0646579265594, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc23598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc23620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc236a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc23d08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1234.0646579265594, "timesteps_since_restore": 561134, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 40.05675675675676, "ram_util_percent": 58.22702702702704}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0915620061244216, "episode_reward_min": -2.717029522593284, "episode_reward_mean": 1.0533761134836797, "episode_len_mean": 422.27, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.3748669443002419}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1025552176417857, "avg_speed_min": 0.22606237271833618, "avg_speed_max": 5.757077283023692, "avg_rl_veh_arrival_mean": 318.59333333333336, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.221097164397287, "mean_processing_ms": 3.3091205686033796, "mean_inference_ms": 0.9813454611675445}, "off_policy_estimator": {}, "info": {"num_steps_trained": 572394, "num_steps_sampled": 572394, "sample_time_ms": 22171.844, "grad_time_ms": 357.662, "update_time_ms": 9.0, "opt_peak_throughput": 31509.09, "sample_peak_throughput": 508.284, "opt_samples": 11269.6, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 0.0010000000474974513, "total_loss": 0.17486464977264404, "policy_loss": 0.007988820783793926, "vf_loss": 0.16580313444137573, "vf_explained_var": 0.12126648426055908, "kl": 0.011301381513476372, "entropy": 1.499825358390808, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11260, "done": false, "timesteps_total": 572394, "episodes_total": 1307, "training_iteration": 51, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-10-53", "timestamp": 1585102253, "time_this_iter_s": 22.99156951904297, "time_total_s": 1257.0562274456024, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2d400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2dc80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1257.0562274456024, "timesteps_since_restore": 572394, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 49.584374999999994, "ram_util_percent": 59.00625}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.171721764710533, "episode_reward_min": -2.717029522593284, "episode_reward_mean": 1.0639567279075788, "episode_len_mean": 411.23, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.38271824744876937}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.236201325970671, "avg_speed_min": 0.22606237271833618, "avg_speed_max": 6.660381123578017, "avg_rl_veh_arrival_mean": 314.265, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.187469219936911, "mean_processing_ms": 3.308365508175979, "mean_inference_ms": 0.9771104163003241}, "off_policy_estimator": {}, "info": {"num_steps_trained": 583757, "num_steps_sampled": 583757, "sample_time_ms": 21827.417, "grad_time_ms": 362.395, "update_time_ms": 9.061, "opt_peak_throughput": 31142.509, "sample_peak_throughput": 517.052, "opt_samples": 11285.9, "learner": {"av": {"cur_kl_coeff": 0.09492187201976776, "cur_lr": 0.0010000000474974513, "total_loss": 0.32209429144859314, "policy_loss": 0.021510491147637367, "vf_loss": 0.2975902259349823, "vf_explained_var": 0.13090360164642334, "kl": 0.031537700444459915, "entropy": 1.5046745538711548, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11363, "done": false, "timesteps_total": 583757, "episodes_total": 1336, "training_iteration": 52, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-11-16", "timestamp": 1585102276, "time_this_iter_s": 23.216776132583618, "time_total_s": 1280.273003578186, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19a60>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19840>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc23ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1280.273003578186, "timesteps_since_restore": 583757, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 45.54705882352942, "ram_util_percent": 60.46176470588236}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.171721764710533, "episode_reward_min": -2.717029522593284, "episode_reward_mean": 0.9116178339496668, "episode_len_mean": 395.78, "episodes_this_iter": 30, "policy_reward_mean": {"av": 0.3279200841545566}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2192172635563656, "avg_speed_min": 0.22606237271833618, "avg_speed_max": 6.660381123578017, "avg_rl_veh_arrival_mean": 315.87166666666667, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.157297433676536, "mean_processing_ms": 3.310467293717766, "mean_inference_ms": 0.9734208752153333}, "off_policy_estimator": {}, "info": {"num_steps_trained": 595034, "num_steps_sampled": 595034, "sample_time_ms": 22208.307, "grad_time_ms": 360.984, "update_time_ms": 8.745, "opt_peak_throughput": 31282.784, "sample_peak_throughput": 508.485, "opt_samples": 11292.6, "learner": {"av": {"cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.46637916564941406, "policy_loss": 0.05999509617686272, "vf_loss": 0.40380969643592834, "vf_explained_var": 0.06143200397491455, "kl": 0.0180804543197155, "entropy": 1.5210505723953247, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11277, "done": false, "timesteps_total": 595034, "episodes_total": 1366, "training_iteration": 53, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-11-43", "timestamp": 1585102303, "time_this_iter_s": 26.398605823516846, "time_total_s": 1306.6716094017029, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc19048>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1306.6716094017029, "timesteps_since_restore": 595034, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.7054054054054, "ram_util_percent": 60.92972972972974}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.171721764710533, "episode_reward_min": -2.717029522593284, "episode_reward_mean": 0.8700786788103421, "episode_len_mean": 405.44, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.31074238528940795}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.091687784950991, "avg_speed_min": 0.22606237271833618, "avg_speed_max": 6.660381123578017, "avg_rl_veh_arrival_mean": 336.08333333333337, "avg_rl_veh_arrival_min": 119.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.134062630350888, "mean_processing_ms": 3.312515759961109, "mean_inference_ms": 0.971479292498498}, "off_policy_estimator": {}, "info": {"num_steps_trained": 606234, "num_steps_sampled": 606234, "sample_time_ms": 22051.929, "grad_time_ms": 360.18, "update_time_ms": 7.899, "opt_peak_throughput": 31340.135, "sample_peak_throughput": 511.887, "opt_samples": 11288.1, "learner": {"av": {"cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.03869904950261116, "policy_loss": -0.09784979373216629, "vf_loss": 0.13551796972751617, "vf_explained_var": 0.13853269815444946, "kl": 0.007240318227559328, "entropy": 1.5070760250091553, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 606234, "episodes_total": 1392, "training_iteration": 54, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-12-04", "timestamp": 1585102324, "time_this_iter_s": 21.153080940246582, "time_total_s": 1327.8246903419495, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc586a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1327.8246903419495, "timesteps_since_restore": 606234, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 51.190322580645166, "ram_util_percent": 61.27096774193548}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0654823711876413, "episode_reward_min": -2.7011462642709807, "episode_reward_mean": 0.9347043108171811, "episode_len_mean": 408.7, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.3326349860559364}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.211803239872207, "avg_speed_min": 0.31361316476063295, "avg_speed_max": 6.660381123578017, "avg_rl_veh_arrival_mean": 330.17833333333334, "avg_rl_veh_arrival_min": 119.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.112270001170966, "mean_processing_ms": 3.3142856049544736, "mean_inference_ms": 0.9693372609320632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 617438, "num_steps_sampled": 617438, "sample_time_ms": 22375.448, "grad_time_ms": 353.809, "update_time_ms": 7.691, "opt_peak_throughput": 31905.628, "sample_peak_throughput": 504.504, "opt_samples": 11288.5, "learner": {"av": {"cur_kl_coeff": 0.14238281548023224, "cur_lr": 0.0010000000474974513, "total_loss": 0.40194472670555115, "policy_loss": 0.017414027824997902, "vf_loss": 0.38157904148101807, "vf_explained_var": 0.06565386056900024, "kl": 0.02072969451546669, "entropy": 1.5240925550460815, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11204, "done": false, "timesteps_total": 617438, "episodes_total": 1418, "training_iteration": 55, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-12-29", "timestamp": 1585102349, "time_this_iter_s": 24.718294858932495, "time_total_s": 1352.542985200882, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58158>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc580d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df2d510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1352.542985200882, "timesteps_since_restore": 617438, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 49.4657142857143, "ram_util_percent": 61.11714285714285}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.195833780350958, "episode_reward_min": -2.688547604484083, "episode_reward_mean": 0.9589288107135183, "episode_len_mean": 413.74, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.33646624937316444}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1415013764155946, "avg_speed_min": 0.31361316476063295, "avg_speed_max": 5.312598811591619, "avg_rl_veh_arrival_mean": 326.83, "avg_rl_veh_arrival_min": 103.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.086886044979716, "mean_processing_ms": 3.317439060334455, "mean_inference_ms": 0.9670325790267944}, "off_policy_estimator": {}, "info": {"num_steps_trained": 628697, "num_steps_sampled": 628697, "sample_time_ms": 22254.158, "grad_time_ms": 346.761, "update_time_ms": 8.471, "opt_peak_throughput": 32548.034, "sample_peak_throughput": 507.159, "opt_samples": 11286.4, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 0.0010000000474974513, "total_loss": 0.2064674347639084, "policy_loss": -0.017494918778538704, "vf_loss": 0.2224309742450714, "vf_explained_var": 0.11436760425567627, "kl": 0.007170156575739384, "entropy": 1.5119889974594116, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11259, "done": false, "timesteps_total": 628697, "episodes_total": 1446, "training_iteration": 56, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-12-51", "timestamp": 1585102371, "time_this_iter_s": 22.527328729629517, "time_total_s": 1375.0703139305115, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df2dd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df2d268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df2d9d8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4cbd90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1375.0703139305115, "timesteps_since_restore": 628697, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 46.303125, "ram_util_percent": 61.3}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.195833780350958, "episode_reward_min": -2.644145522423015, "episode_reward_mean": 1.1185684703620071, "episode_len_mean": 416.37, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.39525387645300614}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2542218285006284, "avg_speed_min": 0.03648218271587484, "avg_speed_max": 5.312598811591619, "avg_rl_veh_arrival_mean": 306.39166666666665, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.060458712069536, "mean_processing_ms": 3.318669570867273, "mean_inference_ms": 0.9641989592099375}, "off_policy_estimator": {}, "info": {"num_steps_trained": 639962, "num_steps_sampled": 639962, "sample_time_ms": 22544.887, "grad_time_ms": 342.482, "update_time_ms": 8.781, "opt_peak_throughput": 32922.63, "sample_peak_throughput": 500.131, "opt_samples": 11275.4, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 0.0010000000474974513, "total_loss": 0.14444170892238617, "policy_loss": -0.05518057197332382, "vf_loss": 0.1976788491010666, "vf_explained_var": 0.12362772226333618, "kl": 0.009099717251956463, "entropy": 1.5281810760498047, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11265, "done": false, "timesteps_total": 639962, "episodes_total": 1475, "training_iteration": 57, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-13-17", "timestamp": 1585102397, "time_this_iter_s": 25.330278396606445, "time_total_s": 1400.400592327118, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc586a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58c80>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1400.400592327118, "timesteps_since_restore": 639962, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 45.53333333333333, "ram_util_percent": 61.333333333333336}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.195833780350958, "episode_reward_min": -2.5592393490642604, "episode_reward_mean": 1.159158936598816, "episode_len_mean": 410.62, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.4110492682974525}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.438698746739409, "avg_speed_min": 0.03648218271587484, "avg_speed_max": 6.07344690441642, "avg_rl_veh_arrival_mean": 288.475, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.033450641197492, "mean_processing_ms": 3.3200771190001457, "mean_inference_ms": 0.9617628035639015}, "off_policy_estimator": {}, "info": {"num_steps_trained": 651314, "num_steps_sampled": 651314, "sample_time_ms": 22572.682, "grad_time_ms": 343.269, "update_time_ms": 8.718, "opt_peak_throughput": 32844.512, "sample_peak_throughput": 499.475, "opt_samples": 11274.5, "learner": {"av": {"cur_kl_coeff": 0.21357421576976776, "cur_lr": 0.0010000000474974513, "total_loss": 0.31901365518569946, "policy_loss": 0.011231515556573868, "vf_loss": 0.3067423105239868, "vf_explained_var": 0.12117135524749756, "kl": 0.004868719726800919, "entropy": 1.5612646341323853, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11352, "done": false, "timesteps_total": 651314, "episodes_total": 1500, "training_iteration": 58, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-13-39", "timestamp": 1585102419, "time_this_iter_s": 21.80019450187683, "time_total_s": 1422.2007868289948, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc587b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc191e0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1422.2007868289948, "timesteps_since_restore": 651314, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 48.861290322580636, "ram_util_percent": 61.280645161290316}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.119261815655098, "episode_reward_min": -2.5592393490642604, "episode_reward_mean": 1.2263669426022057, "episode_len_mean": 422.19, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.4333452094000727}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4551337981887866, "avg_speed_min": 0.03648218271587484, "avg_speed_max": 6.07344690441642, "avg_rl_veh_arrival_mean": 283.43500000000006, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.008477389520552, "mean_processing_ms": 3.3214530533646824, "mean_inference_ms": 0.9591037098601939}, "off_policy_estimator": {}, "info": {"num_steps_trained": 662716, "num_steps_sampled": 662716, "sample_time_ms": 23269.834, "grad_time_ms": 338.266, "update_time_ms": 8.763, "opt_peak_throughput": 33353.019, "sample_peak_throughput": 484.842, "opt_samples": 11282.2, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.08084657788276672, "policy_loss": -0.02016749605536461, "vf_loss": 0.09989091008901596, "vf_explained_var": 0.19863182306289673, "kl": 0.01051777321845293, "entropy": 1.5802018642425537, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11402, "done": false, "timesteps_total": 662716, "episodes_total": 1527, "training_iteration": 59, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-14-05", "timestamp": 1585102445, "time_this_iter_s": 26.145644187927246, "time_total_s": 1448.346431016922, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1d4cbe18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1448.346431016922, "timesteps_since_restore": 662716, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 58.981578947368426, "ram_util_percent": 59.90526315789474}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.119261815655098, "episode_reward_min": -2.68374978852154, "episode_reward_mean": 1.2145924981645666, "episode_len_mean": 426.74, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.42617280637353216}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2648026588031924, "avg_speed_min": 0.03648218271587484, "avg_speed_max": 6.07344690441642, "avg_rl_veh_arrival_mean": 297.94, "avg_rl_veh_arrival_min": 82.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.998480155364024, "mean_processing_ms": 3.3214091130210073, "mean_inference_ms": 0.9580589868641473}, "off_policy_estimator": {}, "info": {"num_steps_trained": 673916, "num_steps_sampled": 673916, "sample_time_ms": 23649.044, "grad_time_ms": 349.032, "update_time_ms": 7.545, "opt_peak_throughput": 32312.792, "sample_peak_throughput": 476.899, "opt_samples": 11278.2, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.17319472134113312, "policy_loss": 0.01866772025823593, "vf_loss": 0.15344974398612976, "vf_explained_var": 0.11666607856750488, "kl": 0.010087796486914158, "entropy": 1.5484890937805176, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 673916, "episodes_total": 1553, "training_iteration": 60, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-14-31", "timestamp": 1585102471, "time_this_iter_s": 25.95561408996582, "time_total_s": 1474.3020451068878, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1d4cb488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1d4cba60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1d4cb510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc54ae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1474.3020451068878, "timesteps_since_restore": 673916, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 55.599999999999994, "ram_util_percent": 58.16216216216216}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.119261815655098, "episode_reward_min": -2.68374978852154, "episode_reward_mean": 1.3430144540334283, "episode_len_mean": 447.93, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4647108837485912}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.40935433751189, "avg_speed_min": 0.3300279947577488, "avg_speed_max": 6.218138296009586, "avg_rl_veh_arrival_mean": 299.635, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.9996904636450505, "mean_processing_ms": 3.323433255010169, "mean_inference_ms": 0.9585760273550528}, "off_policy_estimator": {}, "info": {"num_steps_trained": 685388, "num_steps_sampled": 685388, "sample_time_ms": 23565.242, "grad_time_ms": 341.15, "update_time_ms": 7.746, "opt_peak_throughput": 33121.536, "sample_peak_throughput": 479.494, "opt_samples": 11299.4, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": -0.019301192834973335, "policy_loss": -0.08093856275081635, "vf_loss": 0.06088501587510109, "vf_explained_var": 0.2683985233306885, "kl": 0.0070455726236104965, "entropy": 1.557995080947876, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11472, "done": false, "timesteps_total": 685388, "episodes_total": 1577, "training_iteration": 61, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-14-53", "timestamp": 1585102493, "time_this_iter_s": 22.06106472015381, "time_total_s": 1496.3631098270416, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc191e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc192f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc19bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1496.3631098270416, "timesteps_since_restore": 685388, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 52.651612903225804, "ram_util_percent": 58.25483870967741}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2398688879430546, "episode_reward_min": -2.689268563543216, "episode_reward_mean": 1.3332430732112115, "episode_len_mean": 445.97, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.45815913168770156}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.301589423409518, "avg_speed_min": 0.2670951465576758, "avg_speed_max": 6.218138296009586, "avg_rl_veh_arrival_mean": 309.24666666666667, "avg_rl_veh_arrival_min": 109.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 8.003048344657968, "mean_processing_ms": 3.3209339579843205, "mean_inference_ms": 0.9582922016626187}, "off_policy_estimator": {}, "info": {"num_steps_trained": 696622, "num_steps_sampled": 696622, "sample_time_ms": 23717.908, "grad_time_ms": 354.703, "update_time_ms": 7.564, "opt_peak_throughput": 31819.609, "sample_peak_throughput": 475.864, "opt_samples": 11286.5, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.17376923561096191, "policy_loss": 0.0007211065967567265, "vf_loss": 0.1721581071615219, "vf_explained_var": 0.17361092567443848, "kl": 0.008334547281265259, "entropy": 1.539647102355957, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11234, "done": false, "timesteps_total": 696622, "episodes_total": 1603, "training_iteration": 62, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-15-18", "timestamp": 1585102518, "time_this_iter_s": 24.876256942749023, "time_total_s": 1521.2393667697906, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58510>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58e18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1521.2393667697906, "timesteps_since_restore": 696622, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 52.516666666666666, "ram_util_percent": 58.208333333333336}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2398688879430546, "episode_reward_min": -2.689268563543216, "episode_reward_mean": 1.4454579441185471, "episode_len_mean": 451.31, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.49843377383398174}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3900643238221635, "avg_speed_min": 0.2670951465576758, "avg_speed_max": 6.41101801755252, "avg_rl_veh_arrival_mean": 303.12999999999994, "avg_rl_veh_arrival_min": 94.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.994138836895064, "mean_processing_ms": 3.3206414616407813, "mean_inference_ms": 0.9574074858617372}, "off_policy_estimator": {}, "info": {"num_steps_trained": 707898, "num_steps_sampled": 707898, "sample_time_ms": 23362.088, "grad_time_ms": 349.868, "update_time_ms": 7.713, "opt_peak_throughput": 32259.003, "sample_peak_throughput": 483.108, "opt_samples": 11286.4, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.06641294062137604, "policy_loss": -0.04923928156495094, "vf_loss": 0.11454661190509796, "vf_explained_var": 0.23170477151870728, "kl": 0.010353541001677513, "entropy": 1.5622807741165161, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11276, "done": false, "timesteps_total": 707898, "episodes_total": 1628, "training_iteration": 63, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-15-41", "timestamp": 1585102541, "time_this_iter_s": 22.793042182922363, "time_total_s": 1544.032408952713, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc581e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc580d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc54158>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1544.032408952713, "timesteps_since_restore": 707898, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 52.02121212121213, "ram_util_percent": 58.24545454545455}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.283384594453847, "episode_reward_min": -2.689268563543216, "episode_reward_mean": 1.4305526578131063, "episode_len_mean": 444.7, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.491598851482167}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5639221322765, "avg_speed_min": 0.2670951465576758, "avg_speed_max": 6.41101801755252, "avg_rl_veh_arrival_mean": 294.76666666666665, "avg_rl_veh_arrival_min": 94.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.985619133104356, "mean_processing_ms": 3.3202637838404843, "mean_inference_ms": 0.9560421229993736}, "off_policy_estimator": {}, "info": {"num_steps_trained": 719103, "num_steps_sampled": 719103, "sample_time_ms": 23882.9, "grad_time_ms": 356.958, "update_time_ms": 7.696, "opt_peak_throughput": 31619.7, "sample_peak_throughput": 472.593, "opt_samples": 11286.9, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.29223236441612244, "policy_loss": 0.05162116885185242, "vf_loss": 0.2390221655368805, "vf_explained_var": 0.16368478536605835, "kl": 0.014880882576107979, "entropy": 1.5400922298431396, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11205, "done": false, "timesteps_total": 719103, "episodes_total": 1654, "training_iteration": 64, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-16-07", "timestamp": 1585102567, "time_this_iter_s": 26.440839767456055, "time_total_s": 1570.473248720169, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc54378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc542f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc54268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc63ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1570.473248720169, "timesteps_since_restore": 719103, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 50.00810810810811, "ram_util_percent": 58.41621621621622}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.283384594453847, "episode_reward_min": -2.689268563543216, "episode_reward_mean": 1.3197640756643516, "episode_len_mean": 429.71, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.4550910605739144}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4714858664925017, "avg_speed_min": 0.39366140262615196, "avg_speed_max": 6.41101801755252, "avg_rl_veh_arrival_mean": 293.445, "avg_rl_veh_arrival_min": 89.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.9700773662264, "mean_processing_ms": 3.3196685906946697, "mean_inference_ms": 0.9542702118276801}, "off_policy_estimator": {}, "info": {"num_steps_trained": 730359, "num_steps_sampled": 730359, "sample_time_ms": 23890.699, "grad_time_ms": 354.06, "update_time_ms": 8.163, "opt_peak_throughput": 31893.158, "sample_peak_throughput": 472.657, "opt_samples": 11292.1, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.20536820590496063, "policy_loss": 0.029758285731077194, "vf_loss": 0.17368069291114807, "vf_explained_var": 0.17023080587387085, "kl": 0.018065959215164185, "entropy": 1.5577958822250366, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11256, "done": false, "timesteps_total": 730359, "episodes_total": 1681, "training_iteration": 65, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-16-32", "timestamp": 1585102592, "time_this_iter_s": 24.774531364440918, "time_total_s": 1595.24778008461, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58510>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58bf8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1595.24778008461, "timesteps_since_restore": 730359, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 52.400000000000006, "ram_util_percent": 58.44444444444444}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.283384594453847, "episode_reward_min": -2.6676921134186795, "episode_reward_mean": 1.2866819151302795, "episode_len_mean": 426.66, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.4452186557544219}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4603969436360025, "avg_speed_min": 0.8703483870343376, "avg_speed_max": 6.41101801755252, "avg_rl_veh_arrival_mean": 291.6383333333334, "avg_rl_veh_arrival_min": 81.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.962273538512184, "mean_processing_ms": 3.3203738629491717, "mean_inference_ms": 0.9530237209573655}, "off_policy_estimator": {}, "info": {"num_steps_trained": 741640, "num_steps_sampled": 741640, "sample_time_ms": 24083.093, "grad_time_ms": 351.815, "update_time_ms": 7.237, "opt_peak_throughput": 32102.964, "sample_peak_throughput": 468.972, "opt_samples": 11294.3, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.13919597864151, "policy_loss": -0.009515471756458282, "vf_loss": 0.14743617177009583, "vf_explained_var": 0.2133312225341797, "kl": 0.011942179873585701, "entropy": 1.5327341556549072, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11281, "done": false, "timesteps_total": 741640, "episodes_total": 1707, "training_iteration": 66, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-16-56", "timestamp": 1585102616, "time_this_iter_s": 24.418058156967163, "time_total_s": 1619.6658382415771, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc190d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1619.6658382415771, "timesteps_since_restore": 741640, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 52.09117647058824, "ram_util_percent": 58.49411764705883}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.283384594453847, "episode_reward_min": -2.6676921134186795, "episode_reward_mean": 1.2872829201528442, "episode_len_mean": 430.46, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.44542661596984223}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.422861474104009, "avg_speed_min": 0.5721533839307377, "avg_speed_max": 6.075204846326975, "avg_rl_veh_arrival_mean": 295.3383333333333, "avg_rl_veh_arrival_min": 81.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.955810304718711, "mean_processing_ms": 3.3211661929084446, "mean_inference_ms": 0.9518654420273365}, "off_policy_estimator": {}, "info": {"num_steps_trained": 752864, "num_steps_sampled": 752864, "sample_time_ms": 23687.239, "grad_time_ms": 353.157, "update_time_ms": 7.203, "opt_peak_throughput": 31969.355, "sample_peak_throughput": 476.636, "opt_samples": 11290.2, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.0061132838018238544, "policy_loss": -0.057645417749881744, "vf_loss": 0.0629398375749588, "vf_explained_var": 0.32837218046188354, "kl": 0.007668161764740944, "entropy": 1.5378786325454712, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11224, "done": false, "timesteps_total": 752864, "episodes_total": 1732, "training_iteration": 67, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-17-18", "timestamp": 1585102638, "time_this_iter_s": 21.385013580322266, "time_total_s": 1641.0508518218994, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19488>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc63d90>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1641.0508518218994, "timesteps_since_restore": 752864, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 53.65161290322581, "ram_util_percent": 58.6483870967742}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.155142963484647, "episode_reward_min": -2.693805129799305, "episode_reward_mean": 1.246765213335686, "episode_len_mean": 423.07, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.4359318927747154}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.444475956953527, "avg_speed_min": 0.5721533839307377, "avg_speed_max": 5.58629478892708, "avg_rl_veh_arrival_mean": 298.5733333333333, "avg_rl_veh_arrival_min": 81.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.945268798425425, "mean_processing_ms": 3.3218280797418567, "mean_inference_ms": 0.9502985050543523}, "off_policy_estimator": {}, "info": {"num_steps_trained": 764076, "num_steps_sampled": 764076, "sample_time_ms": 24126.604, "grad_time_ms": 352.209, "update_time_ms": 7.203, "opt_peak_throughput": 32015.678, "sample_peak_throughput": 467.376, "opt_samples": 11276.2, "learner": {"av": {"cur_kl_coeff": 0.10678710788488388, "cur_lr": 0.0010000000474974513, "total_loss": 0.533612847328186, "policy_loss": 0.11766791343688965, "vf_loss": 0.4109448492527008, "vf_explained_var": 0.12126851081848145, "kl": 0.0468236580491066, "entropy": 1.5416011810302734, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11212, "done": false, "timesteps_total": 764076, "episodes_total": 1759, "training_iteration": 68, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-17-44", "timestamp": 1585102664, "time_this_iter_s": 26.192654371261597, "time_total_s": 1667.243506193161, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc63b70>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc631e0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc630d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df069d8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1667.243506193161, "timesteps_since_restore": 764076, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 48.56216216216216, "ram_util_percent": 58.683783783783774}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.155142963484647, "episode_reward_min": -2.693805129799305, "episode_reward_mean": 1.3693011293929698, "episode_len_mean": 442.28, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.4721728032389553}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.514326996598742, "avg_speed_min": 0.5094102191261749, "avg_speed_max": 5.58629478892708, "avg_rl_veh_arrival_mean": 300.97, "avg_rl_veh_arrival_min": 81.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.941202159422066, "mean_processing_ms": 3.321537997081514, "mean_inference_ms": 0.9494099718430472}, "off_policy_estimator": {}, "info": {"num_steps_trained": 775460, "num_steps_sampled": 775460, "sample_time_ms": 23833.019, "grad_time_ms": 348.51, "update_time_ms": 7.144, "opt_peak_throughput": 32350.28, "sample_peak_throughput": 473.058, "opt_samples": 11274.4, "learner": {"av": {"cur_kl_coeff": 0.16018065810203552, "cur_lr": 0.0010000000474974513, "total_loss": -0.04803803935647011, "policy_loss": -0.098651222884655, "vf_loss": 0.04988545551896095, "vf_explained_var": 0.38437122106552124, "kl": 0.0045431824401021, "entropy": 1.5548022985458374, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11384, "done": false, "timesteps_total": 775460, "episodes_total": 1784, "training_iteration": 69, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-18-07", "timestamp": 1585102687, "time_this_iter_s": 23.17277193069458, "time_total_s": 1690.4162781238556, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19c80>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19b70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19598>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc192f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1690.4162781238556, "timesteps_since_restore": 775460, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 53.06470588235294, "ram_util_percent": 58.47941176470589}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1301566443562803, "episode_reward_min": -2.693805129799305, "episode_reward_mean": 1.447344174192601, "episode_len_mean": 445.18, "episodes_this_iter": 23, "policy_reward_mean": {"av": 0.49908419799744863}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6466991375998146, "avg_speed_min": 0.5094102191261749, "avg_speed_max": 5.58629478892708, "avg_rl_veh_arrival_mean": 291.98833333333334, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.9273436436570455, "mean_processing_ms": 3.323212463181071, "mean_inference_ms": 0.9475309670978356}, "off_policy_estimator": {}, "info": {"num_steps_trained": 786760, "num_steps_sampled": 786760, "sample_time_ms": 23615.792, "grad_time_ms": 341.732, "update_time_ms": 7.602, "opt_peak_throughput": 33021.232, "sample_peak_throughput": 477.833, "opt_samples": 11284.4, "learner": {"av": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 0.0010000000474974513, "total_loss": 0.22500105202198029, "policy_loss": -0.002566427690908313, "vf_loss": 0.22659771144390106, "vf_explained_var": 0.1539507508277893, "kl": 0.012109491042792797, "entropy": 1.6252306699752808, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11300, "done": false, "timesteps_total": 786760, "episodes_total": 1807, "training_iteration": 70, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-18-31", "timestamp": 1585102711, "time_this_iter_s": 23.717567920684814, "time_total_s": 1714.1338460445404, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58488>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1714.1338460445404, "timesteps_since_restore": 786760, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 54.11818181818182, "ram_util_percent": 58.54242424242423}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1367787537474947, "episode_reward_min": -2.693805129799305, "episode_reward_mean": 1.4600958432258386, "episode_len_mean": 440.9, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.5052234751646502}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.779087468674045, "avg_speed_min": 0.5094102191261749, "avg_speed_max": 5.694952100231193, "avg_rl_veh_arrival_mean": 284.2683333333333, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.920443032950832, "mean_processing_ms": 3.3211523585887255, "mean_inference_ms": 0.945733669114993}, "off_policy_estimator": {}, "info": {"num_steps_trained": 798079, "num_steps_sampled": 798079, "sample_time_ms": 23846.227, "grad_time_ms": 343.181, "update_time_ms": 7.6, "opt_peak_throughput": 32837.178, "sample_peak_throughput": 472.574, "opt_samples": 11269.1, "learner": {"av": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 0.0010000000474974513, "total_loss": 0.2120523452758789, "policy_loss": 0.01110922358930111, "vf_loss": 0.1993633359670639, "vf_explained_var": 0.16046488285064697, "kl": 0.01972484029829502, "entropy": 1.56019926071167, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11319, "done": false, "timesteps_total": 798079, "episodes_total": 1836, "training_iteration": 71, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-18-55", "timestamp": 1585102735, "time_this_iter_s": 24.390211582183838, "time_total_s": 1738.5240576267242, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc581e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc580d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df06b70>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1738.5240576267242, "timesteps_since_restore": 798079, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 48.37714285714285, "ram_util_percent": 58.53142857142857}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1367787537474947, "episode_reward_min": -2.584210812900916, "episode_reward_mean": 1.580541784024106, "episode_len_mean": 446.68, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.5450144082841745}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8233589550210834, "avg_speed_min": 0.5094102191261749, "avg_speed_max": 5.801015882257524, "avg_rl_veh_arrival_mean": 276.62333333333333, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.898265890247426, "mean_processing_ms": 3.3224306433856605, "mean_inference_ms": 0.9429399199740834}, "off_policy_estimator": {}, "info": {"num_steps_trained": 809302, "num_steps_sampled": 809302, "sample_time_ms": 23930.5, "grad_time_ms": 330.952, "update_time_ms": 7.11, "opt_peak_throughput": 34047.251, "sample_peak_throughput": 470.864, "opt_samples": 11268.0, "learner": {"av": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 0.0010000000474974513, "total_loss": 0.10208464413881302, "policy_loss": -0.01648108847439289, "vf_loss": 0.11702348291873932, "vf_explained_var": 0.21828621625900269, "kl": 0.01925606094300747, "entropy": 1.5562564134597778, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11223, "done": false, "timesteps_total": 809302, "episodes_total": 1860, "training_iteration": 72, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-19-21", "timestamp": 1585102761, "time_this_iter_s": 25.591044187545776, "time_total_s": 1764.11510181427, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc231e0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc23158>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc230d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc8d510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1764.11510181427, "timesteps_since_restore": 809302, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 53.53243243243244, "ram_util_percent": 58.60540540540539}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2662770286372105, "episode_reward_min": -2.584210812900916, "episode_reward_mean": 1.6495463593607982, "episode_len_mean": 447.86, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.5707772869760548}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.85111974827843, "avg_speed_min": 1.316754555470377, "avg_speed_max": 5.801015882257524, "avg_rl_veh_arrival_mean": 274.94666666666666, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.890515318166155, "mean_processing_ms": 3.322744903015698, "mean_inference_ms": 0.9413049808940471}, "off_policy_estimator": {}, "info": {"num_steps_trained": 820631, "num_steps_sampled": 820631, "sample_time_ms": 23877.525, "grad_time_ms": 361.161, "update_time_ms": 6.188, "opt_peak_throughput": 31214.068, "sample_peak_throughput": 472.13, "opt_samples": 11273.3, "learner": {"av": {"cur_kl_coeff": 0.08009032905101776, "cur_lr": 0.0010000000474974513, "total_loss": -0.05179152637720108, "policy_loss": -0.0674467459321022, "vf_loss": 0.015331714414060116, "vf_explained_var": 0.6860997676849365, "kl": 0.004039245657622814, "entropy": 1.5769695043563843, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11329, "done": false, "timesteps_total": 820631, "episodes_total": 1884, "training_iteration": 73, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-19-44", "timestamp": 1585102784, "time_this_iter_s": 22.57742190361023, "time_total_s": 1786.6925237178802, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58bf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1786.6925237178802, "timesteps_since_restore": 820631, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 53.434375, "ram_util_percent": 58.559375}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2662770286372105, "episode_reward_min": -2.688779210101308, "episode_reward_mean": 1.3722830448295218, "episode_len_mean": 430.82, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.47814740237962433}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.68947946295002, "avg_speed_min": 1.2421521085168887, "avg_speed_max": 6.7096895970355135, "avg_rl_veh_arrival_mean": 279.16, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.882134550782163, "mean_processing_ms": 3.3196066149405805, "mean_inference_ms": 0.9398982905781216}, "off_policy_estimator": {}, "info": {"num_steps_trained": 832053, "num_steps_sampled": 832053, "sample_time_ms": 23739.899, "grad_time_ms": 351.333, "update_time_ms": 6.95, "opt_peak_throughput": 32148.961, "sample_peak_throughput": 475.781, "opt_samples": 11295.0, "learner": {"av": {"cur_kl_coeff": 0.04004516452550888, "cur_lr": 0.0010000000474974513, "total_loss": 0.5139739513397217, "policy_loss": 0.16100116074085236, "vf_loss": 0.3504539728164673, "vf_explained_var": 0.15073555707931519, "kl": 0.06289900839328766, "entropy": 1.5832048654556274, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11422, "done": false, "timesteps_total": 832053, "episodes_total": 1913, "training_iteration": 74, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-20-09", "timestamp": 1585102809, "time_this_iter_s": 24.96574878692627, "time_total_s": 1811.6582725048065, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58950>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc190d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc19a60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1811.6582725048065, "timesteps_since_restore": 832053, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 50.569444444444436, "ram_util_percent": 58.61944444444444}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2662770286372105, "episode_reward_min": -2.688779210101308, "episode_reward_mean": 1.3901820805476641, "episode_len_mean": 439.78, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.48103186178119856}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6250116655138367, "avg_speed_min": 1.09171031192188, "avg_speed_max": 6.7096895970355135, "avg_rl_veh_arrival_mean": 280.575, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.872380862544063, "mean_processing_ms": 3.3202854552143277, "mean_inference_ms": 0.938918623910364}, "off_policy_estimator": {}, "info": {"num_steps_trained": 843349, "num_steps_sampled": 843349, "sample_time_ms": 23459.106, "grad_time_ms": 351.031, "update_time_ms": 6.526, "opt_peak_throughput": 32188.041, "sample_peak_throughput": 481.647, "opt_samples": 11299.0, "learner": {"av": {"cur_kl_coeff": 0.06006775051355362, "cur_lr": 0.0010000000474974513, "total_loss": 0.052607081830501556, "policy_loss": -0.0713713988661766, "vf_loss": 0.12308549135923386, "vf_explained_var": 0.20121198892593384, "kl": 0.01486701238900423, "entropy": 1.5664153099060059, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11296, "done": false, "timesteps_total": 843349, "episodes_total": 1937, "training_iteration": 75, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-20-31", "timestamp": 1585102831, "time_this_iter_s": 21.95924186706543, "time_total_s": 1833.617514371872, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19400>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19510>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc8d6a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1833.617514371872, "timesteps_since_restore": 843349, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 52.964516129032255, "ram_util_percent": 58.612903225806434}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.219970499817602, "episode_reward_min": -2.688779210101308, "episode_reward_mean": 1.3394010269917807, "episode_len_mean": 443.59, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.461862423100614}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5470382055356886, "avg_speed_min": 0.25810403488263756, "avg_speed_max": 6.7096895970355135, "avg_rl_veh_arrival_mean": 293.835, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.873458845176542, "mean_processing_ms": 3.3198193993191403, "mean_inference_ms": 0.9394879190697155}, "off_policy_estimator": {}, "info": {"num_steps_trained": 854607, "num_steps_sampled": 854607, "sample_time_ms": 23563.291, "grad_time_ms": 356.448, "update_time_ms": 6.58, "opt_peak_throughput": 31692.414, "sample_peak_throughput": 479.419, "opt_samples": 11296.7, "learner": {"av": {"cur_kl_coeff": 0.06006775051355362, "cur_lr": 0.0010000000474974513, "total_loss": 0.3252829313278198, "policy_loss": 0.04771395027637482, "vf_loss": 0.2755548357963562, "vf_explained_var": 0.16459286212921143, "kl": 0.03353176265954971, "entropy": 1.5685367584228516, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11258, "done": false, "timesteps_total": 854607, "episodes_total": 1964, "training_iteration": 76, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-20-56", "timestamp": 1585102856, "time_this_iter_s": 25.52814793586731, "time_total_s": 1859.1456623077393, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc586a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc8d7b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc8d730>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc8de18>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1859.1456623077393, "timesteps_since_restore": 854607, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 53.056756756756755, "ram_util_percent": 58.894594594594594}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1481122138303252, "episode_reward_min": -2.688779210101308, "episode_reward_mean": 1.2518176991193173, "episode_len_mean": 437.69, "episodes_this_iter": 23, "policy_reward_mean": {"av": 0.4331549131900751}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.460686843896766, "avg_speed_min": 0.25810403488263756, "avg_speed_max": 6.7096895970355135, "avg_rl_veh_arrival_mean": 298.505, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.861078714016063, "mean_processing_ms": 3.3188668571531306, "mean_inference_ms": 0.9383006389757635}, "off_policy_estimator": {}, "info": {"num_steps_trained": 865829, "num_steps_sampled": 865829, "sample_time_ms": 23566.12, "grad_time_ms": 356.901, "update_time_ms": 7.331, "opt_peak_throughput": 31651.655, "sample_peak_throughput": 479.353, "opt_samples": 11296.5, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.11435642838478088, "policy_loss": -0.021640151739120483, "vf_loss": 0.13509468734264374, "vf_explained_var": 0.22894996404647827, "kl": 0.010009520687162876, "entropy": 1.6810251474380493, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11222, "done": false, "timesteps_total": 865829, "episodes_total": 1987, "training_iteration": 77, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-21-18", "timestamp": 1585102878, "time_this_iter_s": 21.426549434661865, "time_total_s": 1880.5722117424011, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19bf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58840>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1880.5722117424011, "timesteps_since_restore": 865829, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 46.526666666666664, "ram_util_percent": 59.023333333333326}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1481122138303252, "episode_reward_min": -2.7588745245324846, "episode_reward_mean": 1.3929598937055485, "episode_len_mean": 450.24, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.4754129330053066}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3744512707625143, "avg_speed_min": 0.25810403488263756, "avg_speed_max": 5.658231685859315, "avg_rl_veh_arrival_mean": 305.6466666666667, "avg_rl_veh_arrival_min": 43.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.845563485137866, "mean_processing_ms": 3.321151235818009, "mean_inference_ms": 0.9369696727750693}, "off_policy_estimator": {}, "info": {"num_steps_trained": 877056, "num_steps_sampled": 877056, "sample_time_ms": 23386.516, "grad_time_ms": 352.276, "update_time_ms": 7.324, "opt_peak_throughput": 32071.43, "sample_peak_throughput": 483.099, "opt_samples": 11298.0, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.12553110718727112, "policy_loss": -0.0010422065388411283, "vf_loss": 0.12545830011367798, "vf_explained_var": 0.12869369983673096, "kl": 0.012374884448945522, "entropy": 1.6236611604690552, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11227, "done": false, "timesteps_total": 877056, "episodes_total": 2014, "training_iteration": 78, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-21-42", "timestamp": 1585102902, "time_this_iter_s": 24.341249704360962, "time_total_s": 1904.913461446762, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc589d8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58a60>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58ae8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc23d08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1904.913461446762, "timesteps_since_restore": 877056, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 51.19714285714286, "ram_util_percent": 59.151428571428575}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1238876088280803, "episode_reward_min": -2.7588745245324846, "episode_reward_mean": 1.4320631332839897, "episode_len_mean": 438.11, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.4938148735462033}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2364001363969495, "avg_speed_min": 0.25810403488263756, "avg_speed_max": 5.616276440037736, "avg_rl_veh_arrival_mean": 308.86, "avg_rl_veh_arrival_min": 43.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.844260968291952, "mean_processing_ms": 3.32039263396276, "mean_inference_ms": 0.9369215232022128}, "off_policy_estimator": {}, "info": {"num_steps_trained": 888256, "num_steps_sampled": 888256, "sample_time_ms": 23788.125, "grad_time_ms": 362.673, "update_time_ms": 7.372, "opt_peak_throughput": 31101.332, "sample_peak_throughput": 474.169, "opt_samples": 11279.6, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.19032569229602814, "policy_loss": 0.010566089302301407, "vf_loss": 0.17882199585437775, "vf_explained_var": 0.14136254787445068, "kl": 0.010406095534563065, "entropy": 1.6296311616897583, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 888256, "episodes_total": 2040, "training_iteration": 79, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-22-09", "timestamp": 1585102929, "time_this_iter_s": 27.318495512008667, "time_total_s": 1932.2319569587708, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc23ea0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc232f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df06bf8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc732f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1932.2319569587708, "timesteps_since_restore": 888256, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 58.379487179487185, "ram_util_percent": 59.91538461538461}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1225336610400385, "episode_reward_min": -2.7588745245324846, "episode_reward_mean": 1.4472782548848926, "episode_len_mean": 443.11, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.5007883234895822}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3376796268934625, "avg_speed_min": 0.48890776933095265, "avg_speed_max": 6.059209816789782, "avg_rl_veh_arrival_mean": 302.54333333333335, "avg_rl_veh_arrival_min": 43.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.839065548605742, "mean_processing_ms": 3.3190218776166462, "mean_inference_ms": 0.9359349906081479}, "off_policy_estimator": {}, "info": {"num_steps_trained": 899733, "num_steps_sampled": 899733, "sample_time_ms": 23672.442, "grad_time_ms": 350.106, "update_time_ms": 8.095, "opt_peak_throughput": 32268.212, "sample_peak_throughput": 477.234, "opt_samples": 11297.3, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.1608814001083374, "policy_loss": -0.02910810150206089, "vf_loss": 0.18900923430919647, "vf_explained_var": 0.12110239267349243, "kl": 0.010879573412239552, "entropy": 1.592576503753662, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11477, "done": false, "timesteps_total": 899733, "episodes_total": 2066, "training_iteration": 80, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-22-32", "timestamp": 1585102952, "time_this_iter_s": 22.43681311607361, "time_total_s": 1954.6687700748444, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc73598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc73620>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc736a8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc73d08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1954.6687700748444, "timesteps_since_restore": 899733, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 53.20625, "ram_util_percent": 61.3625}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1225336610400385, "episode_reward_min": -2.7588745245324846, "episode_reward_mean": 1.42649441928744, "episode_len_mean": 442.92, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.4918946273404966}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3799698421311484, "avg_speed_min": 0.5528682444013637, "avg_speed_max": 6.132921081175355, "avg_rl_veh_arrival_mean": 304.87000000000006, "avg_rl_veh_arrival_min": 60.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.845699429009243, "mean_processing_ms": 3.3187971521822663, "mean_inference_ms": 0.9365229652484787}, "off_policy_estimator": {}, "info": {"num_steps_trained": 911118, "num_steps_sampled": 911118, "sample_time_ms": 23734.844, "grad_time_ms": 347.904, "update_time_ms": 7.852, "opt_peak_throughput": 32491.417, "sample_peak_throughput": 476.258, "opt_samples": 11303.9, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.10527301579713821, "policy_loss": -0.020619388669729233, "vf_loss": 0.12496969103813171, "vf_explained_var": 0.19953137636184692, "kl": 0.010240525007247925, "entropy": 1.604896903038025, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11385, "done": false, "timesteps_total": 911118, "episodes_total": 2091, "training_iteration": 81, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-22-57", "timestamp": 1585102977, "time_this_iter_s": 24.973002672195435, "time_total_s": 1979.6417727470398, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc23598>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc236a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58b70>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 1979.6417727470398, "timesteps_since_restore": 911118, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 56.86944444444444, "ram_util_percent": 61.57500000000001}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1225336610400385, "episode_reward_min": -2.597660016574643, "episode_reward_mean": 1.2424704563994522, "episode_len_mean": 422.98, "episodes_this_iter": 29, "policy_reward_mean": {"av": 0.4390354969609371}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4485873905233935, "avg_speed_min": 0.2124582217352738, "avg_speed_max": 6.488551240086312, "avg_rl_veh_arrival_mean": 286.295, "avg_rl_veh_arrival_min": 60.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.838978533024724, "mean_processing_ms": 3.3204839205180563, "mean_inference_ms": 0.9356546409246067}, "off_policy_estimator": {}, "info": {"num_steps_trained": 922350, "num_steps_sampled": 922350, "sample_time_ms": 23748.358, "grad_time_ms": 336.074, "update_time_ms": 8.854, "opt_peak_throughput": 33637.811, "sample_peak_throughput": 476.024, "opt_samples": 11304.8, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.22501705586910248, "policy_loss": 0.05048733204603195, "vf_loss": 0.17298690974712372, "vf_explained_var": 0.1861025094985962, "kl": 0.017122888937592506, "entropy": 1.6281373500823975, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11232, "done": false, "timesteps_total": 922350, "episodes_total": 2120, "training_iteration": 82, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-23-23", "timestamp": 1585103003, "time_this_iter_s": 25.62626004219055, "time_total_s": 2005.2680327892303, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58f28>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58c80>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58488>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc19730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2005.2680327892303, "timesteps_since_restore": 922350, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 55.519444444444446, "ram_util_percent": 62.191666666666684}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1225336610400385, "episode_reward_min": -2.693438412690684, "episode_reward_mean": 1.1555564833181953, "episode_len_mean": 423.51, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.41123006523779193}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4949520439583583, "avg_speed_min": 0.2124582217352738, "avg_speed_max": 6.488551240086312, "avg_rl_veh_arrival_mean": 285.52666666666664, "avg_rl_veh_arrival_min": 103.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.838439817913144, "mean_processing_ms": 3.321370558928889, "mean_inference_ms": 0.9354950883117241}, "off_policy_estimator": {}, "info": {"num_steps_trained": 933550, "num_steps_sampled": 933550, "sample_time_ms": 23889.616, "grad_time_ms": 314.672, "update_time_ms": 9.014, "opt_peak_throughput": 35884.644, "sample_peak_throughput": 472.67, "opt_samples": 11291.9, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.12636016309261322, "policy_loss": -0.052854374051094055, "vf_loss": 0.17813177406787872, "vf_explained_var": 0.1489197015762329, "kl": 0.012016729451715946, "entropy": 1.6613565683364868, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 933550, "episodes_total": 2147, "training_iteration": 83, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-23-46", "timestamp": 1585103026, "time_this_iter_s": 23.75588846206665, "time_total_s": 2029.023921251297, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19268>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc197b8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc190d0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc73ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2029.023921251297, "timesteps_since_restore": 933550, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 51.882352941176464, "ram_util_percent": 62.5235294117647}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.116292567461323, "episode_reward_min": -2.693438412690684, "episode_reward_mean": 1.0171427299913955, "episode_len_mean": 409.16, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.3645672867352672}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.337619239166722, "avg_speed_min": 0.2124582217352738, "avg_speed_max": 6.488551240086312, "avg_rl_veh_arrival_mean": 286.21833333333336, "avg_rl_veh_arrival_min": 54.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.833631239814599, "mean_processing_ms": 3.3240044170826413, "mean_inference_ms": 0.9350971706870985}, "off_policy_estimator": {}, "info": {"num_steps_trained": 944907, "num_steps_sampled": 944907, "sample_time_ms": 23670.92, "grad_time_ms": 321.562, "update_time_ms": 9.33, "opt_peak_throughput": 35095.57, "sample_peak_throughput": 476.762, "opt_samples": 11285.4, "learner": {"av": {"cur_kl_coeff": 0.09010162204504013, "cur_lr": 0.0010000000474974513, "total_loss": 0.39705580472946167, "policy_loss": 0.09479975700378418, "vf_loss": 0.30034777522087097, "vf_explained_var": 0.14454150199890137, "kl": 0.021179109811782837, "entropy": 1.6302714347839355, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11357, "done": false, "timesteps_total": 944907, "episodes_total": 2174, "training_iteration": 84, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-24-09", "timestamp": 1585103049, "time_this_iter_s": 22.850080251693726, "time_total_s": 2051.8740015029907, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc2d158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc2d268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc2d2f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc2d950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2051.8740015029907, "timesteps_since_restore": 944907, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 51.133333333333326, "ram_util_percent": 59.490909090909085}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 2.9919037575506686, "episode_reward_min": -2.726671781689142, "episode_reward_mean": 0.8106257461462006, "episode_len_mean": 383.24, "episodes_this_iter": 33, "policy_reward_mean": {"av": 0.30023175783192624}, "custom_metrics": {"num_ped_collisions_mean": 0.14, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1251696160311724, "avg_speed_min": 0.2203616606032146, "avg_speed_max": 5.6925229213199975, "avg_rl_veh_arrival_mean": 297.5966666666667, "avg_rl_veh_arrival_min": 54.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.829981329804884, "mean_processing_ms": 3.3302706950062255, "mean_inference_ms": 0.93503131852006}, "off_policy_estimator": {}, "info": {"num_steps_trained": 956124, "num_steps_sampled": 956124, "sample_time_ms": 24230.868, "grad_time_ms": 329.574, "update_time_ms": 9.379, "opt_peak_throughput": 34218.382, "sample_peak_throughput": 465.419, "opt_samples": 11277.5, "learner": {"av": {"cur_kl_coeff": 0.1351524293422699, "cur_lr": 0.0010000000474974513, "total_loss": 0.5503774285316467, "policy_loss": 0.10520131140947342, "vf_loss": 0.4418192207813263, "vf_explained_var": 0.07028776407241821, "kl": 0.024838948622345924, "entropy": 1.7170867919921875, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11217, "done": false, "timesteps_total": 956124, "episodes_total": 2207, "training_iteration": 85, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-24-37", "timestamp": 1585103077, "time_this_iter_s": 27.643208742141724, "time_total_s": 2079.5172102451324, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19840>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc192f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc19c80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58ea0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2079.5172102451324, "timesteps_since_restore": 956124, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 47.405128205128214, "ram_util_percent": 57.22564102564104}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 2.9919037575506686, "episode_reward_min": -2.7548292674109245, "episode_reward_mean": 0.7888854537406256, "episode_len_mean": 392.25, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.2817448049073663}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.967612664117647, "avg_speed_min": 0.2203616606032146, "avg_speed_max": 5.537259995845827, "avg_rl_veh_arrival_mean": 317.94000000000005, "avg_rl_veh_arrival_min": 54.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.827419699525852, "mean_processing_ms": 3.3332284465987914, "mean_inference_ms": 0.9346291062316671}, "off_policy_estimator": {}, "info": {"num_steps_trained": 967357, "num_steps_sampled": 967357, "sample_time_ms": 23822.593, "grad_time_ms": 320.659, "update_time_ms": 9.636, "opt_peak_throughput": 35162.014, "sample_peak_throughput": 473.29, "opt_samples": 11275.0, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 0.0010000000474974513, "total_loss": 0.1447460800409317, "policy_loss": -0.07660715281963348, "vf_loss": 0.22026845812797546, "vf_explained_var": 0.03537195920944214, "kl": 0.005350474733859301, "entropy": 1.6865283250808716, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11233, "done": false, "timesteps_total": 967357, "episodes_total": 2233, "training_iteration": 86, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-24-58", "timestamp": 1585103098, "time_this_iter_s": 21.340821981430054, "time_total_s": 2100.8580322265625, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc58d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58730>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58378>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc236a8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2100.8580322265625, "timesteps_since_restore": 967357, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 46.14838709677421, "ram_util_percent": 56.28064516129032}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.0237063548079504, "episode_reward_min": -2.7548292674109245, "episode_reward_mean": 0.9782220877149413, "episode_len_mean": 402.34, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.34936503132676466}, "custom_metrics": {"num_ped_collisions_mean": 0.13, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.015438911613103, "avg_speed_min": 0.2203616606032146, "avg_speed_max": 6.247015291350478, "avg_rl_veh_arrival_mean": 314.90666666666664, "avg_rl_veh_arrival_min": 54.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.82057701093459, "mean_processing_ms": 3.3337154121964856, "mean_inference_ms": 0.9339304232910902}, "off_policy_estimator": {}, "info": {"num_steps_trained": 978615, "num_steps_sampled": 978615, "sample_time_ms": 23716.207, "grad_time_ms": 328.165, "update_time_ms": 8.76, "opt_peak_throughput": 34368.666, "sample_peak_throughput": 475.565, "opt_samples": 11278.6, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 0.0010000000474974513, "total_loss": -0.024286165833473206, "policy_loss": -0.13925322890281677, "vf_loss": 0.1137770265340805, "vf_explained_var": 0.13411182165145874, "kl": 0.005870282184332609, "entropy": 1.639732837677002, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11258, "done": false, "timesteps_total": 978615, "episodes_total": 2258, "training_iteration": 87, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-25-19", "timestamp": 1585103119, "time_this_iter_s": 20.43391442298889, "time_total_s": 2121.2919466495514, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc23d08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc232f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc23ea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc2dae8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2121.2919466495514, "timesteps_since_restore": 978615, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 42.04827586206896, "ram_util_percent": 56.286206896551725}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1790477979552016, "episode_reward_min": -2.7548292674109245, "episode_reward_mean": 0.9003800077630837, "episode_len_mean": 406.48, "episodes_this_iter": 32, "policy_reward_mean": {"av": 0.3137212570603078}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0415089637691084, "avg_speed_min": 0.6606140328849992, "avg_speed_max": 6.247015291350478, "avg_rl_veh_arrival_mean": 330.35, "avg_rl_veh_arrival_min": 80.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.809304819399239, "mean_processing_ms": 3.3340536220901225, "mean_inference_ms": 0.9326601852546895}, "off_policy_estimator": {}, "info": {"num_steps_trained": 989852, "num_steps_sampled": 989852, "sample_time_ms": 23811.713, "grad_time_ms": 338.522, "update_time_ms": 8.52, "opt_peak_throughput": 33320.145, "sample_peak_throughput": 473.7, "opt_samples": 11279.6, "learner": {"av": {"cur_kl_coeff": 0.20272865891456604, "cur_lr": 0.0010000000474974513, "total_loss": 0.6050527095794678, "policy_loss": 0.13890095055103302, "vf_loss": 0.4613274931907654, "vf_explained_var": 0.07584923505783081, "kl": 0.02379654161632061, "entropy": 1.725752353668213, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11237, "done": false, "timesteps_total": 989852, "episodes_total": 2290, "training_iteration": 88, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-25-44", "timestamp": 1585103144, "time_this_iter_s": 25.41292405128479, "time_total_s": 2146.704870700836, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc2dd08>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc2de18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc2dea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc3b598>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2146.704870700836, "timesteps_since_restore": 989852, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 41.32222222222222, "ram_util_percent": 56.34166666666666}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1790477979552016, "episode_reward_min": -2.7548292674109245, "episode_reward_mean": 1.02389972394219, "episode_len_mean": 414.01, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.3580068964832832}, "custom_metrics": {"num_ped_collisions_mean": 0.15, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1385691834715987, "avg_speed_min": 0.39225492999161293, "avg_speed_max": 6.247015291350478, "avg_rl_veh_arrival_mean": 327.6533333333333, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.789979891818593, "mean_processing_ms": 3.3363121918132608, "mean_inference_ms": 0.9301558997425632}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1001059, "num_steps_sampled": 1001059, "sample_time_ms": 23214.933, "grad_time_ms": 332.338, "update_time_ms": 8.541, "opt_peak_throughput": 33942.264, "sample_peak_throughput": 485.907, "opt_samples": 11280.3, "learner": {"av": {"cur_kl_coeff": 0.30409297347068787, "cur_lr": 0.0010000000474974513, "total_loss": 0.11133963614702225, "policy_loss": -0.09609124064445496, "vf_loss": 0.20603227615356445, "vf_explained_var": 0.059789180755615234, "kl": 0.004599078092724085, "entropy": 1.7053550481796265, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11207, "done": false, "timesteps_total": 1001059, "episodes_total": 2316, "training_iteration": 89, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-26-06", "timestamp": 1585103166, "time_this_iter_s": 21.26520299911499, "time_total_s": 2167.970073699951, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc236a8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc23598>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc23158>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc580d0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2167.970073699951, "timesteps_since_restore": 1001059, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 39.56451612903225, "ram_util_percent": 56.335483870967735}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2522438422996247, "episode_reward_min": -2.609899723910524, "episode_reward_mean": 0.9531800631441649, "episode_len_mean": 401.02, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.3392099868840446}, "custom_metrics": {"num_ped_collisions_mean": 0.16, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2043320853861066, "avg_speed_min": 0.39225492999161293, "avg_speed_max": 6.056537321102805, "avg_rl_veh_arrival_mean": 320.58833333333337, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.771827802899961, "mean_processing_ms": 3.3375184469715826, "mean_inference_ms": 0.927646215356702}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1012292, "num_steps_sampled": 1012292, "sample_time_ms": 23162.196, "grad_time_ms": 341.694, "update_time_ms": 7.419, "opt_peak_throughput": 32941.499, "sample_peak_throughput": 485.96, "opt_samples": 11255.9, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 0.0010000000474974513, "total_loss": 0.3949738144874573, "policy_loss": 0.02843490056693554, "vf_loss": 0.36441096663475037, "vf_explained_var": 0.08073705434799194, "kl": 0.013995504006743431, "entropy": 1.7610669136047363, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11233, "done": false, "timesteps_total": 1012292, "episodes_total": 2344, "training_iteration": 90, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-26-28", "timestamp": 1585103188, "time_this_iter_s": 22.005189180374146, "time_total_s": 2189.9752628803253, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc588c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58e18>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc192f0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2189.9752628803253, "timesteps_since_restore": 1012292, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 40.9, "ram_util_percent": 56.22580645161291}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2522438422996247, "episode_reward_min": -2.609899723910524, "episode_reward_mean": 1.1299246993860348, "episode_len_mean": 417.43, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.39646480680211754}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.342408620931767, "avg_speed_min": 0.39225492999161293, "avg_speed_max": 6.056537321102805, "avg_rl_veh_arrival_mean": 308.19666666666666, "avg_rl_veh_arrival_min": 74.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.759477084771361, "mean_processing_ms": 3.336195153471207, "mean_inference_ms": 0.9257342835887675}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1023592, "num_steps_sampled": 1023592, "sample_time_ms": 22794.165, "grad_time_ms": 338.463, "update_time_ms": 7.458, "opt_peak_throughput": 33230.786, "sample_peak_throughput": 493.433, "opt_samples": 11247.4, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 0.0010000000474974513, "total_loss": 0.1340899020433426, "policy_loss": -0.03575076535344124, "vf_loss": 0.16877897083759308, "vf_explained_var": 0.05814868211746216, "kl": 0.006982722785323858, "entropy": 1.7328941822052002, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11300, "done": false, "timesteps_total": 1023592, "episodes_total": 2369, "training_iteration": 91, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-26-49", "timestamp": 1585103209, "time_this_iter_s": 21.26637029647827, "time_total_s": 2211.2416331768036, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc19158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc19378>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc191e0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc3b730>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2211.2416331768036, "timesteps_since_restore": 1023592, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 40.812903225806444, "ram_util_percent": 56.067741935483866}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2522438422996247, "episode_reward_min": -2.5918247744450893, "episode_reward_mean": 1.2069817611784708, "episode_len_mean": 435.85, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4176407478126197}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3977182590699844, "avg_speed_min": 0.39225492999161293, "avg_speed_max": 6.056537321102805, "avg_rl_veh_arrival_mean": 308.6816666666666, "avg_rl_veh_arrival_min": 111.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.749154469938154, "mean_processing_ms": 3.336159049918952, "mean_inference_ms": 0.9241321060842128}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1034822, "num_steps_sampled": 1034822, "sample_time_ms": 22206.451, "grad_time_ms": 327.553, "update_time_ms": 6.505, "opt_peak_throughput": 34337.005, "sample_peak_throughput": 506.483, "opt_samples": 11247.2, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 0.0010000000474974513, "total_loss": 0.10563155263662338, "policy_loss": -0.036351971328258514, "vf_loss": 0.14107100665569305, "vf_explained_var": 0.1265886425971985, "kl": 0.006001582834869623, "entropy": 1.7121220827102661, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11230, "done": false, "timesteps_total": 1034822, "episodes_total": 2393, "training_iteration": 92, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-27-08", "timestamp": 1585103228, "time_this_iter_s": 19.608246564865112, "time_total_s": 2230.8498797416687, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc580d0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc58268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc582f0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc231e0>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2230.8498797416687, "timesteps_since_restore": 1034822, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 42.160714285714285, "ram_util_percent": 56.060714285714276}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.199390731535044, "episode_reward_min": -2.70203848618387, "episode_reward_mean": 1.2110196865583003, "episode_len_mean": 434.39, "episodes_this_iter": 28, "policy_reward_mean": {"av": 0.42491918826607045}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.11, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3753112357129242, "avg_speed_min": 0.4440523130679161, "avg_speed_max": 5.959261754766385, "avg_rl_veh_arrival_mean": 301.53, "avg_rl_veh_arrival_min": 108.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.73444040803091, "mean_processing_ms": 3.3326730198319807, "mean_inference_ms": 0.9218435382452017}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1046089, "num_steps_sampled": 1046089, "sample_time_ms": 22025.932, "grad_time_ms": 339.993, "update_time_ms": 6.18, "opt_peak_throughput": 33100.38, "sample_peak_throughput": 510.939, "opt_samples": 11253.9, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 0.0010000000474974513, "total_loss": 0.17662940919399261, "policy_loss": -0.006277980748564005, "vf_loss": 0.18154923617839813, "vf_explained_var": 0.08517706394195557, "kl": 0.00893265102058649, "entropy": 1.765980839729309, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11267, "done": false, "timesteps_total": 1046089, "episodes_total": 2421, "training_iteration": 93, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-27-31", "timestamp": 1585103251, "time_this_iter_s": 22.089637279510498, "time_total_s": 2252.939517021179, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc232f0>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc23268>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc23ea0>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc3b8c8>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2252.939517021179, "timesteps_since_restore": 1046089, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 43.058064516129036, "ram_util_percent": 56.054838709677405}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.199390731535044, "episode_reward_min": -2.70203848618387, "episode_reward_mean": 1.3293776069071808, "episode_len_mean": 439.73, "episodes_this_iter": 24, "policy_reward_mean": {"av": 0.4584060713473038}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.13, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3665214834918906, "avg_speed_min": 0.4440523130679161, "avg_speed_max": 5.959261754766385, "avg_rl_veh_arrival_mean": 298.3666666666666, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.728675857249384, "mean_processing_ms": 3.3295001033103846, "mean_inference_ms": 0.9209434100782942}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1057289, "num_steps_sampled": 1057289, "sample_time_ms": 22005.179, "grad_time_ms": 338.488, "update_time_ms": 5.426, "opt_peak_throughput": 33201.162, "sample_peak_throughput": 510.707, "opt_samples": 11238.2, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 0.0010000000474974513, "total_loss": 0.13905227184295654, "policy_loss": -0.024896441027522087, "vf_loss": 0.16313038766384125, "vf_explained_var": 0.14696037769317627, "kl": 0.0053818970918655396, "entropy": 1.7249746322631836, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 1057289, "episodes_total": 2445, "training_iteration": 94, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-27-53", "timestamp": 1585103273, "time_this_iter_s": 22.62055492401123, "time_total_s": 2275.5600719451904, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc3bae8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc3bbf8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc3bc80>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc47378>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2275.5600719451904, "timesteps_since_restore": 1057289, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 42.309375, "ram_util_percent": 56.015625}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2260685718605457, "episode_reward_min": -2.7299745351435085, "episode_reward_mean": 1.3491135172588533, "episode_len_mean": 443.63, "episodes_this_iter": 23, "policy_reward_mean": {"av": 0.4668212862487383}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.1, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.332366062625385, "avg_speed_min": 0.4440523130679161, "avg_speed_max": 5.889522101207029, "avg_rl_veh_arrival_mean": 298.9433333333333, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.70751828307881, "mean_processing_ms": 3.3283176857692522, "mean_inference_ms": 0.9184693357678085}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1068607, "num_steps_sampled": 1068607, "sample_time_ms": 21191.212, "grad_time_ms": 331.313, "update_time_ms": 5.516, "opt_peak_throughput": 33950.63, "sample_peak_throughput": 530.8, "opt_samples": 11248.3, "learner": {"av": {"cur_kl_coeff": 0.15204648673534393, "cur_lr": 0.0010000000474974513, "total_loss": 0.0317273885011673, "policy_loss": -0.06970564275979996, "vf_loss": 0.10088177770376205, "vf_explained_var": 0.2539293169975281, "kl": 0.003625687910243869, "entropy": 1.7104129791259766, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11318, "done": false, "timesteps_total": 1068607, "episodes_total": 2468, "training_iteration": 95, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-28-13", "timestamp": 1585103293, "time_this_iter_s": 19.431845664978027, "time_total_s": 2294.9919176101685, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc23158>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc236a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc23620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc58a60>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2294.9919176101685, "timesteps_since_restore": 1068607, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 40.167857142857144, "ram_util_percent": 56.0642857142857}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2260685718605457, "episode_reward_min": -2.7299745351435085, "episode_reward_mean": 1.369471444652732, "episode_len_mean": 438.71, "episodes_this_iter": 27, "policy_reward_mean": {"av": 0.47386555178295225}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3905424546932545, "avg_speed_min": 0.4440523130679161, "avg_speed_max": 5.889522101207029, "avg_rl_veh_arrival_mean": 301.83, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.698487020183575, "mean_processing_ms": 3.324608939435679, "mean_inference_ms": 0.9169224011787762}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1079987, "num_steps_sampled": 1079987, "sample_time_ms": 21172.271, "grad_time_ms": 330.36, "update_time_ms": 6.004, "opt_peak_throughput": 34093.137, "sample_peak_throughput": 531.969, "opt_samples": 11263.0, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 0.0010000000474974513, "total_loss": 0.1802925169467926, "policy_loss": 8.631997479824349e-05, "vf_loss": 0.17915956676006317, "vf_explained_var": 0.14345580339431763, "kl": 0.01376623846590519, "entropy": 1.7421270608901978, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11380, "done": false, "timesteps_total": 1079987, "episodes_total": 2495, "training_iteration": 96, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-28-34", "timestamp": 1585103314, "time_this_iter_s": 21.160687923431396, "time_total_s": 2316.1526055336, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc588c8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc586a8>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc58620>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc47510>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2316.1526055336, "timesteps_since_restore": 1079987, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 42.92666666666666, "ram_util_percent": 56.11333333333332}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2260685718605457, "episode_reward_min": -2.7299745351435085, "episode_reward_mean": 1.483256926558393, "episode_len_mean": 452.42, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.504509158693331}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.373486142609242, "avg_speed_min": 0.4440523130679161, "avg_speed_max": 5.889522101207029, "avg_rl_veh_arrival_mean": 306.30999999999995, "avg_rl_veh_arrival_min": 105.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.6753018016590495, "mean_processing_ms": 3.323813480810031, "mean_inference_ms": 0.9142505965940386}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1091324, "num_steps_sampled": 1091324, "sample_time_ms": 21071.176, "grad_time_ms": 321.205, "update_time_ms": 5.957, "opt_peak_throughput": 35089.406, "sample_peak_throughput": 534.897, "opt_samples": 11270.9, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 0.0010000000474974513, "total_loss": 0.06983454525470734, "policy_loss": -0.01892298087477684, "vf_loss": 0.08780719339847565, "vf_explained_var": 0.2549673318862915, "kl": 0.012499998323619366, "entropy": 1.7831385135650635, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11337, "done": false, "timesteps_total": 1091324, "episodes_total": 2520, "training_iteration": 97, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-28-53", "timestamp": 1585103333, "time_this_iter_s": 19.32344126701355, "time_total_s": 2335.4760468006134, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc477b8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc47840>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc478c8>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc47f28>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2335.4760468006134, "timesteps_since_restore": 1091324, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 47.22500000000001, "ram_util_percent": 56.12500000000001}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.2260685718605457, "episode_reward_min": -2.7299745351435085, "episode_reward_mean": 1.4546903814347982, "episode_len_mean": 461.54, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.49311538353721956}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.387739272837399, "avg_speed_min": 0.22047949203582487, "avg_speed_max": 5.889522101207029, "avg_rl_veh_arrival_mean": 314.50166666666667, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.661728176399102, "mean_processing_ms": 3.321671285517591, "mean_inference_ms": 0.9123485362676473}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1102524, "num_steps_sampled": 1102524, "sample_time_ms": 20849.03, "grad_time_ms": 315.19, "update_time_ms": 6.831, "opt_peak_throughput": 35747.324, "sample_peak_throughput": 540.418, "opt_samples": 11267.2, "learner": {"av": {"cur_kl_coeff": 0.07602324336767197, "cur_lr": 0.0010000000474974513, "total_loss": 0.318287193775177, "policy_loss": 0.07392805814743042, "vf_loss": 0.24235215783119202, "vf_explained_var": 0.10944217443466187, "kl": 0.026399794965982437, "entropy": 1.7453789710998535, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 1102524, "episodes_total": 2545, "training_iteration": 98, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-29-16", "timestamp": 1585103356, "time_this_iter_s": 23.12089443206787, "time_total_s": 2358.5969412326813, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc8de18>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc8dea0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc8df28>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc8d950>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2358.5969412326813, "timesteps_since_restore": 1102524, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 45.2030303030303, "ram_util_percent": 56.13939393939393}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1716334494454204, "episode_reward_min": -2.6985191573925538, "episode_reward_mean": 1.3889780006585923, "episode_len_mean": 451.42, "episodes_this_iter": 25, "policy_reward_mean": {"av": 0.47244149682265035}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.393436298019, "avg_speed_min": 0.22047949203582487, "avg_speed_max": 5.5221055345249335, "avg_rl_veh_arrival_mean": 311.505, "avg_rl_veh_arrival_min": 129.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.659605947087199, "mean_processing_ms": 3.318866131333035, "mean_inference_ms": 0.9119625952387622}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1113724, "num_steps_sampled": 1113724, "sample_time_ms": 21240.746, "grad_time_ms": 319.709, "update_time_ms": 7.096, "opt_peak_throughput": 35239.862, "sample_peak_throughput": 530.419, "opt_samples": 11266.5, "learner": {"av": {"cur_kl_coeff": 0.11403486877679825, "cur_lr": 0.0010000000474974513, "total_loss": 0.07559356838464737, "policy_loss": -0.04978862404823303, "vf_loss": 0.12474027276039124, "vf_explained_var": 0.19566094875335693, "kl": 0.005629159975796938, "entropy": 1.758140206336975, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11200, "done": false, "timesteps_total": 1113724, "episodes_total": 2570, "training_iteration": 99, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-30-04", "timestamp": 1585103404, "time_this_iter_s": 25.230775356292725, "time_total_s": 2383.827716588974, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1cc8d378>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1cc8d2f0>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1cc8d268>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1cc23d08>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2383.827716588974, "timesteps_since_restore": 1113724, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 32.57794117647058, "ram_util_percent": 56.63970588235293}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
{"episode_reward_max": 3.1716334494454204, "episode_reward_min": -2.6985191573925538, "episode_reward_mean": 1.38800045073686, "episode_len_mean": 448.75, "episodes_this_iter": 26, "policy_reward_mean": {"av": 0.472108996849272}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.09, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.3099295130974298, "avg_speed_min": 0.22047949203582487, "avg_speed_max": 5.5221055345249335, "avg_rl_veh_arrival_mean": 307.0966666666667, "avg_rl_veh_arrival_min": 131.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 7.650380015508465, "mean_processing_ms": 3.320139738249844, "mean_inference_ms": 0.9104406619651724}, "off_policy_estimator": {}, "info": {"num_steps_trained": 1124929, "num_steps_sampled": 1124929, "sample_time_ms": 21758.978, "grad_time_ms": 325.136, "update_time_ms": 7.116, "opt_peak_throughput": 34643.014, "sample_peak_throughput": 517.658, "opt_samples": 11263.7, "learner": {"av": {"cur_kl_coeff": 0.11403486877679825, "cur_lr": 0.0010000000474974513, "total_loss": 0.21855023503303528, "policy_loss": 0.07322023808956146, "vf_loss": 0.14407674968242645, "vf_explained_var": 0.15269005298614502, "kl": 0.010990404523909092, "entropy": 1.8181143999099731, "entropy_coeff": 0.0, "model": {}}}}, "timesteps_this_iter": 11205, "done": true, "timesteps_total": 1124929, "episodes_total": 2596, "training_iteration": 100, "experiment_id": "54f40c4fb39d470086511790f866f03d", "date": "2020-03-24_19-30-31", "timestamp": 1585103431, "time_this_iter_s": 27.230034589767456, "time_total_s": 2411.0577511787415, "pid": 21842, "hostname": "nick-ThinkPad", "node_ip": "192.168.1.198", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": "tune.function(<function setup_exps_PPO.<locals>.on_episode_start at 0x7f1a1df06bf8>)", "on_episode_step": "tune.function(<function setup_exps_PPO.<locals>.on_episode_step at 0x7f1a1df06b70>)", "on_episode_end": "tune.function(<function setup_exps_PPO.<locals>.on_episode_end at 0x7f1a1df06a60>)", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [32, 32], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 1,\n            \"max_decel\": 1,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 0,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 0\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 3,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "Bayesian1Env-v0", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.001, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "num_workers": 8, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 10000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", "Box(22,)", "Box(1,)", {}]}, "policy_mapping_fn": "tune.function(<function setup_exps_PPO.<locals>.policy_mapping_fn at 0x7f1a1df06378>)", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "shuffle_sequences": true, "num_sgd_iter": 30, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "simple_optimizer": true}, "time_since_restore": 2411.0577511787415, "timesteps_since_restore": 1124929, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 50.64102564102564, "ram_util_percent": 57.81538461538461}, "num_healthy_workers": 8, "trial_id": "d6c7a7ac"}
