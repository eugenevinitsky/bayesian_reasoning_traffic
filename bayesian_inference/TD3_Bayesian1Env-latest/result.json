{"episode_reward_max": -0.5699912107024866, "episode_reward_min": -0.6173870941253154, "episode_reward_mean": -0.593689152413901, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -0.6173870941253154}, "policy_reward_max": {"av": -0.5699912107024866}, "policy_reward_mean": {"av": -0.593689152413901}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.6590480131832233, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 0.8491733016555707, "avg_rl_veh_arrival_mean": 500.5, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 3.0806307549719567, "mean_processing_ms": 2.786159991741657, "mean_inference_ms": 1.0059372885720237}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 878, "num_steps_trained": 0, "num_steps_sampled": 1000, "sample_time_ms": 113.807, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.004, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 1000, "episodes_total": 2, "training_iteration": 1, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-25-45", "timestamp": 1585797945, "time_this_iter_s": 8.634444952011108, "time_total_s": 8.634444952011108, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71ce6f28>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce6ae8>", "on_episode_end": "<function on_episode_end at 0x7f7d71ce6d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71ce6e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8.634444952011108, "timesteps_since_restore": 1000, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.87692307692308, "ram_util_percent": 17.815384615384616}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5699912107024866, "episode_reward_min": -0.636703407495684, "episode_reward_mean": -0.6076092300463762, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -0.636703407495684}, "policy_reward_max": {"av": -0.5699912107024866}, "policy_reward_mean": {"av": -0.6076092300463762}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.6413343853213113, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 0.8491733016555707, "avg_rl_veh_arrival_mean": 500.25, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.7753768175796827, "mean_processing_ms": 2.782240919444991, "mean_inference_ms": 0.9263083550649303}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1754, "num_steps_trained": 0, "num_steps_sampled": 2000, "sample_time_ms": 113.813, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.004, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 2000, "episodes_total": 4, "training_iteration": 2, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-25-51", "timestamp": 1585797951, "time_this_iter_s": 6.738875150680542, "time_total_s": 15.37332010269165, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2b70>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a2c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15.37332010269165, "timesteps_since_restore": 2000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 49.37777777777777, "ram_util_percent": 18.044444444444444}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5424798241823576, "episode_reward_min": -0.636703407495684, "episode_reward_mean": -0.594454164085935, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -0.636703407495684}, "policy_reward_max": {"av": -0.5424798241823576}, "policy_reward_mean": {"av": -0.594454164085935}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.6914491327715719, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 0.8491733016555707, "avg_rl_veh_arrival_mean": 500.1666666666667, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.571694179945739, "mean_processing_ms": 2.7766970395587864, "mean_inference_ms": 0.8720652355314454}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2613, "num_steps_trained": 0, "num_steps_sampled": 3000, "sample_time_ms": 114.7, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.004, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 3000, "episodes_total": 6, "training_iteration": 3, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-25-57", "timestamp": 1585797957, "time_this_iter_s": 6.142580986022949, "time_total_s": 21.5159010887146, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701ccbf8>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce6730>", "on_episode_end": "<function on_episode_end at 0x7f7d71ce6950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71ce6840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 21.5159010887146, "timesteps_since_restore": 3000, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 46.666666666666664, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5319763662135142, "episode_reward_min": -0.6431762374908822, "episode_reward_mean": -0.5927346985275008, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -0.6431762374908822}, "policy_reward_max": {"av": -0.5319763662135142}, "policy_reward_mean": {"av": -0.5927346985275008}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.6700380392251277, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 0.8491733016555707, "avg_rl_veh_arrival_mean": 500.125, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.4352731485158667, "mean_processing_ms": 2.7718441650858274, "mean_inference_ms": 0.8377324755375154}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3490, "num_steps_trained": 0, "num_steps_sampled": 4000, "sample_time_ms": 113.379, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.004, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 4000, "episodes_total": 8, "training_iteration": 4, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-26-04", "timestamp": 1585797964, "time_this_iter_s": 6.376094341278076, "time_total_s": 27.891995429992676, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70117400>", "on_episode_step": "<function on_episode_step at 0x7f7d70117488>", "on_episode_end": "<function on_episode_end at 0x7f7d70117510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70117598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 27.891995429992676, "timesteps_since_restore": 4000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 50.75555555555556, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5248334669352943, "episode_reward_min": -0.6431762374908822, "episode_reward_mean": -0.590195576754243, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -0.6431762374908822}, "policy_reward_max": {"av": -0.5248334669352943}, "policy_reward_mean": {"av": -0.590195576754243}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.6852721236958503, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 0.8491733016555707, "avg_rl_veh_arrival_mean": 500.1, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.346792645006132, "mean_processing_ms": 2.769925486187619, "mean_inference_ms": 0.8151704112782177}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4355, "num_steps_trained": 0, "num_steps_sampled": 5000, "sample_time_ms": 113.894, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 5000, "episodes_total": 10, "training_iteration": 5, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-26-11", "timestamp": 1585797971, "time_this_iter_s": 6.762847185134888, "time_total_s": 34.65484261512756, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701ccbf8>", "on_episode_step": "<function on_episode_step at 0x7f7d701ccae8>", "on_episode_end": "<function on_episode_end at 0x7f7d701cce18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701ccd08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 34.65484261512756, "timesteps_since_restore": 5000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 49.9, "ram_util_percent": 18.009999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5248334669352943, "episode_reward_min": -0.6431762374908822, "episode_reward_mean": -0.59216089971047, "episode_len_mean": 500.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -0.6431762374908822}, "policy_reward_max": {"av": -0.5248334669352943}, "policy_reward_mean": {"av": -0.59216089971047}, "custom_metrics": {"num_ped_collisions_mean": 0.0, "num_ped_collisions_min": 0, "num_ped_collisions_max": 0, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.6797513326731974, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 0.8491733016555707, "avg_rl_veh_arrival_mean": 500.0833333333333, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.280647753162665, "mean_processing_ms": 2.7689979197315906, "mean_inference_ms": 0.7996512120438685}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 5228, "num_steps_trained": 0, "num_steps_sampled": 6000, "sample_time_ms": 114.39, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 6000, "episodes_total": 12, "training_iteration": 6, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-26-17", "timestamp": 1585797977, "time_this_iter_s": 6.705965042114258, "time_total_s": 41.36080765724182, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701261e0>", "on_episode_step": "<function on_episode_step at 0x7f7d70126268>", "on_episode_end": "<function on_episode_end at 0x7f7d701262f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70126378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 41.36080765724182, "timesteps_since_restore": 6000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 50.57000000000001, "ram_util_percent": 18.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5248334669352943, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.7854926629995403, "episode_len_mean": 484.2142857142857, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": -0.5248334669352943}, "policy_reward_mean": {"av": -0.7854926629995403}, "custom_metrics": {"num_ped_collisions_mean": 0.07142857142857142, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.7393286528319177, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 1.1614499852924156, "avg_rl_veh_arrival_mean": 500.07142857142856, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.227385257206716, "mean_processing_ms": 2.7674498244866705, "mean_inference_ms": 0.786040322065224}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 6007, "num_steps_trained": 0, "num_steps_sampled": 7000, "sample_time_ms": 3.352, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.004, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 7000, "episodes_total": 14, "training_iteration": 7, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-26-24", "timestamp": 1585797984, "time_this_iter_s": 6.214120864868164, "time_total_s": 47.574928522109985, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71ce67b8>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce6730>", "on_episode_end": "<function on_episode_end at 0x7f7d71ce6d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71ce68c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 47.574928522109985, "timesteps_since_restore": 7000, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 50.099999999999994, "ram_util_percent": 18.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5248334669352943, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.7591222140783603, "episode_len_mean": 486.1875, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": -0.5248334669352943}, "policy_reward_mean": {"av": -0.7591222140783603}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.7353491815106356, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 1.1614499852924156, "avg_rl_veh_arrival_mean": 500.0625, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.1819347694129685, "mean_processing_ms": 2.765746732296317, "mean_inference_ms": 0.7745907606312379}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 6875, "num_steps_trained": 0, "num_steps_sampled": 8000, "sample_time_ms": 3.837, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 8000, "episodes_total": 16, "training_iteration": 8, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-26-30", "timestamp": 1585797990, "time_this_iter_s": 6.212513446807861, "time_total_s": 53.78744196891785, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701ccea0>", "on_episode_step": "<function on_episode_step at 0x7f7d701cc6a8>", "on_episode_end": "<function on_episode_end at 0x7f7d701ccd90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701cc488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 53.78744196891785, "timesteps_since_restore": 8000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 47.75555555555556, "ram_util_percent": 18.15555555555555}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.5229127098374443, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.7401700165540887, "episode_len_mean": 487.72222222222223, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": -0.5229127098374443}, "policy_reward_mean": {"av": -0.7401700165540887}, "custom_metrics": {"num_ped_collisions_mean": 0.05555555555555555, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.729166728383361, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 1.1614499852924156, "avg_rl_veh_arrival_mean": 500.05555555555554, "avg_rl_veh_arrival_min": 500.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.1440128498463786, "mean_processing_ms": 2.764282717541868, "mean_inference_ms": 0.7652648708563903}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 7735, "num_steps_trained": 0, "num_steps_sampled": 9000, "sample_time_ms": 3.72, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.005, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 9000, "episodes_total": 18, "training_iteration": 9, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-26-36", "timestamp": 1585797996, "time_this_iter_s": 6.451117992401123, "time_total_s": 60.23855996131897, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2a60>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2e18>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a2b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 60.23855996131897, "timesteps_since_restore": 9000, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 51.739999999999995, "ram_util_percent": 18.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": -0.05455488440661489, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.6926030577634166, "episode_len_mean": 471.42857142857144, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": -0.05455488440661489}, "policy_reward_mean": {"av": -0.6926030577634166}, "custom_metrics": {"num_ped_collisions_mean": 0.047619047619047616, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.8443033075030586, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 3.037472255415587, "avg_rl_veh_arrival_mean": 482.0, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.0992924577320937, "mean_processing_ms": 2.7776799439452793, "mean_inference_ms": 0.7535270977107441}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 8532, "num_steps_trained": 0, "num_steps_sampled": 10000, "sample_time_ms": 2.982, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 0.003, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 10000, "episodes_total": 21, "training_iteration": 10, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-26-44", "timestamp": 1585798004, "time_this_iter_s": 7.45257568359375, "time_total_s": 67.69113564491272, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2950>", "on_episode_step": "<function on_episode_step at 0x7f7d701a20d0>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a2268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 67.69113564491272, "timesteps_since_restore": 10000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 48.4, "ram_util_percent": 18.23}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.0008239964799865249, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.6975577655106122, "episode_len_mean": 473.9130434782609, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.0008239964799865249}, "policy_reward_mean": {"av": -0.6975577655106122}, "custom_metrics": {"num_ped_collisions_mean": 0.043478260869565216, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 0.9384461362593896, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 3.037472255415587, "avg_rl_veh_arrival_mean": 483.5652173913044, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.077735519497206, "mean_processing_ms": 2.784553455327219, "mean_inference_ms": 0.7481373366912073}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 9388, "num_steps_trained": 85600, "num_steps_sampled": 11000, "sample_time_ms": 5.212, "replay_time_ms": 18.631, "grad_time_ms": 19.87, "update_time_ms": 0.005, "opt_peak_throughput": 5032.708, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2.9278955459594727, "max_q": 3.2514007091522217, "min_q": -27.532756805419922}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 11000, "episodes_total": 23, "training_iteration": 11, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-27-22", "timestamp": 1585798042, "time_this_iter_s": 38.65828275680542, "time_total_s": 106.34941840171814, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71cb2620>", "on_episode_step": "<function on_episode_step at 0x7f7d71cb21e0>", "on_episode_end": "<function on_episode_end at 0x7f7d71cb2bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71cb2ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 106.34941840171814, "timesteps_since_restore": 11000, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 69.2, "ram_util_percent": 18.58727272727273}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.5965876399163913, "episode_len_mean": 476.0, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.5965876399163913}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.1951766194921334, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 4.649422071852884, "avg_rl_veh_arrival_mean": 465.2, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.0560465093061566, "mean_processing_ms": 2.7885860337356885, "mean_inference_ms": 0.7411335146833288}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 9755, "num_steps_trained": 122300, "num_steps_sampled": 12000, "sample_time_ms": 4.215, "replay_time_ms": 16.722, "grad_time_ms": 16.725, "update_time_ms": 0.004, "opt_peak_throughput": 5979.119, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.087808609008789, "max_q": 3.6501641273498535, "min_q": -27.800931930541992}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 12000, "episodes_total": 25, "training_iteration": 12, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-27-40", "timestamp": 1585798060, "time_this_iter_s": 18.01824140548706, "time_total_s": 124.3676598072052, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2e18>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2a60>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a2f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 124.3676598072052, "timesteps_since_restore": 12000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 68.25384615384615, "ram_util_percent": 18.6}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.5915424724280534, "episode_len_mean": 477.77777777777777, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.5915424724280534}, "custom_metrics": {"num_ped_collisions_mean": 0.037037037037037035, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.2084053935851145, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 4.649422071852884, "avg_rl_veh_arrival_mean": 467.77777777777777, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.0383065714913333, "mean_processing_ms": 2.7918243126350557, "mean_inference_ms": 0.7360154500396467}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 10636, "num_steps_trained": 210400, "num_steps_sampled": 13000, "sample_time_ms": 4.358, "replay_time_ms": 17.015, "grad_time_ms": 18.798, "update_time_ms": 0.005, "opt_peak_throughput": 5319.825, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.702646255493164, "max_q": 1.9310863018035889, "min_q": -27.66659164428711}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 13000, "episodes_total": 27, "training_iteration": 13, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-28-19", "timestamp": 1585798099, "time_this_iter_s": 38.43768525123596, "time_total_s": 162.80534505844116, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a20d0>", "on_episode_step": "<function on_episode_step at 0x7f7d701a22f0>", "on_episode_end": "<function on_episode_end at 0x7f7d701a21e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a2d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 162.80534505844116, "timesteps_since_restore": 13000, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 69.37407407407409, "ram_util_percent": 18.605555555555558}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.5507271216790203, "episode_len_mean": 479.3103448275862, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.5507271216790203}, "custom_metrics": {"num_ped_collisions_mean": 0.034482758620689655, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.1752569457596727, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 4.649422071852884, "avg_rl_veh_arrival_mean": 470.0, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.024212886082281, "mean_processing_ms": 2.7946825556755894, "mean_inference_ms": 0.7321838606515108}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 11528, "num_steps_trained": 299600, "num_steps_sampled": 14000, "sample_time_ms": 4.186, "replay_time_ms": 16.122, "grad_time_ms": 20.767, "update_time_ms": 0.005, "opt_peak_throughput": 4815.344, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.336629867553711, "max_q": 1.6039811372756958, "min_q": -18.92498207092285}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 14000, "episodes_total": 29, "training_iteration": 14, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-28-59", "timestamp": 1585798139, "time_this_iter_s": 39.66081953048706, "time_total_s": 202.46616458892822, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2b70>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a28c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 202.46616458892822, "timesteps_since_restore": 14000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 69.58070175438597, "ram_util_percent": 18.67017543859649}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.610479261463869, "episode_len_mean": 480.64516129032256, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.610479261463869}, "custom_metrics": {"num_ped_collisions_mean": 0.03225806451612903, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.2280532262535049, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 4.649422071852884, "avg_rl_veh_arrival_mean": 471.93548387096774, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.013493909395561, "mean_processing_ms": 2.7971280688110043, "mean_inference_ms": 0.7293907302408991}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 12414, "num_steps_trained": 388200, "num_steps_sampled": 15000, "sample_time_ms": 4.064, "replay_time_ms": 14.225, "grad_time_ms": 17.134, "update_time_ms": 0.005, "opt_peak_throughput": 5836.349, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.626967191696167, "max_q": 1.3781770467758179, "min_q": -19.268062591552734}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 15000, "episodes_total": 31, "training_iteration": 15, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-29-38", "timestamp": 1585798178, "time_this_iter_s": 39.687448263168335, "time_total_s": 242.15361285209656, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a29d8>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2378>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701262f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 242.15361285209656, "timesteps_since_restore": 15000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 70.40714285714286, "ram_util_percent": 18.7}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.5561917593053225, "episode_len_mean": 481.8181818181818, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.5561917593053225}, "custom_metrics": {"num_ped_collisions_mean": 0.030303030303030304, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.2893310803461109, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 4.649422071852884, "avg_rl_veh_arrival_mean": 467.42424242424244, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 2.0034244341243053, "mean_processing_ms": 2.798919835758946, "mean_inference_ms": 0.7265345642202464}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 13067, "num_steps_trained": 453500, "num_steps_sampled": 16000, "sample_time_ms": 4.486, "replay_time_ms": 18.695, "grad_time_ms": 20.374, "update_time_ms": 0.005, "opt_peak_throughput": 4908.179, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.452275276184082, "max_q": 0.7646613121032715, "min_q": -23.627578735351562}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 16000, "episodes_total": 33, "training_iteration": 16, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-30-08", "timestamp": 1585798208, "time_this_iter_s": 29.874701261520386, "time_total_s": 272.02831411361694, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71ce6ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce6e18>", "on_episode_end": "<function on_episode_end at 0x7f7d71cb2bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71cb2ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 272.02831411361694, "timesteps_since_restore": 16000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 68.8674418604651, "ram_util_percent": 18.709302325581397}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.5243907998592893, "episode_len_mean": 482.85714285714283, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.5243907998592893}, "custom_metrics": {"num_ped_collisions_mean": 0.02857142857142857, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.292712966046334, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 4.649422071852884, "avg_rl_veh_arrival_mean": 469.2857142857143, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9947048456344496, "mean_processing_ms": 2.800402004661827, "mean_inference_ms": 0.7244493550531734}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 13941, "num_steps_trained": 540900, "num_steps_sampled": 17000, "sample_time_ms": 5.391, "replay_time_ms": 19.389, "grad_time_ms": 21.756, "update_time_ms": 0.005, "opt_peak_throughput": 4596.508, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.444575786590576, "max_q": 1.0760276317596436, "min_q": -21.660221099853516}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 17000, "episodes_total": 35, "training_iteration": 17, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-30-48", "timestamp": 1585798248, "time_this_iter_s": 39.641852617263794, "time_total_s": 311.67016673088074, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2378>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2400>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a29d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 311.67016673088074, "timesteps_since_restore": 17000, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 70.24107142857143, "ram_util_percent": 18.791071428571428}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.48152302483931486, "episode_len_mean": 483.7837837837838, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.48152302483931486}, "custom_metrics": {"num_ped_collisions_mean": 0.02702702702702703, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.4242185216145393, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 461.4594594594595, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9862649369491645, "mean_processing_ms": 2.8012656113952366, "mean_inference_ms": 0.722029572797469}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 14458, "num_steps_trained": 592600, "num_steps_sampled": 18000, "sample_time_ms": 4.443, "replay_time_ms": 16.104, "grad_time_ms": 19.479, "update_time_ms": 0.005, "opt_peak_throughput": 5133.605, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.630688667297363, "max_q": 0.362530380487442, "min_q": -17.75149154663086}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 18000, "episodes_total": 37, "training_iteration": 18, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-31-13", "timestamp": 1585798273, "time_this_iter_s": 25.07378125190735, "time_total_s": 336.7439479827881, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d701a2d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a2950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 336.7439479827881, "timesteps_since_restore": 18000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 71.3777777777778, "ram_util_percent": 18.799999999999997}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.535246764060311, "episode_len_mean": 484.61538461538464, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.535246764060311}, "custom_metrics": {"num_ped_collisions_mean": 0.02564102564102564, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.449491178364577, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 463.43589743589746, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9794777878587586, "mean_processing_ms": 2.80208333380073, "mean_inference_ms": 0.720267972039994}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 15332, "num_steps_trained": 680000, "num_steps_sampled": 19000, "sample_time_ms": 3.905, "replay_time_ms": 15.624, "grad_time_ms": 17.636, "update_time_ms": 0.005, "opt_peak_throughput": 5670.17, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.035902500152588, "max_q": 1.256034255027771, "min_q": -15.287818908691406}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 19000, "episodes_total": 39, "training_iteration": 19, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-31-53", "timestamp": 1585798313, "time_this_iter_s": 39.68747687339783, "time_total_s": 376.4314248561859, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70126840>", "on_episode_step": "<function on_episode_step at 0x7f7d701cc488>", "on_episode_end": "<function on_episode_end at 0x7f7d701cc158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701ccbf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 376.4314248561859, "timesteps_since_restore": 19000, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 71.05, "ram_util_percent": 18.84285714285715}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.5902959503203, "episode_len_mean": 485.3658536585366, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.5902959503203}, "custom_metrics": {"num_ped_collisions_mean": 0.024390243902439025, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.4536954152122186, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 465.219512195122, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9735447726504425, "mean_processing_ms": 2.8029179923177256, "mean_inference_ms": 0.7189659450387695}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 16230, "num_steps_trained": 769800, "num_steps_sampled": 20000, "sample_time_ms": 4.075, "replay_time_ms": 14.09, "grad_time_ms": 18.724, "update_time_ms": 0.005, "opt_peak_throughput": 5340.878, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.217353343963623, "max_q": 0.40574780106544495, "min_q": -20.87403678894043}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 20000, "episodes_total": 41, "training_iteration": 20, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-32-33", "timestamp": 1585798353, "time_this_iter_s": 40.511006355285645, "time_total_s": 416.94243121147156, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d700510d0>", "on_episode_step": "<function on_episode_step at 0x7f7d70051158>", "on_episode_end": "<function on_episode_end at 0x7f7d700511e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70051268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 416.94243121147156, "timesteps_since_restore": 20000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 69.82068965517242, "ram_util_percent": 18.95172413793103}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.608383044558876, "episode_len_mean": 477.3255813953488, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.608383044558876}, "custom_metrics": {"num_ped_collisions_mean": 0.023255813953488372, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0, "num_veh_collisions_min": 0, "num_veh_collisions_max": 0, "avg_speed_mean": 1.5211563184722365, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 458.1162790697674, "avg_rl_veh_arrival_min": 121.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9687406436474368, "mean_processing_ms": 2.803641499176533, "mean_inference_ms": 0.7180564919184612}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 17095, "num_steps_trained": 856300, "num_steps_sampled": 21000, "sample_time_ms": 4.501, "replay_time_ms": 18.374, "grad_time_ms": 21.742, "update_time_ms": 0.005, "opt_peak_throughput": 4599.466, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2.9696009159088135, "max_q": 0.33880722522735596, "min_q": -13.99400520324707}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 21000, "episodes_total": 43, "training_iteration": 21, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-33-12", "timestamp": 1585798392, "time_this_iter_s": 38.57223296165466, "time_total_s": 455.5146641731262, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701cc158>", "on_episode_step": "<function on_episode_step at 0x7f7d701cca60>", "on_episode_end": "<function on_episode_end at 0x7f7d701ccbf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701cc8c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 455.5146641731262, "timesteps_since_restore": 21000, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 69.74727272727273, "ram_util_percent": 19.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.6149636386935199, "episode_len_mean": 463.02127659574467, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.6149636386935199}, "custom_metrics": {"num_ped_collisions_mean": 0.02127659574468085, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02127659574468085, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.633171885711929, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 445.4468085106383, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9607564927306875, "mean_processing_ms": 2.8133650941318966, "mean_inference_ms": 0.7163612851302444}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 17823, "num_steps_trained": 929100, "num_steps_sampled": 22000, "sample_time_ms": 4.039, "replay_time_ms": 16.368, "grad_time_ms": 20.909, "update_time_ms": 0.005, "opt_peak_throughput": 4782.635, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.4709584712982178, "max_q": 1.2330729961395264, "min_q": -23.25689125061035}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 22000, "episodes_total": 47, "training_iteration": 22, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-33-47", "timestamp": 1585798427, "time_this_iter_s": 35.35642695426941, "time_total_s": 490.87109112739563, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70051d08>", "on_episode_step": "<function on_episode_step at 0x7f7d70051d90>", "on_episode_end": "<function on_episode_end at 0x7f7d700516a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70051620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 490.87109112739563, "timesteps_since_restore": 22000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 67.638, "ram_util_percent": 19.034}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.6327790615093738, "episode_len_mean": 464.53061224489795, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.6327790615093738}, "custom_metrics": {"num_ped_collisions_mean": 0.02040816326530612, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02040816326530612, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.6342675681082304, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 447.6734693877551, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9577152892646144, "mean_processing_ms": 2.8175014838851498, "mean_inference_ms": 0.7157747185413521}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 18696, "num_steps_trained": 1016400, "num_steps_sampled": 23000, "sample_time_ms": 4.195, "replay_time_ms": 15.887, "grad_time_ms": 21.074, "update_time_ms": 0.005, "opt_peak_throughput": 4745.273, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.706881523132324, "max_q": -0.20635674893856049, "min_q": -22.030624389648438}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 23000, "episodes_total": 49, "training_iteration": 23, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-34-27", "timestamp": 1585798467, "time_this_iter_s": 39.25650382041931, "time_total_s": 530.1275949478149, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d700510d0>", "on_episode_step": "<function on_episode_step at 0x7f7d70051730>", "on_episode_end": "<function on_episode_end at 0x7f7d70051158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70051048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 530.1275949478149, "timesteps_since_restore": 23000, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 69.85892857142856, "ram_util_percent": 19.089285714285715}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.6584400878018061, "episode_len_mean": 459.90384615384613, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.6584400878018061}, "custom_metrics": {"num_ped_collisions_mean": 0.019230769230769232, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.019230769230769232, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.6870442529442906, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 444.0192307692308, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.95380239825958, "mean_processing_ms": 2.8255111688737875, "mean_inference_ms": 0.7149608461346328}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 19474, "num_steps_trained": 1094200, "num_steps_sampled": 24000, "sample_time_ms": 3.978, "replay_time_ms": 14.344, "grad_time_ms": 16.341, "update_time_ms": 0.004, "opt_peak_throughput": 6119.632, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.5399298667907715, "max_q": 1.1346195936203003, "min_q": -18.604597091674805}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 24000, "episodes_total": 52, "training_iteration": 24, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-35-03", "timestamp": 1585798503, "time_this_iter_s": 36.109185457229614, "time_total_s": 566.2367804050446, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71ce6d08>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce68c8>", "on_episode_end": "<function on_episode_end at 0x7f7d71ce6bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71ce66a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 566.2367804050446, "timesteps_since_restore": 24000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 68.04901960784315, "ram_util_percent": 19.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.6613727203226284, "episode_len_mean": 461.3888888888889, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.6613727203226284}, "custom_metrics": {"num_ped_collisions_mean": 0.018518518518518517, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.018518518518518517, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.6805573813021784, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 446.0925925925926, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.95170316948284, "mean_processing_ms": 2.8301156164044907, "mean_inference_ms": 0.7145264517258544}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 20335, "num_steps_trained": 1180300, "num_steps_sampled": 25000, "sample_time_ms": 4.387, "replay_time_ms": 17.897, "grad_time_ms": 20.595, "update_time_ms": 0.005, "opt_peak_throughput": 4855.564, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.5414340496063232, "max_q": -0.32052910327911377, "min_q": -15.98715877532959}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 25000, "episodes_total": 54, "training_iteration": 25, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-35-41", "timestamp": 1585798541, "time_this_iter_s": 37.981308937072754, "time_total_s": 604.2180893421173, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d700510d0>", "on_episode_step": "<function on_episode_step at 0x7f7d70051ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d70051d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70051d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 604.2180893421173, "timesteps_since_restore": 25000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 67.93703703703704, "ram_util_percent": 19.12592592592593}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.6986733069392917, "episode_len_mean": 462.76785714285717, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.6986733069392917}, "custom_metrics": {"num_ped_collisions_mean": 0.017857142857142856, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.017857142857142856, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.692122812302912, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 448.01785714285717, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9498802309749401, "mean_processing_ms": 2.8342293829236973, "mean_inference_ms": 0.7142383745756852}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 21202, "num_steps_trained": 1267000, "num_steps_sampled": 26000, "sample_time_ms": 4.22, "replay_time_ms": 16.569, "grad_time_ms": 17.653, "update_time_ms": 0.005, "opt_peak_throughput": 5664.648, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2.7772092819213867, "max_q": 2.1959033012390137, "min_q": -14.825645446777344}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 26000, "episodes_total": 56, "training_iteration": 26, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-36-20", "timestamp": 1585798580, "time_this_iter_s": 38.47865962982178, "time_total_s": 642.6967489719391, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70051510>", "on_episode_step": "<function on_episode_step at 0x7f7d70051c80>", "on_episode_end": "<function on_episode_end at 0x7f7d700516a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70051840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 642.6967489719391, "timesteps_since_restore": 26000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 68.61607142857143, "ram_util_percent": 19.207142857142856}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.7352466780189879, "episode_len_mean": 458.7931034482759, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.7352466780189879}, "custom_metrics": {"num_ped_collisions_mean": 0.034482758620689655, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.017241379310344827, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.7072973002830805, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 449.8103448275862, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9483309748197626, "mean_processing_ms": 2.8379249447861103, "mean_inference_ms": 0.7140582335511048}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 22069, "num_steps_trained": 1353700, "num_steps_sampled": 27000, "sample_time_ms": 3.548, "replay_time_ms": 16.585, "grad_time_ms": 20.196, "update_time_ms": 0.005, "opt_peak_throughput": 4951.403, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.186574935913086, "max_q": -0.30273643136024475, "min_q": -15.030083656311035}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 27000, "episodes_total": 58, "training_iteration": 27, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-36-58", "timestamp": 1585798618, "time_this_iter_s": 38.035638093948364, "time_total_s": 680.7323870658875, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2d90>", "on_episode_step": "<function on_episode_step at 0x7f7d701a2d08>", "on_episode_end": "<function on_episode_end at 0x7f7d70126158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701261e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 680.7323870658875, "timesteps_since_restore": 27000, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 68.16851851851852, "ram_util_percent": 19.262962962962956}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.7835035541059232, "episode_len_mean": 456.0163934426229, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.7835035541059232}, "custom_metrics": {"num_ped_collisions_mean": 0.04918032786885246, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01639344262295082, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.7206700713291678, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 452.27868852459017, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9464089749446087, "mean_processing_ms": 2.8446833162484007, "mean_inference_ms": 0.7137913209813637}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 22854, "num_steps_trained": 1432200, "num_steps_sampled": 28000, "sample_time_ms": 4.014, "replay_time_ms": 15.668, "grad_time_ms": 17.516, "update_time_ms": 0.005, "opt_peak_throughput": 5709.029, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.398472785949707, "max_q": -0.4127737581729889, "min_q": -14.352757453918457}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 28000, "episodes_total": 61, "training_iteration": 28, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-37-35", "timestamp": 1585798655, "time_this_iter_s": 36.588993072509766, "time_total_s": 717.3213801383972, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70081620>", "on_episode_step": "<function on_episode_step at 0x7f7d70081378>", "on_episode_end": "<function on_episode_end at 0x7f7d700816a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 717.3213801383972, "timesteps_since_restore": 28000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 68.02307692307691, "ram_util_percent": 19.299999999999997}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.841876516084199, "episode_len_mean": 451.875, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.841876516084199}, "custom_metrics": {"num_ped_collisions_mean": 0.0625, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.015625, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.761263332084923, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 454.515625, "avg_rl_veh_arrival_min": 114.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.944850823487001, "mean_processing_ms": 2.8523645063740393, "mean_inference_ms": 0.7135486006697228}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 23655, "num_steps_trained": 1512300, "num_steps_sampled": 29000, "sample_time_ms": 129.841, "replay_time_ms": 19.647, "grad_time_ms": 19.296, "update_time_ms": 0.006, "opt_peak_throughput": 5182.408, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.022188186645508, "max_q": -0.500482976436615, "min_q": -16.567874908447266}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 29000, "episodes_total": 64, "training_iteration": 29, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-38-12", "timestamp": 1585798692, "time_this_iter_s": 37.52834415435791, "time_total_s": 754.8497242927551, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8400>", "on_episode_step": "<function on_episode_step at 0x7f7d687f86a8>", "on_episode_end": "<function on_episode_end at 0x7f7d687f8bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687f8d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 754.8497242927551, "timesteps_since_restore": 29000, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 69.73962264150943, "ram_util_percent": 19.32830188679245}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8231652094193701, "episode_len_mean": 448.089552238806, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8231652094193701}, "custom_metrics": {"num_ped_collisions_mean": 0.05970149253731343, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.029850746268656716, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.8162556566345593, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 447.04477611940297, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9429874498384367, "mean_processing_ms": 2.8602846924580434, "mean_inference_ms": 0.7130773599682165}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 24324, "num_steps_trained": 1579200, "num_steps_sampled": 30100, "sample_time_ms": 149.793, "replay_time_ms": 15.517, "grad_time_ms": 17.737, "update_time_ms": 0.005, "opt_peak_throughput": 5637.884, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.059040546417236, "max_q": 0.21946997940540314, "min_q": -19.667016983032227}}}, "timesteps_this_iter": 1100, "done": false, "timesteps_total": 30100, "episodes_total": 67, "training_iteration": 30, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-38-44", "timestamp": 1585798724, "time_this_iter_s": 31.87104821205139, "time_total_s": 786.7207725048065, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8d08>", "on_episode_step": "<function on_episode_step at 0x7f7d687f8598>", "on_episode_end": "<function on_episode_end at 0x7f7d687f8378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687f82f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 786.7207725048065, "timesteps_since_restore": 30100, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 69.77826086956522, "ram_util_percent": 19.4}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8275926187875112, "episode_len_mean": 449.59420289855075, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8275926187875112}, "custom_metrics": {"num_ped_collisions_mean": 0.057971014492753624, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.028985507246376812, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.8123396114557209, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 448.57971014492756, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9418225720118598, "mean_processing_ms": 2.8649852775341196, "mean_inference_ms": 0.7128375799015184}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 25170, "num_steps_trained": 1663800, "num_steps_sampled": 31104, "sample_time_ms": 132.217, "replay_time_ms": 17.998, "grad_time_ms": 20.885, "update_time_ms": 0.005, "opt_peak_throughput": 4788.046, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.29202938079834, "max_q": -0.18244224786758423, "min_q": -13.922887802124023}}}, "timesteps_this_iter": 1004, "done": false, "timesteps_total": 31104, "episodes_total": 69, "training_iteration": 31, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-39-22", "timestamp": 1585798762, "time_this_iter_s": 38.25979518890381, "time_total_s": 824.9805676937103, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70081950>", "on_episode_step": "<function on_episode_step at 0x7f7d70081a60>", "on_episode_end": "<function on_episode_end at 0x7f7d70081620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 824.9805676937103, "timesteps_since_restore": 31104, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 70.35555555555555, "ram_util_percent": 19.40555555555556}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8442018240890489, "episode_len_mean": 445.63380281690144, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8442018240890489}, "custom_metrics": {"num_ped_collisions_mean": 0.056338028169014086, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04225352112676056, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.8568149219642045, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 444.6478873239437, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9409068387039528, "mean_processing_ms": 2.869269106535502, "mean_inference_ms": 0.7126959644301524}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 26046, "num_steps_trained": 1751400, "num_steps_sampled": 32104, "sample_time_ms": 5.049, "replay_time_ms": 19.442, "grad_time_ms": 21.223, "update_time_ms": 0.006, "opt_peak_throughput": 4711.955, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.876457452774048, "max_q": -0.29967430233955383, "min_q": -21.133724212646484}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 32104, "episodes_total": 71, "training_iteration": 32, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-40-02", "timestamp": 1585798802, "time_this_iter_s": 39.846473693847656, "time_total_s": 864.827041387558, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70081ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d700811e0>", "on_episode_end": "<function on_episode_end at 0x7f7d70081510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d700816a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 864.827041387558, "timesteps_since_restore": 32104, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 70.01754385964911, "ram_util_percent": 19.489473684210527}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8906017391196405, "episode_len_mean": 442.9054054054054, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8906017391196405}, "custom_metrics": {"num_ped_collisions_mean": 0.06756756756756757, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04054054054054054, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.870732202821197, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 446.8918918918919, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.939698106648826, "mean_processing_ms": 2.8763604792720288, "mean_inference_ms": 0.7125506997799237}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 26862, "num_steps_trained": 1833000, "num_steps_sampled": 33104, "sample_time_ms": 3.964, "replay_time_ms": 16.232, "grad_time_ms": 20.55, "update_time_ms": 0.005, "opt_peak_throughput": 4866.171, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.982651710510254, "max_q": -0.04972532391548157, "min_q": -14.634899139404297}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 33104, "episodes_total": 74, "training_iteration": 33, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-40-41", "timestamp": 1585798841, "time_this_iter_s": 38.686989307403564, "time_total_s": 903.5140306949615, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71ce67b8>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce6e18>", "on_episode_end": "<function on_episode_end at 0x7f7d71ce6ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687f8400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 903.5140306949615, "timesteps_since_restore": 33104, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 69.97272727272727, "ram_util_percent": 19.507272727272728}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8856977521529563, "episode_len_mean": 444.4078947368421, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8856977521529563}, "custom_metrics": {"num_ped_collisions_mean": 0.06578947368421052, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.039473684210526314, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.8638916239245666, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 448.2894736842105, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.93901869644541, "mean_processing_ms": 2.8806164493826074, "mean_inference_ms": 0.7125346431570103}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 27724, "num_steps_trained": 1919200, "num_steps_sampled": 34104, "sample_time_ms": 4.828, "replay_time_ms": 20.883, "grad_time_ms": 24.057, "update_time_ms": 0.005, "opt_peak_throughput": 4156.781, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.434542179107666, "max_q": -0.5499227046966553, "min_q": -12.753947257995605}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 34104, "episodes_total": 76, "training_iteration": 34, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-41-20", "timestamp": 1585798880, "time_this_iter_s": 39.23497200012207, "time_total_s": 942.7490026950836, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70081048>", "on_episode_step": "<function on_episode_step at 0x7f7d700817b8>", "on_episode_end": "<function on_episode_end at 0x7f7d7004f048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d7004f488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 942.7490026950836, "timesteps_since_restore": 34104, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 69.91636363636363, "ram_util_percent": 19.59454545454545}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.923557685132757, "episode_len_mean": 438.0, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.923557685132757}, "custom_metrics": {"num_ped_collisions_mean": 0.075, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.914363659740237, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 446.0, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9375908978125849, "mean_processing_ms": 2.8913103415917254, "mean_inference_ms": 0.7124643083984971}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 28474, "num_steps_trained": 1994200, "num_steps_sampled": 35104, "sample_time_ms": 128.467, "replay_time_ms": 21.423, "grad_time_ms": 22.111, "update_time_ms": 0.005, "opt_peak_throughput": 4522.682, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.561997413635254, "max_q": -0.8200396299362183, "min_q": -20.57493782043457}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 35104, "episodes_total": 80, "training_iteration": 35, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-41-57", "timestamp": 1585798917, "time_this_iter_s": 36.437997341156006, "time_total_s": 979.1870000362396, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70051ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d70051400>", "on_episode_end": "<function on_episode_end at 0x7f7d687f8bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687f81e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 979.1870000362396, "timesteps_since_restore": 35104, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 69.63269230769231, "ram_util_percent": 19.60192307692308}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.9446507346872846, "episode_len_mean": 434.5121951219512, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.9446507346872846}, "custom_metrics": {"num_ped_collisions_mean": 0.08536585365853659, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04878048780487805, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.934660911867084, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 447.3170731707317, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.937053379705206, "mean_processing_ms": 2.8961090189926684, "mean_inference_ms": 0.712487400761961}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 29340, "num_steps_trained": 2080800, "num_steps_sampled": 36104, "sample_time_ms": 4.412, "replay_time_ms": 18.824, "grad_time_ms": 22.184, "update_time_ms": 0.005, "opt_peak_throughput": 4507.683, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.54144287109375, "max_q": -1.0244346857070923, "min_q": -12.163564682006836}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 36104, "episodes_total": 82, "training_iteration": 36, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-42-36", "timestamp": 1585798956, "time_this_iter_s": 39.73324155807495, "time_total_s": 1018.9202415943146, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70126158>", "on_episode_step": "<function on_episode_step at 0x7f7d70126620>", "on_episode_end": "<function on_episode_end at 0x7f7d701266a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70126ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1018.9202415943146, "timesteps_since_restore": 36104, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 70.79649122807018, "ram_util_percent": 19.69122807017544}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.9295729744494191, "episode_len_mean": 436.8235294117647, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.9295729744494191}, "custom_metrics": {"num_ped_collisions_mean": 0.08235294117647059, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.047058823529411764, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.9385185275741492, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 6.3870992289974895, "avg_rl_veh_arrival_mean": 447.45882352941175, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9363814300238928, "mean_processing_ms": 2.9034184086696913, "mean_inference_ms": 0.712426222516946}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 30106, "num_steps_trained": 2157400, "num_steps_sampled": 37198, "sample_time_ms": 144.446, "replay_time_ms": 18.716, "grad_time_ms": 20.518, "update_time_ms": 0.005, "opt_peak_throughput": 4873.737, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.0598225593566895, "max_q": -0.4280310571193695, "min_q": -20.66472625732422}}}, "timesteps_this_iter": 1094, "done": false, "timesteps_total": 37198, "episodes_total": 85, "training_iteration": 37, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-43-13", "timestamp": 1585798993, "time_this_iter_s": 36.05121111869812, "time_total_s": 1054.9714527130127, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8400>", "on_episode_step": "<function on_episode_step at 0x7f7d7004f6a8>", "on_episode_end": "<function on_episode_end at 0x7f7d7004fa60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d7004fc80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1054.9714527130127, "timesteps_since_restore": 37198, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 68.84313725490198, "ram_util_percent": 19.700000000000003}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.9224506121570634, "episode_len_mean": 438.2758620689655, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.9224506121570634}, "custom_metrics": {"num_ped_collisions_mean": 0.08045977011494253, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04597701149425287, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 1.9944747138965289, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 7.064050157229744, "avg_rl_veh_arrival_mean": 444.3448275862069, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.935684704251682, "mean_processing_ms": 2.90774303531857, "mean_inference_ms": 0.7122268002232013}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 30613, "num_steps_trained": 2208100, "num_steps_sampled": 38198, "sample_time_ms": 160.256, "replay_time_ms": 18.588, "grad_time_ms": 19.262, "update_time_ms": 0.005, "opt_peak_throughput": 5191.696, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.5063157081604, "max_q": -1.131790280342102, "min_q": -13.81930923461914}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 38198, "episodes_total": 87, "training_iteration": 38, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-43-36", "timestamp": 1585799016, "time_this_iter_s": 23.7253360748291, "time_total_s": 1078.6967887878418, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71ce66a8>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce67b8>", "on_episode_end": "<function on_episode_end at 0x7f7d71ce6bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71ce6ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1078.6967887878418, "timesteps_since_restore": 38198, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 68.03529411764706, "ram_util_percent": 19.767647058823528}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8896450629879946, "episode_len_mean": 439.6629213483146, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8896450629879946}, "custom_metrics": {"num_ped_collisions_mean": 0.07865168539325842, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.0449438202247191, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.0974865604101653, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 437.7191011235955, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9345165995044062, "mean_processing_ms": 2.9115265959826737, "mean_inference_ms": 0.7117245917048985}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 30774, "num_steps_trained": 2224200, "num_steps_sampled": 39200, "sample_time_ms": 152.919, "replay_time_ms": 15.752, "grad_time_ms": 16.213, "update_time_ms": 0.005, "opt_peak_throughput": 6167.713, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.7530150413513184, "max_q": 0.0754447877407074, "min_q": -21.350231170654297}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 39200, "episodes_total": 89, "training_iteration": 39, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-43-47", "timestamp": 1585799027, "time_this_iter_s": 10.194666862487793, "time_total_s": 1088.8914556503296, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71cb21e0>", "on_episode_step": "<function on_episode_step at 0x7f7d70126620>", "on_episode_end": "<function on_episode_end at 0x7f7d70126840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701266a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1088.8914556503296, "timesteps_since_restore": 39200, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 71.00000000000001, "ram_util_percent": 19.800000000000004}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8898457969442929, "episode_len_mean": 437.2717391304348, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8898457969442929}, "custom_metrics": {"num_ped_collisions_mean": 0.08695652173913043, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.043478260869565216, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.1769573512305183, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 435.6304347826087, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9324920972396529, "mean_processing_ms": 2.9172111725104592, "mean_inference_ms": 0.7107676716078402}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 31303, "num_steps_trained": 2277100, "num_steps_sampled": 40305, "sample_time_ms": 152.294, "replay_time_ms": 19.286, "grad_time_ms": 20.587, "update_time_ms": 0.005, "opt_peak_throughput": 4857.543, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.219926357269287, "max_q": -0.3291739523410797, "min_q": -12.851224899291992}}}, "timesteps_this_iter": 1105, "done": false, "timesteps_total": 40305, "episodes_total": 92, "training_iteration": 40, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-44-13", "timestamp": 1585799053, "time_this_iter_s": 26.105668783187866, "time_total_s": 1114.9971244335175, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70126d90>", "on_episode_step": "<function on_episode_step at 0x7f7d70081400>", "on_episode_end": "<function on_episode_end at 0x7f7d70081620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1114.9971244335175, "timesteps_since_restore": 40305, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 67.18108108108105, "ram_util_percent": 19.799999999999994}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8845949382200812, "episode_len_mean": 435.69473684210527, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8845949382200812}, "custom_metrics": {"num_ped_collisions_mean": 0.09473684210526316, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.042105263157894736, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.222226828632369, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 434.0736842105263, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9303564289653354, "mean_processing_ms": 2.922770218390433, "mean_inference_ms": 0.7096890497003545}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 31914, "num_steps_trained": 2338200, "num_steps_sampled": 41458, "sample_time_ms": 148.432, "replay_time_ms": 14.615, "grad_time_ms": 17.187, "update_time_ms": 0.005, "opt_peak_throughput": 5818.343, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.268406391143799, "max_q": 3.760887384414673, "min_q": -19.879322052001953}}}, "timesteps_this_iter": 1153, "done": false, "timesteps_total": 41458, "episodes_total": 95, "training_iteration": 41, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-44-43", "timestamp": 1585799083, "time_this_iter_s": 29.95681595802307, "time_total_s": 1144.9539403915405, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d700511e0>", "on_episode_step": "<function on_episode_step at 0x7f7d70051048>", "on_episode_end": "<function on_episode_end at 0x7f7d701ccbf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701cc048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1144.9539403915405, "timesteps_since_restore": 41458, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 69.03488372093024, "ram_util_percent": 19.802325581395348}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8552527698863611, "episode_len_mean": 437.02061855670104, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8552527698863611}, "custom_metrics": {"num_ped_collisions_mean": 0.09278350515463918, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.041237113402061855, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.2997672633536945, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 428.50515463917526, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9286610737074603, "mean_processing_ms": 2.925998329615674, "mean_inference_ms": 0.7087674020868082}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 32105, "num_steps_trained": 2357300, "num_steps_sampled": 42463, "sample_time_ms": 161.579, "replay_time_ms": 20.541, "grad_time_ms": 23.88, "update_time_ms": 0.005, "opt_peak_throughput": 4187.537, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.132986545562744, "max_q": -0.41271841526031494, "min_q": -20.050317764282227}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 42463, "episodes_total": 97, "training_iteration": 42, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-44-54", "timestamp": 1585799094, "time_this_iter_s": 11.690125942230225, "time_total_s": 1156.6440663337708, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70126840>", "on_episode_step": "<function on_episode_step at 0x7f7d700810d0>", "on_episode_end": "<function on_episode_end at 0x7f7d70081d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1156.6440663337708, "timesteps_since_restore": 42463, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 70.88823529411765, "ram_util_percent": 19.88235294117647}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.833670636011946, "episode_len_mean": 438.2929292929293, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.833670636011946}, "custom_metrics": {"num_ped_collisions_mean": 0.09090909090909091, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04040404040404041, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.3216996758528152, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 426.54545454545456, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 501.0}, "sampler_perf": {"mean_env_wait_ms": 1.9268680290443072, "mean_processing_ms": 2.9288957607587625, "mean_inference_ms": 0.7078009560888863}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 32651, "num_steps_trained": 2411900, "num_steps_sampled": 43463, "sample_time_ms": 125.371, "replay_time_ms": 19.198, "grad_time_ms": 16.904, "update_time_ms": 0.005, "opt_peak_throughput": 5915.702, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.5095508098602295, "max_q": -0.6236889362335205, "min_q": -10.571168899536133}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 43463, "episodes_total": 99, "training_iteration": 43, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-45-20", "timestamp": 1585799120, "time_this_iter_s": 25.761171579360962, "time_total_s": 1182.4052379131317, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d7004fa60>", "on_episode_step": "<function on_episode_step at 0x7f7d7004fae8>", "on_episode_end": "<function on_episode_end at 0x7f7d7004f400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d7004fb70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1182.4052379131317, "timesteps_since_restore": 43463, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 67.81111111111112, "ram_util_percent": 19.89722222222222}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8231911778449884, "episode_len_mean": 438.91, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8231911778449884}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.312687560499206, "avg_speed_min": 0.46892272471087587, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 427.27, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.9136742615062665, "mean_processing_ms": 2.9330425327336953, "mean_inference_ms": 0.7039280523108209}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 33522, "num_steps_trained": 2499000, "num_steps_sampled": 44463, "sample_time_ms": 129.09, "replay_time_ms": 20.263, "grad_time_ms": 21.764, "update_time_ms": 0.006, "opt_peak_throughput": 4594.675, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.121062278747559, "max_q": 0.21242749691009521, "min_q": -12.992833137512207}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 44463, "episodes_total": 101, "training_iteration": 44, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-45-59", "timestamp": 1585799159, "time_this_iter_s": 38.667049407958984, "time_total_s": 1221.0722873210907, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71cb21e0>", "on_episode_step": "<function on_episode_step at 0x7f7d70051400>", "on_episode_end": "<function on_episode_end at 0x7f7d700511e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70051ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1221.0722873210907, "timesteps_since_restore": 44463, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 68.47818181818182, "ram_util_percent": 19.90363636363637}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.7995282784010981, "episode_len_mean": 438.91, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.7995282784010981}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.426202886477856, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 420.41, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.89468788090958, "mean_processing_ms": 2.93845541809951, "mean_inference_ms": 0.6984468160689968}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 33700, "num_steps_trained": 2516800, "num_steps_sampled": 45463, "sample_time_ms": 149.077, "replay_time_ms": 17.63, "grad_time_ms": 18.523, "update_time_ms": 0.005, "opt_peak_throughput": 5398.804, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.263429164886475, "max_q": -0.922756016254425, "min_q": -17.27346420288086}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 45463, "episodes_total": 103, "training_iteration": 45, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-46-09", "timestamp": 1585799169, "time_this_iter_s": 10.606647491455078, "time_total_s": 1231.6789348125458, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d700810d0>", "on_episode_step": "<function on_episode_step at 0x7f7d70081048>", "on_episode_end": "<function on_episode_end at 0x7f7d701ccbf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71ce6bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1231.6789348125458, "timesteps_since_restore": 45463, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 66.50666666666666, "ram_util_percent": 19.953333333333333}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8308334955628667, "episode_len_mean": 434.68, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8308334955628667}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.483017981114993, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 420.41, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8849616822393431, "mean_processing_ms": 2.943985226511306, "mean_inference_ms": 0.6954432027243044}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 34575, "num_steps_trained": 2604300, "num_steps_sampled": 46463, "sample_time_ms": 3.234, "replay_time_ms": 14.347, "grad_time_ms": 16.138, "update_time_ms": 0.004, "opt_peak_throughput": 6196.672, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.144432067871094, "max_q": 1.8873103857040405, "min_q": -13.302812576293945}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 46463, "episodes_total": 105, "training_iteration": 46, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-46-48", "timestamp": 1585799208, "time_this_iter_s": 38.65674686431885, "time_total_s": 1270.3356816768646, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70081620>", "on_episode_step": "<function on_episode_step at 0x7f7d700816a8>", "on_episode_end": "<function on_episode_end at 0x7f7d70081d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1270.3356816768646, "timesteps_since_restore": 46463, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 68.56, "ram_util_percent": 19.996363636363636}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8277721873066285, "episode_len_mean": 430.77, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8277721873066285}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.6476763375438286, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 413.48, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8753912418270757, "mean_processing_ms": 2.9564727763640053, "mean_inference_ms": 0.6915713431998921}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 34794, "num_steps_trained": 2626200, "num_steps_sampled": 47652, "sample_time_ms": 150.971, "replay_time_ms": 19.908, "grad_time_ms": 20.881, "update_time_ms": 0.005, "opt_peak_throughput": 4788.991, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3.9121315479278564, "max_q": -0.19182077050209045, "min_q": -11.9580659866333}}}, "timesteps_this_iter": 1189, "done": false, "timesteps_total": 47652, "episodes_total": 109, "training_iteration": 47, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-47-03", "timestamp": 1585799223, "time_this_iter_s": 14.701934099197388, "time_total_s": 1285.037615776062, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687782f0>", "on_episode_step": "<function on_episode_step at 0x7f7d687781e0>", "on_episode_end": "<function on_episode_end at 0x7f7d68778400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1285.037615776062, "timesteps_since_restore": 47652, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 65.63809523809523, "ram_util_percent": 20.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.8039592133899466, "episode_len_mean": 430.77, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8039592133899466}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.7731713065726207, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 406.34, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8718853383332592, "mean_processing_ms": 2.9624010094145876, "mean_inference_ms": 0.6897484346848748}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 34952, "num_steps_trained": 2642000, "num_steps_sampled": 48652, "sample_time_ms": 154.823, "replay_time_ms": 19.607, "grad_time_ms": 19.807, "update_time_ms": 0.005, "opt_peak_throughput": 5048.743, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.487997055053711, "max_q": -1.168443202972412, "min_q": -13.435344696044922}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 48652, "episodes_total": 111, "training_iteration": 48, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-47-13", "timestamp": 1585799233, "time_this_iter_s": 9.676023721694946, "time_total_s": 1294.713639497757, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f2ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d687f20d0>", "on_episode_end": "<function on_episode_end at 0x7f7d687f2158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1294.713639497757, "timesteps_since_restore": 48652, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 63.707142857142856, "ram_util_percent": 20.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.2816507087765774, "episode_reward_mean": -0.793271771652667, "episode_len_mean": 430.77, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.2816507087765774}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.793271771652667}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.8455068739460487, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 402.76, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8690782364896785, "mean_processing_ms": 2.968204136061288, "mean_inference_ms": 0.6880516769695391}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 35452, "num_steps_trained": 2692000, "num_steps_sampled": 49652, "sample_time_ms": 157.384, "replay_time_ms": 16.462, "grad_time_ms": 18.832, "update_time_ms": 0.004, "opt_peak_throughput": 5310.146, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.112806797027588, "max_q": -0.4614889919757843, "min_q": -15.123467445373535}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 49652, "episodes_total": 113, "training_iteration": 49, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-47-36", "timestamp": 1585799256, "time_this_iter_s": 23.11109757423401, "time_total_s": 1317.824737071991, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f29d8>", "on_episode_step": "<function on_episode_step at 0x7f7d687f2730>", "on_episode_end": "<function on_episode_end at 0x7f7d68727048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687270d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1317.824737071991, "timesteps_since_restore": 49652, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 67.13636363636364, "ram_util_percent": 20.027272727272727}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.7550063563415007, "episode_len_mean": 432.98, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.7550063563415007}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9179142306625057, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 399.34, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.867043487660257, "mean_processing_ms": 2.9739508923509477, "mean_inference_ms": 0.6865679993391768}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 35961, "num_steps_trained": 2742900, "num_steps_sampled": 50652, "sample_time_ms": 155.241, "replay_time_ms": 18.39, "grad_time_ms": 19.409, "update_time_ms": 0.005, "opt_peak_throughput": 5152.359, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.562446594238281, "max_q": -1.1429716348648071, "min_q": -13.449010848999023}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 50652, "episodes_total": 115, "training_iteration": 50, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-48-01", "timestamp": 1585799281, "time_this_iter_s": 24.981053829193115, "time_total_s": 1342.805790901184, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f2158>", "on_episode_step": "<function on_episode_step at 0x7f7d687f2598>", "on_episode_end": "<function on_episode_end at 0x7f7d687f2950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687f2ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1342.805790901184, "timesteps_since_restore": 50652, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 70.33714285714288, "ram_util_percent": 20.09714285714286}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.7685722823120691, "episode_len_mean": 432.98, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.7685722823120691}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9421031757457246, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 399.34, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8657941481847486, "mean_processing_ms": 2.979678258786834, "mean_inference_ms": 0.6852734653596176}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 36831, "num_steps_trained": 2829900, "num_steps_sampled": 51654, "sample_time_ms": 130.814, "replay_time_ms": 20.178, "grad_time_ms": 21.349, "update_time_ms": 0.005, "opt_peak_throughput": 4684.165, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.159551620483398, "max_q": -1.1694848537445068, "min_q": -14.907240867614746}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 51654, "episodes_total": 117, "training_iteration": 51, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-48-40", "timestamp": 1585799320, "time_this_iter_s": 39.25333642959595, "time_total_s": 1382.05912733078, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778b70>", "on_episode_step": "<function on_episode_step at 0x7f7d687787b8>", "on_episode_end": "<function on_episode_end at 0x7f7d68778730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1382.05912733078, "timesteps_since_restore": 51654, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 68.425, "ram_util_percent": 20.099999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.792128219448182, "episode_len_mean": 432.98, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.792128219448182}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9645217098062506, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 399.34, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8649083516962321, "mean_processing_ms": 2.9842751071594784, "mean_inference_ms": 0.6841443814069299}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 37713, "num_steps_trained": 2918100, "num_steps_sampled": 52654, "sample_time_ms": 4.448, "replay_time_ms": 18.446, "grad_time_ms": 20.784, "update_time_ms": 0.005, "opt_peak_throughput": 4811.477, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.813091278076172, "max_q": -0.7879193425178528, "min_q": -15.896478652954102}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 52654, "episodes_total": 119, "training_iteration": 52, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-49-19", "timestamp": 1585799359, "time_this_iter_s": 39.107856035232544, "time_total_s": 1421.1669833660126, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727268>", "on_episode_step": "<function on_episode_step at 0x7f7d68727488>", "on_episode_end": "<function on_episode_end at 0x7f7d68727bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1421.1669833660126, "timesteps_since_restore": 52654, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 67.37678571428572, "ram_util_percent": 20.164285714285715}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.8131515689810236, "episode_len_mean": 436.77, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.8131515689810236}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.966570258739333, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 403.13, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8642258667617475, "mean_processing_ms": 2.9877296924222865, "mean_inference_ms": 0.6831518674484909}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 38592, "num_steps_trained": 3006000, "num_steps_sampled": 53654, "sample_time_ms": 4.228, "replay_time_ms": 16.557, "grad_time_ms": 16.519, "update_time_ms": 0.005, "opt_peak_throughput": 6053.61, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5.0420451164245605, "max_q": -1.2460176944732666, "min_q": -15.969587326049805}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 53654, "episodes_total": 121, "training_iteration": 53, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-49-59", "timestamp": 1585799399, "time_this_iter_s": 39.687604904174805, "time_total_s": 1460.8545882701874, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727510>", "on_episode_step": "<function on_episode_step at 0x7f7d687276a8>", "on_episode_end": "<function on_episode_end at 0x7f7d687277b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687278c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1460.8545882701874, "timesteps_since_restore": 53654, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 69.39285714285714, "ram_util_percent": 20.2}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5721750652921453, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.810785064231534, "episode_len_mean": 436.77, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5721750652921453}, "policy_reward_mean": {"av": -0.810785064231534}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.955114991243775, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 403.13, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.863265833267188, "mean_processing_ms": 2.991135660350655, "mean_inference_ms": 0.6820432156917501}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 39447, "num_steps_trained": 3091500, "num_steps_sampled": 54659, "sample_time_ms": 130.066, "replay_time_ms": 17.068, "grad_time_ms": 21.09, "update_time_ms": 0.006, "opt_peak_throughput": 4741.588, "opt_samples": 100.0, "learner": {"av": {"mean_q": -4.927218437194824, "max_q": 1.514868140220642, "min_q": -17.60963249206543}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 54659, "episodes_total": 123, "training_iteration": 54, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-50-38", "timestamp": 1585799438, "time_this_iter_s": 39.507691860198975, "time_total_s": 1500.3622801303864, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d7004f158>", "on_episode_step": "<function on_episode_step at 0x7f7d7004f620>", "on_episode_end": "<function on_episode_end at 0x7f7d7004fae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d7004fb70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1500.3622801303864, "timesteps_since_restore": 54659, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 70.32678571428572, "ram_util_percent": 20.271428571428572}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.8648122651546127, "episode_len_mean": 432.67, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.8648122651546127}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9389443604416634, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 408.05, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8632938808897739, "mean_processing_ms": 2.994916378622418, "mean_inference_ms": 0.681609907092356}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 40322, "num_steps_trained": 3179000, "num_steps_sampled": 55659, "sample_time_ms": 4.055, "replay_time_ms": 15.588, "grad_time_ms": 17.472, "update_time_ms": 0.005, "opt_peak_throughput": 5723.395, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5.432693004608154, "max_q": -1.6268476247787476, "min_q": -16.863000869750977}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 55659, "episodes_total": 125, "training_iteration": 55, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-51-18", "timestamp": 1585799478, "time_this_iter_s": 39.60125422477722, "time_total_s": 1539.9635343551636, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc7b8>", "on_episode_step": "<function on_episode_step at 0x7f7d686cc6a8>", "on_episode_end": "<function on_episode_end at 0x7f7d686cc378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686cc510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1539.9635343551636, "timesteps_since_restore": 55659, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 70.3561403508772, "ram_util_percent": 20.299999999999997}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.8816780875461215, "episode_len_mean": 432.67, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.8816780875461215}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9474585227333483, "avg_speed_min": 0.5574928027670256, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 408.05, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.863155191622409, "mean_processing_ms": 2.9986912591950103, "mean_inference_ms": 0.6810086173101608}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 41208, "num_steps_trained": 3267600, "num_steps_sampled": 56659, "sample_time_ms": 5.277, "replay_time_ms": 18.147, "grad_time_ms": 20.41, "update_time_ms": 0.005, "opt_peak_throughput": 4899.55, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5.341002941131592, "max_q": -1.264076590538025, "min_q": -11.75826358795166}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 56659, "episodes_total": 127, "training_iteration": 56, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-51-58", "timestamp": 1585799518, "time_this_iter_s": 40.46441698074341, "time_total_s": 1580.427951335907, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f20d0>", "on_episode_step": "<function on_episode_step at 0x7f7d68778378>", "on_episode_end": "<function on_episode_end at 0x7f7d68778c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687789d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1580.427951335907, "timesteps_since_restore": 56659, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 69.73333333333333, "ram_util_percent": 20.370175438596494}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.8980513573010963, "episode_len_mean": 432.67, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.8980513573010963}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.964058602831591, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 408.05, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.862776112184763, "mean_processing_ms": 3.0023912565000512, "mean_inference_ms": 0.6802974519963287}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 42083, "num_steps_trained": 3355100, "num_steps_sampled": 57659, "sample_time_ms": 3.694, "replay_time_ms": 18.289, "grad_time_ms": 20.525, "update_time_ms": 0.005, "opt_peak_throughput": 4872.061, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5.172518253326416, "max_q": -1.3167654275894165, "min_q": -16.851661682128906}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 57659, "episodes_total": 129, "training_iteration": 57, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-52-39", "timestamp": 1585799559, "time_this_iter_s": 40.25446343421936, "time_total_s": 1620.6824147701263, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc510>", "on_episode_step": "<function on_episode_step at 0x7f7d686cc1e0>", "on_episode_end": "<function on_episode_end at 0x7f7d68778950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1620.6824147701263, "timesteps_since_restore": 57659, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 70.2719298245614, "ram_util_percent": 20.400000000000002}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.8918037616507227, "episode_len_mean": 432.67, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.8918037616507227}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9633815143548308, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 408.05, "avg_rl_veh_arrival_min": 102.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8619458556288149, "mean_processing_ms": 3.0060530013890934, "mean_inference_ms": 0.6794525243883227}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 42948, "num_steps_trained": 3441600, "num_steps_sampled": 58659, "sample_time_ms": 3.32, "replay_time_ms": 16.005, "grad_time_ms": 15.829, "update_time_ms": 0.005, "opt_peak_throughput": 6317.417, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5.414351940155029, "max_q": -2.4457621574401855, "min_q": -18.4731502532959}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 58659, "episodes_total": 131, "training_iteration": 58, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-53-17", "timestamp": 1585799597, "time_this_iter_s": 38.20649003982544, "time_total_s": 1658.8889048099518, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686f5d90>", "on_episode_step": "<function on_episode_step at 0x7f7d686f5400>", "on_episode_end": "<function on_episode_end at 0x7f7d686f5048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686f5b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1658.8889048099518, "timesteps_since_restore": 58659, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 67.11636363636364, "ram_util_percent": 20.474545454545453}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9634002197607026, "episode_len_mean": 424.34, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9634002197607026}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0159410712422936, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 406.1, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.860789838384462, "mean_processing_ms": 3.0150185545693513, "mean_inference_ms": 0.677890686366012}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 43694, "num_steps_trained": 3516200, "num_steps_sampled": 59659, "sample_time_ms": 4.407, "replay_time_ms": 18.272, "grad_time_ms": 23.189, "update_time_ms": 0.005, "opt_peak_throughput": 4312.359, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5.77740478515625, "max_q": -1.4249904155731201, "min_q": -15.359125137329102}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 59659, "episodes_total": 135, "training_iteration": 59, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-53-54", "timestamp": 1585799634, "time_this_iter_s": 36.62541317939758, "time_total_s": 1695.5143179893494, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71ce67b8>", "on_episode_step": "<function on_episode_step at 0x7f7d71ce66a8>", "on_episode_end": "<function on_episode_end at 0x7f7d71ce68c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71ce6488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1695.5143179893494, "timesteps_since_restore": 59659, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 67.41730769230767, "ram_util_percent": 20.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9809947669266981, "episode_len_mean": 421.79, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9809947669266981}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9790304465608908, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 407.06, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8601759582802517, "mean_processing_ms": 3.0224553532337723, "mean_inference_ms": 0.6768674806558167}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 44504, "num_steps_trained": 3597200, "num_steps_sampled": 60659, "sample_time_ms": 4.174, "replay_time_ms": 18.032, "grad_time_ms": 17.975, "update_time_ms": 0.005, "opt_peak_throughput": 5563.365, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.098381519317627, "max_q": -1.7380741834640503, "min_q": -15.580680847167969}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 60659, "episodes_total": 138, "training_iteration": 60, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-54-31", "timestamp": 1585799671, "time_this_iter_s": 37.38973331451416, "time_total_s": 1732.9040513038635, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8598>", "on_episode_step": "<function on_episode_step at 0x7f7d687f8730>", "on_episode_end": "<function on_episode_end at 0x7f7d687f8ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1732.9040513038635, "timesteps_since_restore": 60659, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 68.09622641509434, "ram_util_percent": 20.54905660377358}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9795071461207021, "episode_len_mean": 421.79, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9795071461207021}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9873067187420577, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 407.06, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.859586123316093, "mean_processing_ms": 3.0273153487800495, "mean_inference_ms": 0.6760627425476283}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 45376, "num_steps_trained": 3684400, "num_steps_sampled": 61659, "sample_time_ms": 126.819, "replay_time_ms": 17.173, "grad_time_ms": 17.647, "update_time_ms": 0.005, "opt_peak_throughput": 5666.608, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.195554733276367, "max_q": -2.82814884185791, "min_q": -17.27344512939453}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 61659, "episodes_total": 140, "training_iteration": 61, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-55-10", "timestamp": 1585799710, "time_this_iter_s": 38.88298797607422, "time_total_s": 1771.7870392799377, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70051048>", "on_episode_step": "<function on_episode_step at 0x7f7d70051598>", "on_episode_end": "<function on_episode_end at 0x7f7d687270d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1771.7870392799377, "timesteps_since_restore": 61659, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 68.73272727272727, "ram_util_percent": 20.59999999999999}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9617292805821914, "episode_len_mean": 421.79, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9617292805821914}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9809003910186287, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 407.06, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.858875003751516, "mean_processing_ms": 3.032098591921352, "mean_inference_ms": 0.6751806897114357}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 46250, "num_steps_trained": 3771800, "num_steps_sampled": 62659, "sample_time_ms": 4.75, "replay_time_ms": 17.605, "grad_time_ms": 21.546, "update_time_ms": 0.005, "opt_peak_throughput": 4641.211, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.2179274559021, "max_q": -1.7279106378555298, "min_q": -14.708102226257324}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 62659, "episodes_total": 142, "training_iteration": 62, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-55-49", "timestamp": 1585799749, "time_this_iter_s": 39.4039580821991, "time_total_s": 1811.1909973621368, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701a2840>", "on_episode_step": "<function on_episode_step at 0x7f7d701a22f0>", "on_episode_end": "<function on_episode_end at 0x7f7d701a20d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701a2400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1811.1909973621368, "timesteps_since_restore": 62659, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 69.30357142857143, "ram_util_percent": 20.633928571428573}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9711962691762521, "episode_len_mean": 425.54, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9711962691762521}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9524138526919774, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 410.81, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8580441977981637, "mean_processing_ms": 3.0358251248256507, "mean_inference_ms": 0.6742943627553316}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 47136, "num_steps_trained": 3860400, "num_steps_sampled": 63659, "sample_time_ms": 4.377, "replay_time_ms": 17.961, "grad_time_ms": 22.794, "update_time_ms": 0.005, "opt_peak_throughput": 4387.077, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.975245475769043, "max_q": -2.905075788497925, "min_q": -21.66715431213379}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 63659, "episodes_total": 144, "training_iteration": 63, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-56-29", "timestamp": 1585799789, "time_this_iter_s": 39.7923424243927, "time_total_s": 1850.9833397865295, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727510>", "on_episode_step": "<function on_episode_step at 0x7f7d68727158>", "on_episode_end": "<function on_episode_end at 0x7f7d68727bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1850.9833397865295, "timesteps_since_restore": 63659, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 67.97368421052632, "ram_util_percent": 20.708771929824557}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9861285581659216, "episode_len_mean": 429.4, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9861285581659216}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9362934805664587, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 414.67, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8571826680581445, "mean_processing_ms": 3.0384839019487617, "mean_inference_ms": 0.6734580314388748}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 47994, "num_steps_trained": 3946200, "num_steps_sampled": 64660, "sample_time_ms": 133.936, "replay_time_ms": 21.302, "grad_time_ms": 20.586, "update_time_ms": 0.005, "opt_peak_throughput": 4857.723, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.39175271987915, "max_q": -2.5966506004333496, "min_q": -17.423044204711914}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 64660, "episodes_total": 146, "training_iteration": 64, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-57-08", "timestamp": 1585799828, "time_this_iter_s": 38.332252502441406, "time_total_s": 1889.315592288971, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8400>", "on_episode_step": "<function on_episode_step at 0x7f7d70081488>", "on_episode_end": "<function on_episode_end at 0x7f7d700818c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701ccc80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1889.315592288971, "timesteps_since_restore": 64660, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 67.81481481481481, "ram_util_percent": 20.72592592592592}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9893284563860567, "episode_len_mean": 433.17, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9893284563860567}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.905836160302119, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 418.44, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.856281247587479, "mean_processing_ms": 3.041107038133585, "mean_inference_ms": 0.6726214507480289}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 48866, "num_steps_trained": 4033400, "num_steps_sampled": 65660, "sample_time_ms": 4.593, "replay_time_ms": 20.317, "grad_time_ms": 23.235, "update_time_ms": 0.005, "opt_peak_throughput": 4303.797, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.66745662689209, "max_q": -1.4095873832702637, "min_q": -18.575462341308594}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 65660, "episodes_total": 148, "training_iteration": 65, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-57-48", "timestamp": 1585799868, "time_this_iter_s": 40.19026279449463, "time_total_s": 1929.5058550834656, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778378>", "on_episode_step": "<function on_episode_step at 0x7f7d68778d08>", "on_episode_end": "<function on_episode_end at 0x7f7d687782f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1929.5058550834656, "timesteps_since_restore": 65660, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 70.29122807017545, "ram_util_percent": 20.799999999999997}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9787422565904801, "episode_len_mean": 433.17, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9787422565904801}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9613123951977407, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 414.95, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.855155244688977, "mean_processing_ms": 3.043230446883092, "mean_inference_ms": 0.6716996454765216}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 49392, "num_steps_trained": 4086000, "num_steps_sampled": 66660, "sample_time_ms": 4.819, "replay_time_ms": 16.377, "grad_time_ms": 19.196, "update_time_ms": 0.005, "opt_peak_throughput": 5209.41, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.409780979156494, "max_q": -2.678208112716675, "min_q": -17.847253799438477}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 66660, "episodes_total": 150, "training_iteration": 66, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-58-13", "timestamp": 1585799893, "time_this_iter_s": 25.55505394935608, "time_total_s": 1955.0609090328217, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f28c8>", "on_episode_step": "<function on_episode_step at 0x7f7d72072ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d701261e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70126620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1955.0609090328217, "timesteps_since_restore": 66660, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 69.41351351351354, "ram_util_percent": 20.802702702702696}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9766192861196373, "episode_len_mean": 432.76, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9766192861196373}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9760880750356016, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 414.54, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8540707792263496, "mean_processing_ms": 3.0448885163357438, "mean_inference_ms": 0.6708209412638848}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 50254, "num_steps_trained": 4172200, "num_steps_sampled": 67660, "sample_time_ms": 3.948, "replay_time_ms": 16.847, "grad_time_ms": 20.484, "update_time_ms": 0.005, "opt_peak_throughput": 4881.741, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.766294956207275, "max_q": -2.2080495357513428, "min_q": -17.986209869384766}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 67660, "episodes_total": 152, "training_iteration": 67, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-58-54", "timestamp": 1585799934, "time_this_iter_s": 40.21339774131775, "time_total_s": 1995.2743067741394, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d700816a8>", "on_episode_step": "<function on_episode_step at 0x7f7d700818c8>", "on_episode_end": "<function on_episode_end at 0x7f7d70081b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1995.2743067741394, "timesteps_since_restore": 67660, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 71.09473684210526, "ram_util_percent": 20.88771929824562}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9861853071990498, "episode_len_mean": 432.76, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9861853071990498}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.9911092530495518, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 414.54, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8528898773422975, "mean_processing_ms": 3.046615915619101, "mean_inference_ms": 0.6699421002278392}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 51120, "num_steps_trained": 4258800, "num_steps_sampled": 68660, "sample_time_ms": 3.764, "replay_time_ms": 17.407, "grad_time_ms": 20.342, "update_time_ms": 0.005, "opt_peak_throughput": 4915.847, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.853696823120117, "max_q": -2.079453468322754, "min_q": -22.6731014251709}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 68660, "episodes_total": 154, "training_iteration": 68, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_03-59-33", "timestamp": 1585799973, "time_this_iter_s": 39.04517340660095, "time_total_s": 2034.3194801807404, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc6a8>", "on_episode_step": "<function on_episode_step at 0x7f7d686cc950>", "on_episode_end": "<function on_episode_end at 0x7f7d71cb2d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71cb2e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2034.3194801807404, "timesteps_since_restore": 68660, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 68.61818181818182, "ram_util_percent": 20.907272727272733}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.987124737494834, "episode_len_mean": 432.76, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.987124737494834}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 2.988874272831826, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 414.54, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8516740347505323, "mean_processing_ms": 3.0483802692139443, "mean_inference_ms": 0.669031948291465}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 51991, "num_steps_trained": 4345900, "num_steps_sampled": 69660, "sample_time_ms": 4.235, "replay_time_ms": 17.273, "grad_time_ms": 24.297, "update_time_ms": 0.006, "opt_peak_throughput": 4115.706, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.688474178314209, "max_q": -1.2241157293319702, "min_q": -20.067556381225586}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 69660, "episodes_total": 156, "training_iteration": 69, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-00-12", "timestamp": 1585800012, "time_this_iter_s": 39.073734998703, "time_total_s": 2073.3932151794434, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778d08>", "on_episode_step": "<function on_episode_step at 0x7f7d68778620>", "on_episode_end": "<function on_episode_end at 0x7f7d68778510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687781e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2073.3932151794434, "timesteps_since_restore": 69660, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 68.87857142857142, "ram_util_percent": 20.98392857142857}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9635529093065475, "episode_len_mean": 435.81, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9635529093065475}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0302445149830457, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 410.96, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8502827064748368, "mean_processing_ms": 3.050119929712732, "mean_inference_ms": 0.6680191077596385}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 52515, "num_steps_trained": 4398300, "num_steps_sampled": 70660, "sample_time_ms": 3.884, "replay_time_ms": 18.068, "grad_time_ms": 18.815, "update_time_ms": 0.005, "opt_peak_throughput": 5314.937, "opt_samples": 100.0, "learner": {"av": {"mean_q": -7.2172746658325195, "max_q": -2.3184690475463867, "min_q": -22.22739028930664}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 70660, "episodes_total": 158, "training_iteration": 70, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-00-37", "timestamp": 1585800037, "time_this_iter_s": 25.16757035255432, "time_total_s": 2098.5607855319977, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868ab70>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a400>", "on_episode_end": "<function on_episode_end at 0x7f7d6868ac80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868abf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2098.5607855319977, "timesteps_since_restore": 70660, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 69.67500000000001, "ram_util_percent": 21.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9778006305313457, "episode_len_mean": 435.81, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9778006305313457}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0233746686598044, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 410.96, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8488286110172043, "mean_processing_ms": 3.0511361662557603, "mean_inference_ms": 0.6670483920274797}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 53400, "num_steps_trained": 4486800, "num_steps_sampled": 71660, "sample_time_ms": 4.359, "replay_time_ms": 19.398, "grad_time_ms": 20.709, "update_time_ms": 0.005, "opt_peak_throughput": 4828.798, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.901850700378418, "max_q": -2.1285691261291504, "min_q": -18.240835189819336}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 71660, "episodes_total": 160, "training_iteration": 71, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-01-17", "timestamp": 1585800077, "time_this_iter_s": 40.30818557739258, "time_total_s": 2138.8689711093903, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a2f0>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a268>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2138.8689711093903, "timesteps_since_restore": 71660, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 68.89999999999999, "ram_util_percent": 21.047368421052628}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9577215419589287, "episode_len_mean": 438.76, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9577215419589287}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.0156545339412775, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.189250246905629, "avg_rl_veh_arrival_mean": 410.96, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8466665170590317, "mean_processing_ms": 3.0523711538133584, "mean_inference_ms": 0.6656175932027104}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 54192, "num_steps_trained": 4566000, "num_steps_sampled": 72660, "sample_time_ms": 5.002, "replay_time_ms": 18.486, "grad_time_ms": 22.296, "update_time_ms": 0.005, "opt_peak_throughput": 4485.042, "opt_samples": 100.0, "learner": {"av": {"mean_q": -7.431093215942383, "max_q": -1.183969259262085, "min_q": -15.63569164276123}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 72660, "episodes_total": 163, "training_iteration": 72, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-01-55", "timestamp": 1585800115, "time_this_iter_s": 37.56040549278259, "time_total_s": 2176.429376602173, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687782f0>", "on_episode_step": "<function on_episode_step at 0x7f7d687789d8>", "on_episode_end": "<function on_episode_end at 0x7f7d68778950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2176.429376602173, "timesteps_since_restore": 72660, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 68.39245283018867, "ram_util_percent": 21.103773584905653}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9840371704061519, "episode_len_mean": 434.63, "episodes_this_iter": 5, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9840371704061519}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1579835839551254, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.230661198340846, "avg_rl_veh_arrival_mean": 410.0, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8428031176468616, "mean_processing_ms": 3.0542835680979947, "mean_inference_ms": 0.6630308540168218}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 54530, "num_steps_trained": 4599800, "num_steps_sampled": 74060, "sample_time_ms": 156.372, "replay_time_ms": 17.653, "grad_time_ms": 18.992, "update_time_ms": 0.005, "opt_peak_throughput": 5265.39, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6.809244155883789, "max_q": -1.87643563747406, "min_q": -17.879655838012695}}}, "timesteps_this_iter": 1400, "done": false, "timesteps_total": 74060, "episodes_total": 168, "training_iteration": 73, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-02-16", "timestamp": 1585800136, "time_this_iter_s": 20.99189829826355, "time_total_s": 2197.4212749004364, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868aae8>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a1e0>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2197.4212749004364, "timesteps_since_restore": 74060, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 65.34666666666668, "ram_util_percent": 21.100000000000005}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9574420017355734, "episode_len_mean": 438.45, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9574420017355734}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1659025763029693, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.230661198340846, "avg_rl_veh_arrival_mean": 410.43, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8411788962466147, "mean_processing_ms": 3.055025362304402, "mean_inference_ms": 0.6619131632071031}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 55051, "num_steps_trained": 4651900, "num_steps_sampled": 75060, "sample_time_ms": 151.732, "replay_time_ms": 19.042, "grad_time_ms": 20.19, "update_time_ms": 0.005, "opt_peak_throughput": 4952.842, "opt_samples": 100.0, "learner": {"av": {"mean_q": -7.633432388305664, "max_q": -2.1410560607910156, "min_q": -25.345714569091797}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 75060, "episodes_total": 170, "training_iteration": 74, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-02-41", "timestamp": 1585800161, "time_this_iter_s": 25.266045331954956, "time_total_s": 2222.6873202323914, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68644598>", "on_episode_step": "<function on_episode_step at 0x7f7d72072d08>", "on_episode_end": "<function on_episode_end at 0x7f7d72072d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d72072ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2222.6873202323914, "timesteps_since_restore": 75060, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 68.65555555555555, "ram_util_percent": 21.15833333333334}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.1127558650612857, "episode_reward_mean": -0.9396559879922467, "episode_len_mean": 438.45, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.1127558650612857}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.9396559879922467}, "custom_metrics": {"num_ped_collisions_mean": 0.12, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.169648995641014, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.230661198340846, "avg_rl_veh_arrival_mean": 410.43, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8395192133064868, "mean_processing_ms": 3.0554819720251887, "mean_inference_ms": 0.6607805214946737}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 55922, "num_steps_trained": 4739000, "num_steps_sampled": 76060, "sample_time_ms": 3.795, "replay_time_ms": 15.478, "grad_time_ms": 17.113, "update_time_ms": 0.005, "opt_peak_throughput": 5843.594, "opt_samples": 100.0, "learner": {"av": {"mean_q": -7.989442348480225, "max_q": -0.8036251068115234, "min_q": -18.875244140625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 76060, "episodes_total": 172, "training_iteration": 75, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-03-20", "timestamp": 1585800200, "time_this_iter_s": 38.96793556213379, "time_total_s": 2261.655255794525, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a9d8>", "on_episode_step": "<function on_episode_step at 0x7f7d6868aa60>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2261.655255794525, "timesteps_since_restore": 76060, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 67.325, "ram_util_percent": 21.2}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0922680453452775, "episode_reward_mean": -0.894330214685195, "episode_len_mean": 442.1, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0922680453452775}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.894330214685195}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1838717486405455, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.230661198340846, "avg_rl_veh_arrival_mean": 407.78, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8377722403615637, "mean_processing_ms": 3.055568437451443, "mean_inference_ms": 0.6595968135568657}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 56514, "num_steps_trained": 4798200, "num_steps_sampled": 77060, "sample_time_ms": 127.9, "replay_time_ms": 14.568, "grad_time_ms": 15.544, "update_time_ms": 0.005, "opt_peak_throughput": 6433.435, "opt_samples": 100.0, "learner": {"av": {"mean_q": -7.698362827301025, "max_q": -2.915048122406006, "min_q": -26.273151397705078}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 77060, "episodes_total": 174, "training_iteration": 76, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-03-47", "timestamp": 1585800227, "time_this_iter_s": 26.357581853866577, "time_total_s": 2288.0128376483917, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868ae18>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a840>", "on_episode_end": "<function on_episode_end at 0x7f7d6868ac80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a7b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2288.0128376483917, "timesteps_since_restore": 77060, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 61.418918918918905, "ram_util_percent": 20.35405405405405}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0922680453452775, "episode_reward_mean": -0.8951445579245056, "episode_len_mean": 442.1, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0922680453452775}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.8951445579245056}, "custom_metrics": {"num_ped_collisions_mean": 0.11, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.1854643171689903, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.230661198340846, "avg_rl_veh_arrival_mean": 407.78, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8359752072548974, "mean_processing_ms": 3.0557115907731713, "mean_inference_ms": 0.6583723091783068}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57390, "num_steps_trained": 4885800, "num_steps_sampled": 78060, "sample_time_ms": 3.606, "replay_time_ms": 15.06, "grad_time_ms": 17.223, "update_time_ms": 0.004, "opt_peak_throughput": 5806.181, "opt_samples": 100.0, "learner": {"av": {"mean_q": -9.009943008422852, "max_q": -2.4113988876342773, "min_q": -22.045095443725586}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 78060, "episodes_total": 176, "training_iteration": 77, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-04-23", "timestamp": 1585800263, "time_this_iter_s": 36.53527212142944, "time_total_s": 2324.548109769821, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8e18>", "on_episode_step": "<function on_episode_step at 0x7f7d687279d8>", "on_episode_end": "<function on_episode_end at 0x7f7d687277b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2324.548109769821, "timesteps_since_restore": 78060, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 61.16538461538461, "ram_util_percent": 19.907692307692308}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.8356582652365977, "episode_len_mean": 445.55, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.8356582652365977}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.2744519278780673, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 400.73, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8340175236655865, "mean_processing_ms": 3.0545665785254243, "mean_inference_ms": 0.6570297774509111}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57535, "num_steps_trained": 4900300, "num_steps_sampled": 79061, "sample_time_ms": 150.739, "replay_time_ms": 15.581, "grad_time_ms": 17.247, "update_time_ms": 0.004, "opt_peak_throughput": 5798.171, "opt_samples": 100.0, "learner": {"av": {"mean_q": -7.719044208526611, "max_q": -3.0721733570098877, "min_q": -17.204683303833008}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 79061, "episodes_total": 178, "training_iteration": 78, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-04-32", "timestamp": 1585800272, "time_this_iter_s": 8.481980323791504, "time_total_s": 2333.0300900936127, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc8c8>", "on_episode_step": "<function on_episode_step at 0x7f7d686cc048>", "on_episode_end": "<function on_episode_end at 0x7f7d686cc268>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686ccb70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2333.0300900936127, "timesteps_since_restore": 79061, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 56.82500000000001, "ram_util_percent": 19.95}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.807829030107927, "episode_len_mean": 449.45, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.807829030107927}, "custom_metrics": {"num_ped_collisions_mean": 0.1, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.337966340554599, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 397.75, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8318336455526947, "mean_processing_ms": 3.0532749603628093, "mean_inference_ms": 0.6555634867321399}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57712, "num_steps_trained": 4918000, "num_steps_sampled": 80061, "sample_time_ms": 151.47, "replay_time_ms": 15.912, "grad_time_ms": 17.177, "update_time_ms": 0.005, "opt_peak_throughput": 5821.574, "opt_samples": 100.0, "learner": {"av": {"mean_q": -8.748309135437012, "max_q": -2.7139365673065186, "min_q": -26.63011360168457}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 80061, "episodes_total": 180, "training_iteration": 79, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-04-41", "timestamp": 1585800281, "time_this_iter_s": 9.855173110961914, "time_total_s": 2342.8852632045746, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661c80>", "on_episode_step": "<function on_episode_step at 0x7f7d68661d08>", "on_episode_end": "<function on_episode_end at 0x7f7d68661d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68661e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2342.8852632045746, "timesteps_since_restore": 80061, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 56.664285714285725, "ram_util_percent": 19.964285714285715}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.7615025794421996, "episode_len_mean": 453.55, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7615025794421996}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.409453591579723, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 390.85, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8293493829128757, "mean_processing_ms": 3.051973841946128, "mean_inference_ms": 0.6539326958175019}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57899, "num_steps_trained": 4936700, "num_steps_sampled": 81061, "sample_time_ms": 153.459, "replay_time_ms": 20.662, "grad_time_ms": 21.994, "update_time_ms": 0.005, "opt_peak_throughput": 4546.701, "opt_samples": 100.0, "learner": {"av": {"mean_q": -8.728845596313477, "max_q": -2.6054718494415283, "min_q": -22.209068298339844}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 81061, "episodes_total": 182, "training_iteration": 80, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-04-52", "timestamp": 1585800292, "time_this_iter_s": 10.327545404434204, "time_total_s": 2353.212808609009, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661950>", "on_episode_step": "<function on_episode_step at 0x7f7d68661a60>", "on_episode_end": "<function on_episode_end at 0x7f7d68661ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686619d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2353.212808609009, "timesteps_since_restore": 81061, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 57.166666666666664, "ram_util_percent": 20.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.7419590723532201, "episode_len_mean": 453.55, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7419590723532201}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4626706336647946, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 387.3, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8267361669578752, "mean_processing_ms": 3.050274440182737, "mean_inference_ms": 0.6523052944702492}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 58401, "num_steps_trained": 4986900, "num_steps_sampled": 82061, "sample_time_ms": 128.725, "replay_time_ms": 16.714, "grad_time_ms": 17.251, "update_time_ms": 0.005, "opt_peak_throughput": 5796.64, "opt_samples": 100.0, "learner": {"av": {"mean_q": -8.540687561035156, "max_q": -3.200209856033325, "min_q": -24.31171989440918}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 82061, "episodes_total": 184, "training_iteration": 81, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-05-15", "timestamp": 1585800315, "time_this_iter_s": 22.860517501831055, "time_total_s": 2376.07332611084, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661730>", "on_episode_step": "<function on_episode_step at 0x7f7d68661488>", "on_episode_end": "<function on_episode_end at 0x7f7d68661048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686610d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2376.07332611084, "timesteps_since_restore": 82061, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 64.12727272727274, "ram_util_percent": 20.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.717954309453234, "episode_len_mean": 453.55, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.717954309453234}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.547754467482294, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 381.93, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8240444499080757, "mean_processing_ms": 3.0485595803192265, "mean_inference_ms": 0.6506341530059236}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 58580, "num_steps_trained": 5004800, "num_steps_sampled": 83061, "sample_time_ms": 154.627, "replay_time_ms": 17.63, "grad_time_ms": 18.626, "update_time_ms": 0.005, "opt_peak_throughput": 5368.847, "opt_samples": 100.0, "learner": {"av": {"mean_q": -8.541838645935059, "max_q": -3.2875635623931885, "min_q": -25.008846282958984}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 83061, "episodes_total": 186, "training_iteration": 82, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-05-25", "timestamp": 1585800325, "time_this_iter_s": 10.208711624145508, "time_total_s": 2386.2820377349854, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661d08>", "on_episode_step": "<function on_episode_step at 0x7f7d68661d90>", "on_episode_end": "<function on_episode_end at 0x7f7d68661f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686617b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2386.2820377349854, "timesteps_since_restore": 83061, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 61.52857142857142, "ram_util_percent": 20.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.7304563529167, "episode_len_mean": 453.55, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7304563529167}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5050997395386245, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 385.58, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8216230592439506, "mean_processing_ms": 3.0470246038335067, "mean_inference_ms": 0.6491264421829774}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 59099, "num_steps_trained": 5056700, "num_steps_sampled": 84061, "sample_time_ms": 151.067, "replay_time_ms": 19.957, "grad_time_ms": 19.894, "update_time_ms": 0.005, "opt_peak_throughput": 5026.562, "opt_samples": 100.0, "learner": {"av": {"mean_q": -9.923751831054688, "max_q": -2.8639402389526367, "min_q": -21.75010108947754}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 84061, "episodes_total": 188, "training_iteration": 83, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-05-49", "timestamp": 1585800349, "time_this_iter_s": 23.592358827590942, "time_total_s": 2409.8743965625763, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685ba378>", "on_episode_step": "<function on_episode_step at 0x7f7d685ba400>", "on_episode_end": "<function on_episode_end at 0x7f7d685ba488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685ba510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2409.8743965625763, "timesteps_since_restore": 84061, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 63.161764705882355, "ram_util_percent": 20.00294117647059}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.7236011583481925, "episode_len_mean": 453.55, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7236011583481925}, "custom_metrics": {"num_ped_collisions_mean": 0.09, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.522371504168045, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 382.82, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8193692576254648, "mean_processing_ms": 3.0454285647689194, "mean_inference_ms": 0.6477314863315167}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 59328, "num_steps_trained": 5079600, "num_steps_sampled": 85061, "sample_time_ms": 149.581, "replay_time_ms": 16.982, "grad_time_ms": 16.363, "update_time_ms": 0.005, "opt_peak_throughput": 6111.277, "opt_samples": 100.0, "learner": {"av": {"mean_q": -8.621294975280762, "max_q": -2.901527166366577, "min_q": -23.418825149536133}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 85061, "episodes_total": 190, "training_iteration": 84, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-06-01", "timestamp": 1585800361, "time_this_iter_s": 11.997375011444092, "time_total_s": 2421.8717715740204, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868ad90>", "on_episode_step": "<function on_episode_step at 0x7f7d6868ac80>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a6a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2421.8717715740204, "timesteps_since_restore": 85061, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 62.54705882352941, "ram_util_percent": 20.07058823529412}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0518584301778864, "episode_reward_mean": -0.6888363669976405, "episode_len_mean": 457.56, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0518584301778864}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.6888363669976405}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5321481849785723, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 379.71, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.817041699141954, "mean_processing_ms": 3.043610423720212, "mean_inference_ms": 0.6463014675151958}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 59501, "num_steps_trained": 5096900, "num_steps_sampled": 86062, "sample_time_ms": 155.47, "replay_time_ms": 17.415, "grad_time_ms": 18.776, "update_time_ms": 0.005, "opt_peak_throughput": 5326.087, "opt_samples": 100.0, "learner": {"av": {"mean_q": -9.265525817871094, "max_q": -3.7535996437072754, "min_q": -18.37054443359375}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 86062, "episodes_total": 192, "training_iteration": 85, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-06-11", "timestamp": 1585800371, "time_this_iter_s": 9.696614503860474, "time_total_s": 2431.568386077881, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778510>", "on_episode_step": "<function on_episode_step at 0x7f7d68778840>", "on_episode_end": "<function on_episode_end at 0x7f7d68778d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687786a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2431.568386077881, "timesteps_since_restore": 86062, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 57.81428571428571, "ram_util_percent": 20.092857142857145}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.6871715893989877, "episode_len_mean": 456.8, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.6871715893989877}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5799725657523296, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 377.0, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8147729389218166, "mean_processing_ms": 3.04156342940271, "mean_inference_ms": 0.6449496010868259}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 60033, "num_steps_trained": 5150100, "num_steps_sampled": 87062, "sample_time_ms": 3.846, "replay_time_ms": 15.402, "grad_time_ms": 17.11, "update_time_ms": 0.005, "opt_peak_throughput": 5844.571, "opt_samples": 100.0, "learner": {"av": {"mean_q": -9.024827003479004, "max_q": -3.2335519790649414, "min_q": -18.59427833557129}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 87062, "episodes_total": 194, "training_iteration": 86, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-06-35", "timestamp": 1585800395, "time_this_iter_s": 23.86490488052368, "time_total_s": 2455.4332909584045, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a7b8>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a488>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868ad08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2455.4332909584045, "timesteps_since_restore": 87062, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 62.69411764705882, "ram_util_percent": 20.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.7331061919947843, "episode_len_mean": 452.81, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7331061919947843}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4665650084137325, "avg_speed_min": 0.6318211405958025, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 383.52, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8107846780081582, "mean_processing_ms": 3.0386585323657846, "mean_inference_ms": 0.6425758477126261}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 60722, "num_steps_trained": 5219000, "num_steps_sampled": 88235, "sample_time_ms": 146.293, "replay_time_ms": 19.231, "grad_time_ms": 20.419, "update_time_ms": 0.005, "opt_peak_throughput": 4897.451, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.11581802368164, "max_q": -2.9763715267181396, "min_q": -22.288557052612305}}}, "timesteps_this_iter": 1173, "done": false, "timesteps_total": 88235, "episodes_total": 198, "training_iteration": 87, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-07-07", "timestamp": 1585800427, "time_this_iter_s": 32.82873249053955, "time_total_s": 2488.262023448944, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6861a488>", "on_episode_step": "<function on_episode_step at 0x7f7d6861a510>", "on_episode_end": "<function on_episode_end at 0x7f7d6861a598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6861a620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2488.262023448944, "timesteps_since_restore": 88235, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 62.13695652173912, "ram_util_percent": 20.106521739130436}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.7477322367965613, "episode_len_mean": 449.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7477322367965613}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5099614427015293, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 379.8, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8090242220361474, "mean_processing_ms": 3.0374249959620494, "mean_inference_ms": 0.6415120321416191}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 61593, "num_steps_trained": 5306100, "num_steps_sampled": 89235, "sample_time_ms": 3.819, "replay_time_ms": 13.231, "grad_time_ms": 16.887, "update_time_ms": 0.004, "opt_peak_throughput": 5921.841, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.723377227783203, "max_q": -2.585946559906006, "min_q": -25.805421829223633}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 89235, "episodes_total": 200, "training_iteration": 88, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-07-45", "timestamp": 1585800465, "time_this_iter_s": 37.75393724441528, "time_total_s": 2526.0159606933594, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d68661d08>", "on_episode_end": "<function on_episode_end at 0x7f7d686611e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686617b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2526.0159606933594, "timesteps_since_restore": 89235, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 63.372222222222234, "ram_util_percent": 20.17407407407408}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.7640529380858143, "episode_len_mean": 449.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7640529380858143}, "custom_metrics": {"num_ped_collisions_mean": 0.08, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.517849649906688, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 379.87, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8073541090855259, "mean_processing_ms": 3.0362783422106747, "mean_inference_ms": 0.6405020727117889}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 62125, "num_steps_trained": 5359300, "num_steps_sampled": 90235, "sample_time_ms": 4.768, "replay_time_ms": 17.981, "grad_time_ms": 20.758, "update_time_ms": 0.005, "opt_peak_throughput": 4817.324, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.634561538696289, "max_q": -2.0608036518096924, "min_q": -22.060897827148438}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 90235, "episodes_total": 202, "training_iteration": 89, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-08-10", "timestamp": 1585800490, "time_this_iter_s": 24.403823137283325, "time_total_s": 2550.4197838306427, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a620>", "on_episode_step": "<function on_episode_step at 0x7f7d6868aae8>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a6a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2550.4197838306427, "timesteps_since_restore": 90235, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 64.1342857142857, "ram_util_percent": 20.200000000000003}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.762193914757148, "episode_len_mean": 453.32, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.762193914757148}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4494553204133456, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 383.31, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.805840833278134, "mean_processing_ms": 3.0352462168329337, "mean_inference_ms": 0.6395929380130128}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 62973, "num_steps_trained": 5444100, "num_steps_sampled": 91235, "sample_time_ms": 3.956, "replay_time_ms": 18.597, "grad_time_ms": 20.286, "update_time_ms": 0.005, "opt_peak_throughput": 4929.465, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.955945014953613, "max_q": -3.419764280319214, "min_q": -24.72510528564453}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 91235, "episodes_total": 204, "training_iteration": 90, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-08-46", "timestamp": 1585800526, "time_this_iter_s": 36.06236410140991, "time_total_s": 2586.4821479320526, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9c80>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9950>", "on_episode_end": "<function on_episode_end at 0x7f7d685f9a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2586.4821479320526, "timesteps_since_restore": 91235, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 63.20392156862744, "ram_util_percent": 20.203921568627454}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.750515362171145, "episode_len_mean": 453.32, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.750515362171145}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.4975193080720817, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 379.87, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8035993912089632, "mean_processing_ms": 3.0333491120489398, "mean_inference_ms": 0.6382784786098774}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 63214, "num_steps_trained": 5468200, "num_steps_sampled": 92374, "sample_time_ms": 149.701, "replay_time_ms": 15.558, "grad_time_ms": 16.778, "update_time_ms": 0.005, "opt_peak_throughput": 5960.172, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.615649223327637, "max_q": -3.086421489715576, "min_q": -32.55038833618164}}}, "timesteps_this_iter": 1139, "done": false, "timesteps_total": 92374, "episodes_total": 207, "training_iteration": 91, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-09-00", "timestamp": 1585800540, "time_this_iter_s": 13.896486282348633, "time_total_s": 2600.3786342144012, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a1e0>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a488>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a6a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a7b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2600.3786342144012, "timesteps_since_restore": 92374, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 62.75, "ram_util_percent": 20.265}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5717370834634111, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.7157840113269013, "episode_len_mean": 457.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5717370834634111}, "policy_reward_mean": {"av": -0.7157840113269013}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.5115439397286696, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 376.44, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8020592210085433, "mean_processing_ms": 3.031807181650888, "mean_inference_ms": 0.6373862964778474}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 63377, "num_steps_trained": 5484500, "num_steps_sampled": 93377, "sample_time_ms": 151.341, "replay_time_ms": 18.325, "grad_time_ms": 21.431, "update_time_ms": 0.005, "opt_peak_throughput": 4666.217, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.91781234741211, "max_q": -4.091084003448486, "min_q": -24.61414909362793}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 93377, "episodes_total": 209, "training_iteration": 92, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-09-09", "timestamp": 1585800549, "time_this_iter_s": 9.620684146881104, "time_total_s": 2609.9993183612823, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d68661d90>", "on_episode_end": "<function on_episode_end at 0x7f7d68661d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68661bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2609.9993183612823, "timesteps_since_restore": 93377, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 61.035714285714285, "ram_util_percent": 20.300000000000004}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.7170766300872269, "episode_len_mean": 457.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.7170766300872269}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.489163254864306, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 377.0, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.8007032087672508, "mean_processing_ms": 3.03041763908452, "mean_inference_ms": 0.6366132675629131}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 63588, "num_steps_trained": 5505600, "num_steps_sampled": 94377, "sample_time_ms": 151.327, "replay_time_ms": 18.692, "grad_time_ms": 17.493, "update_time_ms": 0.005, "opt_peak_throughput": 5716.694, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.278794288635254, "max_q": -3.1130080223083496, "min_q": -29.95958137512207}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 94377, "episodes_total": 211, "training_iteration": 93, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-09-21", "timestamp": 1585800561, "time_this_iter_s": 11.601834535598755, "time_total_s": 2621.601152896881, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f91e0>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d685f9158>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f98c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2621.601152896881, "timesteps_since_restore": 94377, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 61.825, "ram_util_percent": 20.3}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.7048401515595296, "episode_len_mean": 457.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.7048401515595296}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.01, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.52969436381725, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 373.61, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7993337196097046, "mean_processing_ms": 3.0290782940610588, "mean_inference_ms": 0.6358251519333528}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 63752, "num_steps_trained": 5522000, "num_steps_sampled": 95377, "sample_time_ms": 152.16, "replay_time_ms": 16.463, "grad_time_ms": 17.671, "update_time_ms": 0.004, "opt_peak_throughput": 5658.855, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.447757720947266, "max_q": -3.187368392944336, "min_q": -20.551998138427734}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 95377, "episodes_total": 213, "training_iteration": 94, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-09-30", "timestamp": 1585800570, "time_this_iter_s": 9.43312931060791, "time_total_s": 2631.034282207489, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778510>", "on_episode_step": "<function on_episode_step at 0x7f7d68778840>", "on_episode_end": "<function on_episode_end at 0x7f7d68778488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2631.034282207489, "timesteps_since_restore": 95377, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 60.83846153846154, "ram_util_percent": 20.300000000000004}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.6896546259555753, "episode_len_mean": 449.38, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.6896546259555753}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.6147097572537974, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 362.55, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7963629257257554, "mean_processing_ms": 3.0272993240206203, "mean_inference_ms": 0.6341293569741182}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 64034, "num_steps_trained": 5550200, "num_steps_sampled": 96587, "sample_time_ms": 148.646, "replay_time_ms": 18.565, "grad_time_ms": 17.735, "update_time_ms": 0.005, "opt_peak_throughput": 5638.703, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.089807510375977, "max_q": -3.2824699878692627, "min_q": -28.941635131835938}}}, "timesteps_this_iter": 1210, "done": false, "timesteps_total": 96587, "episodes_total": 217, "training_iteration": 95, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-09-47", "timestamp": 1585800587, "time_this_iter_s": 16.921729564666748, "time_total_s": 2647.9560117721558, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71cb2e18>", "on_episode_step": "<function on_episode_step at 0x7f7d687277b8>", "on_episode_end": "<function on_episode_end at 0x7f7d68727e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2647.9560117721558, "timesteps_since_restore": 96587, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 60.824, "ram_util_percent": 20.3}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.6531965703402304, "episode_len_mean": 449.38, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.6531965703402304}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.660875601204233, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 359.26, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.794693062840757, "mean_processing_ms": 3.0264576649881794, "mean_inference_ms": 0.6331725198935082}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 64556, "num_steps_trained": 5602400, "num_steps_sampled": 97587, "sample_time_ms": 145.825, "replay_time_ms": 16.301, "grad_time_ms": 14.292, "update_time_ms": 0.004, "opt_peak_throughput": 6996.897, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.049966812133789, "max_q": -3.641200542449951, "min_q": -24.971818923950195}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 97587, "episodes_total": 219, "training_iteration": 96, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-10-10", "timestamp": 1585800610, "time_this_iter_s": 23.092212438583374, "time_total_s": 2671.048224210739, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68604730>", "on_episode_step": "<function on_episode_step at 0x7f7d686041e0>", "on_episode_end": "<function on_episode_end at 0x7f7d686049d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f8048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2671.048224210739, "timesteps_since_restore": 97587, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 61.621875, "ram_util_percent": 20.3}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.6353338258949389, "episode_len_mean": 449.38, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.6353338258949389}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.693855160927417, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 355.99, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7928633421054565, "mean_processing_ms": 3.0256320503454193, "mean_inference_ms": 0.6321277890885173}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 65095, "num_steps_trained": 5656300, "num_steps_sampled": 98587, "sample_time_ms": 126.033, "replay_time_ms": 20.1, "grad_time_ms": 19.514, "update_time_ms": 0.005, "opt_peak_throughput": 5124.516, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.009417533874512, "max_q": -2.489886999130249, "min_q": -27.229467391967773}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 98587, "episodes_total": 221, "training_iteration": 97, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-10-35", "timestamp": 1585800635, "time_this_iter_s": 24.394178867340088, "time_total_s": 2695.442403078079, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687781e0>", "on_episode_step": "<function on_episode_step at 0x7f7d68778378>", "on_episode_end": "<function on_episode_end at 0x7f7d68778d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2695.442403078079, "timesteps_since_restore": 98587, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 61.85714285714287, "ram_util_percent": 20.365714285714283}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.5999172924246555, "episode_len_mean": 445.25, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.5999172924246555}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.8082183955641153, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 345.44, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.788538073670262, "mean_processing_ms": 3.024688044206816, "mean_inference_ms": 0.6296863346174527}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 65337, "num_steps_trained": 5680500, "num_steps_sampled": 99763, "sample_time_ms": 146.492, "replay_time_ms": 15.357, "grad_time_ms": 14.768, "update_time_ms": 0.005, "opt_peak_throughput": 6771.21, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.745622634887695, "max_q": -3.0917673110961914, "min_q": -26.55626678466797}}}, "timesteps_this_iter": 1176, "done": false, "timesteps_total": 99763, "episodes_total": 225, "training_iteration": 98, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-10-50", "timestamp": 1585800650, "time_this_iter_s": 15.178392171859741, "time_total_s": 2710.620795249939, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778840>", "on_episode_step": "<function on_episode_step at 0x7f7d68778a60>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868ad90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2710.620795249939, "timesteps_since_restore": 99763, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 59.92727272727272, "ram_util_percent": 20.395454545454538}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.5820701280194612, "episode_len_mean": 445.25, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.5820701280194612}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.842149870093792, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 342.27, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7862464369391762, "mean_processing_ms": 3.024237281085232, "mean_inference_ms": 0.6283513690737458}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 65884, "num_steps_trained": 5735200, "num_steps_sampled": 100764, "sample_time_ms": 151.623, "replay_time_ms": 14.719, "grad_time_ms": 16.962, "update_time_ms": 0.004, "opt_peak_throughput": 5895.671, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.909262657165527, "max_q": -3.4955456256866455, "min_q": -28.641355514526367}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 100764, "episodes_total": 227, "training_iteration": 99, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-11-15", "timestamp": 1585800675, "time_this_iter_s": 24.712807655334473, "time_total_s": 2735.3336029052734, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727e18>", "on_episode_step": "<function on_episode_step at 0x7f7d687277b8>", "on_episode_end": "<function on_episode_end at 0x7f7d68629598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2735.3336029052734, "timesteps_since_restore": 100764, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 63.177142857142854, "ram_util_percent": 20.399999999999995}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.5553083597437528, "episode_len_mean": 445.25, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.5553083597437528}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 3.9284577558692217, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 335.66, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.783707468069195, "mean_processing_ms": 3.023736653544548, "mean_inference_ms": 0.6268799323674245}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 66090, "num_steps_trained": 5755800, "num_steps_sampled": 101765, "sample_time_ms": 150.25, "replay_time_ms": 15.93, "grad_time_ms": 17.092, "update_time_ms": 0.005, "opt_peak_throughput": 5850.678, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10.882218360900879, "max_q": -3.2780704498291016, "min_q": -25.384862899780273}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 101765, "episodes_total": 229, "training_iteration": 100, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-11-26", "timestamp": 1585800686, "time_this_iter_s": 11.137679815292358, "time_total_s": 2746.471282720566, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68604e18>", "on_episode_step": "<function on_episode_step at 0x7f7d68604950>", "on_episode_end": "<function on_episode_end at 0x7f7d68604730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68604d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2746.471282720566, "timesteps_since_restore": 101765, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 62.412499999999994, "ram_util_percent": 20.4}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.5214921745476403, "episode_len_mean": 445.25, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.5214921745476403}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.004562235745996, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 329.11, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7810224923751312, "mean_processing_ms": 3.023192123980695, "mean_inference_ms": 0.6252986901935492}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 66309, "num_steps_trained": 5777700, "num_steps_sampled": 102765, "sample_time_ms": 156.979, "replay_time_ms": 18.867, "grad_time_ms": 16.646, "update_time_ms": 0.006, "opt_peak_throughput": 6007.611, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.562525749206543, "max_q": -3.204149007797241, "min_q": -33.77366638183594}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 102765, "episodes_total": 231, "training_iteration": 101, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-11-38", "timestamp": 1585800698, "time_this_iter_s": 11.858947992324829, "time_total_s": 2758.3302307128906, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686619d8>", "on_episode_step": "<function on_episode_step at 0x7f7d68661d90>", "on_episode_end": "<function on_episode_end at 0x7f7d68604840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686049d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2758.3302307128906, "timesteps_since_restore": 102765, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 62.2235294117647, "ram_util_percent": 20.4}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.4849764169947786, "episode_len_mean": 445.25, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.4849764169947786}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.087955617917784, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 322.53, "avg_rl_veh_arrival_min": 100.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7781256466781667, "mean_processing_ms": 3.0218584010081404, "mean_inference_ms": 0.6236331286168698}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 66509, "num_steps_trained": 5797700, "num_steps_sampled": 103765, "sample_time_ms": 145.971, "replay_time_ms": 18.717, "grad_time_ms": 16.644, "update_time_ms": 0.005, "opt_peak_throughput": 6008.136, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.466670989990234, "max_q": -3.9858007431030273, "min_q": -23.766551971435547}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 103765, "episodes_total": 233, "training_iteration": 102, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-11-49", "timestamp": 1585800709, "time_this_iter_s": 10.809568405151367, "time_total_s": 2769.139799118042, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629a60>", "on_episode_step": "<function on_episode_step at 0x7f7d68629048>", "on_episode_end": "<function on_episode_end at 0x7f7d687f20d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71cb2e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2769.139799118042, "timesteps_since_restore": 103765, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 59.17999999999999, "ram_util_percent": 20.419999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.4345245542891818, "episode_len_mean": 453.58, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.4345245542891818}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.120335905189167, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 320.0, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7751166272980288, "mean_processing_ms": 3.020432536395232, "mean_inference_ms": 0.6218935135743618}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 66712, "num_steps_trained": 5818000, "num_steps_sampled": 104766, "sample_time_ms": 154.129, "replay_time_ms": 16.655, "grad_time_ms": 20.153, "update_time_ms": 0.005, "opt_peak_throughput": 4961.935, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.431751251220703, "max_q": -3.152778387069702, "min_q": -24.97294044494629}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 104766, "episodes_total": 235, "training_iteration": 103, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-12-00", "timestamp": 1585800720, "time_this_iter_s": 11.339547395706177, "time_total_s": 2780.479346513748, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc950>", "on_episode_step": "<function on_episode_step at 0x7f7d6868ad90>", "on_episode_end": "<function on_episode_end at 0x7f7d6868aea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2780.479346513748, "timesteps_since_restore": 104766, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 65.6875, "ram_util_percent": 20.475}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.4093838487713813, "episode_len_mean": 456.13, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.4093838487713813}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.171061352799663, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 317.23, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.771954466885926, "mean_processing_ms": 3.018632811594539, "mean_inference_ms": 0.6200774988995483}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67036, "num_steps_trained": 5850400, "num_steps_sampled": 105766, "sample_time_ms": 145.61, "replay_time_ms": 17.776, "grad_time_ms": 18.697, "update_time_ms": 0.006, "opt_peak_throughput": 5348.54, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.583507537841797, "max_q": -2.838937520980835, "min_q": -23.88254165649414}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 105766, "episodes_total": 237, "training_iteration": 104, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-12-16", "timestamp": 1585800736, "time_this_iter_s": 15.717187643051147, "time_total_s": 2796.1965341567993, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9d90>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9840>", "on_episode_end": "<function on_episode_end at 0x7f7d685f9f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2796.1965341567993, "timesteps_since_restore": 105766, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 60.29545454545453, "ram_util_percent": 20.495454545454546}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.3741062734455468, "episode_len_mean": 456.13, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.3741062734455468}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.261446752048001, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 310.7, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7686361019147823, "mean_processing_ms": 3.0167724031910232, "mean_inference_ms": 0.6181668284463682}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67235, "num_steps_trained": 5870300, "num_steps_sampled": 106766, "sample_time_ms": 156.881, "replay_time_ms": 19.113, "grad_time_ms": 21.228, "update_time_ms": 0.005, "opt_peak_throughput": 4710.822, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.664624214172363, "max_q": -3.623826026916504, "min_q": -24.764310836791992}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 106766, "episodes_total": 239, "training_iteration": 105, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-12-27", "timestamp": 1585800747, "time_this_iter_s": 10.77836561203003, "time_total_s": 2806.9748997688293, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9c80>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d72072d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868ad90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2806.9748997688293, "timesteps_since_restore": 106766, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 59.0875, "ram_util_percent": 20.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.3301284640614785, "episode_len_mean": 456.13, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.3301284640614785}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.02, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.326754031480508, "avg_speed_min": 0.6682213013008056, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 304.38, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7651617533243495, "mean_processing_ms": 3.014890562442078, "mean_inference_ms": 0.6161484109640398}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67468, "num_steps_trained": 5893600, "num_steps_sampled": 107771, "sample_time_ms": 154.785, "replay_time_ms": 17.104, "grad_time_ms": 17.495, "update_time_ms": 0.005, "opt_peak_throughput": 5715.782, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.509705543518066, "max_q": -3.5259358882904053, "min_q": -28.469409942626953}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 107771, "episodes_total": 241, "training_iteration": 106, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-12-39", "timestamp": 1585800759, "time_this_iter_s": 12.217834711074829, "time_total_s": 2819.192734479904, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8bf8>", "on_episode_step": "<function on_episode_step at 0x7f7d687f8620>", "on_episode_end": "<function on_episode_end at 0x7f7d687f8ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71cb2e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2819.192734479904, "timesteps_since_restore": 107771, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 60.35882352941176, "ram_util_percent": 20.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.30904463478312194, "episode_len_mean": 452.16, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.30904463478312194}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.461912345201791, "avg_speed_min": 1.1357475837473012, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 293.96, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7597065798813114, "mean_processing_ms": 3.012299767108025, "mean_inference_ms": 0.6129408831085829}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67710, "num_steps_trained": 5917800, "num_steps_sampled": 108865, "sample_time_ms": 155.66, "replay_time_ms": 17.583, "grad_time_ms": 21.835, "update_time_ms": 0.005, "opt_peak_throughput": 4579.744, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.886488914489746, "max_q": -4.072688102722168, "min_q": -29.16024398803711}}}, "timesteps_this_iter": 1094, "done": false, "timesteps_total": 108865, "episodes_total": 244, "training_iteration": 107, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-12-53", "timestamp": 1585800773, "time_this_iter_s": 14.057025671005249, "time_total_s": 2833.2497601509094, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778d08>", "on_episode_step": "<function on_episode_step at 0x7f7d68629950>", "on_episode_end": "<function on_episode_end at 0x7f7d686290d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686299d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2833.2497601509094, "timesteps_since_restore": 108865, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 62.370000000000005, "ram_util_percent": 20.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.2658242611958099, "episode_len_mean": 452.16, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.2658242611958099}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.543003279469475, "avg_speed_min": 1.1357475837473012, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 287.45, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7559268775946177, "mean_processing_ms": 3.0105809623895494, "mean_inference_ms": 0.6106874093816999}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67929, "num_steps_trained": 5939700, "num_steps_sampled": 109865, "sample_time_ms": 145.603, "replay_time_ms": 15.192, "grad_time_ms": 15.96, "update_time_ms": 0.004, "opt_peak_throughput": 6265.626, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.0166597366333, "max_q": -4.332747936248779, "min_q": -28.316585540771484}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 109865, "episodes_total": 246, "training_iteration": 108, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-13-05", "timestamp": 1585800785, "time_this_iter_s": 11.873318195343018, "time_total_s": 2845.1230783462524, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc950>", "on_episode_step": "<function on_episode_step at 0x7f7d686ccb70>", "on_episode_end": "<function on_episode_end at 0x7f7d701ccb70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d72072d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2845.1230783462524, "timesteps_since_restore": 109865, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 62.16470588235294, "ram_util_percent": 20.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.24451821671073073, "episode_len_mean": 443.97, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.24451821671073073}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.581155642500821, "avg_speed_min": 1.1357475837473012, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 279.34, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7482451569077027, "mean_processing_ms": 3.0079127833146857, "mean_inference_ms": 0.6060926779376438}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 68497, "num_steps_trained": 5996500, "num_steps_sampled": 111038, "sample_time_ms": 147.899, "replay_time_ms": 16.45, "grad_time_ms": 18.719, "update_time_ms": 0.005, "opt_peak_throughput": 5342.239, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.803208351135254, "max_q": -0.9319106340408325, "min_q": -26.584321975708008}}}, "timesteps_this_iter": 1173, "done": false, "timesteps_total": 111038, "episodes_total": 250, "training_iteration": 109, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-13-32", "timestamp": 1585800812, "time_this_iter_s": 27.596724033355713, "time_total_s": 2872.719802379608, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b5c80>", "on_episode_step": "<function on_episode_step at 0x7f7d685b5b70>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b5a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2872.719802379608, "timesteps_since_restore": 111038, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 59.246153846153845, "ram_util_percent": 20.210256410256413}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.23037413792986805, "episode_len_mean": 443.78, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.23037413792986805}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.632942226359649, "avg_speed_min": 1.1357475837473012, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 276.96, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7422330215199218, "mean_processing_ms": 3.0062023128910016, "mean_inference_ms": 0.6025077715804169}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 68772, "num_steps_trained": 6024000, "num_steps_sampled": 112132, "sample_time_ms": 147.666, "replay_time_ms": 16.809, "grad_time_ms": 16.876, "update_time_ms": 0.005, "opt_peak_throughput": 5925.455, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.086153984069824, "max_q": -3.381673812866211, "min_q": -25.131093978881836}}}, "timesteps_this_iter": 1094, "done": false, "timesteps_total": 112132, "episodes_total": 253, "training_iteration": 110, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-13-47", "timestamp": 1585800827, "time_this_iter_s": 14.418193578720093, "time_total_s": 2887.1379959583282, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661d90>", "on_episode_step": "<function on_episode_step at 0x7f7d68661ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b5400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2887.1379959583282, "timesteps_since_restore": 112132, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 51.3, "ram_util_percent": 19.0904761904762}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.19573471005356458, "episode_len_mean": 443.78, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.19573471005356458}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.689922061382493, "avg_speed_min": 1.1357475837473012, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 270.75, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7380682530265275, "mean_processing_ms": 3.005043474056937, "mean_inference_ms": 0.6000213401785741}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69022, "num_steps_trained": 6049000, "num_steps_sampled": 113138, "sample_time_ms": 145.216, "replay_time_ms": 15.032, "grad_time_ms": 16.655, "update_time_ms": 0.004, "opt_peak_throughput": 6004.103, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.672778129577637, "max_q": -4.3474249839782715, "min_q": -26.06757164001465}}}, "timesteps_this_iter": 1006, "done": false, "timesteps_total": 113138, "episodes_total": 255, "training_iteration": 111, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-13-59", "timestamp": 1585800839, "time_this_iter_s": 12.251471519470215, "time_total_s": 2899.3894674777985, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686292f0>", "on_episode_step": "<function on_episode_step at 0x7f7d68629620>", "on_episode_end": "<function on_episode_end at 0x7f7d68629ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2899.3894674777985, "timesteps_since_restore": 113138, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 55.61176470588235, "ram_util_percent": 19.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.15078082088860717, "episode_len_mean": 443.78, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.15078082088860717}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.7540261398634955, "avg_speed_min": 1.1357475837473012, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 264.44, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.733819849403485, "mean_processing_ms": 3.0038711688162443, "mean_inference_ms": 0.5974815129711584}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69258, "num_steps_trained": 6072600, "num_steps_sampled": 114142, "sample_time_ms": 150.548, "replay_time_ms": 15.724, "grad_time_ms": 19.218, "update_time_ms": 0.005, "opt_peak_throughput": 5203.322, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.495545387268066, "max_q": -3.370213270187378, "min_q": -25.275602340698242}}}, "timesteps_this_iter": 1004, "done": false, "timesteps_total": 114142, "episodes_total": 257, "training_iteration": 112, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-14-10", "timestamp": 1585800850, "time_this_iter_s": 11.408609867095947, "time_total_s": 2910.7980773448944, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f91e0>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9950>", "on_episode_end": "<function on_episode_end at 0x7f7d685f97b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f99d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2910.7980773448944, "timesteps_since_restore": 114142, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 50.1, "ram_util_percent": 19.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.12879365993993175, "episode_len_mean": 443.78, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.12879365993993175}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.816707609081305, "avg_speed_min": 1.1357475837473012, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 260.92, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.729485693029452, "mean_processing_ms": 3.002681182865839, "mean_inference_ms": 0.5948809372707216}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69419, "num_steps_trained": 6088700, "num_steps_sampled": 115142, "sample_time_ms": 155.031, "replay_time_ms": 19.897, "grad_time_ms": 17.592, "update_time_ms": 0.005, "opt_peak_throughput": 5684.51, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.839827537536621, "max_q": -4.344791412353516, "min_q": -25.345413208007812}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 115142, "episodes_total": 259, "training_iteration": 113, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-14-20", "timestamp": 1585800860, "time_this_iter_s": 9.282416343688965, "time_total_s": 2920.0804936885834, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b5d90>", "on_episode_step": "<function on_episode_step at 0x7f7d685b59d8>", "on_episode_end": "<function on_episode_end at 0x7f7d685b52f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b56a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2920.0804936885834, "timesteps_since_restore": 115142, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 54.97692307692308, "ram_util_percent": 19.099999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -3.0020854412368014, "episode_reward_mean": -0.08839763317239417, "episode_len_mean": 443.78, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0020854412368014}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.08839763317239417}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.901130442451068, "avg_speed_min": 1.1942443661608992, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 254.58, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7250029862577505, "mean_processing_ms": 3.0013009357755402, "mean_inference_ms": 0.5921954947911802}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69645, "num_steps_trained": 6111300, "num_steps_sampled": 116142, "sample_time_ms": 4.064, "replay_time_ms": 18.336, "grad_time_ms": 14.279, "update_time_ms": 0.004, "opt_peak_throughput": 7003.182, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.955107688903809, "max_q": -3.8058884143829346, "min_q": -32.73033142089844}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 116142, "episodes_total": 261, "training_iteration": 114, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-14-31", "timestamp": 1585800871, "time_this_iter_s": 11.321088790893555, "time_total_s": 2931.401582479477, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b58c8>", "on_episode_step": "<function on_episode_step at 0x7f7d685b5158>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5268>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b5048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2931.401582479477, "timesteps_since_restore": 116142, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 52.54375, "ram_util_percent": 19.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -2.998789580842382, "episode_reward_mean": -0.031696650558924684, "episode_len_mean": 447.73, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": -0.031696650558924684}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.947184646192709, "avg_speed_min": 1.1942443661608992, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 248.04, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.720368833923119, "mean_processing_ms": 2.999708243989462, "mean_inference_ms": 0.5894417069587027}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69858, "num_steps_trained": 6132600, "num_steps_sampled": 117142, "sample_time_ms": 3.942, "replay_time_ms": 17.805, "grad_time_ms": 17.334, "update_time_ms": 0.004, "opt_peak_throughput": 5768.943, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.487931251525879, "max_q": -4.627736568450928, "min_q": -31.958845138549805}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 117142, "episodes_total": 263, "training_iteration": 115, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-14-42", "timestamp": 1585800882, "time_this_iter_s": 10.734051704406738, "time_total_s": 2942.1356341838837, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553378>", "on_episode_step": "<function on_episode_step at 0x7f7d68553400>", "on_episode_end": "<function on_episode_end at 0x7f7d68553488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2942.1356341838837, "timesteps_since_restore": 117142, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 50.06000000000001, "ram_util_percent": 19.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5704160271250416, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.01509641889762598, "episode_len_mean": 451.68, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5704160271250416}, "policy_reward_mean": {"av": 0.01509641889762598}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.9885487763439285, "avg_speed_min": 1.1942443661608992, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 241.57, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7158728771447167, "mean_processing_ms": 2.9975655834428863, "mean_inference_ms": 0.5867925649914116}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 70074, "num_steps_trained": 6154200, "num_steps_sampled": 118142, "sample_time_ms": 148.527, "replay_time_ms": 16.984, "grad_time_ms": 16.263, "update_time_ms": 0.005, "opt_peak_throughput": 6148.879, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.014710426330566, "max_q": -4.233267307281494, "min_q": -32.06598663330078}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 118142, "episodes_total": 265, "training_iteration": 116, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-14-53", "timestamp": 1585800893, "time_this_iter_s": 11.14695429801941, "time_total_s": 2953.282588481903, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9950>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9b70>", "on_episode_end": "<function on_episode_end at 0x7f7d685f9ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9158>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2953.282588481903, "timesteps_since_restore": 118142, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 56.849999999999994, "ram_util_percent": 19.1375}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5657561660757364, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.04939433558348311, "episode_len_mean": 455.84, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5657561660757364}, "policy_reward_mean": {"av": 0.04939433558348311}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.984954237271891, "avg_speed_min": 1.1942443661608992, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 238.93, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.7112648885233945, "mean_processing_ms": 2.9953357371818616, "mean_inference_ms": 0.5840854636024057}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 70306, "num_steps_trained": 6177400, "num_steps_sampled": 119142, "sample_time_ms": 144.837, "replay_time_ms": 17.474, "grad_time_ms": 15.449, "update_time_ms": 0.005, "opt_peak_throughput": 6472.961, "opt_samples": 100.0, "learner": {"av": {"mean_q": -11.919713973999023, "max_q": -4.65376091003418, "min_q": -22.795001983642578}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 119142, "episodes_total": 267, "training_iteration": 117, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-15-04", "timestamp": 1585800904, "time_this_iter_s": 10.93610954284668, "time_total_s": 2964.2186980247498, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778378>", "on_episode_step": "<function on_episode_step at 0x7f7d68778510>", "on_episode_end": "<function on_episode_end at 0x7f7d68778840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2964.2186980247498, "timesteps_since_restore": 119142, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 50.05, "ram_util_percent": 19.13125}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.561315851984216, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.009204130980935574, "episode_len_mean": 451.72, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.561315851984216}, "policy_reward_mean": {"av": 0.009204130980935574}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 4.957961506646442, "avg_speed_min": 1.1942443661608992, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 242.55, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.706740037154799, "mean_processing_ms": 2.9931255961142154, "mean_inference_ms": 0.5814259098077557}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71156, "num_steps_trained": 6262400, "num_steps_sampled": 120142, "sample_time_ms": 3.271, "replay_time_ms": 14.87, "grad_time_ms": 15.144, "update_time_ms": 0.005, "opt_peak_throughput": 6603.404, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.891270637512207, "max_q": 0.8445010185241699, "min_q": -26.796518325805664}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 120142, "episodes_total": 269, "training_iteration": 118, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-15-37", "timestamp": 1585800937, "time_this_iter_s": 33.364994764328, "time_total_s": 2997.5836927890778, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629c80>", "on_episode_step": "<function on_episode_step at 0x7f7d68629ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d686296a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2997.5836927890778, "timesteps_since_restore": 120142, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 54.32127659574468, "ram_util_percent": 19.200000000000006}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.561315851984216, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.0038677081919039936, "episode_len_mean": 447.85, "episodes_this_iter": 4, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.561315851984216}, "policy_reward_mean": {"av": 0.0038677081919039936}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.008238734978634, "avg_speed_min": 1.1942443661608992, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 238.67, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6974801379130506, "mean_processing_ms": 2.989351867092827, "mean_inference_ms": 0.5759955197115176}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71441, "num_steps_trained": 6290900, "num_steps_sampled": 121348, "sample_time_ms": 142.388, "replay_time_ms": 16.845, "grad_time_ms": 16.856, "update_time_ms": 0.004, "opt_peak_throughput": 5932.462, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.579755783081055, "max_q": -5.102964878082275, "min_q": -32.94236373901367}}}, "timesteps_this_iter": 1206, "done": false, "timesteps_total": 121348, "episodes_total": 273, "training_iteration": 119, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-15-53", "timestamp": 1585800953, "time_this_iter_s": 15.64414119720459, "time_total_s": 3013.2278339862823, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685697b8>", "on_episode_step": "<function on_episode_step at 0x7f7d68569ae8>", "on_episode_end": "<function on_episode_end at 0x7f7d68569b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3013.2278339862823, "timesteps_since_restore": 121348, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 51.199999999999996, "ram_util_percent": 19.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.561315851984216, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.02614147127379483, "episode_len_mean": 444.12, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.561315851984216}, "policy_reward_mean": {"av": 0.02614147127379483}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.112145140349214, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.447221661612951, "avg_rl_veh_arrival_mean": 228.18, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6904380804646189, "mean_processing_ms": 2.9868039522562957, "mean_inference_ms": 0.5718462802305043}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71706, "num_steps_trained": 6317400, "num_steps_sampled": 122464, "sample_time_ms": 147.482, "replay_time_ms": 16.193, "grad_time_ms": 16.402, "update_time_ms": 0.005, "opt_peak_throughput": 6096.727, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.773516654968262, "max_q": 1.7040632963180542, "min_q": -25.862560272216797}}}, "timesteps_this_iter": 1116, "done": false, "timesteps_total": 122464, "episodes_total": 276, "training_iteration": 120, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-16-07", "timestamp": 1585800967, "time_this_iter_s": 13.641793012619019, "time_total_s": 3026.8696269989014, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b5598>", "on_episode_step": "<function on_episode_step at 0x7f7d685b5268>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3026.8696269989014, "timesteps_since_restore": 122464, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 51.195, "ram_util_percent": 19.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5605659856179189, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.025201344939949865, "episode_len_mean": 444.12, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5605659856179189}, "policy_reward_mean": {"av": 0.025201344939949865}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.075177383967482, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.123596428087968, "avg_rl_veh_arrival_mean": 229.2, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6858816320562005, "mean_processing_ms": 2.985208687262106, "mean_inference_ms": 0.5691580336068207}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71960, "num_steps_trained": 6342800, "num_steps_sampled": 123465, "sample_time_ms": 147.952, "replay_time_ms": 17.067, "grad_time_ms": 17.396, "update_time_ms": 0.005, "opt_peak_throughput": 5748.346, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.108978271484375, "max_q": -5.478261470794678, "min_q": -23.296079635620117}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 123465, "episodes_total": 278, "training_iteration": 121, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-16-19", "timestamp": 1585800979, "time_this_iter_s": 12.177442073822021, "time_total_s": 3039.0470690727234, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685437b8>", "on_episode_step": "<function on_episode_step at 0x7f7d68543950>", "on_episode_end": "<function on_episode_end at 0x7f7d68543a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3039.0470690727234, "timesteps_since_restore": 123465, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 52.14705882352941, "ram_util_percent": 19.2}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5605659856179189, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.010048485882828452, "episode_len_mean": 440.08, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5605659856179189}, "policy_reward_mean": {"av": 0.010048485882828452}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.042333934058617, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.123596428087968, "avg_rl_veh_arrival_mean": 229.06, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6793459421582972, "mean_processing_ms": 2.983208106359383, "mean_inference_ms": 0.5652874077476722}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 72230, "num_steps_trained": 6369800, "num_steps_sampled": 124550, "sample_time_ms": 146.413, "replay_time_ms": 17.521, "grad_time_ms": 20.229, "update_time_ms": 0.005, "opt_peak_throughput": 4943.298, "opt_samples": 100.0, "learner": {"av": {"mean_q": -12.566332817077637, "max_q": -5.543756484985352, "min_q": -22.094940185546875}}}, "timesteps_this_iter": 1085, "done": false, "timesteps_total": 124550, "episodes_total": 281, "training_iteration": 122, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-16-33", "timestamp": 1585800993, "time_this_iter_s": 14.105651378631592, "time_total_s": 3053.152720451355, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661488>", "on_episode_step": "<function on_episode_step at 0x7f7d701266a8>", "on_episode_end": "<function on_episode_end at 0x7f7d687f20d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3053.152720451355, "timesteps_since_restore": 124550, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 54.375000000000014, "ram_util_percent": 19.225}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.009954987861454618, "episode_len_mean": 440.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.009954987861454618}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.037923520167961, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.2189599024111155, "avg_rl_veh_arrival_mean": 229.21, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6750572230671443, "mean_processing_ms": 2.9819191660650466, "mean_inference_ms": 0.5627529118413482}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 72412, "num_steps_trained": 6388000, "num_steps_sampled": 125579, "sample_time_ms": 150.987, "replay_time_ms": 14.389, "grad_time_ms": 15.366, "update_time_ms": 0.004, "opt_peak_throughput": 6507.983, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.529962539672852, "max_q": -5.755316734313965, "min_q": -27.798532485961914}}}, "timesteps_this_iter": 1029, "done": false, "timesteps_total": 125579, "episodes_total": 283, "training_iteration": 123, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-16-43", "timestamp": 1585801003, "time_this_iter_s": 10.029217958450317, "time_total_s": 3063.1819384098053, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543400>", "on_episode_step": "<function on_episode_step at 0x7f7d68543510>", "on_episode_end": "<function on_episode_end at 0x7f7d68543f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3063.1819384098053, "timesteps_since_restore": 125579, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 54.79333333333332, "ram_util_percent": 19.273333333333337}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.019752968141852657, "episode_len_mean": 440.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.019752968141852657}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.0442472929270465, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.2189599024111155, "avg_rl_veh_arrival_mean": 227.85, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6708546693868715, "mean_processing_ms": 2.980675236438051, "mean_inference_ms": 0.5602681074239542}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 72793, "num_steps_trained": 6426100, "num_steps_sampled": 126579, "sample_time_ms": 146.469, "replay_time_ms": 19.805, "grad_time_ms": 16.271, "update_time_ms": 0.005, "opt_peak_throughput": 6146.068, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.277536392211914, "max_q": -6.274540424346924, "min_q": -25.59735679626465}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 126579, "episodes_total": 285, "training_iteration": 124, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-17-00", "timestamp": 1585801020, "time_this_iter_s": 17.173144817352295, "time_total_s": 3080.3550832271576, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629158>", "on_episode_step": "<function on_episode_step at 0x7f7d686292f0>", "on_episode_end": "<function on_episode_end at 0x7f7d70081400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3080.3550832271576, "timesteps_since_restore": 126579, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 54.42083333333333, "ram_util_percent": 19.304166666666667}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.03010300503433251, "episode_len_mean": 440.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.03010300503433251}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.052234028136323, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.2189599024111155, "avg_rl_veh_arrival_mean": 225.79, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6667066505923542, "mean_processing_ms": 2.9794702589203474, "mean_inference_ms": 0.5578230641493311}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 73102, "num_steps_trained": 6457000, "num_steps_sampled": 127579, "sample_time_ms": 3.674, "replay_time_ms": 16.237, "grad_time_ms": 16.956, "update_time_ms": 0.004, "opt_peak_throughput": 5897.619, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.573591232299805, "max_q": -3.4040329456329346, "min_q": -26.932348251342773}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 127579, "episodes_total": 287, "training_iteration": 125, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-17-15", "timestamp": 1585801035, "time_this_iter_s": 14.311126947402954, "time_total_s": 3094.6662101745605, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569488>", "on_episode_step": "<function on_episode_step at 0x7f7d68569620>", "on_episode_end": "<function on_episode_end at 0x7f7d68569730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685697b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3094.6662101745605, "timesteps_since_restore": 127579, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 53.7, "ram_util_percent": 19.300000000000004}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.03064336885965461, "episode_len_mean": 440.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.03064336885965461}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.0715756113887425, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.2189599024111155, "avg_rl_veh_arrival_mean": 225.26, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6625724754889815, "mean_processing_ms": 2.978289376177123, "mean_inference_ms": 0.5553923441812616}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 73255, "num_steps_trained": 6472300, "num_steps_sampled": 128579, "sample_time_ms": 147.909, "replay_time_ms": 17.853, "grad_time_ms": 17.017, "update_time_ms": 0.005, "opt_peak_throughput": 5876.622, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.266779899597168, "max_q": -5.928201675415039, "min_q": -28.646024703979492}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 128579, "episodes_total": 289, "training_iteration": 126, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-17-23", "timestamp": 1585801043, "time_this_iter_s": 8.47976541519165, "time_total_s": 3103.145975589752, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685699d8>", "on_episode_step": "<function on_episode_step at 0x7f7d68569ae8>", "on_episode_end": "<function on_episode_end at 0x7f7d68569e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3103.145975589752, "timesteps_since_restore": 128579, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 52.607692307692304, "ram_util_percent": 19.300000000000004}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.020152207164397484, "episode_len_mean": 440.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.020152207164397484}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.014855794808155, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.2189599024111155, "avg_rl_veh_arrival_mean": 228.99, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6586094201573496, "mean_processing_ms": 2.9771788401986385, "mean_inference_ms": 0.5530563052275412}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 73810, "num_steps_trained": 6527800, "num_steps_sampled": 129579, "sample_time_ms": 148.3, "replay_time_ms": 18.249, "grad_time_ms": 17.349, "update_time_ms": 0.004, "opt_peak_throughput": 5763.893, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.436271667480469, "max_q": -5.655439376831055, "min_q": -25.461748123168945}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 129579, "episodes_total": 291, "training_iteration": 127, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-17-47", "timestamp": 1585801067, "time_this_iter_s": 23.548699140548706, "time_total_s": 3126.694674730301, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b50d0>", "on_episode_step": "<function on_episode_step at 0x7f7d685b5b70>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b5048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3126.694674730301, "timesteps_since_restore": 129579, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 53.65757575757575, "ram_util_percent": 19.3}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.02058528721627597, "episode_len_mean": 440.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.02058528721627597}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.0162526638208975, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 229.33, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6546947712459599, "mean_processing_ms": 2.976099363429035, "mean_inference_ms": 0.5507426390843834}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 74025, "num_steps_trained": 6549300, "num_steps_sampled": 130579, "sample_time_ms": 3.838, "replay_time_ms": 14.298, "grad_time_ms": 15.751, "update_time_ms": 0.005, "opt_peak_throughput": 6348.994, "opt_samples": 100.0, "learner": {"av": {"mean_q": -13.503218650817871, "max_q": -5.939206600189209, "min_q": -26.71934700012207}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 130579, "episodes_total": 293, "training_iteration": 128, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-17-57", "timestamp": 1585801077, "time_this_iter_s": 10.708473205566406, "time_total_s": 3137.4031479358673, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b5378>", "on_episode_step": "<function on_episode_step at 0x7f7d685b5158>", "on_episode_end": "<function on_episode_end at 0x7f7d68543b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3137.4031479358673, "timesteps_since_restore": 130579, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 52.38666666666667, "ram_util_percent": 19.300000000000004}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.07004086101688894, "episode_len_mean": 444.22, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.07004086101688894}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.060391506826811, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 223.03, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6507538017441905, "mean_processing_ms": 2.9748173558584763, "mean_inference_ms": 0.548416063247909}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 74263, "num_steps_trained": 6573100, "num_steps_sampled": 131579, "sample_time_ms": 3.897, "replay_time_ms": 16.732, "grad_time_ms": 17.053, "update_time_ms": 0.004, "opt_peak_throughput": 5864.043, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.013911247253418, "max_q": -4.924396991729736, "min_q": -29.195905685424805}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 131579, "episodes_total": 295, "training_iteration": 129, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-18-09", "timestamp": 1585801089, "time_this_iter_s": 11.584969520568848, "time_total_s": 3148.988117456436, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543950>", "on_episode_step": "<function on_episode_step at 0x7f7d68543ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d685692f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3148.988117456436, "timesteps_since_restore": 131579, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 52.970588235294116, "ram_util_percent": 19.3}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.06486634297633397, "episode_len_mean": 444.15, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.06486634297633397}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.100443603917476, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 224.35, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6447532224737664, "mean_processing_ms": 2.972757758391664, "mean_inference_ms": 0.5448878361181296}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 74612, "num_steps_trained": 6608000, "num_steps_sampled": 132657, "sample_time_ms": 142.8, "replay_time_ms": 16.542, "grad_time_ms": 17.369, "update_time_ms": 0.005, "opt_peak_throughput": 5757.452, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.112475395202637, "max_q": -6.816588401794434, "min_q": -30.253849029541016}}}, "timesteps_this_iter": 1078, "done": false, "timesteps_total": 132657, "episodes_total": 298, "training_iteration": 130, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-18-26", "timestamp": 1585801106, "time_this_iter_s": 16.819998741149902, "time_total_s": 3165.808116197586, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553378>", "on_episode_step": "<function on_episode_step at 0x7f7d68553488>", "on_episode_end": "<function on_episode_end at 0x7f7d68553730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685538c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3165.808116197586, "timesteps_since_restore": 132657, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 52.69583333333333, "ram_util_percent": 19.329166666666666}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.09274642050002027, "episode_len_mean": 447.87, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.09274642050002027}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.1414612773094825, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 221.85, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6406032164795195, "mean_processing_ms": 2.9713615037016843, "mean_inference_ms": 0.5424646962814489}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 74866, "num_steps_trained": 6633400, "num_steps_sampled": 133657, "sample_time_ms": 144.441, "replay_time_ms": 17.518, "grad_time_ms": 14.563, "update_time_ms": 0.005, "opt_peak_throughput": 6866.756, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.534676551818848, "max_q": -6.06756591796875, "min_q": -33.44816589355469}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 133657, "episodes_total": 300, "training_iteration": 131, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-18-38", "timestamp": 1585801118, "time_this_iter_s": 12.110198020935059, "time_total_s": 3177.918314218521, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685537b8>", "on_episode_step": "<function on_episode_step at 0x7f7d68553950>", "on_episode_end": "<function on_episode_end at 0x7f7d68553510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3177.918314218521, "timesteps_since_restore": 133657, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 50.523529411764706, "ram_util_percent": 19.370588235294115}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.11527940948223922, "episode_len_mean": 447.87, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.11527940948223922}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.1767315680982735, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 218.5, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.636413296126808, "mean_processing_ms": 2.969971511111347, "mean_inference_ms": 0.5400232838728448}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 75065, "num_steps_trained": 6653300, "num_steps_sampled": 134664, "sample_time_ms": 150.412, "replay_time_ms": 14.758, "grad_time_ms": 16.441, "update_time_ms": 0.004, "opt_peak_throughput": 6082.254, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.554204940795898, "max_q": -6.849640369415283, "min_q": -38.174560546875}}}, "timesteps_this_iter": 1007, "done": false, "timesteps_total": 134664, "episodes_total": 302, "training_iteration": 132, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-18-48", "timestamp": 1585801128, "time_this_iter_s": 10.024066686630249, "time_total_s": 3187.9423809051514, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553400>", "on_episode_step": "<function on_episode_step at 0x7f7d68553598>", "on_episode_end": "<function on_episode_end at 0x7f7d685532f0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3187.9423809051514, "timesteps_since_restore": 134664, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 49.23571428571429, "ram_util_percent": 19.400000000000002}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.15315183245574626, "episode_len_mean": 444.23, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.15315183245574626}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.264590570587053, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 208.96, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6300670201687826, "mean_processing_ms": 2.968017161885761, "mean_inference_ms": 0.5363208412936936}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 75396, "num_steps_trained": 6686400, "num_steps_sampled": 135790, "sample_time_ms": 146.04, "replay_time_ms": 18.589, "grad_time_ms": 16.521, "update_time_ms": 0.004, "opt_peak_throughput": 6052.954, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.184139251708984, "max_q": -8.443828582763672, "min_q": -28.966991424560547}}}, "timesteps_this_iter": 1126, "done": false, "timesteps_total": 135790, "episodes_total": 305, "training_iteration": 133, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-19-04", "timestamp": 1585801144, "time_this_iter_s": 16.32342290878296, "time_total_s": 3204.2658038139343, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685432f0>", "on_episode_step": "<function on_episode_step at 0x7f7d68543488>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b50d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3204.2658038139343, "timesteps_since_restore": 135790, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 51.56086956521739, "ram_util_percent": 19.39999999999999}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.1529175985786205, "episode_len_mean": 444.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.1529175985786205}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.24891547225608, "avg_speed_min": 1.3412840768599925, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 209.36, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6258671526852484, "mean_processing_ms": 2.9666103641363732, "mean_inference_ms": 0.5338769079484286}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 75613, "num_steps_trained": 6708100, "num_steps_sampled": 136793, "sample_time_ms": 145.045, "replay_time_ms": 15.766, "grad_time_ms": 16.047, "update_time_ms": 0.005, "opt_peak_throughput": 6231.648, "opt_samples": 100.0, "learner": {"av": {"mean_q": -14.517276763916016, "max_q": -2.1757898330688477, "min_q": -29.23708152770996}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 136793, "episodes_total": 307, "training_iteration": 134, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-19-15", "timestamp": 1585801155, "time_this_iter_s": 11.054202795028687, "time_total_s": 3215.320006608963, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543a60>", "on_episode_step": "<function on_episode_step at 0x7f7d68543b70>", "on_episode_end": "<function on_episode_end at 0x7f7d68543840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701266a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3215.320006608963, "timesteps_since_restore": 136793, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 55.1125, "ram_util_percent": 19.4}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.1402620714351146, "episode_len_mean": 444.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.1402620714351146}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.195480588817109, "avg_speed_min": 1.2290908872073438, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.68, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6218002057978753, "mean_processing_ms": 2.965267247460208, "mean_inference_ms": 0.5315182057465512}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 76141, "num_steps_trained": 6760900, "num_steps_sampled": 137793, "sample_time_ms": 4.025, "replay_time_ms": 17.464, "grad_time_ms": 18.675, "update_time_ms": 0.005, "opt_peak_throughput": 5354.665, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.903907775878906, "max_q": -7.876951694488525, "min_q": -32.66720962524414}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 137793, "episodes_total": 309, "training_iteration": 135, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-19-37", "timestamp": 1585801177, "time_this_iter_s": 21.808321237564087, "time_total_s": 3237.128327846527, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d68553bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d68553730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3237.128327846527, "timesteps_since_restore": 137793, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 50.980645161290326, "ram_util_percent": 19.193548387096765}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.14079730729314208, "episode_len_mean": 444.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.14079730729314208}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.198151060583846, "avg_speed_min": 1.2290908872073438, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.31, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6177891528949504, "mean_processing_ms": 2.9639585408441347, "mean_inference_ms": 0.5291988930097915}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 76338, "num_steps_trained": 6780600, "num_steps_sampled": 138793, "sample_time_ms": 3.43, "replay_time_ms": 16.155, "grad_time_ms": 14.771, "update_time_ms": 0.004, "opt_peak_throughput": 6769.865, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.647039413452148, "max_q": -5.001574993133545, "min_q": -31.939592361450195}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 138793, "episodes_total": 311, "training_iteration": 136, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-19-47", "timestamp": 1585801187, "time_this_iter_s": 9.486513614654541, "time_total_s": 3246.6148414611816, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543400>", "on_episode_step": "<function on_episode_step at 0x7f7d68543950>", "on_episode_end": "<function on_episode_end at 0x7f7d685439d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3246.6148414611816, "timesteps_since_restore": 138793, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 40.33571428571429, "ram_util_percent": 17.81428571428572}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.14080416975645169, "episode_len_mean": 444.23, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.14080416975645169}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.206062486385658, "avg_speed_min": 1.2290908872073438, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.22, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6138409951788453, "mean_processing_ms": 2.962687940845982, "mean_inference_ms": 0.5269213037279968}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 76492, "num_steps_trained": 6796000, "num_steps_sampled": 139801, "sample_time_ms": 144.521, "replay_time_ms": 14.223, "grad_time_ms": 14.808, "update_time_ms": 0.004, "opt_peak_throughput": 6753.243, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.04642677307129, "max_q": -7.843730449676514, "min_q": -29.708698272705078}}}, "timesteps_this_iter": 1008, "done": false, "timesteps_total": 139801, "episodes_total": 313, "training_iteration": 137, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-19-55", "timestamp": 1585801195, "time_this_iter_s": 8.032810926437378, "time_total_s": 3254.647652387619, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543620>", "on_episode_step": "<function on_episode_step at 0x7f7d68543a60>", "on_episode_end": "<function on_episode_end at 0x7f7d68778a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687786a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3254.647652387619, "timesteps_since_restore": 139801, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 41.77272727272728, "ram_util_percent": 17.83636363636364}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.16388205704791875, "episode_len_mean": 452.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.16388205704791875}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.183629602901196, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 216.46, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.609979673820839, "mean_processing_ms": 2.9611124645114684, "mean_inference_ms": 0.5247244367260745}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 77015, "num_steps_trained": 6848300, "num_steps_sampled": 140801, "sample_time_ms": 3.406, "replay_time_ms": 13.617, "grad_time_ms": 14.038, "update_time_ms": 0.004, "opt_peak_throughput": 7123.502, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.709451675415039, "max_q": -7.3010358810424805, "min_q": -33.113609313964844}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 140801, "episodes_total": 315, "training_iteration": 138, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-20-15", "timestamp": 1585801215, "time_this_iter_s": 19.921385288238525, "time_total_s": 3274.5690376758575, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569b70>", "on_episode_step": "<function on_episode_step at 0x7f7d68569840>", "on_episode_end": "<function on_episode_end at 0x7f7d68569c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3274.5690376758575, "timesteps_since_restore": 140801, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 43.28928571428571, "ram_util_percent": 17.878571428571426}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.16461166369502309, "episode_len_mean": 452.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.16461166369502309}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.186491296291791, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 216.35, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6060246667006777, "mean_processing_ms": 2.959465982406928, "mean_inference_ms": 0.5224791351477103}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 77201, "num_steps_trained": 6866900, "num_steps_sampled": 141801, "sample_time_ms": 145.884, "replay_time_ms": 19.156, "grad_time_ms": 15.586, "update_time_ms": 0.004, "opt_peak_throughput": 6416.154, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.088909149169922, "max_q": -4.844379901885986, "min_q": -37.34900665283203}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 141801, "episodes_total": 317, "training_iteration": 139, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-20-24", "timestamp": 1585801224, "time_this_iter_s": 9.19799017906189, "time_total_s": 3283.7670278549194, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b5ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d685b5c80>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b5ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3283.7670278549194, "timesteps_since_restore": 141801, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 43.43846153846154, "ram_util_percent": 17.900000000000002}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.998789580842382, "episode_reward_mean": 0.17206202232032125, "episode_len_mean": 452.08, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998789580842382}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.17206202232032125}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.18927487939192, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 215.94, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.6021294270167565, "mean_processing_ms": 2.9578467328689215, "mean_inference_ms": 0.5202480400882333}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 77715, "num_steps_trained": 6918300, "num_steps_sampled": 142801, "sample_time_ms": 3.042, "replay_time_ms": 12.7, "grad_time_ms": 12.687, "update_time_ms": 0.004, "opt_peak_throughput": 7881.852, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.513249397277832, "max_q": -5.69363260269165, "min_q": -39.46726989746094}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 142801, "episodes_total": 319, "training_iteration": 140, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-20-44", "timestamp": 1585801244, "time_this_iter_s": 19.698214530944824, "time_total_s": 3303.4652423858643, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684d6598>", "on_episode_step": "<function on_episode_step at 0x7f7d684d6620>", "on_episode_end": "<function on_episode_end at 0x7f7d684d66a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684d6730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3303.4652423858643, "timesteps_since_restore": 142801, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 41.28965517241379, "ram_util_percent": 17.9}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9981176617764835, "episode_reward_mean": 0.19162797835076148, "episode_len_mean": 452.05, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9981176617764835}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.19162797835076148}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2143942096827205, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 213.19, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5963134054125192, "mean_processing_ms": 2.9554959552324878, "mean_inference_ms": 0.516924912699209}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 77977, "num_steps_trained": 6944500, "num_steps_sampled": 143865, "sample_time_ms": 135.904, "replay_time_ms": 13.534, "grad_time_ms": 14.373, "update_time_ms": 0.004, "opt_peak_throughput": 6957.274, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15.390528678894043, "max_q": -6.620641708374023, "min_q": -32.99641799926758}}}, "timesteps_this_iter": 1064, "done": false, "timesteps_total": 143865, "episodes_total": 322, "training_iteration": 141, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-20-57", "timestamp": 1585801257, "time_this_iter_s": 13.02357816696167, "time_total_s": 3316.488820552826, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68536d90>", "on_episode_step": "<function on_episode_step at 0x7f7d68536d08>", "on_episode_end": "<function on_episode_end at 0x7f7d68536c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3316.488820552826, "timesteps_since_restore": 143865, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 41.416666666666664, "ram_util_percent": 17.899999999999995}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9981176617764835, "episode_reward_mean": 0.2052960884719052, "episode_len_mean": 448.63, "episodes_this_iter": 4, "policy_reward_min": {"av": -2.9981176617764835}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.2052960884719052}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.24672845658445, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 209.51, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5885968362924248, "mean_processing_ms": 2.952356678708365, "mean_inference_ms": 0.5125306259733248}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 78278, "num_steps_trained": 6974600, "num_steps_sampled": 145120, "sample_time_ms": 143.388, "replay_time_ms": 14.163, "grad_time_ms": 14.109, "update_time_ms": 0.004, "opt_peak_throughput": 7087.463, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.1959285736084, "max_q": -8.342473030090332, "min_q": -32.57594299316406}}}, "timesteps_this_iter": 1255, "done": false, "timesteps_total": 145120, "episodes_total": 326, "training_iteration": 142, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-21-12", "timestamp": 1585801272, "time_this_iter_s": 15.550657749176025, "time_total_s": 3332.039478302002, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686619d8>", "on_episode_step": "<function on_episode_step at 0x7f7d686617b8>", "on_episode_end": "<function on_episode_end at 0x7f7d685b58c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b5730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3332.039478302002, "timesteps_since_restore": 145120, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 41.349999999999994, "ram_util_percent": 17.89999999999999}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9985809196964746, "episode_reward_mean": 0.17011327251603856, "episode_len_mean": 444.58, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9985809196964746}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.17011327251603856}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.232816054610555, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.57, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.582872289896716, "mean_processing_ms": 2.9502555669346258, "mean_inference_ms": 0.5092692923582567}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 78502, "num_steps_trained": 6997000, "num_steps_sampled": 146218, "sample_time_ms": 141.208, "replay_time_ms": 13.341, "grad_time_ms": 13.333, "update_time_ms": 0.004, "opt_peak_throughput": 7500.021, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.881351470947266, "max_q": -6.247802257537842, "min_q": -33.521324157714844}}}, "timesteps_this_iter": 1098, "done": false, "timesteps_total": 146218, "episodes_total": 329, "training_iteration": 143, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-21-24", "timestamp": 1585801284, "time_this_iter_s": 11.769371747970581, "time_total_s": 3343.8088500499725, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569b70>", "on_episode_step": "<function on_episode_step at 0x7f7d68569158>", "on_episode_end": "<function on_episode_end at 0x7f7d68569bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685369d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3343.8088500499725, "timesteps_since_restore": 146218, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 41.64117647058824, "ram_util_percent": 17.9}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9985809196964746, "episode_reward_mean": 0.16980976981327447, "episode_len_mean": 444.58, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9985809196964746}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.16980976981327447}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.217812916140023, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 213.95, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5791512742148177, "mean_processing_ms": 2.9489208249457994, "mean_inference_ms": 0.5071648676548307}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 78844, "num_steps_trained": 7031200, "num_steps_sampled": 147221, "sample_time_ms": 143.766, "replay_time_ms": 13.034, "grad_time_ms": 14.061, "update_time_ms": 0.004, "opt_peak_throughput": 7111.654, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.988815307617188, "max_q": -8.657588958740234, "min_q": -29.125192642211914}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 147221, "episodes_total": 331, "training_iteration": 144, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-21-38", "timestamp": 1585801298, "time_this_iter_s": 14.201179027557373, "time_total_s": 3358.01002907753, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d68569840>", "on_episode_end": "<function on_episode_end at 0x7f7d685699d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3358.01002907753, "timesteps_since_restore": 147221, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 41.025, "ram_util_percent": 17.899999999999995}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9985809196964746, "episode_reward_mean": 0.16968039493107281, "episode_len_mean": 444.58, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9985809196964746}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.16968039493107281}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.21918916754594, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 214.12, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5754876048886104, "mean_processing_ms": 2.9476247585523545, "mean_inference_ms": 0.5050937543538827}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 79053, "num_steps_trained": 7052100, "num_steps_sampled": 148221, "sample_time_ms": 139.352, "replay_time_ms": 17.242, "grad_time_ms": 16.191, "update_time_ms": 0.004, "opt_peak_throughput": 6176.423, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.546586990356445, "max_q": -8.757804870605469, "min_q": -32.93330383300781}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 148221, "episodes_total": 333, "training_iteration": 145, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-21-49", "timestamp": 1585801309, "time_this_iter_s": 10.168904542922974, "time_total_s": 3368.178933620453, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685366a8>", "on_episode_step": "<function on_episode_step at 0x7f7d68536730>", "on_episode_end": "<function on_episode_end at 0x7f7d685367b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68536b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3368.178933620453, "timesteps_since_restore": 148221, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 40.873333333333335, "ram_util_percent": 17.9}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9985809196964746, "episode_reward_mean": 0.16975799309727044, "episode_len_mean": 444.58, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9985809196964746}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.16975799309727044}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.226687809121356, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 213.96, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5718522615813544, "mean_processing_ms": 2.946352317065273, "mean_inference_ms": 0.5030537213971722}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 79243, "num_steps_trained": 7071100, "num_steps_sampled": 149221, "sample_time_ms": 140.705, "replay_time_ms": 18.747, "grad_time_ms": 15.076, "update_time_ms": 0.004, "opt_peak_throughput": 6632.936, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.93816566467285, "max_q": -8.347322463989258, "min_q": -32.74205780029297}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 149221, "episodes_total": 335, "training_iteration": 146, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-21-58", "timestamp": 1585801318, "time_this_iter_s": 9.513663053512573, "time_total_s": 3377.6925966739655, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d68569158>", "on_episode_end": "<function on_episode_end at 0x7f7d68569400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3377.6925966739655, "timesteps_since_restore": 149221, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 44.18461538461539, "ram_util_percent": 17.923076923076927}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9985809196964746, "episode_reward_mean": 0.17041444549529147, "episode_len_mean": 444.58, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9985809196964746}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.17041444549529147}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.252317579698565, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.59, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5682290646749266, "mean_processing_ms": 2.945096474086579, "mean_inference_ms": 0.5010247294696576}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 79440, "num_steps_trained": 7090800, "num_steps_sampled": 150221, "sample_time_ms": 146.24, "replay_time_ms": 15.856, "grad_time_ms": 16.68, "update_time_ms": 0.005, "opt_peak_throughput": 5995.237, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.987640380859375, "max_q": -5.1057610511779785, "min_q": -31.80254364013672}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 150221, "episodes_total": 337, "training_iteration": 147, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-22-08", "timestamp": 1585801328, "time_this_iter_s": 9.535764217376709, "time_total_s": 3387.228360891342, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543730>", "on_episode_step": "<function on_episode_step at 0x7f7d68543950>", "on_episode_end": "<function on_episode_end at 0x7f7d68543bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3387.228360891342, "timesteps_since_restore": 150221, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 40.41428571428571, "ram_util_percent": 17.92142857142857}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5681098451115114, "episode_reward_min": -2.9985809196964746, "episode_reward_mean": 0.1701685801683461, "episode_len_mean": 444.58, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9985809196964746}, "policy_reward_max": {"av": 0.5681098451115114}, "policy_reward_mean": {"av": 0.1701685801683461}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.247273375071849, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.6, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5646554572533302, "mean_processing_ms": 2.943871213994811, "mean_inference_ms": 0.49902895448233225}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 79655, "num_steps_trained": 7112300, "num_steps_sampled": 151221, "sample_time_ms": 147.846, "replay_time_ms": 15.648, "grad_time_ms": 13.595, "update_time_ms": 0.004, "opt_peak_throughput": 7355.847, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.784914016723633, "max_q": -7.1961445808410645, "min_q": -31.207326889038086}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 151221, "episodes_total": 339, "training_iteration": 148, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-22-18", "timestamp": 1585801338, "time_this_iter_s": 10.278165578842163, "time_total_s": 3397.5065264701843, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569bf8>", "on_episode_step": "<function on_episode_step at 0x7f7d68569c80>", "on_episode_end": "<function on_episode_end at 0x7f7d68569d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569f28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3397.5065264701843, "timesteps_since_restore": 151221, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 41.949999999999996, "ram_util_percent": 17.95}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5716979833504291, "episode_reward_min": -2.9985809196964746, "episode_reward_mean": 0.17101745976181473, "episode_len_mean": 444.69, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9985809196964746}, "policy_reward_max": {"av": 0.5716979833504291}, "policy_reward_mean": {"av": 0.17101745976181473}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2561682335448054, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.1, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5593742125311782, "mean_processing_ms": 2.9421901999514, "mean_inference_ms": 0.4961018343028917}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 79873, "num_steps_trained": 7134100, "num_steps_sampled": 152330, "sample_time_ms": 145.037, "replay_time_ms": 13.761, "grad_time_ms": 14.812, "update_time_ms": 0.004, "opt_peak_throughput": 6751.275, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.508251190185547, "max_q": -9.119800567626953, "min_q": -28.148183822631836}}}, "timesteps_this_iter": 1109, "done": false, "timesteps_total": 152330, "episodes_total": 342, "training_iteration": 149, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-22-29", "timestamp": 1585801349, "time_this_iter_s": 11.382828712463379, "time_total_s": 3408.8893551826477, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684cd730>", "on_episode_step": "<function on_episode_step at 0x7f7d684cd7b8>", "on_episode_end": "<function on_episode_end at 0x7f7d684cd840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684cd8c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3408.8893551826477, "timesteps_since_restore": 152330, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 40.970588235294116, "ram_util_percent": 17.976470588235294}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5716979833504291, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.136599982858579, "episode_len_mean": 440.66, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5716979833504291}, "policy_reward_mean": {"av": 0.136599982858579}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.270172490909671, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 214.75, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5541253994829571, "mean_processing_ms": 2.940540530313941, "mean_inference_ms": 0.4932088205436251}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 80058, "num_steps_trained": 7152600, "num_steps_sampled": 153426, "sample_time_ms": 144.347, "replay_time_ms": 15.481, "grad_time_ms": 14.641, "update_time_ms": 0.004, "opt_peak_throughput": 6830.358, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16.062789916992188, "max_q": -6.057229995727539, "min_q": -27.916793823242188}}}, "timesteps_this_iter": 1096, "done": false, "timesteps_total": 153426, "episodes_total": 345, "training_iteration": 150, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-22-40", "timestamp": 1585801360, "time_this_iter_s": 10.431320667266846, "time_total_s": 3419.3206758499146, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778a60>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9158>", "on_episode_end": "<function on_episode_end at 0x7f7d685f9a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3419.3206758499146, "timesteps_since_restore": 153426, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 38.54, "ram_util_percent": 17.993333333333332}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5716979833504291, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.14285683438434782, "episode_len_mean": 440.66, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5716979833504291}, "policy_reward_mean": {"av": 0.14285683438434782}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.288541418584637, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.289863749976157, "avg_rl_veh_arrival_mean": 212.94, "avg_rl_veh_arrival_min": 83.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5506633095660556, "mean_processing_ms": 2.939314781392348, "mean_inference_ms": 0.4913127407022948}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 80411, "num_steps_trained": 7187900, "num_steps_sampled": 154427, "sample_time_ms": 147.454, "replay_time_ms": 15.381, "grad_time_ms": 14.818, "update_time_ms": 0.004, "opt_peak_throughput": 6748.332, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.08146095275879, "max_q": -7.579451084136963, "min_q": -36.56931686401367}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 154427, "episodes_total": 347, "training_iteration": 151, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-22-54", "timestamp": 1585801374, "time_this_iter_s": 14.714517831802368, "time_total_s": 3434.035193681717, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d68629f28>", "on_episode_end": "<function on_episode_end at 0x7f7d684bdd90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684bda60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3434.035193681717, "timesteps_since_restore": 154427, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 42.26190476190476, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5716979833504291, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.14170321933934418, "episode_len_mean": 444.9, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5716979833504291}, "policy_reward_mean": {"av": 0.14170321933934418}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.283761116337584, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.31304705559272, "avg_rl_veh_arrival_mean": 216.95, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5454623271549093, "mean_processing_ms": 2.9373770411917404, "mean_inference_ms": 0.488469066462165}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 80946, "num_steps_trained": 7241400, "num_steps_sampled": 155522, "sample_time_ms": 143.905, "replay_time_ms": 16.04, "grad_time_ms": 16.112, "update_time_ms": 0.005, "opt_peak_throughput": 6206.658, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.50172233581543, "max_q": -10.068548202514648, "min_q": -38.268882751464844}}}, "timesteps_this_iter": 1095, "done": false, "timesteps_total": 155522, "episodes_total": 350, "training_iteration": 152, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-23-17", "timestamp": 1585801397, "time_this_iter_s": 22.228349924087524, "time_total_s": 3456.2635436058044, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f6d08>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6d90>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3456.2635436058044, "timesteps_since_restore": 155522, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 43.86774193548386, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5716979833504291, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.16599213081358927, "episode_len_mean": 448.97, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5716979833504291}, "policy_reward_mean": {"av": 0.16599213081358927}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.258901404706804, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.31304705559272, "avg_rl_veh_arrival_mean": 216.76, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5420829266268794, "mean_processing_ms": 2.9359701763675905, "mean_inference_ms": 0.4866309316057697}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 81496, "num_steps_trained": 7296400, "num_steps_sampled": 156531, "sample_time_ms": 142.134, "replay_time_ms": 16.209, "grad_time_ms": 14.556, "update_time_ms": 0.004, "opt_peak_throughput": 6870.108, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.234861373901367, "max_q": -3.5229337215423584, "min_q": -36.59880065917969}}}, "timesteps_this_iter": 1009, "done": false, "timesteps_total": 156531, "episodes_total": 352, "training_iteration": 153, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-23-38", "timestamp": 1585801418, "time_this_iter_s": 20.961711883544922, "time_total_s": 3477.2252554893494, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d701266a8>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6ae8>", "on_episode_end": "<function on_episode_end at 0x7f7d684f66a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f61e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3477.2252554893494, "timesteps_since_restore": 156531, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 41.86333333333333, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5716979833504291, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.16516511254706098, "episode_len_mean": 448.97, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5716979833504291}, "policy_reward_mean": {"av": 0.16516511254706098}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.275463984778989, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.31304705559272, "avg_rl_veh_arrival_mean": 216.59, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5386837110513607, "mean_processing_ms": 2.934542335361668, "mean_inference_ms": 0.48478527529612997}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 81716, "num_steps_trained": 7318400, "num_steps_sampled": 157543, "sample_time_ms": 141.789, "replay_time_ms": 13.961, "grad_time_ms": 13.103, "update_time_ms": 0.004, "opt_peak_throughput": 7632.057, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.88051986694336, "max_q": -8.46284008026123, "min_q": -38.074432373046875}}}, "timesteps_this_iter": 1012, "done": false, "timesteps_total": 157543, "episodes_total": 354, "training_iteration": 154, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-23-48", "timestamp": 1585801428, "time_this_iter_s": 10.418080806732178, "time_total_s": 3487.6433362960815, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f6d08>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6048>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6510>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3487.6433362960815, "timesteps_since_restore": 157543, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 41.44666666666667, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5716979833504291, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.13105799068363716, "episode_len_mean": 444.83, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5716979833504291}, "policy_reward_mean": {"av": 0.13105799068363716}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.309773811022894, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.31304705559272, "avg_rl_veh_arrival_mean": 218.74, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5336454458938389, "mean_processing_ms": 2.9326306216299214, "mean_inference_ms": 0.4820551446513768}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 81874, "num_steps_trained": 7334200, "num_steps_sampled": 158617, "sample_time_ms": 146.254, "replay_time_ms": 14.73, "grad_time_ms": 15.186, "update_time_ms": 0.004, "opt_peak_throughput": 6585.054, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.833158493041992, "max_q": -8.171610832214355, "min_q": -36.89292907714844}}}, "timesteps_this_iter": 1074, "done": false, "timesteps_total": 158617, "episodes_total": 357, "training_iteration": 155, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-23-58", "timestamp": 1585801438, "time_this_iter_s": 9.381007194519043, "time_total_s": 3497.0243434906006, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f61e0>", "on_episode_step": "<function on_episode_step at 0x7f7d684f66a8>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3497.0243434906006, "timesteps_since_restore": 158617, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 39.44615384615384, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.13102269319032273, "episode_len_mean": 441.29, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.13102269319032273}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.313101059285405, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.497475710022785, "avg_rl_veh_arrival_mean": 218.56, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.528777791201637, "mean_processing_ms": 2.9309882866399426, "mean_inference_ms": 0.47942976020163763}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 82135, "num_steps_trained": 7360300, "num_steps_sampled": 159765, "sample_time_ms": 146.512, "replay_time_ms": 15.637, "grad_time_ms": 15.111, "update_time_ms": 0.004, "opt_peak_throughput": 6617.793, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.40508270263672, "max_q": -8.104552268981934, "min_q": -34.89976119995117}}}, "timesteps_this_iter": 1148, "done": false, "timesteps_total": 159765, "episodes_total": 360, "training_iteration": 156, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-24-11", "timestamp": 1585801451, "time_this_iter_s": 13.015424489974976, "time_total_s": 3510.0397679805756, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d70081400>", "on_episode_step": "<function on_episode_step at 0x7f7d70081b70>", "on_episode_end": "<function on_episode_end at 0x7f7d68778378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687786a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3510.0397679805756, "timesteps_since_restore": 159765, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 39.78947368421052, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.13139984142736677, "episode_len_mean": 441.29, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.13139984142736677}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.318672548002732, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.497475710022785, "avg_rl_veh_arrival_mean": 218.25, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5255934233204107, "mean_processing_ms": 2.929934208446523, "mean_inference_ms": 0.4777127090972128}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 82342, "num_steps_trained": 7381000, "num_steps_sampled": 160766, "sample_time_ms": 143.542, "replay_time_ms": 15.763, "grad_time_ms": 14.71, "update_time_ms": 0.004, "opt_peak_throughput": 6798.076, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.1011905670166, "max_q": -5.949201583862305, "min_q": -35.304420471191406}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 160766, "episodes_total": 362, "training_iteration": 157, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-24-21", "timestamp": 1585801461, "time_this_iter_s": 9.928672552108765, "time_total_s": 3519.9684405326843, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685432f0>", "on_episode_step": "<function on_episode_step at 0x7f7d68543400>", "on_episode_end": "<function on_episode_end at 0x7f7d68543730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3519.9684405326843, "timesteps_since_restore": 160766, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 43.357142857142854, "ram_util_percent": 18.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.12388523288559947, "episode_len_mean": 441.29, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.12388523288559947}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.276639320498935, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.497475710022785, "avg_rl_veh_arrival_mean": 221.67, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5225103729124958, "mean_processing_ms": 2.9289246541839224, "mean_inference_ms": 0.4760479806575053}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 82893, "num_steps_trained": 7436100, "num_steps_sampled": 161766, "sample_time_ms": 3.947, "replay_time_ms": 14.911, "grad_time_ms": 18.328, "update_time_ms": 0.005, "opt_peak_throughput": 5456.211, "opt_samples": 100.0, "learner": {"av": {"mean_q": -17.78541374206543, "max_q": -8.394142150878906, "min_q": -37.35926818847656}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 161766, "episodes_total": 364, "training_iteration": 158, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-24-42", "timestamp": 1585801482, "time_this_iter_s": 21.24059534072876, "time_total_s": 3541.209035873413, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569598>", "on_episode_step": "<function on_episode_step at 0x7f7d68569b70>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3541.209035873413, "timesteps_since_restore": 161766, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 42.84, "ram_util_percent": 18.053333333333335}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.10859940693998434, "episode_len_mean": 437.33, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10859940693998434}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.283235518062749, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.497475710022785, "avg_rl_veh_arrival_mean": 220.56, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.517963952106711, "mean_processing_ms": 2.9276260731677013, "mean_inference_ms": 0.4735938427133389}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 83119, "num_steps_trained": 7458700, "num_steps_sampled": 162869, "sample_time_ms": 143.218, "replay_time_ms": 17.376, "grad_time_ms": 18.033, "update_time_ms": 0.004, "opt_peak_throughput": 5545.534, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.264644622802734, "max_q": -7.557277679443359, "min_q": -37.55907440185547}}}, "timesteps_this_iter": 1103, "done": false, "timesteps_total": 162869, "episodes_total": 367, "training_iteration": 159, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-24-54", "timestamp": 1585801494, "time_this_iter_s": 11.950321197509766, "time_total_s": 3553.159357070923, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d686617b8>", "on_episode_end": "<function on_episode_end at 0x7f7d68661488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d70081400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3553.159357070923, "timesteps_since_restore": 162869, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 43.45882352941177, "ram_util_percent": 18.094117647058823}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.0174606435539113, "episode_reward_mean": 0.15913737262486716, "episode_len_mean": 441.45, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0174606435539113}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.15913737262486716}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.3227836936978425, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.497475710022785, "avg_rl_veh_arrival_mean": 214.19, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5148495351737459, "mean_processing_ms": 2.9267653461018033, "mean_inference_ms": 0.4719208281894504}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 83359, "num_steps_trained": 7482700, "num_steps_sampled": 163869, "sample_time_ms": 144.9, "replay_time_ms": 14.992, "grad_time_ms": 14.072, "update_time_ms": 0.004, "opt_peak_throughput": 7106.376, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.290969848632812, "max_q": -8.802298545837402, "min_q": -36.65791702270508}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 163869, "episodes_total": 369, "training_iteration": 160, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-25-05", "timestamp": 1585801505, "time_this_iter_s": 10.928166627883911, "time_total_s": 3564.0875236988068, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684bdf28>", "on_episode_step": "<function on_episode_step at 0x7f7d684bdea0>", "on_episode_end": "<function on_episode_end at 0x7f7d684bd9d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685b5d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3564.0875236988068, "timesteps_since_restore": 163869, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 41.212500000000006, "ram_util_percent": 18.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.14678742783614168, "episode_len_mean": 441.51, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.14678742783614168}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.3323593951610375, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.62359162923336, "avg_rl_veh_arrival_mean": 217.46, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5103147759474138, "mean_processing_ms": 2.9252680365420254, "mean_inference_ms": 0.46949476120463757}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 83906, "num_steps_trained": 7537400, "num_steps_sampled": 164972, "sample_time_ms": 143.73, "replay_time_ms": 13.38, "grad_time_ms": 13.95, "update_time_ms": 0.004, "opt_peak_throughput": 7168.207, "opt_samples": 100.0, "learner": {"av": {"mean_q": -18.460617065429688, "max_q": -6.725651264190674, "min_q": -37.89796829223633}}}, "timesteps_this_iter": 1103, "done": false, "timesteps_total": 164972, "episodes_total": 372, "training_iteration": 161, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-25-27", "timestamp": 1585801527, "time_this_iter_s": 22.343165159225464, "time_total_s": 3586.430688858032, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f69d8>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6158>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3586.430688858032, "timesteps_since_restore": 164972, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 42.10625, "ram_util_percent": 18.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.14440945170630498, "episode_len_mean": 445.24, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.14440945170630498}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.297446193348256, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.62359162923336, "avg_rl_veh_arrival_mean": 221.1, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5073176087709788, "mean_processing_ms": 2.924193456853804, "mean_inference_ms": 0.4679014349929491}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 84460, "num_steps_trained": 7592800, "num_steps_sampled": 165995, "sample_time_ms": 144.411, "replay_time_ms": 14.653, "grad_time_ms": 15.601, "update_time_ms": 0.005, "opt_peak_throughput": 6409.888, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.079608917236328, "max_q": -8.103316307067871, "min_q": -41.54669952392578}}}, "timesteps_this_iter": 1023, "done": false, "timesteps_total": 165995, "episodes_total": 374, "training_iteration": 162, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-25-49", "timestamp": 1585801549, "time_this_iter_s": 21.311505794525146, "time_total_s": 3607.7421946525574, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9510>", "on_episode_step": "<function on_episode_step at 0x7f7d72072d08>", "on_episode_end": "<function on_episode_end at 0x7f7d72072d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68661ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3607.7421946525574, "timesteps_since_restore": 165995, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 42.01333333333332, "ram_util_percent": 18.100000000000005}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.14505702457311284, "episode_len_mean": 445.24, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.14505702457311284}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.306280197102329, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.62359162923336, "avg_rl_veh_arrival_mean": 221.38, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5043008589333215, "mean_processing_ms": 2.9230348953314, "mean_inference_ms": 0.46630512881107317}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 84675, "num_steps_trained": 7614300, "num_steps_sampled": 166995, "sample_time_ms": 141.537, "replay_time_ms": 18.269, "grad_time_ms": 16.187, "update_time_ms": 0.005, "opt_peak_throughput": 6177.87, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.594940185546875, "max_q": -7.6163716316223145, "min_q": -37.59039306640625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 166995, "episodes_total": 376, "training_iteration": 163, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-25-59", "timestamp": 1585801559, "time_this_iter_s": 10.06906533241272, "time_total_s": 3617.81125998497, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68661400>", "on_episode_step": "<function on_episode_step at 0x7f7d68661598>", "on_episode_end": "<function on_episode_end at 0x7f7d686617b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68661488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3617.81125998497, "timesteps_since_restore": 166995, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 39.33571428571428, "ram_util_percent": 18.099999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.14553668999546687, "episode_len_mean": 445.24, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.14553668999546687}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.3263485271807465, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.62359162923336, "avg_rl_veh_arrival_mean": 220.53, "avg_rl_veh_arrival_min": 96.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.5013013950613696, "mean_processing_ms": 2.9218955756489335, "mean_inference_ms": 0.46472481039864455}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 84869, "num_steps_trained": 7633700, "num_steps_sampled": 167995, "sample_time_ms": 144.912, "replay_time_ms": 21.053, "grad_time_ms": 17.74, "update_time_ms": 0.005, "opt_peak_throughput": 5636.922, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.154788970947266, "max_q": -10.897828102111816, "min_q": -45.221195220947266}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 167995, "episodes_total": 378, "training_iteration": 164, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-26-08", "timestamp": 1585801568, "time_this_iter_s": 9.384524583816528, "time_total_s": 3627.1957845687866, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629e18>", "on_episode_step": "<function on_episode_step at 0x7f7d68629ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d686291e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3627.1957845687866, "timesteps_since_restore": 167995, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 40.59285714285715, "ram_util_percent": 18.099999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.11847514714437328, "episode_len_mean": 445.33, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.11847514714437328}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.293289142705181, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.62359162923336, "avg_rl_veh_arrival_mean": 227.31, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4969113023961866, "mean_processing_ms": 2.920176794582489, "mean_inference_ms": 0.4624216510593457}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 85425, "num_steps_trained": 7689300, "num_steps_sampled": 169090, "sample_time_ms": 148.044, "replay_time_ms": 16.344, "grad_time_ms": 15.831, "update_time_ms": 0.005, "opt_peak_throughput": 6316.751, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.118919372558594, "max_q": -9.353822708129883, "min_q": -45.88748550415039}}}, "timesteps_this_iter": 1095, "done": false, "timesteps_total": 169090, "episodes_total": 381, "training_iteration": 165, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-26-31", "timestamp": 1585801591, "time_this_iter_s": 22.62816286087036, "time_total_s": 3649.823947429657, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629510>", "on_episode_step": "<function on_episode_step at 0x7f7d68629bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d68629598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3649.823947429657, "timesteps_since_restore": 169090, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 43.94375, "ram_util_percent": 18.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.11867145561801273, "episode_len_mean": 445.33, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.11867145561801273}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.300969385444926, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 227.38, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.494020872934903, "mean_processing_ms": 2.9190666499186047, "mean_inference_ms": 0.4609082622418146}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 85598, "num_steps_trained": 7706600, "num_steps_sampled": 170094, "sample_time_ms": 144.691, "replay_time_ms": 14.085, "grad_time_ms": 14.077, "update_time_ms": 0.005, "opt_peak_throughput": 7103.849, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.1003475189209, "max_q": -8.436113357543945, "min_q": -36.740272521972656}}}, "timesteps_this_iter": 1004, "done": false, "timesteps_total": 170094, "episodes_total": 383, "training_iteration": 166, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-26-39", "timestamp": 1585801599, "time_this_iter_s": 8.59175729751587, "time_total_s": 3658.415704727173, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b50d0>", "on_episode_step": "<function on_episode_step at 0x7f7d685b5950>", "on_episode_end": "<function on_episode_end at 0x7f7d685b5a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68644158>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3658.415704727173, "timesteps_since_restore": 170094, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 42.074999999999996, "ram_util_percent": 18.116666666666664}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.12054129684832274, "episode_len_mean": 445.33, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.12054129684832274}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.34574550126559, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 225.14, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4911138123058074, "mean_processing_ms": 2.9179664623311083, "mean_inference_ms": 0.45939077458794086}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 85771, "num_steps_trained": 7723900, "num_steps_sampled": 171099, "sample_time_ms": 147.64, "replay_time_ms": 14.798, "grad_time_ms": 15.193, "update_time_ms": 0.004, "opt_peak_throughput": 6581.82, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.869850158691406, "max_q": -10.433327674865723, "min_q": -49.258094787597656}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 171099, "episodes_total": 385, "training_iteration": 167, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-26-48", "timestamp": 1585801608, "time_this_iter_s": 8.654194593429565, "time_total_s": 3667.0698993206024, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a158>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a2f0>", "on_episode_end": "<function on_episode_end at 0x7f7d6868ae18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3667.0698993206024, "timesteps_since_restore": 171099, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 40.075, "ram_util_percent": 18.141666666666662}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10643592200073099, "episode_len_mean": 441.34, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10643592200073099}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.335723054391017, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 224.06, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4882814029165952, "mean_processing_ms": 2.9169043655703764, "mean_inference_ms": 0.45791230410195993}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 86375, "num_steps_trained": 7784300, "num_steps_sampled": 172099, "sample_time_ms": 3.731, "replay_time_ms": 14.435, "grad_time_ms": 16.823, "update_time_ms": 0.004, "opt_peak_throughput": 5944.115, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.440086364746094, "max_q": -9.316749572753906, "min_q": -35.3826789855957}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 172099, "episodes_total": 387, "training_iteration": 168, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-27-11", "timestamp": 1585801631, "time_this_iter_s": 22.996519327163696, "time_total_s": 3690.066418647766, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684bd9d8>", "on_episode_step": "<function on_episode_step at 0x7f7d684bdd08>", "on_episode_end": "<function on_episode_end at 0x7f7d684bd400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684bdd90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3690.066418647766, "timesteps_since_restore": 172099, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 42.4060606060606, "ram_util_percent": 18.184848484848487}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10858488586376805, "episode_len_mean": 441.34, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10858488586376805}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.302792388361667, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 225.22, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.484119229975758, "mean_processing_ms": 2.9155305308489314, "mean_inference_ms": 0.4557456366588523}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 86671, "num_steps_trained": 7813900, "num_steps_sampled": 173184, "sample_time_ms": 143.223, "replay_time_ms": 13.528, "grad_time_ms": 14.127, "update_time_ms": 0.004, "opt_peak_throughput": 7078.719, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.6341552734375, "max_q": -9.047602653503418, "min_q": -42.441471099853516}}}, "timesteps_this_iter": 1085, "done": false, "timesteps_total": 173184, "episodes_total": 390, "training_iteration": 169, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-27-25", "timestamp": 1585801645, "time_this_iter_s": 14.041244983673096, "time_total_s": 3704.107663631439, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727950>", "on_episode_step": "<function on_episode_step at 0x7f7d68727b70>", "on_episode_end": "<function on_episode_end at 0x7f7d687270d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3704.107663631439, "timesteps_since_restore": 173184, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 43.17, "ram_util_percent": 18.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09582001651398865, "episode_len_mean": 437.38, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09582001651398865}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.24177749886073, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 227.84, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4814217935723162, "mean_processing_ms": 2.9146609072213376, "mean_inference_ms": 0.4543544899784233}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 87552, "num_steps_trained": 7902000, "num_steps_sampled": 174184, "sample_time_ms": 3.519, "replay_time_ms": 14.871, "grad_time_ms": 14.448, "update_time_ms": 0.004, "opt_peak_throughput": 6921.259, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.797006607055664, "max_q": -7.363651752471924, "min_q": -41.58097839355469}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 174184, "episodes_total": 392, "training_iteration": 170, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-27-57", "timestamp": 1585801677, "time_this_iter_s": 31.484941005706787, "time_total_s": 3735.592604637146, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d687f8bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d685536a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3735.592604637146, "timesteps_since_restore": 174184, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 42.062222222222225, "ram_util_percent": 18.200000000000006}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.06591533955159973, "episode_len_mean": 437.38, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.06591533955159973}, "custom_metrics": {"num_ped_collisions_mean": 0.07, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.176869899739553, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 233.32, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4774832694948394, "mean_processing_ms": 2.9135673601829253, "mean_inference_ms": 0.4523387002087671}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 88108, "num_steps_trained": 7957600, "num_steps_sampled": 175288, "sample_time_ms": 143.754, "replay_time_ms": 15.123, "grad_time_ms": 14.726, "update_time_ms": 0.004, "opt_peak_throughput": 6790.713, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.08435821533203, "max_q": -10.731107711791992, "min_q": -44.77865982055664}}}, "timesteps_this_iter": 1104, "done": false, "timesteps_total": 175288, "episodes_total": 395, "training_iteration": 171, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-28-19", "timestamp": 1585801699, "time_this_iter_s": 22.330970764160156, "time_total_s": 3757.923575401306, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684bdea0>", "on_episode_step": "<function on_episode_step at 0x7f7d684bd268>", "on_episode_end": "<function on_episode_end at 0x7f7d701cc048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701ccc80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3757.923575401306, "timesteps_since_restore": 175288, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 42.04375, "ram_util_percent": 18.2}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10232639834869, "episode_len_mean": 441.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10232639834869}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.207069705148719, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 229.39, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4748873985246533, "mean_processing_ms": 2.9127270633900246, "mean_inference_ms": 0.4510180499014751}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 88303, "num_steps_trained": 7977100, "num_steps_sampled": 176306, "sample_time_ms": 142.427, "replay_time_ms": 13.405, "grad_time_ms": 13.264, "update_time_ms": 0.003, "opt_peak_throughput": 7539.061, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.24199104309082, "max_q": -10.859822273254395, "min_q": -39.302978515625}}}, "timesteps_this_iter": 1018, "done": false, "timesteps_total": 176306, "episodes_total": 397, "training_iteration": 172, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-28-29", "timestamp": 1585801709, "time_this_iter_s": 9.544364929199219, "time_total_s": 3767.4679403305054, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a400>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a158>", "on_episode_end": "<function on_episode_end at 0x7f7d68553ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553620>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3767.4679403305054, "timesteps_since_restore": 176306, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 40.86923076923077, "ram_util_percent": 18.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10365587716360147, "episode_len_mean": 441.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10365587716360147}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.232731064514264, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 228.22, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4722721460303563, "mean_processing_ms": 2.9118680030698965, "mean_inference_ms": 0.4496890208394872}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 88527, "num_steps_trained": 7999500, "num_steps_sampled": 177306, "sample_time_ms": 144.811, "replay_time_ms": 16.512, "grad_time_ms": 14.613, "update_time_ms": 0.004, "opt_peak_throughput": 6842.995, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19.843416213989258, "max_q": -9.351755142211914, "min_q": -50.2588996887207}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 177306, "episodes_total": 399, "training_iteration": 173, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-28-39", "timestamp": 1585801719, "time_this_iter_s": 10.271036863327026, "time_total_s": 3777.7389771938324, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687270d0>", "on_episode_step": "<function on_episode_step at 0x7f7d687279d8>", "on_episode_end": "<function on_episode_end at 0x7f7d68727b70>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3777.7389771938324, "timesteps_since_restore": 177306, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 40.67333333333334, "ram_util_percent": 18.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10439777116265425, "episode_len_mean": 441.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10439777116265425}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.256747002207985, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 227.99, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.469675571075313, "mean_processing_ms": 2.91102776879648, "mean_inference_ms": 0.4483730915250787}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 88673, "num_steps_trained": 8014100, "num_steps_sampled": 178306, "sample_time_ms": 148.853, "replay_time_ms": 17.042, "grad_time_ms": 13.941, "update_time_ms": 0.005, "opt_peak_throughput": 7173.012, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.95319175720215, "max_q": -10.849366188049316, "min_q": -50.69059753417969}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 178306, "episodes_total": 401, "training_iteration": 174, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-28-47", "timestamp": 1585801727, "time_this_iter_s": 8.179012775421143, "time_total_s": 3785.9179899692535, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553158>", "on_episode_step": "<function on_episode_step at 0x7f7d685532f0>", "on_episode_end": "<function on_episode_end at 0x7f7d68553598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685536a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3785.9179899692535, "timesteps_since_restore": 178306, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 43.56666666666666, "ram_util_percent": 18.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10307938213832464, "episode_len_mean": 441.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10307938213832464}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.258538921649131, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 227.96, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4671012958545788, "mean_processing_ms": 2.910146344954184, "mean_inference_ms": 0.44707673894299105}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 88919, "num_steps_trained": 8038700, "num_steps_sampled": 179309, "sample_time_ms": 148.313, "replay_time_ms": 15.68, "grad_time_ms": 14.698, "update_time_ms": 0.004, "opt_peak_throughput": 6803.523, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.947006225585938, "max_q": -2.6865172386169434, "min_q": -48.571632385253906}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 179309, "episodes_total": 403, "training_iteration": 175, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-28-58", "timestamp": 1585801738, "time_this_iter_s": 11.081377744674683, "time_total_s": 3796.999367713928, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687f8ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d687f8620>", "on_episode_end": "<function on_episode_end at 0x7f7d701ccc80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d701cc268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3796.999367713928, "timesteps_since_restore": 179309, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 42.83333333333333, "ram_util_percent": 18.233333333333334}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.08567185214974136, "episode_len_mean": 441.09, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.08567185214974136}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.271440447055264, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 229.87, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4633114908410443, "mean_processing_ms": 2.9089047239938797, "mean_inference_ms": 0.44517090106567975}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 89446, "num_steps_trained": 8091400, "num_steps_sampled": 180400, "sample_time_ms": 144.828, "replay_time_ms": 13.307, "grad_time_ms": 14.171, "update_time_ms": 0.004, "opt_peak_throughput": 7056.9, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.468791961669922, "max_q": -10.360898971557617, "min_q": -42.14057922363281}}}, "timesteps_this_iter": 1091, "done": false, "timesteps_total": 180400, "episodes_total": 406, "training_iteration": 176, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-29-19", "timestamp": 1585801759, "time_this_iter_s": 21.075274229049683, "time_total_s": 3818.074641942978, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629598>", "on_episode_step": "<function on_episode_step at 0x7f7d68629bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d68629400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3818.074641942978, "timesteps_since_restore": 180400, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 38.816666666666656, "ram_util_percent": 17.256666666666668}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09820462591533785, "episode_len_mean": 441.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09820462591533785}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.311212335507192, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 226.72, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.460793055919922, "mean_processing_ms": 2.9080964563017373, "mean_inference_ms": 0.44390565043277364}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 89658, "num_steps_trained": 8112600, "num_steps_sampled": 181403, "sample_time_ms": 143.278, "replay_time_ms": 16.343, "grad_time_ms": 14.096, "update_time_ms": 0.005, "opt_peak_throughput": 7094.092, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.45289421081543, "max_q": -10.704648971557617, "min_q": -52.99024963378906}}}, "timesteps_this_iter": 1003, "done": false, "timesteps_total": 181403, "episodes_total": 408, "training_iteration": 177, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-29-29", "timestamp": 1585801769, "time_this_iter_s": 9.540839910507202, "time_total_s": 3827.615481853485, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71cb2a60>", "on_episode_step": "<function on_episode_step at 0x7f7d71cb2730>", "on_episode_end": "<function on_episode_end at 0x7f7d71cb2c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d71cb2d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3827.615481853485, "timesteps_since_restore": 181403, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 33.6, "ram_util_percent": 16.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09639631454429858, "episode_len_mean": 441.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09639631454429858}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.267453454491864, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 229.69, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4583185438244652, "mean_processing_ms": 2.907312323923145, "mean_inference_ms": 0.4426613931416547}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 90154, "num_steps_trained": 8162200, "num_steps_sampled": 182403, "sample_time_ms": 146.885, "replay_time_ms": 16.902, "grad_time_ms": 13.442, "update_time_ms": 0.004, "opt_peak_throughput": 7439.479, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.08807373046875, "max_q": -10.842442512512207, "min_q": -46.928863525390625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 182403, "episodes_total": 410, "training_iteration": 178, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-29-47", "timestamp": 1585801787, "time_this_iter_s": 18.674760580062866, "time_total_s": 3846.290242433548, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684bd7b8>", "on_episode_step": "<function on_episode_step at 0x7f7d684bdd08>", "on_episode_end": "<function on_episode_end at 0x7f7d684bd378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684bdea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3846.290242433548, "timesteps_since_restore": 182403, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 36.422222222222224, "ram_util_percent": 16.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09570732787974003, "episode_len_mean": 441.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09570732787974003}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.245259872057713, "avg_speed_min": 0.9620258250229446, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 230.29, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4558840174913348, "mean_processing_ms": 2.906552626776214, "mean_inference_ms": 0.44143633947350464}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 90345, "num_steps_trained": 8181300, "num_steps_sampled": 183404, "sample_time_ms": 145.345, "replay_time_ms": 13.726, "grad_time_ms": 13.164, "update_time_ms": 0.004, "opt_peak_throughput": 7596.491, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.860986709594727, "max_q": -10.977249145507812, "min_q": -55.10013961791992}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 183404, "episodes_total": 412, "training_iteration": 179, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-29-56", "timestamp": 1585801796, "time_this_iter_s": 8.987703084945679, "time_total_s": 3855.2779455184937, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f99d8>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9488>", "on_episode_end": "<function on_episode_end at 0x7f7d685f96a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3855.2779455184937, "timesteps_since_restore": 183404, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 33.80833333333333, "ram_util_percent": 16.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10314529887389831, "episode_len_mean": 441.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10314529887389831}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.288688422988165, "avg_speed_min": 0.992589401449478, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 227.12, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.453471110985982, "mean_processing_ms": 2.905807235754782, "mean_inference_ms": 0.44021549642214175}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 90542, "num_steps_trained": 8201000, "num_steps_sampled": 184404, "sample_time_ms": 140.716, "replay_time_ms": 13.104, "grad_time_ms": 12.153, "update_time_ms": 0.004, "opt_peak_throughput": 8228.53, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21.080183029174805, "max_q": -9.960074424743652, "min_q": -44.916831970214844}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 184404, "episodes_total": 414, "training_iteration": 180, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-30-06", "timestamp": 1585801806, "time_this_iter_s": 9.239645719528198, "time_total_s": 3864.517591238022, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553158>", "on_episode_step": "<function on_episode_step at 0x7f7d68553378>", "on_episode_end": "<function on_episode_end at 0x7f7d68553400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3864.517591238022, "timesteps_since_restore": 184404, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 34.192857142857136, "ram_util_percent": 16.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10262439725753161, "episode_len_mean": 441.09, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10262439725753161}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.28074995334398, "avg_speed_min": 0.992589401449478, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 227.63, "avg_rl_veh_arrival_min": 101.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4510734991130345, "mean_processing_ms": 2.9050717811508413, "mean_inference_ms": 0.4389984108392696}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 90759, "num_steps_trained": 8222700, "num_steps_sampled": 185405, "sample_time_ms": 143.86, "replay_time_ms": 13.557, "grad_time_ms": 12.943, "update_time_ms": 0.004, "opt_peak_throughput": 7726.238, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.032365798950195, "max_q": -10.648554801940918, "min_q": -47.62046432495117}}}, "timesteps_this_iter": 1001, "done": false, "timesteps_total": 185405, "episodes_total": 416, "training_iteration": 181, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-30-15", "timestamp": 1585801815, "time_this_iter_s": 9.682326316833496, "time_total_s": 3874.1999175548553, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a6a8>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a2f0>", "on_episode_end": "<function on_episode_end at 0x7f7d684bd8c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684bd048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3874.1999175548553, "timesteps_since_restore": 185405, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 34.2, "ram_util_percent": 16.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09071766009783026, "episode_len_mean": 437.08, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09071766009783026}, "custom_metrics": {"num_ped_collisions_mean": 0.06, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.310610229978371, "avg_speed_min": 0.992589401449478, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 223.68, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4474789060245723, "mean_processing_ms": 2.9041306300598784, "mean_inference_ms": 0.4371754688396879}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 90966, "num_steps_trained": 8243400, "num_steps_sampled": 186503, "sample_time_ms": 147.005, "replay_time_ms": 14.092, "grad_time_ms": 12.54, "update_time_ms": 0.003, "opt_peak_throughput": 7974.75, "opt_samples": 100.0, "learner": {"av": {"mean_q": -20.646554946899414, "max_q": -11.930384635925293, "min_q": -52.025970458984375}}}, "timesteps_this_iter": 1098, "done": false, "timesteps_total": 186503, "episodes_total": 419, "training_iteration": 182, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-30-26", "timestamp": 1585801826, "time_this_iter_s": 10.698718547821045, "time_total_s": 3884.8986361026764, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6868a488>", "on_episode_step": "<function on_episode_step at 0x7f7d6868ab70>", "on_episode_end": "<function on_episode_end at 0x7f7d6868ae18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3884.8986361026764, "timesteps_since_restore": 186503, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 31.856250000000003, "ram_util_percent": 16.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.12666310007331322, "episode_len_mean": 441.36, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.12666310007331322}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.35049225060992, "avg_speed_min": 0.992589401449478, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 219.94, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4451090646442681, "mean_processing_ms": 2.9034043988339335, "mean_inference_ms": 0.435976041790746}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 91123, "num_steps_trained": 8259100, "num_steps_sampled": 187503, "sample_time_ms": 3.581, "replay_time_ms": 14.412, "grad_time_ms": 14.275, "update_time_ms": 0.004, "opt_peak_throughput": 7005.264, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.427783966064453, "max_q": -11.961669921875, "min_q": -48.10331344604492}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 187503, "episodes_total": 421, "training_iteration": 183, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-30-34", "timestamp": 1585801834, "time_this_iter_s": 7.88962197303772, "time_total_s": 3892.788258075714, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc158>", "on_episode_step": "<function on_episode_step at 0x7f7d686cc2f0>", "on_episode_end": "<function on_episode_end at 0x7f7d686cc488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686cc8c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3892.788258075714, "timesteps_since_restore": 187503, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 32.79090909090908, "ram_util_percent": 16.5}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.10968089907158607, "episode_len_mean": 441.36, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.10968089907158607}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.268768844990588, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 226.04, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4427941099744743, "mean_processing_ms": 2.902579490004547, "mean_inference_ms": 0.43481824801499286}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 91989, "num_steps_trained": 8345700, "num_steps_sampled": 188503, "sample_time_ms": 120.461, "replay_time_ms": 14.684, "grad_time_ms": 13.788, "update_time_ms": 0.004, "opt_peak_throughput": 7252.491, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.200401306152344, "max_q": -13.12824535369873, "min_q": -51.653533935546875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 188503, "episodes_total": 423, "training_iteration": 184, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-31-04", "timestamp": 1585801864, "time_this_iter_s": 29.583353281021118, "time_total_s": 3922.3716113567352, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778840>", "on_episode_step": "<function on_episode_step at 0x7f7d68778d90>", "on_episode_end": "<function on_episode_end at 0x7f7d68778ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3922.3716113567352, "timesteps_since_restore": 188503, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 32.65, "ram_util_percent": 15.678571428571429}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.12175557272068285, "episode_len_mean": 448.76, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.12175557272068285}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.314132128738208, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 226.81, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4404690121396981, "mean_processing_ms": 2.9016308119857355, "mean_inference_ms": 0.43365634172900497}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 92185, "num_steps_trained": 8365300, "num_steps_sampled": 189508, "sample_time_ms": 143.184, "replay_time_ms": 15.486, "grad_time_ms": 12.767, "update_time_ms": 0.003, "opt_peak_throughput": 7832.749, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.22408676147461, "max_q": -9.439945220947266, "min_q": -52.3231201171875}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 189508, "episodes_total": 425, "training_iteration": 185, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-31-13", "timestamp": 1585801873, "time_this_iter_s": 8.994410037994385, "time_total_s": 3931.3660213947296, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686617b8>", "on_episode_step": "<function on_episode_step at 0x7f7d701ccb70>", "on_episode_end": "<function on_episode_end at 0x7f7d701cc048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3931.3660213947296, "timesteps_since_restore": 189508, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 29.07692307692308, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.1420573234856388, "episode_len_mean": 448.86, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.1420573234856388}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.325204451818928, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 223.05, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4369768309903594, "mean_processing_ms": 2.9002124169617765, "mean_inference_ms": 0.43191487184045807}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 92426, "num_steps_trained": 8389400, "num_steps_sampled": 190617, "sample_time_ms": 142.282, "replay_time_ms": 13.784, "grad_time_ms": 12.77, "update_time_ms": 0.004, "opt_peak_throughput": 7831.053, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.064525604248047, "max_q": -12.732621192932129, "min_q": -50.443870544433594}}}, "timesteps_this_iter": 1109, "done": false, "timesteps_total": 190617, "episodes_total": 428, "training_iteration": 186, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-31-24", "timestamp": 1585801884, "time_this_iter_s": 11.35546875, "time_total_s": 3942.7214901447296, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553378>", "on_episode_step": "<function on_episode_step at 0x7f7d68553598>", "on_episode_end": "<function on_episode_end at 0x7f7d685536a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3942.7214901447296, "timesteps_since_restore": 190617, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 28.1375, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.1432681626829019, "episode_len_mean": 448.86, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.1432681626829019}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.376910118827812, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 221.1, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4346511761401144, "mean_processing_ms": 2.8992330063430267, "mean_inference_ms": 0.4307552202855501}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 92605, "num_steps_trained": 8407300, "num_steps_sampled": 191617, "sample_time_ms": 3.359, "replay_time_ms": 14.374, "grad_time_ms": 13.392, "update_time_ms": 0.004, "opt_peak_throughput": 7467.28, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.177026748657227, "max_q": -12.936630249023438, "min_q": -62.49432373046875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 191617, "episodes_total": 430, "training_iteration": 187, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-31-33", "timestamp": 1585801893, "time_this_iter_s": 8.547982215881348, "time_total_s": 3951.269472360611, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d71cb2d90>", "on_episode_step": "<function on_episode_step at 0x7f7d68727ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d68727c80>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687270d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3951.269472360611, "timesteps_since_restore": 191617, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 27.558333333333334, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09283331547565518, "episode_len_mean": 441.02, "episodes_this_iter": 4, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09283331547565518}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.3254455341253095, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 223.72, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4300903159509268, "mean_processing_ms": 2.897709582194779, "mean_inference_ms": 0.4284759486027233}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 92805, "num_steps_trained": 8427300, "num_steps_sampled": 192828, "sample_time_ms": 145.664, "replay_time_ms": 13.278, "grad_time_ms": 13.252, "update_time_ms": 0.004, "opt_peak_throughput": 7546.277, "opt_samples": 100.0, "learner": {"av": {"mean_q": -22.093307495117188, "max_q": -5.1733832359313965, "min_q": -52.072078704833984}}}, "timesteps_this_iter": 1211, "done": false, "timesteps_total": 192828, "episodes_total": 434, "training_iteration": 188, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-31-44", "timestamp": 1585801904, "time_this_iter_s": 11.445223569869995, "time_total_s": 3962.714695930481, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727b70>", "on_episode_step": "<function on_episode_step at 0x7f7d6868a158>", "on_episode_end": "<function on_episode_end at 0x7f7d6868a6a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6868a2f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3962.714695930481, "timesteps_since_restore": 192828, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 28.256249999999998, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09426179577175153, "episode_len_mean": 441.02, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09426179577175153}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.36513903035314, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 222.92, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4278691863112523, "mean_processing_ms": 2.896995632587302, "mean_inference_ms": 0.42736890064787325}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 92957, "num_steps_trained": 8442500, "num_steps_sampled": 193828, "sample_time_ms": 145.437, "replay_time_ms": 16.258, "grad_time_ms": 12.404, "update_time_ms": 0.003, "opt_peak_throughput": 8061.644, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.592018127441406, "max_q": -12.628779411315918, "min_q": -54.082923889160156}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 193828, "episodes_total": 436, "training_iteration": 189, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-31-52", "timestamp": 1585801912, "time_this_iter_s": 7.580081939697266, "time_total_s": 3970.294777870178, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685537b8>", "on_episode_step": "<function on_episode_step at 0x7f7d68553ae8>", "on_episode_end": "<function on_episode_end at 0x7f7d68553a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685531e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3970.294777870178, "timesteps_since_restore": 193828, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 25.918181818181814, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09391329642032714, "episode_len_mean": 441.02, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09391329642032714}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.371619621973348, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 222.6, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4256627101774655, "mean_processing_ms": 2.896292814074397, "mean_inference_ms": 0.4262742027590572}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 93141, "num_steps_trained": 8460900, "num_steps_sampled": 194830, "sample_time_ms": 137.001, "replay_time_ms": 13.203, "grad_time_ms": 12.21, "update_time_ms": 0.003, "opt_peak_throughput": 8190.208, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.076852798461914, "max_q": -13.672019004821777, "min_q": -49.400672912597656}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 194830, "episodes_total": 438, "training_iteration": 190, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-32-00", "timestamp": 1585801920, "time_this_iter_s": 8.372135877609253, "time_total_s": 3978.6669137477875, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684bd048>", "on_episode_step": "<function on_episode_step at 0x7f7d684bdd08>", "on_episode_end": "<function on_episode_end at 0x7f7d684bd400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684bd488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3978.6669137477875, "timesteps_since_restore": 194830, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 25.51666666666667, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09258446160375178, "episode_len_mean": 444.88, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09258446160375178}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.348798422960945, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 226.35, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.423509255833502, "mean_processing_ms": 2.895561215781802, "mean_inference_ms": 0.42521439484368156}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 93657, "num_steps_trained": 8512500, "num_steps_sampled": 195830, "sample_time_ms": 3.229, "replay_time_ms": 14.013, "grad_time_ms": 12.994, "update_time_ms": 0.004, "opt_peak_throughput": 7696.013, "opt_samples": 100.0, "learner": {"av": {"mean_q": -23.05398941040039, "max_q": -13.05501937866211, "min_q": -52.656982421875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 195830, "episodes_total": 440, "training_iteration": 191, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-32-18", "timestamp": 1585801938, "time_this_iter_s": 18.300554275512695, "time_total_s": 3996.9674680233, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b58c8>", "on_episode_step": "<function on_episode_step at 0x7f7d685531e0>", "on_episode_end": "<function on_episode_end at 0x7f7d68553a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68553ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3996.9674680233, "timesteps_since_restore": 195830, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 30.242307692307694, "ram_util_percent": 15.011538461538462}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.08475417619268978, "episode_len_mean": 444.88, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.08475417619268978}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2585953788613935, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 231.12, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4213833064340502, "mean_processing_ms": 2.894775970511638, "mean_inference_ms": 0.4241774683101348}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 94305, "num_steps_trained": 8577300, "num_steps_sampled": 196830, "sample_time_ms": 133.886, "replay_time_ms": 16.049, "grad_time_ms": 13.352, "update_time_ms": 0.004, "opt_peak_throughput": 7489.508, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.079906463623047, "max_q": -12.411958694458008, "min_q": -59.89392852783203}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 196830, "episodes_total": 442, "training_iteration": 192, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-32-41", "timestamp": 1585801961, "time_this_iter_s": 22.311543464660645, "time_total_s": 4019.279011487961, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553400>", "on_episode_step": "<function on_episode_step at 0x7f7d68553598>", "on_episode_end": "<function on_episode_end at 0x7f7d68553378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685536a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4019.279011487961, "timesteps_since_restore": 196830, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 29.828125, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.12031722267955557, "episode_len_mean": 448.91, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.12031722267955557}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.2853902213641355, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 227.8, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4192854363938643, "mean_processing_ms": 2.8938990875737267, "mean_inference_ms": 0.4231575759811504}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 94463, "num_steps_trained": 8593100, "num_steps_sampled": 197830, "sample_time_ms": 143.465, "replay_time_ms": 15.332, "grad_time_ms": 13.397, "update_time_ms": 0.003, "opt_peak_throughput": 7464.21, "opt_samples": 100.0, "learner": {"av": {"mean_q": -24.079858779907227, "max_q": -11.304452896118164, "min_q": -54.03066635131836}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 197830, "episodes_total": 444, "training_iteration": 193, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-32-49", "timestamp": 1585801969, "time_this_iter_s": 7.813540458679199, "time_total_s": 4027.09255194664, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685b5620>", "on_episode_step": "<function on_episode_step at 0x7f7d701ccb70>", "on_episode_end": "<function on_episode_end at 0x7f7d700818c8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d700816a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4027.09255194664, "timesteps_since_restore": 197830, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 28.69090909090909, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.11881197460286605, "episode_len_mean": 448.91, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.11881197460286605}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.286348204780893, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 226.96, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4171606110116342, "mean_processing_ms": 2.893004577575434, "mean_inference_ms": 0.42212953469251624}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 94764, "num_steps_trained": 8623200, "num_steps_sampled": 198830, "sample_time_ms": 2.932, "replay_time_ms": 12.435, "grad_time_ms": 12.136, "update_time_ms": 0.003, "opt_peak_throughput": 8239.894, "opt_samples": 100.0, "learner": {"av": {"mean_q": -26.7984619140625, "max_q": -11.576601028442383, "min_q": -64.77184295654297}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 198830, "episodes_total": 446, "training_iteration": 194, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-33-01", "timestamp": 1585801981, "time_this_iter_s": 12.021737337112427, "time_total_s": 4039.1142892837524, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc2f0>", "on_episode_step": "<function on_episode_step at 0x7f7d686ccb70>", "on_episode_end": "<function on_episode_end at 0x7f7d68778378>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687781e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4039.1142892837524, "timesteps_since_restore": 198830, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 28.441176470588236, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.12501176614417506, "episode_len_mean": 448.95, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.12501176614417506}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.30774310535916, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 224.86, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4139577173054136, "mean_processing_ms": 2.891701615697034, "mean_inference_ms": 0.4205865928246925}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 95095, "num_steps_trained": 8656300, "num_steps_sampled": 199927, "sample_time_ms": 142.862, "replay_time_ms": 12.272, "grad_time_ms": 12.471, "update_time_ms": 0.004, "opt_peak_throughput": 8018.521, "opt_samples": 100.0, "learner": {"av": {"mean_q": 119.61907196044922, "max_q": 243.1133270263672, "min_q": -19.918212890625}}}, "timesteps_this_iter": 1097, "done": false, "timesteps_total": 199927, "episodes_total": 449, "training_iteration": 195, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-33-14", "timestamp": 1585801994, "time_this_iter_s": 13.808289289474487, "time_total_s": 4052.922578573227, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d700816a8>", "on_episode_step": "<function on_episode_step at 0x7f7d7004f620>", "on_episode_end": "<function on_episode_end at 0x7f7d7004f950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d7004f268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4052.922578573227, "timesteps_since_restore": 199927, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 26.879999999999995, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.1253847054440358, "episode_len_mean": 448.95, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.1253847054440358}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.324073310497775, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 223.84, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.411810433182144, "mean_processing_ms": 2.8907981194506114, "mean_inference_ms": 0.41955503006463424}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 95517, "num_steps_trained": 8698500, "num_steps_sampled": 200927, "sample_time_ms": 143.631, "replay_time_ms": 15.654, "grad_time_ms": 13.744, "update_time_ms": 0.004, "opt_peak_throughput": 7275.866, "opt_samples": 100.0, "learner": {"av": {"mean_q": 101.2254409790039, "max_q": 571.103271484375, "min_q": -196.23263549804688}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 200927, "episodes_total": 451, "training_iteration": 196, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-33-30", "timestamp": 1585802010, "time_this_iter_s": 15.387154340744019, "time_total_s": 4068.309732913971, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d68727b70>", "on_episode_end": "<function on_episode_end at 0x7f7d68727bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687270d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4068.309732913971, "timesteps_since_restore": 200927, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 29.8, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.09230841553359292, "episode_len_mean": 444.92, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.09230841553359292}, "custom_metrics": {"num_ped_collisions_mean": 0.05, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.341631339578107, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 226.27, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4085832813904255, "mean_processing_ms": 2.8895948209462388, "mean_inference_ms": 0.4180048193118778}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 95688, "num_steps_trained": 8715600, "num_steps_sampled": 202022, "sample_time_ms": 141.448, "replay_time_ms": 16.724, "grad_time_ms": 12.843, "update_time_ms": 0.005, "opt_peak_throughput": 7786.292, "opt_samples": 100.0, "learner": {"av": {"mean_q": 3981.884765625, "max_q": 9436.982421875, "min_q": 598.3990478515625}}}, "timesteps_this_iter": 1095, "done": false, "timesteps_total": 202022, "episodes_total": 454, "training_iteration": 197, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-33-39", "timestamp": 1585802019, "time_this_iter_s": 9.248914003372192, "time_total_s": 4077.558646917343, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629b70>", "on_episode_step": "<function on_episode_step at 0x7f7d68629bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d68629510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686291e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4077.558646917343, "timesteps_since_restore": 202022, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 24.846153846153847, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.12802988219537537, "episode_len_mean": 449.06, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.12802988219537537}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.365127796724338, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 222.49, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4064848969810748, "mean_processing_ms": 2.888716242385919, "mean_inference_ms": 0.41699930777903016}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 95822, "num_steps_trained": 8729000, "num_steps_sampled": 203027, "sample_time_ms": 145.594, "replay_time_ms": 14.539, "grad_time_ms": 13.038, "update_time_ms": 0.004, "opt_peak_throughput": 7670.089, "opt_samples": 100.0, "learner": {"av": {"mean_q": 10124.5029296875, "max_q": 31894.447265625, "min_q": 2308.93359375}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 203027, "episodes_total": 456, "training_iteration": 198, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-33-46", "timestamp": 1585802026, "time_this_iter_s": 6.92074179649353, "time_total_s": 4084.4793887138367, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f96a8>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9730>", "on_episode_end": "<function on_episode_end at 0x7f7d685f97b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4084.4793887138367, "timesteps_since_restore": 203027, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 26.4, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5735952116151987, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.129187504923978, "episode_len_mean": 449.06, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5735952116151987}, "policy_reward_mean": {"av": 0.129187504923978}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.381868128395942, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 221.93, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4043652175405166, "mean_processing_ms": 2.887773624272256, "mean_inference_ms": 0.41598448076326294}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 95962, "num_steps_trained": 8743000, "num_steps_sampled": 204027, "sample_time_ms": 142.804, "replay_time_ms": 15.736, "grad_time_ms": 13.387, "update_time_ms": 0.004, "opt_peak_throughput": 7470.153, "opt_samples": 100.0, "learner": {"av": {"mean_q": 9353.6298828125, "max_q": 32803.8359375, "min_q": -1942.4217529296875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 204027, "episodes_total": 458, "training_iteration": 199, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-33-53", "timestamp": 1585802033, "time_this_iter_s": 7.194425106048584, "time_total_s": 4091.6738138198853, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68604840>", "on_episode_step": "<function on_episode_step at 0x7f7d68604a60>", "on_episode_end": "<function on_episode_end at 0x7f7d68604ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68604ae8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4091.6738138198853, "timesteps_since_restore": 204027, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 27.96, "ram_util_percent": 15.0}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.113962288769994, "episode_len_mean": 448.63, "episodes_this_iter": 3, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.113962288769994}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.368557771272334, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 221.44, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.4011889866063394, "mean_processing_ms": 2.886420789340915, "mean_inference_ms": 0.41446394501239986}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96130, "num_steps_trained": 8759800, "num_steps_sampled": 205123, "sample_time_ms": 141.165, "replay_time_ms": 13.687, "grad_time_ms": 12.56, "update_time_ms": 0.004, "opt_peak_throughput": 7961.928, "opt_samples": 100.0, "learner": {"av": {"mean_q": 2603.021240234375, "max_q": 3740.466796875, "min_q": -3490.103515625}}}, "timesteps_this_iter": 1096, "done": false, "timesteps_total": 205123, "episodes_total": 461, "training_iteration": 200, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-02", "timestamp": 1585802042, "time_this_iter_s": 9.114640474319458, "time_total_s": 4100.788454294205, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686cc2f0>", "on_episode_step": "<function on_episode_step at 0x7f7d686cc268>", "on_episode_end": "<function on_episode_end at 0x7f7d684bd400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684bd048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4100.788454294205, "timesteps_since_restore": 205123, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 28.323076923076922, "ram_util_percent": 15.053846153846154}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.1227517471351867, "episode_len_mean": 448.63, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.1227517471351867}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.4495184769614005, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 217.24, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3990612277775007, "mean_processing_ms": 2.885532554906302, "mean_inference_ms": 0.4134489628085498}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96267, "num_steps_trained": 8773500, "num_steps_sampled": 206125, "sample_time_ms": 143.567, "replay_time_ms": 15.064, "grad_time_ms": 13.864, "update_time_ms": 0.004, "opt_peak_throughput": 7212.979, "opt_samples": 100.0, "learner": {"av": {"mean_q": -5254.60009765625, "max_q": -303.89678955078125, "min_q": -10882.7255859375}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 206125, "episodes_total": 463, "training_iteration": 201, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-09", "timestamp": 1585802049, "time_this_iter_s": 7.0773680210113525, "time_total_s": 4107.865822315216, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68553400>", "on_episode_step": "<function on_episode_step at 0x7f7d685537b8>", "on_episode_end": "<function on_episode_end at 0x7f7d700816a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d700818c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4107.865822315216, "timesteps_since_restore": 206125, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 28.209999999999997, "ram_util_percent": 15.079999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.12454759625688312, "episode_len_mean": 448.63, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.12454759625688312}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.08, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.48012382280711, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 216.38, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.396921182563766, "mean_processing_ms": 2.8845955389071207, "mean_inference_ms": 0.4124281873237017}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96404, "num_steps_trained": 8787200, "num_steps_sampled": 207133, "sample_time_ms": 151.697, "replay_time_ms": 14.359, "grad_time_ms": 12.212, "update_time_ms": 0.004, "opt_peak_throughput": 8188.657, "opt_samples": 100.0, "learner": {"av": {"mean_q": -10196.6298828125, "max_q": -1185.1649169921875, "min_q": -18648.05078125}}}, "timesteps_this_iter": 1008, "done": false, "timesteps_total": 207133, "episodes_total": 465, "training_iteration": 202, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-17", "timestamp": 1585802057, "time_this_iter_s": 7.180072784423828, "time_total_s": 4115.04589509964, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f97b8>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9b70>", "on_episode_end": "<function on_episode_end at 0x7f7d68661ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686617b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4115.04589509964, "timesteps_since_restore": 207133, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 27.745454545454546, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.14041821366406812, "episode_len_mean": 452.59, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.14041821366406812}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.51028934815901, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 216.37, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3947637510124835, "mean_processing_ms": 2.8835905953110608, "mean_inference_ms": 0.41140014848772954}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96568, "num_steps_trained": 8803600, "num_steps_sampled": 208133, "sample_time_ms": 3.045, "replay_time_ms": 12.89, "grad_time_ms": 12.248, "update_time_ms": 0.004, "opt_peak_throughput": 8164.588, "opt_samples": 100.0, "learner": {"av": {"mean_q": -19363.24609375, "max_q": -362.2178955078125, "min_q": -28409.6953125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 208133, "episodes_total": 467, "training_iteration": 203, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-24", "timestamp": 1585802064, "time_this_iter_s": 7.828472137451172, "time_total_s": 4122.874367237091, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727c80>", "on_episode_step": "<function on_episode_step at 0x7f7d68727b70>", "on_episode_end": "<function on_episode_end at 0x7f7d687270d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4122.874367237091, "timesteps_since_restore": 208133, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 28.072727272727267, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.034523151830583, "episode_reward_mean": 0.1416569515472591, "episode_len_mean": 452.59, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.034523151830583}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.1416569515472591}, "custom_metrics": {"num_ped_collisions_mean": 0.04, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.5583875182393445, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 215.32, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3926167190964944, "mean_processing_ms": 2.88259382027376, "mean_inference_ms": 0.41037450533377184}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96683, "num_steps_trained": 8815100, "num_steps_sampled": 209135, "sample_time_ms": 145.133, "replay_time_ms": 13.137, "grad_time_ms": 14.781, "update_time_ms": 0.003, "opt_peak_throughput": 6765.563, "opt_samples": 100.0, "learner": {"av": {"mean_q": -6574.25146484375, "max_q": -404.6462097167969, "min_q": -23919.173828125}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 209135, "episodes_total": 469, "training_iteration": 204, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-31", "timestamp": 1585802071, "time_this_iter_s": 6.336960792541504, "time_total_s": 4129.211328029633, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f68c8>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6950>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6d08>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4129.211328029633, "timesteps_since_restore": 209135, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 27.7, "ram_util_percent": 15.100000000000001}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.0217260049281354, "episode_reward_mean": 0.1833093440134544, "episode_len_mean": 456.4, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0217260049281354}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.1833093440134544}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.641026254056548, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 207.89, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3904364373705764, "mean_processing_ms": 2.8814921044251554, "mean_inference_ms": 0.4093328177568138}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96819, "num_steps_trained": 8828700, "num_steps_sampled": 210135, "sample_time_ms": 147.911, "replay_time_ms": 14.181, "grad_time_ms": 13.311, "update_time_ms": 0.004, "opt_peak_throughput": 7512.864, "opt_samples": 100.0, "learner": {"av": {"mean_q": -15420.275390625, "max_q": -972.419189453125, "min_q": -40958.54296875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 210135, "episodes_total": 471, "training_iteration": 205, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-38", "timestamp": 1585802078, "time_this_iter_s": 6.975750684738159, "time_total_s": 4136.187078714371, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685691e0>", "on_episode_step": "<function on_episode_step at 0x7f7d68569c80>", "on_episode_end": "<function on_episode_end at 0x7f7d68569f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4136.187078714371, "timesteps_since_restore": 210135, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 27.85, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.0217260049281354, "episode_reward_mean": 0.2016572464215494, "episode_len_mean": 456.4, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0217260049281354}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.2016572464215494}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.702115704145773, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 204.25, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3882129014537037, "mean_processing_ms": 2.880368907281345, "mean_inference_ms": 0.4082682714244278}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96971, "num_steps_trained": 8843900, "num_steps_sampled": 211135, "sample_time_ms": 3.093, "replay_time_ms": 13.591, "grad_time_ms": 12.999, "update_time_ms": 0.004, "opt_peak_throughput": 7692.992, "opt_samples": 100.0, "learner": {"av": {"mean_q": -16369.1689453125, "max_q": -2153.466552734375, "min_q": -34186.48828125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 211135, "episodes_total": 473, "training_iteration": 206, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-45", "timestamp": 1585802085, "time_this_iter_s": 7.590367555618286, "time_total_s": 4143.777446269989, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f66a8>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6a60>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f67b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4143.777446269989, "timesteps_since_restore": 211135, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 26.919999999999998, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5733783828607765, "episode_reward_min": -3.0217260049281354, "episode_reward_mean": 0.20232020147098786, "episode_len_mean": 456.4, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0217260049281354}, "policy_reward_max": {"av": 0.5733783828607765}, "policy_reward_mean": {"av": 0.20232020147098786}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.72609003992542, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 203.2, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.385979800180087, "mean_processing_ms": 2.8792512271864736, "mean_inference_ms": 0.4071961023851253}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97094, "num_steps_trained": 8856200, "num_steps_sampled": 212135, "sample_time_ms": 143.732, "replay_time_ms": 15.314, "grad_time_ms": 14.134, "update_time_ms": 0.004, "opt_peak_throughput": 7075.245, "opt_samples": 100.0, "learner": {"av": {"mean_q": -21811.525390625, "max_q": -2674.8330078125, "min_q": -38028.296875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 212135, "episodes_total": 475, "training_iteration": 207, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-34-52", "timestamp": 1585802092, "time_this_iter_s": 6.681913614273071, "time_total_s": 4150.459359884262, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d686048c8>", "on_episode_end": "<function on_episode_end at 0x7f7d68604ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68604400>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4150.459359884262, "timesteps_since_restore": 212135, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 25.21, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -3.0217260049281354, "episode_reward_mean": 0.2031480300096006, "episode_len_mean": 456.4, "episodes_this_iter": 2, "policy_reward_min": {"av": -3.0217260049281354}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.2031480300096006}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.754096727656104, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 202.38, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.383762499142743, "mean_processing_ms": 2.878147452626978, "mean_inference_ms": 0.40613276844434737}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97238, "num_steps_trained": 8870600, "num_steps_sampled": 213135, "sample_time_ms": 144.627, "replay_time_ms": 16.594, "grad_time_ms": 12.921, "update_time_ms": 0.004, "opt_peak_throughput": 7739.611, "opt_samples": 100.0, "learner": {"av": {"mean_q": -31461.033203125, "max_q": -4376.9208984375, "min_q": -59016.2578125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 213135, "episodes_total": 477, "training_iteration": 208, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-00", "timestamp": 1585802100, "time_this_iter_s": 7.354366302490234, "time_total_s": 4157.813726186752, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f6b70>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6f28>", "on_episode_end": "<function on_episode_end at 0x7f7d68778d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4157.813726186752, "timesteps_since_restore": 213135, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 28.89090909090909, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.998733815719504, "episode_reward_mean": 0.23945338523231016, "episode_len_mean": 460.35, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998733815719504}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.23945338523231016}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.788278648577712, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 198.58, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3815335509343125, "mean_processing_ms": 2.8769971859355086, "mean_inference_ms": 0.405065608219506}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97374, "num_steps_trained": 8884200, "num_steps_sampled": 214135, "sample_time_ms": 141.754, "replay_time_ms": 17.215, "grad_time_ms": 13.598, "update_time_ms": 0.004, "opt_peak_throughput": 7353.99, "opt_samples": 100.0, "learner": {"av": {"mean_q": -44178.74609375, "max_q": -14619.01171875, "min_q": -76898.2265625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 214135, "episodes_total": 479, "training_iteration": 209, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-07", "timestamp": 1585802107, "time_this_iter_s": 7.044878244400024, "time_total_s": 4164.858604431152, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6849c378>", "on_episode_step": "<function on_episode_step at 0x7f7d6849c598>", "on_episode_end": "<function on_episode_end at 0x7f7d6849c620>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6849c6a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4164.858604431152, "timesteps_since_restore": 214135, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 26.7, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.998733815719504, "episode_reward_mean": 0.24709177688430153, "episode_len_mean": 460.35, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.998733815719504}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.24709177688430153}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.857741988890923, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.676854200522033, "avg_rl_veh_arrival_mean": 194.82, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.379260516834495, "mean_processing_ms": 2.875771010767586, "mean_inference_ms": 0.4039779705010587}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97523, "num_steps_trained": 8899100, "num_steps_sampled": 215135, "sample_time_ms": 3.196, "replay_time_ms": 13.587, "grad_time_ms": 13.266, "update_time_ms": 0.004, "opt_peak_throughput": 7538.248, "opt_samples": 100.0, "learner": {"av": {"mean_q": -53322.50390625, "max_q": -23787.791015625, "min_q": -164105.96875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 215135, "episodes_total": 481, "training_iteration": 210, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-14", "timestamp": 1585802114, "time_this_iter_s": 7.510608434677124, "time_total_s": 4172.3692128658295, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687781e0>", "on_episode_step": "<function on_episode_step at 0x7f7d68778268>", "on_episode_end": "<function on_episode_end at 0x7f7d68778400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4172.3692128658295, "timesteps_since_restore": 215135, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 26.28, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.2121749732865595, "episode_len_mean": 455.95, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.2121749732865595}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.837486685712845, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 197.81, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3759056089066337, "mean_processing_ms": 2.8741163839082673, "mean_inference_ms": 0.40237599147810527}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97655, "num_steps_trained": 8912300, "num_steps_sampled": 216195, "sample_time_ms": 264.709, "replay_time_ms": 18.618, "grad_time_ms": 14.127, "update_time_ms": 0.004, "opt_peak_throughput": 7078.588, "opt_samples": 100.0, "learner": {"av": {"mean_q": -59414.1484375, "max_q": -17232.99609375, "min_q": -169404.1875}}}, "timesteps_this_iter": 1060, "done": false, "timesteps_total": 216195, "episodes_total": 484, "training_iteration": 211, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-22", "timestamp": 1585802122, "time_this_iter_s": 8.127083778381348, "time_total_s": 4180.496296644211, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569158>", "on_episode_step": "<function on_episode_step at 0x7f7d685691e0>", "on_episode_end": "<function on_episode_end at 0x7f7d68569598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569950>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4180.496296644211, "timesteps_since_restore": 216195, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 27.508333333333336, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.22834685450092987, "episode_len_mean": 459.94, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.22834685450092987}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.873474413532339, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 197.99, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3736653873364013, "mean_processing_ms": 2.8730256253667124, "mean_inference_ms": 0.401306865842037}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97800, "num_steps_trained": 8926800, "num_steps_sampled": 217195, "sample_time_ms": 142.757, "replay_time_ms": 16.179, "grad_time_ms": 13.352, "update_time_ms": 0.004, "opt_peak_throughput": 7489.655, "opt_samples": 100.0, "learner": {"av": {"mean_q": -94642.078125, "max_q": -2314.423583984375, "min_q": -201357.765625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 217195, "episodes_total": 486, "training_iteration": 212, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-30", "timestamp": 1585802130, "time_this_iter_s": 7.374327182769775, "time_total_s": 4187.870623826981, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68604ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d68604ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d700816a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685536a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4187.870623826981, "timesteps_since_restore": 217195, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 28.139999999999997, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.23713259202855075, "episode_len_mean": 459.94, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.23713259202855075}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 5.970495896049535, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 193.44, "avg_rl_veh_arrival_min": 99.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.371403176316419, "mean_processing_ms": 2.871884331027078, "mean_inference_ms": 0.400226279128584}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97936, "num_steps_trained": 8940400, "num_steps_sampled": 218195, "sample_time_ms": 145.731, "replay_time_ms": 15.607, "grad_time_ms": 13.083, "update_time_ms": 0.004, "opt_peak_throughput": 7643.406, "opt_samples": 100.0, "learner": {"av": {"mean_q": -126838.609375, "max_q": -753.3152465820312, "min_q": -228460.734375}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 218195, "episodes_total": 488, "training_iteration": 213, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-37", "timestamp": 1585802137, "time_this_iter_s": 6.990963697433472, "time_total_s": 4194.861587524414, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569950>", "on_episode_step": "<function on_episode_step at 0x7f7d68569598>", "on_episode_end": "<function on_episode_end at 0x7f7d685691e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569158>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4194.861587524414, "timesteps_since_restore": 218195, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 26.6, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.2388171495209271, "episode_len_mean": 459.76, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.2388171495209271}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.004018452548395, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 191.9, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.367952265021802, "mean_processing_ms": 2.8702035918280933, "mean_inference_ms": 0.3985750670303398}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98087, "num_steps_trained": 8955500, "num_steps_sampled": 219282, "sample_time_ms": 142.108, "replay_time_ms": 15.491, "grad_time_ms": 13.683, "update_time_ms": 0.004, "opt_peak_throughput": 7308.423, "opt_samples": 100.0, "learner": {"av": {"mean_q": -109324.578125, "max_q": -4072.663818359375, "min_q": -272670.15625}}}, "timesteps_this_iter": 1087, "done": false, "timesteps_total": 219282, "episodes_total": 491, "training_iteration": 214, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-45", "timestamp": 1585802145, "time_this_iter_s": 8.789566040039062, "time_total_s": 4203.651153564453, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d684f67b8>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f60d0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4203.651153564453, "timesteps_since_restore": 219282, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 27.076923076923077, "ram_util_percent": 15.099999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.264087284263797, "episode_len_mean": 459.76, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.264087284263797}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.12740812668315, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 184.58, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3656029949867523, "mean_processing_ms": 2.8690288654404283, "mean_inference_ms": 0.3974403836514739}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98227, "num_steps_trained": 8969500, "num_steps_sampled": 220282, "sample_time_ms": 149.08, "replay_time_ms": 19.15, "grad_time_ms": 16.857, "update_time_ms": 0.004, "opt_peak_throughput": 5932.353, "opt_samples": 100.0, "learner": {"av": {"mean_q": -141796.515625, "max_q": -7034.08056640625, "min_q": -259903.65625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 220282, "episodes_total": 493, "training_iteration": 215, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-35-53", "timestamp": 1585802153, "time_this_iter_s": 7.493947744369507, "time_total_s": 4211.145101308823, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569840>", "on_episode_step": "<function on_episode_step at 0x7f7d68569a60>", "on_episode_end": "<function on_episode_end at 0x7f7d685699d8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569e18>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4211.145101308823, "timesteps_since_restore": 220282, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 27.7, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.2783099261420493, "episode_len_mean": 459.76, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.2783099261420493}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.187306538931164, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 180.99, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3632187843730252, "mean_processing_ms": 2.86778395459163, "mean_inference_ms": 0.39628516581319745}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98360, "num_steps_trained": 8982800, "num_steps_sampled": 221282, "sample_time_ms": 142.493, "replay_time_ms": 14.962, "grad_time_ms": 13.616, "update_time_ms": 0.003, "opt_peak_throughput": 7344.049, "opt_samples": 100.0, "learner": {"av": {"mean_q": -168739.875, "max_q": -1420.532470703125, "min_q": -355000.90625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 221282, "episodes_total": 495, "training_iteration": 216, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-00", "timestamp": 1585802160, "time_this_iter_s": 7.058955192565918, "time_total_s": 4218.204056501389, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629b70>", "on_episode_step": "<function on_episode_step at 0x7f7d686291e0>", "on_episode_end": "<function on_episode_end at 0x7f7d68629400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629730>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4218.204056501389, "timesteps_since_restore": 221282, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 28.250000000000007, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.25810064414057854, "episode_len_mean": 451.7, "episodes_this_iter": 4, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.25810064414057854}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.195298602615012, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 178.86, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3585345814239331, "mean_processing_ms": 2.8656895162059333, "mean_inference_ms": 0.39401283631731815}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98538, "num_steps_trained": 9000600, "num_steps_sampled": 222470, "sample_time_ms": 145.005, "replay_time_ms": 12.837, "grad_time_ms": 13.884, "update_time_ms": 0.004, "opt_peak_throughput": 7202.673, "opt_samples": 100.0, "learner": {"av": {"mean_q": -166513.734375, "max_q": -12259.7939453125, "min_q": -422506.6875}}}, "timesteps_this_iter": 1188, "done": false, "timesteps_total": 222470, "episodes_total": 499, "training_iteration": 217, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-11", "timestamp": 1585802171, "time_this_iter_s": 10.835420370101929, "time_total_s": 4229.0394768714905, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68604510>", "on_episode_step": "<function on_episode_step at 0x7f7d68604840>", "on_episode_end": "<function on_episode_end at 0x7f7d68604ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686047b8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4229.0394768714905, "timesteps_since_restore": 222470, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 28.246666666666673, "ram_util_percent": 15.099999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.25804459219181203, "episode_len_mean": 451.7, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.25804459219181203}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.1899703355019176, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 178.72, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3562337738910886, "mean_processing_ms": 2.864676542600306, "mean_inference_ms": 0.3929017550789621}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98675, "num_steps_trained": 9014300, "num_steps_sampled": 223470, "sample_time_ms": 139.276, "replay_time_ms": 14.618, "grad_time_ms": 13.121, "update_time_ms": 0.004, "opt_peak_throughput": 7621.559, "opt_samples": 100.0, "learner": {"av": {"mean_q": -252254.6875, "max_q": -22236.98828125, "min_q": -514457.0}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 223470, "episodes_total": 501, "training_iteration": 218, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-18", "timestamp": 1585802178, "time_this_iter_s": 7.031793117523193, "time_total_s": 4236.071269989014, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f6bf8>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6840>", "on_episode_end": "<function on_episode_end at 0x7f7d684f66a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4236.071269989014, "timesteps_since_restore": 223470, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 26.909999999999997, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.2608152859117807, "episode_len_mean": 451.7, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.2608152859117807}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.23287363764937, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 177.66, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3539449447112453, "mean_processing_ms": 2.863672988214721, "mean_inference_ms": 0.391794700858512}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98820, "num_steps_trained": 9028800, "num_steps_sampled": 224470, "sample_time_ms": 143.649, "replay_time_ms": 15.811, "grad_time_ms": 13.348, "update_time_ms": 0.004, "opt_peak_throughput": 7491.648, "opt_samples": 100.0, "learner": {"av": {"mean_q": -299050.46875, "max_q": -61701.359375, "min_q": -645327.125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 224470, "episodes_total": 503, "training_iteration": 219, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-25", "timestamp": 1585802185, "time_this_iter_s": 7.376725912094116, "time_total_s": 4243.447995901108, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9510>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9378>", "on_episode_end": "<function on_episode_end at 0x7f7d685f90d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f92f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4243.447995901108, "timesteps_since_restore": 224470, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 29.645454545454548, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.2875302854954505, "episode_len_mean": 455.69, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.2875302854954505}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.306364939014211, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 174.24, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.351621131035594, "mean_processing_ms": 2.862571040622078, "mean_inference_ms": 0.3906744788930684}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98962, "num_steps_trained": 9043000, "num_steps_sampled": 225470, "sample_time_ms": 3.238, "replay_time_ms": 14.774, "grad_time_ms": 12.383, "update_time_ms": 0.004, "opt_peak_throughput": 8075.847, "opt_samples": 100.0, "learner": {"av": {"mean_q": -361250.3125, "max_q": -19837.787109375, "min_q": -571397.5}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 225470, "episodes_total": 505, "training_iteration": 220, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-32", "timestamp": 1585802192, "time_this_iter_s": 7.148871421813965, "time_total_s": 4250.596867322922, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68604400>", "on_episode_step": "<function on_episode_step at 0x7f7d686048c8>", "on_episode_end": "<function on_episode_end at 0x7f7d68604ae8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d686296a8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4250.596867322922, "timesteps_since_restore": 225470, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 27.28, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.28782959021180293, "episode_len_mean": 455.69, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.28782959021180293}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.311964425832582, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 174.0, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3492781514480938, "mean_processing_ms": 2.8614545491114494, "mean_inference_ms": 0.38954544684054754}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99095, "num_steps_trained": 9056300, "num_steps_sampled": 226470, "sample_time_ms": 142.276, "replay_time_ms": 15.871, "grad_time_ms": 12.909, "update_time_ms": 0.004, "opt_peak_throughput": 7746.286, "opt_samples": 100.0, "learner": {"av": {"mean_q": -312678.40625, "max_q": -26507.361328125, "min_q": -714037.875}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 226470, "episodes_total": 507, "training_iteration": 221, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-39", "timestamp": 1585802199, "time_this_iter_s": 6.955186128616333, "time_total_s": 4257.552053451538, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685699d8>", "on_episode_step": "<function on_episode_step at 0x7f7d68569f28>", "on_episode_end": "<function on_episode_end at 0x7f7d68569bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569c80>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4257.552053451538, "timesteps_since_restore": 226470, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 29.27, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.29070131383214776, "episode_len_mean": 455.69, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.29070131383214776}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.390199777354363, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 170.29, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3469297440396488, "mean_processing_ms": 2.860344314322974, "mean_inference_ms": 0.38841328548976234}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99249, "num_steps_trained": 9071700, "num_steps_sampled": 227470, "sample_time_ms": 2.986, "replay_time_ms": 13.094, "grad_time_ms": 12.193, "update_time_ms": 0.003, "opt_peak_throughput": 8201.274, "opt_samples": 100.0, "learner": {"av": {"mean_q": -372388.28125, "max_q": -12591.06640625, "min_q": -716557.0}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 227470, "episodes_total": 509, "training_iteration": 222, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-47", "timestamp": 1585802207, "time_this_iter_s": 7.401488780975342, "time_total_s": 4264.953542232513, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d68629598>", "on_episode_end": "<function on_episode_end at 0x7f7d68629510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68604488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4264.953542232513, "timesteps_since_restore": 227470, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 26.639999999999997, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5734087022356243, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.2917032219242342, "episode_len_mean": 455.69, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5734087022356243}, "policy_reward_mean": {"av": 0.2917032219242342}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.41963700301756, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 169.66, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3445735645304884, "mean_processing_ms": 2.85923810363669, "mean_inference_ms": 0.38727678104833474}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99367, "num_steps_trained": 9083500, "num_steps_sampled": 228470, "sample_time_ms": 144.228, "replay_time_ms": 14.618, "grad_time_ms": 12.759, "update_time_ms": 0.004, "opt_peak_throughput": 7837.403, "opt_samples": 100.0, "learner": {"av": {"mean_q": -341516.90625, "max_q": -9819.357421875, "min_q": -651975.5625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 228470, "episodes_total": 511, "training_iteration": 223, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-36-53", "timestamp": 1585802213, "time_this_iter_s": 6.461498975753784, "time_total_s": 4271.415041208267, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68569c80>", "on_episode_step": "<function on_episode_step at 0x7f7d68569bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d68569f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685699d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4271.415041208267, "timesteps_since_restore": 228470, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 26.369999999999997, "ram_util_percent": 15.1}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.27755525288281513, "episode_len_mean": 451.64, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.27755525288281513}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.440669309821025, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 168.27, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3410795897761296, "mean_processing_ms": 2.8577250771072507, "mean_inference_ms": 0.3855890911296286}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99535, "num_steps_trained": 9100300, "num_steps_sampled": 229560, "sample_time_ms": 143.636, "replay_time_ms": 12.829, "grad_time_ms": 14.76, "update_time_ms": 0.005, "opt_peak_throughput": 6775.093, "opt_samples": 100.0, "learner": {"av": {"mean_q": -394506.8125, "max_q": -58453.3046875, "min_q": -754914.375}}}, "timesteps_this_iter": 1090, "done": false, "timesteps_total": 229560, "episodes_total": 514, "training_iteration": 224, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-03", "timestamp": 1585802223, "time_this_iter_s": 9.314438104629517, "time_total_s": 4280.729479312897, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543b70>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6510>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4280.729479312897, "timesteps_since_restore": 229560, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 27.084615384615383, "ram_util_percent": 15.107692307692306}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.27832756173791906, "episode_len_mean": 451.64, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.27832756173791906}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.07, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.471169288860519, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 167.43, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3387839048559433, "mean_processing_ms": 2.85674615792451, "mean_inference_ms": 0.38447980655438335}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99678, "num_steps_trained": 9114600, "num_steps_sampled": 230560, "sample_time_ms": 141.719, "replay_time_ms": 16.374, "grad_time_ms": 13.529, "update_time_ms": 0.004, "opt_peak_throughput": 7391.456, "opt_samples": 100.0, "learner": {"av": {"mean_q": -400652.90625, "max_q": -35207.0546875, "min_q": -822516.4375}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 230560, "episodes_total": 516, "training_iteration": 225, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-10", "timestamp": 1585802230, "time_this_iter_s": 7.261284828186035, "time_total_s": 4287.990764141083, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f90d0>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9b70>", "on_episode_end": "<function on_episode_end at 0x7f7d68543f28>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4287.990764141083, "timesteps_since_restore": 230560, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 28.360000000000003, "ram_util_percent": 15.11}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.2938494207881848, "episode_len_mean": 455.65, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.2938494207881848}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.50903567575132, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 167.47, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.336510334485232, "mean_processing_ms": 2.855684894634952, "mean_inference_ms": 0.38338052726225164}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99810, "num_steps_trained": 9127800, "num_steps_sampled": 231575, "sample_time_ms": 147.4, "replay_time_ms": 13.712, "grad_time_ms": 12.291, "update_time_ms": 0.005, "opt_peak_throughput": 8136.033, "opt_samples": 100.0, "learner": {"av": {"mean_q": -481707.84375, "max_q": -15176.84375, "min_q": -826118.75}}}, "timesteps_this_iter": 1015, "done": false, "timesteps_total": 231575, "episodes_total": 518, "training_iteration": 226, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-17", "timestamp": 1585802237, "time_this_iter_s": 7.008744239807129, "time_total_s": 4294.99950838089, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f6620>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6bf8>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6a60>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68727b70>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4294.99950838089, "timesteps_since_restore": 231575, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 28.26, "ram_util_percent": 15.149999999999997}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.28862113598949773, "episode_len_mean": 451.66, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.28862113598949773}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.496044559292951, "avg_speed_min": 0.7153166655109114, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 167.17, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3331021431496686, "mean_processing_ms": 2.8541967218431545, "mean_inference_ms": 0.3817291694107523}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99982, "num_steps_trained": 9145000, "num_steps_sampled": 232669, "sample_time_ms": 145.28, "replay_time_ms": 13.098, "grad_time_ms": 14.178, "update_time_ms": 0.004, "opt_peak_throughput": 7053.305, "opt_samples": 100.0, "learner": {"av": {"mean_q": -505891.3125, "max_q": -13406.7119140625, "min_q": -1037159.8125}}}, "timesteps_this_iter": 1094, "done": false, "timesteps_total": 232669, "episodes_total": 521, "training_iteration": 227, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-27", "timestamp": 1585802247, "time_this_iter_s": 9.524059057235718, "time_total_s": 4304.523567438126, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778378>", "on_episode_step": "<function on_episode_step at 0x7f7d68778400>", "on_episode_end": "<function on_episode_end at 0x7f7d68778048>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6849c378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4304.523567438126, "timesteps_since_restore": 232669, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 25.849999999999998, "ram_util_percent": 15.171428571428567}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3069447807094024, "episode_len_mean": 451.66, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.3069447807094024}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.620043326737798, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 159.96, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3308011439797012, "mean_processing_ms": 2.8532077148930934, "mean_inference_ms": 0.3806008629932914}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 100120, "num_steps_trained": 9158800, "num_steps_sampled": 233674, "sample_time_ms": 144.395, "replay_time_ms": 14.567, "grad_time_ms": 12.931, "update_time_ms": 0.005, "opt_peak_throughput": 7733.275, "opt_samples": 100.0, "learner": {"av": {"mean_q": -586705.8125, "max_q": -39531.4140625, "min_q": -1162980.625}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 233674, "episodes_total": 523, "training_iteration": 228, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-34", "timestamp": 1585802254, "time_this_iter_s": 7.286854267120361, "time_total_s": 4311.810421705246, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6849a268>", "on_episode_step": "<function on_episode_step at 0x7f7d6849a620>", "on_episode_end": "<function on_episode_end at 0x7f7d6849a7b8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6849a8c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4311.810421705246, "timesteps_since_restore": 233674, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 29.560000000000002, "ram_util_percent": 15.189999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.30814292121034326, "episode_len_mean": 451.7, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.30814292121034326}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.647848711997841, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 159.4, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3273986968451015, "mean_processing_ms": 2.8518361583739784, "mean_inference_ms": 0.3789337237445015}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 100295, "num_steps_trained": 9176300, "num_steps_sampled": 234765, "sample_time_ms": 139.712, "replay_time_ms": 14.368, "grad_time_ms": 12.399, "update_time_ms": 0.005, "opt_peak_throughput": 8065.302, "opt_samples": 100.0, "learner": {"av": {"mean_q": -597124.375, "max_q": -37280.37109375, "min_q": -1130786.75}}}, "timesteps_this_iter": 1091, "done": false, "timesteps_total": 234765, "episodes_total": 526, "training_iteration": 229, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-43", "timestamp": 1585802263, "time_this_iter_s": 9.299304723739624, "time_total_s": 4321.109726428986, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6849cd90>", "on_episode_step": "<function on_episode_step at 0x7f7d6849c400>", "on_episode_end": "<function on_episode_end at 0x7f7d6849c488>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6849c598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4321.109726428986, "timesteps_since_restore": 234765, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 26.415384615384614, "ram_util_percent": 15.192307692307688}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3087422252295356, "episode_len_mean": 451.7, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.3087422252295356}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.668849076872308, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.617535456258531, "avg_rl_veh_arrival_mean": 158.51, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.325123585255238, "mean_processing_ms": 2.8508579590323473, "mean_inference_ms": 0.37782061672190437}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 100429, "num_steps_trained": 9189700, "num_steps_sampled": 235778, "sample_time_ms": 141.498, "replay_time_ms": 14.44, "grad_time_ms": 13.257, "update_time_ms": 0.004, "opt_peak_throughput": 7543.441, "opt_samples": 100.0, "learner": {"av": {"mean_q": -516121.0, "max_q": -172470.84375, "min_q": -1140358.375}}}, "timesteps_this_iter": 1013, "done": false, "timesteps_total": 235778, "episodes_total": 528, "training_iteration": 230, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-50", "timestamp": 1585802270, "time_this_iter_s": 7.059118032455444, "time_total_s": 4328.168844461441, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686291e0>", "on_episode_step": "<function on_episode_step at 0x7f7d68629400>", "on_episode_end": "<function on_episode_end at 0x7f7d686296a8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4328.168844461441, "timesteps_since_restore": 235778, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 28.599999999999998, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.30898534233876335, "episode_len_mean": 451.7, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.30898534233876335}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.06, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.673121637735732, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.636677508639734, "avg_rl_veh_arrival_mean": 158.44, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3228660012383946, "mean_processing_ms": 2.849891323330273, "mean_inference_ms": 0.376716334169721}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 100574, "num_steps_trained": 9204200, "num_steps_sampled": 236778, "sample_time_ms": 143.608, "replay_time_ms": 16.637, "grad_time_ms": 13.23, "update_time_ms": 0.004, "opt_peak_throughput": 7558.803, "opt_samples": 100.0, "learner": {"av": {"mean_q": -571177.375, "max_q": -48880.14453125, "min_q": -1200190.5}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 236778, "episodes_total": 530, "training_iteration": 231, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-37-58", "timestamp": 1585802278, "time_this_iter_s": 7.50044846534729, "time_total_s": 4335.669292926788, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d6849cd90>", "on_episode_step": "<function on_episode_step at 0x7f7d6849c378>", "on_episode_end": "<function on_episode_end at 0x7f7d6849c510>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d6849cf28>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4335.669292926788, "timesteps_since_restore": 236778, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 27.040000000000003, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3248409720055513, "episode_len_mean": 455.25, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.3248409720055513}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.718740875637523, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.695692177202605, "avg_rl_veh_arrival_mean": 158.45, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3206326747068942, "mean_processing_ms": 2.8487676071421157, "mean_inference_ms": 0.37562753687119305}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 100707, "num_steps_trained": 9217500, "num_steps_sampled": 237778, "sample_time_ms": 143.664, "replay_time_ms": 15.549, "grad_time_ms": 14.971, "update_time_ms": 0.004, "opt_peak_throughput": 6679.498, "opt_samples": 100.0, "learner": {"av": {"mean_q": -577970.375, "max_q": -154981.65625, "min_q": -1270683.625}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 237778, "episodes_total": 532, "training_iteration": 232, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-05", "timestamp": 1585802285, "time_this_iter_s": 6.94131326675415, "time_total_s": 4342.6106061935425, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d68629e18>", "on_episode_end": "<function on_episode_end at 0x7f7d68629d08>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68629598>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4342.6106061935425, "timesteps_since_restore": 237778, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 27.209999999999997, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3607794840189919, "episode_len_mean": 459.54, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.3607794840189919}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.759502811443938, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.695692177202605, "avg_rl_veh_arrival_mean": 154.85, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.318355039091258, "mean_processing_ms": 2.8476052775508163, "mean_inference_ms": 0.3745171989612855}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 100846, "num_steps_trained": 9231400, "num_steps_sampled": 238778, "sample_time_ms": 143.858, "replay_time_ms": 14.467, "grad_time_ms": 13.959, "update_time_ms": 0.004, "opt_peak_throughput": 7164.08, "opt_samples": 100.0, "learner": {"av": {"mean_q": -549790.3125, "max_q": -27601.55078125, "min_q": -1330049.125}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 238778, "episodes_total": 534, "training_iteration": 233, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-12", "timestamp": 1585802292, "time_this_iter_s": 7.166712999343872, "time_total_s": 4349.777319192886, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68487730>", "on_episode_step": "<function on_episode_step at 0x7f7d684877b8>", "on_episode_end": "<function on_episode_end at 0x7f7d68487840>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684878c8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4349.777319192886, "timesteps_since_restore": 238778, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 24.55, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.35538236237300197, "episode_len_mean": 455.74, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.35538236237300197}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.743024278351785, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.695692177202605, "avg_rl_veh_arrival_mean": 154.56, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.315002528039723, "mean_processing_ms": 2.846015418140364, "mean_inference_ms": 0.3728798752268149}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101029, "num_steps_trained": 9249700, "num_steps_sampled": 239884, "sample_time_ms": 144.891, "replay_time_ms": 13.987, "grad_time_ms": 13.196, "update_time_ms": 0.004, "opt_peak_throughput": 7578.333, "opt_samples": 100.0, "learner": {"av": {"mean_q": -611448.75, "max_q": -47187.58984375, "min_q": -1430447.375}}}, "timesteps_this_iter": 1106, "done": false, "timesteps_total": 239884, "episodes_total": 537, "training_iteration": 234, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-22", "timestamp": 1585802302, "time_this_iter_s": 9.788384675979614, "time_total_s": 4359.565703868866, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9bf8>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9ea0>", "on_episode_end": "<function on_episode_end at 0x7f7d68569950>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569d90>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4359.565703868866, "timesteps_since_restore": 239884, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 28.307142857142857, "ram_util_percent": 15.199999999999994}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3568565067924524, "episode_len_mean": 455.74, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.3568565067924524}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.765560572575088, "avg_speed_min": 0.7455299380052337, "avg_speed_max": 7.695692177202605, "avg_rl_veh_arrival_mean": 153.92, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3127789218133503, "mean_processing_ms": 2.844983455564616, "mean_inference_ms": 0.37179023621410906}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101167, "num_steps_trained": 9263500, "num_steps_sampled": 240889, "sample_time_ms": 157.082, "replay_time_ms": 13.531, "grad_time_ms": 13.875, "update_time_ms": 0.004, "opt_peak_throughput": 7207.24, "opt_samples": 100.0, "learner": {"av": {"mean_q": -669544.0, "max_q": -69747.7421875, "min_q": -1454466.875}}}, "timesteps_this_iter": 1005, "done": false, "timesteps_total": 240889, "episodes_total": 539, "training_iteration": 235, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-29", "timestamp": 1585802309, "time_this_iter_s": 7.290308237075806, "time_total_s": 4366.856012105942, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629598>", "on_episode_step": "<function on_episode_step at 0x7f7d68629730>", "on_episode_end": "<function on_episode_end at 0x7f7d68629e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9378>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4366.856012105942, "timesteps_since_restore": 240889, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 25.172727272727272, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.38073012384726523, "episode_len_mean": 455.74, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.38073012384726523}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.896724665933216, "avg_speed_min": 2.797010107584656, "avg_speed_max": 7.695692177202605, "avg_rl_veh_arrival_mean": 146.65, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.310533705321776, "mean_processing_ms": 2.8439459812284564, "mean_inference_ms": 0.3706835249167096}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101308, "num_steps_trained": 9277600, "num_steps_sampled": 241908, "sample_time_ms": 145.425, "replay_time_ms": 14.684, "grad_time_ms": 12.498, "update_time_ms": 0.004, "opt_peak_throughput": 8001.312, "opt_samples": 100.0, "learner": {"av": {"mean_q": -640820.9375, "max_q": -46415.1484375, "min_q": -1402706.625}}}, "timesteps_this_iter": 1019, "done": false, "timesteps_total": 241908, "episodes_total": 541, "training_iteration": 236, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-36", "timestamp": 1585802316, "time_this_iter_s": 7.350489616394043, "time_total_s": 4374.206501722336, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68727950>", "on_episode_step": "<function on_episode_step at 0x7f7d68727c80>", "on_episode_end": "<function on_episode_end at 0x7f7d68727bf8>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687279d8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4374.206501722336, "timesteps_since_restore": 241908, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 29.909999999999997, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.347108590203836, "episode_len_mean": 451.5, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.347108590203836}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.912589843676215, "avg_speed_min": 2.797010107584656, "avg_speed_max": 7.695692177202605, "avg_rl_veh_arrival_mean": 148.58, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3071685339408352, "mean_processing_ms": 2.842520185669022, "mean_inference_ms": 0.3690195779904565}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101451, "num_steps_trained": 9291900, "num_steps_sampled": 242980, "sample_time_ms": 263.145, "replay_time_ms": 18.824, "grad_time_ms": 14.022, "update_time_ms": 0.004, "opt_peak_throughput": 7131.569, "opt_samples": 100.0, "learner": {"av": {"mean_q": -625717.25, "max_q": -38632.4375, "min_q": -1360612.0}}}, "timesteps_this_iter": 1072, "done": false, "timesteps_total": 242980, "episodes_total": 544, "training_iteration": 237, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-45", "timestamp": 1585802325, "time_this_iter_s": 8.51759386062622, "time_total_s": 4382.724095582962, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543b70>", "on_episode_step": "<function on_episode_step at 0x7f7d68487048>", "on_episode_end": "<function on_episode_end at 0x7f7d684870d0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68487158>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4382.724095582962, "timesteps_since_restore": 242980, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 26.45833333333333, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3498311403534705, "episode_len_mean": 451.5, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.3498311403534705}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.05, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 6.9574518004854164, "avg_speed_min": 2.797010107584656, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 147.25, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3049545486584346, "mean_processing_ms": 2.841595223812246, "mean_inference_ms": 0.3679205578494962}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101591, "num_steps_trained": 9305900, "num_steps_sampled": 243980, "sample_time_ms": 144.994, "replay_time_ms": 15.068, "grad_time_ms": 13.475, "update_time_ms": 0.005, "opt_peak_throughput": 7421.275, "opt_samples": 100.0, "learner": {"av": {"mean_q": -697984.75, "max_q": -98089.53125, "min_q": -1524024.5}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 243980, "episodes_total": 546, "training_iteration": 238, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-52", "timestamp": 1585802332, "time_this_iter_s": 7.212762355804443, "time_total_s": 4389.9368579387665, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778598>", "on_episode_step": "<function on_episode_step at 0x7f7d68778378>", "on_episode_end": "<function on_episode_end at 0x7f7d68778730>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d687781e0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4389.9368579387665, "timesteps_since_restore": 243980, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 29.227272727272734, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3666796654743017, "episode_len_mean": 455.41, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.3666796654743017}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.025729404932012, "avg_speed_min": 2.991098579275952, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 145.99, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3027502859352078, "mean_processing_ms": 2.840593797601753, "mean_inference_ms": 0.366824566677505}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101734, "num_steps_trained": 9320200, "num_steps_sampled": 244980, "sample_time_ms": 146.547, "replay_time_ms": 15.54, "grad_time_ms": 13.226, "update_time_ms": 0.004, "opt_peak_throughput": 7561.024, "opt_samples": 100.0, "learner": {"av": {"mean_q": -778800.0, "max_q": -8454.6513671875, "min_q": -1794687.0}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 244980, "episodes_total": 548, "training_iteration": 239, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-38-59", "timestamp": 1585802339, "time_this_iter_s": 7.246667146682739, "time_total_s": 4397.183525085449, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d686048c8>", "on_episode_step": "<function on_episode_step at 0x7f7d68543b70>", "on_episode_end": "<function on_episode_end at 0x7f7d68778400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4397.183525085449, "timesteps_since_restore": 244980, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 26.57, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.37805833117560816, "episode_len_mean": 455.41, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.37805833117560816}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.071176680829043, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 143.22, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.3005207151710072, "mean_processing_ms": 2.839575262713499, "mean_inference_ms": 0.3657145453850873}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101872, "num_steps_trained": 9334000, "num_steps_sampled": 245980, "sample_time_ms": 144.727, "replay_time_ms": 16.555, "grad_time_ms": 13.276, "update_time_ms": 0.004, "opt_peak_throughput": 7532.143, "opt_samples": 100.0, "learner": {"av": {"mean_q": -886691.75, "max_q": -37098.8671875, "min_q": -2009137.25}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 245980, "episodes_total": 550, "training_iteration": 240, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-39-07", "timestamp": 1585802347, "time_this_iter_s": 7.082864761352539, "time_total_s": 4404.266389846802, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778d90>", "on_episode_step": "<function on_episode_step at 0x7f7d68569598>", "on_episode_end": "<function on_episode_end at 0x7f7d68569e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68569bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4404.266389846802, "timesteps_since_restore": 245980, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 27.57, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.37811424999629006, "episode_len_mean": 455.41, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.37811424999629006}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.074655652187005, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 143.33, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2982972981556722, "mean_processing_ms": 2.8385226332406703, "mean_inference_ms": 0.3646074154012655}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102032, "num_steps_trained": 9350000, "num_steps_sampled": 246980, "sample_time_ms": 2.957, "replay_time_ms": 12.324, "grad_time_ms": 12.018, "update_time_ms": 0.003, "opt_peak_throughput": 8321.157, "opt_samples": 100.0, "learner": {"av": {"mean_q": -1072977.0, "max_q": -101894.0234375, "min_q": -2398519.5}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 246980, "episodes_total": 552, "training_iteration": 241, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-39-14", "timestamp": 1585802354, "time_this_iter_s": 7.720542669296265, "time_total_s": 4411.986932516098, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68543bf8>", "on_episode_step": "<function on_episode_step at 0x7f7d68543b70>", "on_episode_end": "<function on_episode_end at 0x7f7d687781e0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778840>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4411.986932516098, "timesteps_since_restore": 246980, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 28.409090909090914, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.4136488486723313, "episode_len_mean": 459.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.4136488486723313}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.102456502054114, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 139.56, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2960624569850332, "mean_processing_ms": 2.8374159565586545, "mean_inference_ms": 0.36349537012722644}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102159, "num_steps_trained": 9362700, "num_steps_sampled": 247980, "sample_time_ms": 3.243, "replay_time_ms": 14.109, "grad_time_ms": 12.875, "update_time_ms": 0.004, "opt_peak_throughput": 7766.741, "opt_samples": 100.0, "learner": {"av": {"mean_q": -1233312.75, "max_q": -12018.1484375, "min_q": -2771800.5}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 247980, "episodes_total": 554, "training_iteration": 242, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-39-21", "timestamp": 1585802361, "time_this_iter_s": 6.761486768722534, "time_total_s": 4418.748419284821, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778730>", "on_episode_step": "<function on_episode_step at 0x7f7d68778c80>", "on_episode_end": "<function on_episode_end at 0x7f7d68778ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778048>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4418.748419284821, "timesteps_since_restore": 247980, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 25.78, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.5736946638760353, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.41371052310971007, "episode_len_mean": 459.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.5736946638760353}, "policy_reward_mean": {"av": 0.41371052310971007}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.10739956361567, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 139.7, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.293846986717902, "mean_processing_ms": 2.8363210950222286, "mean_inference_ms": 0.3623933667861583}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102291, "num_steps_trained": 9375900, "num_steps_sampled": 248980, "sample_time_ms": 145.818, "replay_time_ms": 17.091, "grad_time_ms": 14.952, "update_time_ms": 0.004, "opt_peak_throughput": 6688.221, "opt_samples": 100.0, "learner": {"av": {"mean_q": -1450843.625, "max_q": -57555.6484375, "min_q": -3320575.5}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 248980, "episodes_total": 556, "training_iteration": 243, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-39-28", "timestamp": 1585802368, "time_this_iter_s": 6.983616352081299, "time_total_s": 4425.732035636902, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d687781e0>", "on_episode_step": "<function on_episode_step at 0x7f7d68778268>", "on_episode_end": "<function on_episode_end at 0x7f7d68778d90>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9268>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4425.732035636902, "timesteps_since_restore": 248980, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 24.869999999999997, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.573826160138673, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.41380279015624793, "episode_len_mean": 459.44, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.573826160138673}, "policy_reward_mean": {"av": 0.41380279015624793}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.04, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.113434484766623, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 139.8, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2916508641153386, "mean_processing_ms": 2.8352419411346506, "mean_inference_ms": 0.36130171057373234}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102442, "num_steps_trained": 9391000, "num_steps_sampled": 249980, "sample_time_ms": 2.991, "replay_time_ms": 13.197, "grad_time_ms": 12.28, "update_time_ms": 0.004, "opt_peak_throughput": 8143.094, "opt_samples": 100.0, "learner": {"av": {"mean_q": -1550186.5, "max_q": -52831.46875, "min_q": -3646301.0}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 249980, "episodes_total": 558, "training_iteration": 244, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-39-36", "timestamp": 1585802376, "time_this_iter_s": 7.589038610458374, "time_total_s": 4433.32107424736, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9d08>", "on_episode_step": "<function on_episode_step at 0x7f7d685f9378>", "on_episode_end": "<function on_episode_end at 0x7f7d685f9ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f92f0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4433.32107424736, "timesteps_since_restore": 249980, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 28.463636363636365, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.573826160138673, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.4292022803399502, "episode_len_mean": 463.41, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.573826160138673}, "policy_reward_mean": {"av": 0.4292022803399502}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.132945658856797, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 140.12, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2894709382499494, "mean_processing_ms": 2.834092475895223, "mean_inference_ms": 0.3602208655496411}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102564, "num_steps_trained": 9403200, "num_steps_sampled": 250980, "sample_time_ms": 141.822, "replay_time_ms": 17.366, "grad_time_ms": 12.808, "update_time_ms": 0.004, "opt_peak_throughput": 7807.583, "opt_samples": 100.0, "learner": {"av": {"mean_q": -1907488.375, "max_q": -124710.15625, "min_q": -3786792.0}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 250980, "episodes_total": 560, "training_iteration": 245, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-39-42", "timestamp": 1585802382, "time_this_iter_s": 6.676858901977539, "time_total_s": 4439.997933149338, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68629ae8>", "on_episode_step": "<function on_episode_step at 0x7f7d68629b70>", "on_episode_end": "<function on_episode_end at 0x7f7d68629e18>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4439.997933149338, "timesteps_since_restore": 250980, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 27.822222222222223, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.573826160138673, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.4290838970316964, "episode_len_mean": 459.7, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.573826160138673}, "policy_reward_mean": {"av": 0.4290838970316964}, "custom_metrics": {"num_ped_collisions_mean": 0.02, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.128092917023416, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 140.08, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2862002439846634, "mean_processing_ms": 2.8324578920362433, "mean_inference_ms": 0.35859836724216376}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102757, "num_steps_trained": 9422500, "num_steps_sampled": 252103, "sample_time_ms": 141.774, "replay_time_ms": 13.392, "grad_time_ms": 13.349, "update_time_ms": 0.004, "opt_peak_throughput": 7491.046, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2255013.5, "max_q": -75290.7578125, "min_q": -4323600.5}}}, "timesteps_this_iter": 1123, "done": false, "timesteps_total": 252103, "episodes_total": 563, "training_iteration": 246, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-39-52", "timestamp": 1585802392, "time_this_iter_s": 9.816027164459229, "time_total_s": 4449.813960313797, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d685f9d08>", "on_episode_step": "<function on_episode_step at 0x7f7d685f92f0>", "on_episode_end": "<function on_episode_end at 0x7f7d685f9268>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d685f9ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4449.813960313797, "timesteps_since_restore": 252103, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 25.099999999999998, "ram_util_percent": 15.199999999999994}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.573826160138673, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.39347565231357434, "episode_len_mean": 455.39, "episodes_this_iter": 3, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.573826160138673}, "policy_reward_mean": {"av": 0.39347565231357434}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.094916013982945, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 143.78, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2830089038860126, "mean_processing_ms": 2.831003541846299, "mean_inference_ms": 0.35701766399230095}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102905, "num_steps_trained": 9437300, "num_steps_sampled": 253154, "sample_time_ms": 141.733, "replay_time_ms": 14.371, "grad_time_ms": 12.537, "update_time_ms": 0.003, "opt_peak_throughput": 7976.464, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2324707.75, "max_q": -140842.09375, "min_q": -4795440.0}}}, "timesteps_this_iter": 1051, "done": false, "timesteps_total": 253154, "episodes_total": 566, "training_iteration": 247, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-40-01", "timestamp": 1585802401, "time_this_iter_s": 8.685983180999756, "time_total_s": 4458.499943494797, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f6bf8>", "on_episode_step": "<function on_episode_step at 0x7f7d684f6e18>", "on_episode_end": "<function on_episode_end at 0x7f7d684f6ea0>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684f6a60>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4458.499943494797, "timesteps_since_restore": 253154, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 28.908333333333335, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.573826160138673, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.3933938090600471, "episode_len_mean": 455.39, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.573826160138673}, "policy_reward_mean": {"av": 0.3933938090600471}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.090058223711343, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 143.88, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2809054592195321, "mean_processing_ms": 2.8300529192700576, "mean_inference_ms": 0.3559774060421647}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 103042, "num_steps_trained": 9451000, "num_steps_sampled": 254154, "sample_time_ms": 143.054, "replay_time_ms": 13.48, "grad_time_ms": 12.907, "update_time_ms": 0.004, "opt_peak_throughput": 7747.974, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2583097.0, "max_q": -91380.7265625, "min_q": -5687663.5}}}, "timesteps_this_iter": 1000, "done": false, "timesteps_total": 254154, "episodes_total": 568, "training_iteration": 248, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-40-08", "timestamp": 1585802408, "time_this_iter_s": 6.983897924423218, "time_total_s": 4465.48384141922, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684b82f0>", "on_episode_step": "<function on_episode_step at 0x7f7d684b8378>", "on_episode_end": "<function on_episode_end at 0x7f7d684b8400>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d684b8488>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4465.48384141922, "timesteps_since_restore": 254154, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 26.79, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.573826160138673, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.39340911253645716, "episode_len_mean": 455.39, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.573826160138673}, "policy_reward_mean": {"av": 0.39340911253645716}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.086665105612796, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 143.56, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2788215257099729, "mean_processing_ms": 2.8291134085072973, "mean_inference_ms": 0.35494682497498187}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 103181, "num_steps_trained": 9464900, "num_steps_sampled": 255160, "sample_time_ms": 144.619, "replay_time_ms": 14.298, "grad_time_ms": 14.146, "update_time_ms": 0.004, "opt_peak_throughput": 7069.222, "opt_samples": 100.0, "learner": {"av": {"mean_q": -2869711.0, "max_q": -86490.234375, "min_q": -5903927.0}}}, "timesteps_this_iter": 1006, "done": false, "timesteps_total": 255160, "episodes_total": 570, "training_iteration": 249, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-40-15", "timestamp": 1585802415, "time_this_iter_s": 7.151898384094238, "time_total_s": 4472.635739803314, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d68778378>", "on_episode_step": "<function on_episode_step at 0x7f7d68778730>", "on_episode_end": "<function on_episode_end at 0x7f7d68778598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68778ea0>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4472.635739803314, "timesteps_since_restore": 255160, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 27.64545454545454, "ram_util_percent": 15.199999999999996}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
{"episode_reward_max": 0.573826160138673, "episode_reward_min": -2.9987520449634455, "episode_reward_mean": 0.39335417126055583, "episode_len_mean": 455.39, "episodes_this_iter": 2, "policy_reward_min": {"av": -2.9987520449634455}, "policy_reward_max": {"av": 0.573826160138673}, "policy_reward_mean": {"av": 0.39335417126055583}, "custom_metrics": {"num_ped_collisions_mean": 0.03, "num_ped_collisions_min": 0, "num_ped_collisions_max": 1, "num_veh_collisions_mean": 0.03, "num_veh_collisions_min": 0, "num_veh_collisions_max": 1, "avg_speed_mean": 7.0827838067806645, "avg_speed_min": 3.416919151828472, "avg_speed_max": 7.764350113364023, "avg_rl_veh_arrival_mean": 143.46, "avg_rl_veh_arrival_min": 86.0, "avg_rl_veh_arrival_max": 500.0}, "sampler_perf": {"mean_env_wait_ms": 1.2767555649089768, "mean_processing_ms": 2.828185264256734, "mean_inference_ms": 0.35392441488809967}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 103315, "num_steps_trained": 9478300, "num_steps_sampled": 256162, "sample_time_ms": 144.347, "replay_time_ms": 14.883, "grad_time_ms": 12.564, "update_time_ms": 0.003, "opt_peak_throughput": 7959.39, "opt_samples": 100.0, "learner": {"av": {"mean_q": -3144638.0, "max_q": -192043.046875, "min_q": -6062738.0}}}, "timesteps_this_iter": 1002, "done": true, "timesteps_total": 256162, "episodes_total": 572, "training_iteration": 250, "experiment_id": "faccd81316344eee94a482d8d6d6b9ee", "date": "2020-04-02_04-40-22", "timestamp": 1585802422, "time_this_iter_s": 7.015226125717163, "time_total_s": 4479.650965929031, "pid": 2352, "hostname": "ip-172-31-31-33", "node_ip": "172.31.31.33", "config": {"num_workers": 0, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 100, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 500, "soft_horizon": false, "no_done_at_end": true, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"max_accel\": 2.6,\n            \"max_decel\": 4.5,\n            \"max_num_objects\": 3,\n            \"search_radius\": 50,\n            \"target_velocity\": 25\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 500,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.bayesian_1_env.Bayesian1Env\",\n    \"exp_tag\": \"bayesian_1_env\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"sidewalks\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 1,\n                \"cars_left\": 0,\n                \"cars_right\": 1,\n                \"cars_top\": 1,\n                \"col_num\": 1,\n                \"inner_length\": 50,\n                \"row_num\": 1\n            },\n            \"horizontal_lanes\": 1,\n            \"randomize_routes\": true,\n            \"speed_limit\": 35,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": []\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.bayesian_1.Bayesian1Network\",\n    \"ped\": {\n        \"_PedestrianParams__pedestrians\": {},\n        \"ids\": [\n            \"ped_0\"\n        ],\n        \"num_pedestrians\": 1,\n        \"params\": {\n            \"ped_0\": {\n                \"arrivalPos\": \"43\",\n                \"depart\": \"0.00\",\n                \"departPos\": \"5\",\n                \"from\": \"(1.1)--(2.1)\",\n                \"id\": \"ped_0\",\n                \"to\": \"(2.1)--(1.1)\"\n            }\n        }\n    },\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"rllib_training\": false,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 2,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "TD3"}, "env": "Bayesian1Env-v0", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": "<function on_episode_start at 0x7f7d684f6ea0>", "on_episode_step": "<function on_episode_step at 0x7f7d68553400>", "on_episode_end": "<function on_episode_end at 0x7f7d68553598>", "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": [null, "Box(25,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function setup_exps_TD3.<locals>.policy_mapping_fn at 0x7f7d68543bf8>", "policies_to_train": ["av"]}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.0001, "actor_lr": 1e-05, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4479.650965929031, "timesteps_since_restore": 256162, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 28.0, "ram_util_percent": 15.199999999999998}, "num_healthy_workers": 0, "trial_id": "9ab2c76c", "experiment_tag": "2_actor_lr=1e-05,critic_lr=0.0001,prioritized_replay=True"}
